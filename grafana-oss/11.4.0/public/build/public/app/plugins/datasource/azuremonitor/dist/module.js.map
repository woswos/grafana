{"version":3,"file":"module.js","mappings":"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EAC5C,oCAAoC,EACpC,yCAAyC,EACzC,4CAA4C,EAC5C,iDAAiD,EACjD,yDAAyD,EACzD,wDAAwD,EACxD,6BAA6B,EAC7B,qCAAqC,EACrC,mCAAmC,EACnC,sCAAsC,EACtC,6CAA6C,EAC7C,qCAAqC,EACrC,sCAAsC,GAG3BC,GAAgB,CAC3B,+BACA,kCACA,qCACA,kCACA,8BACA,qBACA,oCACA,iDACA,+BACA,0CACA,8BACA,iCACA,mCACA,4DACA,gCACA,+BACA,0BACA,mCACA,4CACA,+CACA,6CACA,oCACA,gDACA,gDACA,wBACA,kCACA,kDACA,yBACA,uCACA,mDACA,2CACA,2CACA,wDACA,wDACA,yDACA,yDACA,kCACA,4BACA,8BACA,4CACA,uCACA,gDACA,kCACA,wCACA,0BACA,oCACA,4CACA,4DACA,sCACA,kDACA,wCACA,8CACA,8CACA,iDACA,yCACA,6CACA,kCACA,8CACA,8BACA,2CACA,yCACA,sCACA,kCACA,uCACA,mCACA,wCACA,+BACA,iCACA,uCACA,+BACA,4CACA,2CACA,oCACA,sCACA,iCACA,4BACA,yCACA,uCACA,+CACA,yCACA,wCACA,qCACA,gCACA,mCACA,8CACA,8BACA,yCACA,sCACA,iCACA,wCACA,oCACA,mCACA,6BACA,8BACA,gCACA,yCACA,+BACA,oCACA,oDACA,mDACA,oDACA,qCACA,uDACA,2CACA,kDACA,uCACA,gCACA,yCACA,+BACA,4BACA,iCACA,4BACA,yCACA,+CACA,2BACA,iDACA,4BACA,+CACA,+DACA,2EACA,kDACA,oDACA,gDACA,0BACA,gCACA,2CACA,mDACA,iCACA,2CACA,iDACA,gDACA,+CACA,kDACA,uEACA,8CACA,6BACA,gDACA,wDACA,wCACA,mCACA,iCACA,gCACA,0CACA,wCACA,iCACA,6BACA,yCACA,kDACA,yCACA,sCACA,+BACA,kCACA,gCACA,sCACA,8CACA,6CACA,oCACA,uDACA,mCACA,oCACA,qCACA,wCACA,sCACA,qCACA,2CACA,gCACA,2CACA,oCACA,mCACA,gCACA,4CACA,2CACA,yCACA,kCACA,2CACA,mDACA,yDACA,2CACA,2CACA,oCACA,kCACA,gCACA,8BACA,6BACA,oCACA,2BACA,wCACA,6BACA,oCACA,6BACA,oCACA,kCACA,wCACA,0DACA,kCACA,2CACA,iDACA,mCACA,4CACA,qCACA,8CACA,iCACA,iCACA,kCACA,qCACA,kCACA,wCACA,oCACA,iDACA,iDACA,8DACA,kDACA,iDACA,kDACA,iCACA,wCACA,gCACA,uCACA,4CACA,sCACA,0CACA,+BACA,4CACA,0CACA,0CACA,wCACA,4CACA,yDACA,8CACA,iDACA,8BACA,oCACA,mDACA,gDACA,4BACA,sBACA,4BACA,4BACA,mCACA,sDACA,kDACA,qEACA,4BACA,+CACA,+CACA,q2BC1qBF,MAAMhoB,GAAahV,IAA0B,CAC3CkxB,cAAc9wB,EAAAA,EAAAA,KAAI,CAAE8B,QAAS,OAAQ+6B,UAAWj9B,EAAMO,QAAQ,GAAI6U,SAAU,OAAQ3S,aAAczC,EAAMO,QAAQ,KAChHmM,UAAUtM,EAAAA,EAAAA,KAAI,CAAE88B,KAAM,aACtBC,eAAe/8B,EAAAA,EAAAA,KAAI,CAAEqV,QAASzV,EAAMO,QAAQ,KAC5C68B,sBAAsBh9B,EAAAA,EAAAA,KAAI,CAAE8B,QAAS,OAAQ+6B,UAAWj9B,EAAMO,QAAQ,QAiJxE,GA9I+B,EAAGyZ,YAAWlM,mBAiD5BkM,EAYAA,EAAAA,EAKAA,EAgBAA,EAjFf,MAAM9Z,GAAS6U,EAAAA,EAAAA,YAAWC,KAE1BlM,EAAAA,EAAAA,YAAU,KAEiB,IAArBkR,EAAUhkB,QACZ8X,EAAS,CAAC,CAAC,GACb,GACC,CAACkM,EAAWlM,IAEf,MAAMwjB,EAAmB,CAAC7c,EAAe/H,KACvC,MAAMie,EAAe,IAAI3Q,GACzB2Q,EAAalW,GAAS/H,EACtBoB,EAAS6c,EAAa,EAoBlB0S,EAAsB7iC,IAC1BsT,EAASkM,EAAUrT,KAAK+F,GAAc,MAAKA,EAAalS,KAAAA,MAe3Cwf,EAiBAA,EAgBAA,EA7Cf,OACE,iCACE,SAACzB,EAAAA,YAAWA,CACVpS,MAAM,eACNm3B,MAAI,EACJC,aAAW,EACX9vB,QAAS,8CACT2K,WAAY,GACZ5K,cAAanC,GAAiCW,eAAeI,SAASE,aAAaf,gBAEnF,SAAC6C,EAAAA,MAAKA,CACJQ,GAAI,8CACJ/P,MAAiC,QAA1Bmb,EAAY,QAAZA,EAAAA,EAAU,UAAVA,IAAAA,OAAAA,EAAAA,EAAc1N,oBAAd0N,IAAAA,EAAAA,EAA8B,GACrClM,SAAWQ,GAAU+uB,EAAmB,CAAE/wB,aAAcgC,EAAMke,cAAc3tB,QAC5EwP,YAAY,wCAGhB,SAACkK,EAAAA,YAAWA,CACVpS,MAAM,YACNm3B,MAAI,EACJC,aAAW,EACX9vB,QAAS,iDACT2K,WAAY,GACZ5K,cAAanC,GAAiCW,eAAeI,SAASI,UAAUjB,MAChF2C,QAAqB,QAAZ8L,EAAAA,EAAU,UAAVA,IAAAA,GAA6B,QAA7BA,EAAAA,EAAcxU,uBAAdwU,IAAAA,OAAAA,EAAAA,EAA+BoO,SAAS,KACjDja,MAAO,4CAEP,SAACC,EAAAA,MAAKA,CACJQ,GAAI,iDACJ/P,MAAoC,QAA7Bmb,EAAY,QAAZA,EAAAA,EAAU,UAAVA,IAAAA,OAAAA,EAAAA,EAAcxU,uBAAdwU,IAAAA,EAAAA,EAAiC,GACxClM,SAAWQ,GAAU+uB,EAAmB,CAAE73B,gBAAiB8I,EAAMke,cAAc3tB,QAC/EwP,YAAY,2CAGhB,SAACkK,EAAAA,YAAWA,CACVpS,MAAM,SACNm3B,MAAI,EACJC,aAAW,EACX9vB,QAAS,wCACT2K,WAAY,GACZ5K,cAAanC,GAAiCW,eAAeI,SAASK,OAAOlB,MAC7E0L,QAAQ,mHAER,SAAC7I,EAAAA,MAAKA,CACJQ,GAAI,wCACJ/P,MAA2B,QAApBmb,EAAY,QAAZA,EAAAA,EAAU,UAAVA,IAAAA,OAAAA,EAAAA,EAAcvN,cAAduN,IAAAA,EAAAA,EAAwB,GAC/BlM,SAAWQ,GAAU+uB,EAAmB,CAAE5wB,OAAQ6B,EAAMke,cAAc3tB,QACtEwP,YAAY,mBAGhB,SAACE,MAAAA,CAAIxO,UAAWG,EAAOgxB,sBACpBlX,EAAUrT,KAAI,CAAC+F,EAAU+H,SAaT/H,EA0BFA,SAtCb,UAAC6B,MAAAA,CAAkCxO,UAAWG,EAAOwM,mBAC7B,IAArBsN,EAAUhkB,SAAgB,UAACo7B,EAAAA,MAAKA,CAACrxB,UAAWG,EAAOi9B,wBAAe,YAAU1oB,EAAQ,MACrF,SAAC8D,EAAAA,YAAWA,CACVpS,MAAM,iBACNo3B,aAAW,EACX9vB,QAAS,gDAAgDgH,EAAQ,IACjE2D,WAAY,GACZ5K,cAAanC,GAAiCW,eAAeI,SAASG,cAAchB,gBAEpF,UAACgD,MAAAA,CAAIxO,UAAWG,EAAOk9B,gCACrB,SAAChvB,EAAAA,MAAKA,CACJQ,GAAI,gDAAgD6F,EAAQ,IAC5D5V,MAA8B,QAAvB6N,EAAAA,aAAAA,EAAAA,EAAUH,qBAAVG,IAAAA,EAAAA,EAA2B,GAClCoB,SAAWQ,GACTgjB,EAAiB7c,EAAO,SAAK/H,GAAAA,CAAUH,cAAe+B,EAAMke,cAAc3tB,SAE5EwP,YAAY,oBAEd,SAAC0iB,GAAeA,CACdnjB,aAAW,SACXiK,KAAK,QACLlJ,QAAQ,YACR9L,QAAS,IA/FF,CAAC4R,IACtB,MAAMkW,EAAe,IAAI3Q,GACzB2Q,EAAa/V,OAAOH,EAAO,GAC3B3G,EAAS6c,EAAa,EA4FO4G,CAAe9c,GAC9B+c,OAA6B,IAArBxX,EAAUhkB,OAClBwX,cAAa,0BAKnB,SAAC+K,EAAAA,YAAWA,CACVpS,MAAM,gBACNo3B,aAAW,EACX9vB,QAAS,+CAA+CgH,EAAQ,IAChE2D,WAAY,GACZ5K,cAAanC,GAAiCW,eAAeI,SAASM,SAASnB,gBAE/E,SAAC6C,EAAAA,MAAKA,CACJQ,GAAI,+CAA+C6F,EAAQ,IAC3D5V,MAA6B,QAAtB6N,EAAAA,aAAAA,EAAAA,EAAUgb,oBAAVhb,IAAAA,EAAAA,EAA0B,GACjCoB,SAAWQ,GAAUgjB,EAAiB7c,EAAO,SAAK/H,GAAAA,CAAUgb,aAAcpZ,EAAMke,cAAc3tB,SAC9FwP,YAAY,aAxCR,YAAYoG,EAAQ,IAAG,OA8CrC,SAAC/F,EAAAA,OAAMA,CAACd,aAAW,MAAMiK,KAAK,OAAOlJ,QAAQ,YAAY9L,QAjHzC,SAGAmX,EACGA,EAHrBlM,EACEkM,EAAU1gB,OAAO,CACfgT,aAA0B,QAAZ0N,EAAAA,EAAU,UAAVA,IAAAA,OAAAA,EAAAA,EAAc1N,aAC5B9G,gBAA6B,QAAZwU,EAAAA,EAAU,UAAVA,IAAAA,OAAAA,EAAAA,EAAcxU,gBAC/B+G,cAAe,GACfmb,aAAc,KAChB,EA0G+E/vB,KAAK,kBAAS,00BC3J5F,SAAS6lC,GAAmBznB,EAA0B0nB,OACvD1nB,EAAJ,OAAsB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoB6S,mBAAoB6U,EACnC1nB,GAGL0nB,aAAAA,EAAAA,EAAWr1B,cAAc+f,WAAW,uCAC/B,SACFpS,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrB1qB,gBAAiBi4B,EACjB93B,gBAAYzH,EACZiyB,iBAAajyB,EACbqF,UAAW,GACX6sB,iBAAkB,OAKjB,SACFra,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrBtH,gBAAiB6U,EACjB93B,gBAAYzH,EACZiyB,iBAAajyB,EACbqF,UAAW,GACX6sB,iBAAkB,MAGxB,CAiCO,SAASsN,GAAa3nB,EAA0BxS,OACjDwS,EAAJ,OAAsB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBxS,aAAcA,EAC7BwS,EAGF,SACFA,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrB3sB,UAAWA,KAGjB,CAEO,SAASo6B,GAAoB5nB,EAA0BzP,OACxDyP,EAAJ,OAAsB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBqa,oBAAqB9pB,EACpCyP,EAGF,SACFA,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrBE,iBAAkB9pB,KAGxB,CC3EA,MAkCA,GAlCyB,EACvByP,QACA7N,sBACA8N,gBACA4nB,qBACA/Q,oBAc2E9W,EAM9DA,EAlBb,MAAM+a,GAAexc,EAAAA,EAAAA,cAClBsE,IACC,IAAKA,EAAO/Z,MACV,OAGF,MAAMoX,EDsBL,SAAwBF,EAA0Boa,OACnDpa,EAAJ,OAAsB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBoa,eAAgBA,EAC/Bpa,EAGF,SACFA,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrBC,YAAaA,KAGnB,CClCuB0N,CAAe9nB,EAAO6C,EAAO/Z,OAC9CmX,EAAcC,EAAS,GAEzB,CAACD,EAAeD,IAGZzO,EAAUW,EAAkB21B,EAAoB11B,EAAuC,QAAlB6N,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBoa,aAE/F,OACE,SAAC5iB,GAAKA,CAACpH,MAAM,wBACX,SAACuH,EAAAA,OAAMA,CACLC,QAAQ,0CACR9O,OAAyB,QAAlBkX,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBoa,cAAe,KAC1CriB,SAAUgjB,EACVxpB,QAASA,EACTulB,UAAWA,OCxCbiR,GAAa,gBAAiB,UAAqB,MAAEpO,EAAK,WAAEqO,EAAU,SAAEjwB,GAAYjR,GAexF,OAAuB,kBAAoBuS,GAAO,KAAMsgB,EAAM/oB,KAAI,CAACgB,EAAM8M,IAA0B,kBAAoB,MAAO,CAAE3d,IAAK2d,GAASspB,EAC5Ip2B,GACCq2B,GAZkB,EAACC,EAAWD,KAC/B,MAAME,EAAW,IAAIxO,GACrBwO,EAASD,GAAaD,EACtBlwB,EAASowB,EAAS,EASLC,CAAa1pB,EAAOupB,KACjC,IARmB,CAACC,IACpB,MAAMC,EAAW,IAAIxO,GACrBwO,EAAStpB,OAAOqpB,EAAW,GAC3BnwB,EAASowB,EAAS,EAKZE,CAAa3pB,QACA,kBAAoB,EAAA/F,OAAQ,CAAE7R,MAAKgG,QAlBtC,KAChB,MAAMq7B,EAAW,IAAIxO,EAAO,CAAC,GAC7B5hB,EAASowB,EAAS,EAgBwDvvB,QAAS,YAAa7L,KAAM,KAAM+U,KAAM,OAAQ,aAAc,MAAOlgB,KAAM,WACzJ,ICsLA,GA/IwB,EAAGqP,OAAM+O,QAAOsoB,mBAAkBroB,wBAGrDD,EAFH,MAAMqa,GAAmBrhB,EAAAA,EAAAA,UACvB,SAAMgH,EAAAA,SAAoC,QAApCA,EAAkB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBqa,wBAApBra,IAAAA,EAAAA,EAAwC,EAAE,GAChD,CAAmB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBqa,mBAGjBkO,EAlDmB,EAACt3B,EAA6B+O,KACvD,MAAOuoB,EAAiBC,IAAsB18B,EAAAA,EAAAA,UAA0B,CAAC,GAwCzE,OAvCAiH,EAAAA,EAAAA,YAAU,SAEJ9B,EADJ,IAAIw3B,EAA6B,CAAC,EAClC,GAAIx3B,SAAY,QAAZA,EAAAA,EAAM6vB,cAAN7vB,IAAAA,OAAAA,EAAAA,EAAchR,OAAQ,CAExB,MAGMyoC,EAHsBz3B,EAAK6vB,OAAO6H,OAAOv6B,QAAQ0yB,GAAWA,EAAOE,QAAUhhB,EAAMghB,QACnE4H,SAAS9H,GAAWA,EAAO+H,SAG9Cj4B,KAAKi4B,GAAWA,EAAOH,SACvBC,OACAv6B,QAAQwD,GAAyBA,UACpC,IAAK,MAAMxB,KAASs4B,EAElB,IAAK,MAAO73B,EAAW/H,KAAUpI,OAAOwqB,QAAQ9a,GAAQ,CACtD,MAAM04B,EAAiBj4B,EAAUwB,cAC7Bo2B,EAAUK,GACZL,EAAUK,GAAgBj3B,IAAI/I,GAE9B2/B,EAAUK,GAAkB,IAAIh3B,IAAI,CAAChJ,GAEzC,CAEJ,CACA0/B,GAAoBO,IAClB,MAAMC,EAA6B,CAAC,EAC9BC,EAAgBvoC,OAAOP,KAAKsoC,GAClC,GAA6B,IAAzBQ,EAAchpC,OAChB,OAAO8oC,EAET,IAAK,MAAM34B,KAAS64B,EACdF,EAAW34B,IAAUq4B,EAAUr4B,GAAOrD,KAAOg8B,EAAW34B,GAAOrD,KACjEi8B,EAAU54B,GAAS24B,EAAW34B,GAE9B44B,EAAU54B,GAASq4B,EAAUr4B,GAGjC,OAAO44B,CAAS,GAChB,GACD,CAAC/3B,aAAAA,EAAAA,EAAM6vB,OAAQ9gB,EAAMghB,QACjBuH,CAAe,EASEW,CAAmBj4B,EAAM+O,GAE3CmpB,EAAqD,CACzD,CAAE/4B,MAAO,KAAMtH,MAAO,MACtB,CAAEsH,MAAO,KAAMtH,MAAO,MACtB,CAAEsH,MAAO,cAAetH,MAAO,OAG3BsgC,GAAwBpwB,EAAAA,EAAAA,UAAQ,KAGpC,IAAItU,EAAI4jC,EAMR,OALIjO,EAAiBp6B,SACnByE,EAAI4jC,EAAiBl6B,QAClBwE,IAASynB,EAAiB1E,MAAM0T,GAAoBA,EAAgBx4B,YAAc+B,EAAI9J,WAGpFpE,CAAC,GACP,CAAC21B,EAAkBiO,IAEhBgB,EAAgB,CACpBC,EACA33B,EACA9I,EACAiP,KAEAnG,EAAK23B,GAAazgC,EAClBiP,EAASnG,EAAK,EAOV43B,EAAwB,CAACC,EAAoC54B,SAC7B03B,EAApC,MAAMlO,EAAmBj6B,MAAM2+B,KAA6C,QAAxCwJ,EAAAA,EAAgB13B,EAAUwB,sBAA1Bk2B,IAAAA,EAAAA,EAA4C,IAChF,OAAIlO,EAAiB/qB,MAAMlB,GAAWA,IAAWq7B,IACxCpP,EAAiBzpB,KAAKxC,IAAY,CAAEtF,MAAOsF,EAAQgC,MAAOhC,MAE5D,IAAIisB,KAAsBoP,GAAqC,MAAnBA,EAAyB,CAACA,GAAkB,IAAK74B,KAAKgB,IAAU,CACjH9I,MAAO8I,EACPxB,MAAOwB,KACN,EAGC83B,EAA6B,CAACC,EAAuC94B,KACzE,MAAM+4B,EAAeJ,OAAsBrhC,EAAW0I,GACtD,GAAI84B,EACF,IAAK,MAAMv7B,KAAUu7B,EACdC,EAAat6B,MAAMc,GAAUA,EAAMtH,QAAUsF,KAChDw7B,EAAar6B,KAAK,CAAEzG,MAAOsF,EAAQgC,MAAOhC,IAIhD,OAAOw7B,CAAY,EA4ErB,OACE,SAACpyB,GAAKA,CAACpH,MAAM,uBACX,SAAC23B,GAAUA,CAACpO,MAAOU,EAAkBtiB,SArEpB8xB,IACnB,MAAMC,EAAqCD,EAAQj5B,KAAK/L,QAEzCA,EACDA,EACDA,EAHX,MAAO,CACLgM,UAAsB,QAAXhM,EAAAA,EAAEgM,iBAAFhM,IAAAA,EAAAA,EAAe,GAC1BklC,SAAoB,QAAVllC,EAAAA,EAAEklC,gBAAFllC,IAAAA,EAAAA,EAAc,KACxBsgC,QAAkB,QAATtgC,EAAAA,EAAEsgC,eAAFtgC,IAAAA,EAAAA,EAAa,GACvB,IAEHob,EAAc2nB,GAAoB5nB,EAAO8pB,GAAY,EA6DS9B,WA1D1C,CACpBp2B,EACAmG,EACAiyB,SAwB0Dp4B,EAmBkBA,EAhEnDq4B,EA1BOC,EAiDhC,OACE,UAACC,EAAAA,gBAAeA,CAAC3/B,QAAQ,kBACvB,SAACmN,EAAAA,OAAMA,CACLyyB,kBAAgB,EAChB9xB,YAAY,QACZxP,MAAO8I,EAAKf,UACZU,SAvD0B24B,EAuDQt4B,EAAKf,WAAa,GAtDnDu4B,EAAsB7lC,OAAO+kC,EAAiBl6B,QAAQwD,GAASA,EAAK9I,QAAUohC,MAuD/EnyB,SAAWpU,QAAuCA,SAAjC2lC,EAAc,YAAa13B,EAAa,QAAPjO,EAAAA,EAAEmF,aAAFnF,IAAAA,EAAAA,EAAW,GAAIoU,EAAS,KAE5E,SAACJ,EAAAA,OAAMA,CACLyyB,kBAAgB,EAChB9xB,YAAY,YACZxP,MAAO8I,EAAKm4B,SACZx4B,SApCmB04B,EAoCQr4B,EAAKm4B,UAAY,KAnC9CZ,EAAmB75B,MAAMy6B,GAA8BA,EAASjhC,QAAUmhC,IACrEd,EAEF,IAAIA,KAAwBc,EAAmB,CAAC,CAAE75B,MAAO65B,EAAkBnhC,MAAOmhC,IAAsB,KAiCzGlyB,SAAWpU,QAAsCA,SAAhC2lC,EAAc,WAAY13B,EAAa,QAAPjO,EAAAA,EAAEmF,aAAFnF,IAAAA,EAAAA,EAAW,GAAIoU,EAAS,EACzEonB,kBAAgB,IAEC,OAAlBvtB,EAAKm4B,UAAuC,OAAlBn4B,EAAKm4B,UAC9B,SAACpnB,EAAAA,YAAWA,CACVynB,kBAAgB,EAChB9xB,YAAY,kBACZxP,MAAO8I,EAAKuzB,QACZ5zB,QAASm4B,EAA2B93B,EAAKuzB,QAAuB,QAAdvzB,EAAAA,EAAKf,iBAALe,IAAAA,EAAAA,EAAkB,IACpEmG,SAAWpU,GACT2lC,EACE,UACA13B,EACAjO,EAAEiN,KAAK/L,QAAMA,SAAO,QAAPA,EAAAA,EAAEiE,aAAFjE,IAAAA,EAAAA,EAAW,EAAE,IAC1BkT,GAGJF,aAAY,0BACZsnB,kBAAgB,KAIlB,SAACxnB,EAAAA,OAAMA,CACLyyB,kBAAgB,EAChB9xB,YAAY,eACZxP,MAAO8I,EAAKuzB,QAAUvzB,EAAKuzB,QAAQ,GAAK,GACxChG,kBAAgB,EAChB5tB,QAASi4B,EAAsB53B,EAAKuzB,QAAUvzB,EAAKuzB,QAAQ,GAAK,GAAkB,QAAdvzB,EAAAA,EAAKf,iBAALe,IAAAA,EAAAA,EAAkB,IACtFmG,SAAWpU,QAAsCA,SAAhC2lC,EAAc,UAAW13B,EAAM,CAAS,QAARjO,EAAAA,aAAAA,EAAAA,EAAGmF,aAAHnF,IAAAA,EAAAA,EAAY,IAAKoU,EAAS,EAC3E6K,aAAW,KAGf,SAACoY,GAAeA,CAACnjB,aAAW,SAASiK,KAAK,QAAQlJ,QAAQ,YAAY9L,QAASk9B,EAAUpoC,KAAK,oBC1JtG,GA9B0B,EAAGqe,gBAAeD,gBACCA,EAAAA,EAA3C,MAAOlX,EAAOuhC,IAAYv+B,EAAAA,EAAAA,UAA0C,QAAzBkU,EAAkB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoB+iB,aAApB/iB,IAAAA,EAAAA,EAA6B,IAIlE+a,GAAexc,EAAAA,EAAAA,cAAa0J,IAC5BA,EAAG9c,kBAAkBm/B,kBACvBD,EAASpiB,EAAG9c,OAAOrC,MACrB,GACC,IAEGyhC,GAAahsB,EAAAA,EAAAA,cAAY,KAC7B,MAAM2B,EJ8HH,SAAwBF,EAA0B+iB,OACnD/iB,EAAJ,OAAsB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoB+iB,SAAUA,EACzB/iB,EAGF,SACFA,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrB4I,MAAOA,KAGb,CI1IqByH,CAAexqB,EAAOlX,GACvCmX,EAAcC,EAAS,GACtB,CAACD,EAAeD,EAAOlX,IAE1B,OACE,SAAC0O,GAAKA,CAACpH,MAAM,0BACX,SAACiI,EAAAA,MAAKA,CACJQ,GAAG,qCACHP,YAAY,iBACZxP,MAAOA,EACPiP,SAAUgjB,EACVta,OAAQ8pB,EACRhqB,MAAO,QCUf,GA5BwB,EAAGkqB,cAAazqB,QAAO7N,sBAAqB8N,wBAaED,EAMvDA,EAlBb,MAAM+a,GAAexc,EAAAA,EAAAA,cAClBsE,IACC,IAAKA,EAAO/Z,MACV,OAGF,MAAMoX,ELWL,SAAuBF,EAA0BpQ,OAClDoQ,EAAJ,OAAsB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBpQ,cAAeA,EAC9BoQ,EAGF,SACFA,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrBvqB,WAAYA,EACZwqB,iBAAajyB,EACbqF,UAAW,GACX6sB,iBAAkB,MAGxB,CK1BuBqQ,CAAc1qB,EAAO6C,EAAO/Z,OAC7CmX,EAAcC,EAAS,GAEzB,CAACD,EAAeD,IAGZzO,EAAUW,EAAkBu4B,EAAat4B,EAAuC,QAAlB6N,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBpQ,gBAM3EoQ,EAJb,OACE,SAACxI,GAAKA,CAACpH,MAAM,SAASqH,cAAanC,GAAiCsB,mBAAmBhH,WAAW4F,gBAChG,SAACmC,EAAAA,OAAMA,CACLC,QAAQ,qCACR9O,MAAqC,QAA9BkX,EAAkB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBpQ,kBAApBoQ,IAAAA,EAAAA,EAAkC,KACzCjI,SAAUgjB,EACVxpB,QAASA,EACT4tB,kBAAgB,OCWxB,GAlC6B,EAC3BwL,mBACA3qB,QACA7N,sBACA8N,wBAccD,EAAuCA,EAZrD,MAAM+a,GAAexc,EAAAA,EAAAA,cAClBsE,IACC,IAAKA,EAAO/Z,MACV,OAGF,MAAMoX,EAAWunB,GAAmBznB,EAAO6C,EAAO/Z,OAClDmX,EAAcC,EAAS,GAEzB,CAACD,EAAeD,IAGZlX,GAA0B,QAAlBkX,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoB6S,mBAAqC,QAAlB7S,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBvQ,iBACnE8B,EAAUW,EAAkBy4B,EAAkBx4B,EAAqBrJ,GAEzE,OACE,SAAC0O,GAAKA,CAACpH,MAAM,6BACX,SAACuH,EAAAA,OAAMA,CACLC,QAAQ,+CACR9O,MAAOA,GAAS,KAChBiP,SAAUgjB,EACVxpB,QAASA,EACT4tB,kBAAgB,gIC3BxB,MA+CA,GA/CuB,EAAGnf,QAAO4qB,mBAAkBz4B,sBAAqB8N,wBAiC3BD,EAM9BA,EAtCb,MAAM+a,GAAexc,EAAAA,EAAAA,cAClBsE,IACC,IAAKA,EAAO/Z,MACV,OAGF,MAAMoX,EAAWynB,GAAa3nB,EAAO6C,EAAO/Z,OAC5CmX,EAAcC,EAAS,GAEzB,CAACD,EAAeD,IAGZ7R,GAAa6K,EAAAA,EAAAA,UAAQ,SAiB8CgH,EAhBvE,MAAM6qB,EAAeC,EAAmB78B,qBACtC,KACA28B,EAAiBh6B,KAAKpI,GAAMsiC,EAAmBh8B,iCAAiCtG,EAAEM,UAAW,CAC3F,KACA,KACA,MACA,MACA,KACA,KACA,MACA,OAIEiiC,EAAiBH,EAAiBh6B,KAAKjM,IAAOA,MAAY,SAAZA,EAAEmE,gVAAmB,IAAKnE,cAAAA,CAAG6G,YAAaq/B,qVAAiBlmC,SAAC,IAIhH,OAFgBuN,EAAkB64B,EAAgB54B,EAAuC,QAAlB6N,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBxS,UAE7E,GACb,CAACo9B,EAAkBz4B,EAAuC,QAAlB6N,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBxS,YAE/D,OACE,SAACgK,GAAKA,CAACpH,MAAM,uBACX,SAACuH,EAAAA,OAAMA,CACLC,QAAQ,yCACR9O,MAAyB,QAAlBkX,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBxS,UAC3BuK,SAAUgjB,EACVxpB,QAASpD,OClBjB,GA7BiB,EAAG8R,gBAAeD,gBACUA,EAAAA,EAA3C,MAAOlX,EAAOuhC,IAAYv+B,EAAAA,EAAAA,UAAwC,QAAvBkU,EAAkB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBgrB,WAApBhrB,IAAAA,EAAAA,EAA2B,IAIhE+a,GAAexc,EAAAA,EAAAA,cAAa0J,IAC5BA,EAAG9c,kBAAkBm/B,kBACvBD,EAASpiB,EAAG9c,OAAOrC,MACrB,GACC,IAEGyhC,GAAahsB,EAAAA,EAAAA,cAAY,KAC7B,MAAM2B,ERgHH,SAAgBF,EAA0BgrB,OAC3ChrB,EAAJ,OAAsB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBgrB,OAAQA,EACvBhrB,EAGF,SACFA,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrB6Q,IAAKA,KAGX,CQ5HqBC,CAAOjrB,EAAOlX,GAC/BmX,EAAcC,EAAS,GACtB,CAACD,EAAeD,EAAOlX,IAE1B,OACE,SAAC0O,GAAKA,CAACpH,MAAM,gBACX,SAACiI,EAAAA,MAAKA,CACJQ,GAAG,kCACH/P,MAAOA,EACPiP,SAAUgjB,EACVta,OAAQ8pB,EACRhqB,MAAO,QC/BR,SAAS2qB,GAAiBC,EAA2B1oB,EAAoB2oB,GAG9E,MAAO5sB,IAAe1S,EAAAA,EAAAA,WAAS,IAAMu/B,KAAKC,YACnCxiC,EAAOuhC,IAAYv+B,EAAAA,EAAAA,YAEpBy/B,GAAavyB,EAAAA,EAAAA,UAAQ,IAAMlQ,QAAAA,EAAS,IAAI,CAACA,IAc/C,OAZAiK,EAAAA,EAAAA,YAAU,KACRo4B,IACGpwB,MAAM6I,IACLymB,EAASzmB,GACTnB,EAASjE,OAAarW,EAAU,IAEjC0b,OAAOlG,IACN8E,EAASjE,EAAab,EAAI,GAC1B,GAEHytB,GAEIG,CACT,snCCiBA,MAAMC,GAA2BvnB,IAC/B,OAAKA,GAAcA,EAAUhkB,OAGtB,CACLuW,cAAyC,QAA1ByN,EAAAA,EAAU,GAAGzN,qBAAbyN,IAAAA,EAAAA,EAA8B,GAC7C0N,aAAuC,QAAzB1N,EAAAA,EAAU,GAAG0N,oBAAb1N,IAAAA,EAAAA,EAA6B,IAJpC,CAAEzN,cAAe,GAAImb,aAAc,QAG3B1N,EACDA,CACf,EAuEGwnB,GAAwC,CAC5CC,WAAY,GACZv9B,WAAY,GACZoC,WAAY,GACZumB,WAAW,EACX7mB,kBAAmB,GACnBF,oBAAgB5H,GA4ElB,SAASuyB,GACPiR,EAIAC,GAEA,MAAMr6B,EAAUo6B,EAAW/6B,IAAIqB,GAO/B,OAJI25B,IAAkBr6B,EAAQjC,MAAMyC,GAAWA,EAAOjJ,QAAU8iC,EAAcv5B,iBAC5Ed,EAAQhC,KAAK,CAAEa,MAAOw7B,EAAe9iC,MAAO8iC,IAGvCr6B,CACT,CCzLA,MAqJA,GArJ2B,EACzBN,OACA+O,QACA3C,aACAlL,sBACA4F,WACA0K,mBAMEzC,EAAAA,EAJF,MAAM6rB,EDyFyB,EAAC7rB,EAA0B3C,EAAwBtF,KAClF,MAAO+zB,EAAgBC,IAAqBjgC,EAAAA,EAAAA,UAAyB2/B,KAC/D,aAAEl1B,GAAiByJ,MAEvBA,EADF,MAAM,UAAEiE,EAAS,gBAAExU,EAAe,WAAEG,EAAU,YAAEwqB,EAAW,UAAE5sB,EAAS,gBAAEqlB,EAAe,OAAEnc,GACrE,QAAlBsJ,EAAAA,EAAMma,oBAANna,IAAAA,EAAAA,EAAsB,CAAC,GACnB,cAAExJ,EAAa,aAAEmb,GAAiB6Z,GAAwBvnB,OACrCA,EAA3B,MAAMwN,EAAqD,QAAhCxN,EAAAA,GAAaA,EAAUhkB,OAAS,SAAhCgkB,IAAAA,GAAAA,EAgE3B,OA7DAlR,EAAAA,EAAAA,YAAU,KACHwD,GAAiBC,GAAkBmb,GAAiBliB,GAAoBG,EAI7EyN,EAAW2uB,uBACRC,kBACC,CAAE11B,eAAcC,gBAAemb,eAAcliB,kBAAiBG,aAAYijB,mBAC1EpB,EACA/a,GAEDqE,MAAMmxB,IAEL,MAAMC,GAAgBD,EAASj8B,mBAAqB,CAACi8B,EAASn8B,iBAAiBa,KAAKjM,IAAO,CACzFyL,MAAOzL,EACPmE,MAAOnE,UAQYunC,EALrBH,EAAkB,CAChBL,WAAYS,EACZh+B,WAAY+9B,EAAS/7B,oBACrBI,WAAY27B,EAAS37B,WACrBumB,WAAW,EACX7mB,kBAA6C,QAA1Bi8B,EAAAA,EAASj8B,yBAATi8B,IAAAA,EAAAA,EAA8B,GACjDn8B,eAAgBm8B,EAASn8B,gBACzB,IAvBJg8B,EAAkBN,GAwBhB,GACH,CACD/0B,EACA2G,EACA9G,EACAC,EACAmb,EACAliB,EACAG,EACAijB,EACApB,KAIF1e,EAAAA,EAAAA,YAAU,KACR,MAAMq5B,EAAiBhS,GAAe0R,EAAe/7B,eAC/Cs8B,EAAe7+B,GAAa,OAE9B4+B,IAAmBhS,GAAeiS,IAAiB7+B,GACrDuK,EAAS,SACJiI,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrBC,YAAagS,EACb5+B,UAAW6+B,EACXC,oBAAqBR,EAAe39B,WACjCC,QAAQZ,GAAkC,SAApBA,EAAU1E,QAChC8H,KAAKpD,GACJe,EAAAA,UAAUC,aAAas8B,EAAmBh8B,iCAAiCtB,EAAU1E,cAI/F,GACC,CAACiP,EAAU+zB,EAAgB1R,EAAa5sB,EAAWwS,IAE/C8rB,CAAc,EC/JGS,CAAkBvsB,EAAO3C,EAAYtF,GACvD4yB,EDWqC,EAAC3qB,EAAO3C,EAAYtF,EAAU0K,KACzE,MAAM,aAAElM,GAAiByJ,MACcA,EAAvC,MAAM,gBAAEvQ,EAAe,UAAEwU,GAAgC,QAAlBjE,EAAAA,EAAMma,oBAANna,IAAAA,EAAAA,EAAsB,CAAC,GACxD,cAAExJ,EAAa,aAAEmb,GAAiB6Z,GAAwBvnB,GA8BhE,OA5ByBinB,GACvB,gBACE,IAAK30B,IAAiBC,IAAkBmb,EACtC,OAGF,MASMpgB,EAAUmpB,SATMrd,EAAW2uB,uBAAuBQ,oBACtD,CACEj2B,eACA9G,kBACA+G,gBACAmb,iBAEF,GAEqCliB,GAOvC,OAJKA,GAAmB8B,EAAQtR,QAC9B8X,EAAS0vB,GAAmBznB,EAAOzO,EAAQ,GAAGzI,QAGzCyI,CACT,IACAkR,EACA,CAAClM,EAAc9G,EAAiB+G,EAAemb,GAG1B,EC5CE8a,CAAoBzsB,EAAO3C,EAAYtF,EAAU0K,GACpEgoB,ED8CgC,EAACzqB,EAAO3C,EAAYtF,EAAU0K,SAKrDzC,EAJf,MAAM,aAAEzJ,GAAiByJ,MAC2CA,EAApE,MAAM,gBAAEvQ,EAAe,WAAEG,EAAU,UAAEqU,EAAS,gBAAE4O,GAAsC,QAAlB7S,EAAAA,EAAMma,oBAANna,IAAAA,EAAAA,EAAsB,CAAC,GACrF,cAAExJ,EAAa,aAAEmb,GAAiB6Z,GAAwBvnB,OACrCA,EAA3B,MAAMwN,EAAqD,QAAhCxN,EAAAA,GAAaA,EAAUhkB,OAAS,SAAhCgkB,IAAAA,GAAAA,MACZjE,EAAf,MAAMtJ,EAAmC,QAA1BsJ,EAAkB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBtJ,cAApBsJ,IAAAA,EAAAA,EAA8B,GAE7C,OAAOkrB,GACL,gBACE,GAAK30B,GAAiB9G,GAAoB+G,GAAkBmb,EAgB5D,OAFgB+I,SAXMrd,EAAW2uB,uBAAuBU,eACtD,CACEn2B,eACAC,gBACAmb,eACAliB,kBACAojB,mBAEFpB,EACA/a,GAEqC9G,EAGzC,IACA6S,EACA,CAAClM,EAAcC,EAAemb,EAAcliB,EAAiBojB,EAAiBpB,GAAkB,EC1E9Ekb,CAAe3sB,EAAO3C,EAAYtF,EAAU0K,OAE9DzC,EADF,MAAMiE,UACJjE,EAAkB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,GAA6B,QAA7BA,EAAAA,EAAoBiE,iBAApBjE,IAAAA,OAAAA,EAAAA,EAA+BpP,KAAKnM,QAGjBub,EAETA,QALiC,CACzCzJ,aAAcyJ,EAAMzJ,aACpBC,cAAe/R,EAAE+R,cACjB/G,gBAAmC,QAAlBuQ,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBvQ,gBACrCkiB,aAAcltB,EAAEktB,aAChBjb,OAA0B,QAAlBsJ,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBtJ,OAC7B,WANDsJ,IAAAA,EAAAA,EAMO,GAEH4sB,EAA2Bn2B,QACKA,EAA7BuwB,EAAP,OAAyE,QAAlEA,EAAAA,GAAyD,QAA5BvwB,EAAAA,aAAAA,EAAAA,EAAW/G,2BAAX+G,IAAAA,EAAAA,EAAkC,WAA/DuwB,IAAAA,GAAAA,CAA2E,MA+EpD6E,EASFA,EAaAA,EAnE9B,OACE,SAAC/nB,OAAAA,CAAKrM,cAAanC,GAAiCsB,mBAAmBxM,UAAUoL,gBAC/E,UAACgK,GAAUA,YACT,SAACC,GAASA,WACR,UAACM,GAAgBA,YACf,SAACshB,GAAaA,CACZrhB,MAAOA,EACP3C,WAAYA,EACZlL,oBAAqBA,EACrB8N,cAAelI,EACf0K,SAAUA,EACV0S,qBAAsB,CAACzQ,GAAgBK,UACvCd,UAAWA,QAAAA,EAAa,GACxB9M,UAAW,UACXie,WA7CO,CAAC3P,EAAkBuP,SAgBlC6X,EAAqDC,EAfvD,GAA4B,IAAxB9X,EAAa/0B,OAEf,OAAO,EAGT,MAAM4sC,EAAcjZ,GAAqBnO,EAAI0C,IAAK1C,EAAIrU,UAChD07B,EAAoBlZ,GAAqBoB,EAAa,GAAG7M,IAAK6M,EAAa,GAAG5jB,UAMpF,OACEy7B,EAAYt2B,eAAiBu2B,EAAkBv2B,cAC/Cs2B,EAAYn2B,SAAWo2B,EAAkBp2B,SACd,QAA3Bm2B,EAAAA,EAAYp9B,uBAAZo9B,IAAAA,OAAAA,EAAAA,EAA6Bn9B,wBAAyD,QAAjCo9B,EAAAA,EAAkBr9B,uBAAlBq9B,IAAAA,OAAAA,EAAAA,EAAmCp9B,uBACvFk9B,EAAwBC,EAAYp9B,gBAAgB,EA6B7CyU,eAAgB,CAACD,EAAWlM,KAI1B,SAACupB,GAAsBA,CAACrd,UAAWA,EAAqClM,SAAUA,IAEpF8e,gBA/Ba7B,IACvB,GAA4B,IAAxBA,EAAa/0B,OACf,MAAO,GAET,MAAM6sC,EAAoBlZ,GAAqBoB,EAAa,GAAG7M,IAAK6M,EAAa,GAAG5jB,UACpF,OAAOw7B,EAAwBE,EAAkBr9B,iBAC7C,0KACA,EAAE,KA0BE,SAACs9B,GAAoBA,CACnBpC,iBAAkBA,EAClB3qB,MAAOA,EACP3C,WAAYA,EACZlL,oBAAqBA,EACrB8N,cAAelI,EACf0K,SAAUA,KAEZ,SAACuqB,GAAeA,CACdvC,YAAaA,EACbzqB,MAAOA,EACP3C,WAAYA,EACZlL,oBAAqBA,EACrB8N,cAAelI,EACf0K,SAAUA,KAEZ,SAACwqB,GAAgBA,CACfjtB,MAAOA,EACP3C,WAAYA,EACZlL,oBAAqBA,EACrB8N,cAAelI,EACf0K,SAAUA,EACVolB,mBAA+C,QAA3BgE,EAAAA,aAAAA,EAAAA,EAAiBH,kBAAjBG,IAAAA,EAAAA,EAA+B,GACnD/U,UAAW+U,EAAgB/U,aAE7B,SAACoW,GAAcA,CACbltB,MAAOA,EACP3C,WAAYA,EACZlL,oBAAqBA,EACrB8N,cAAelI,EACf0K,SAAUA,EACVmoB,iBAA6C,QAA3BiB,EAAAA,aAAAA,EAAAA,EAAiB19B,kBAAjB09B,IAAAA,EAAAA,EAA+B,WAIvD,SAACpsB,GAASA,WACR,SAACM,GAAgBA,WACf,SAACotB,GAAeA,CACdl8B,KAAMA,EACN+O,MAAOA,EACP3C,WAAYA,EACZlL,oBAAqBA,EACrB8N,cAAelI,EACf0K,SAAUA,EACV6lB,iBAA6C,QAA3BuD,EAAAA,aAAAA,EAAAA,EAAiBt7B,kBAAjBs7B,IAAAA,EAAAA,EAA+B,UAIvD,SAACpsB,GAASA,WACR,UAACM,GAAgBA,YACf,SAACqtB,GAAQA,CACPptB,MAAOA,EACP3C,WAAYA,EACZlL,oBAAqBA,EACrB8N,cAAelI,EACf0K,SAAUA,KAEZ,SAAC4qB,GAAiBA,CAChBrtB,MAAOA,EACP3C,WAAYA,EACZlL,oBAAqBA,EACrB8N,cAAelI,EACf0K,SAAUA,6BC/JjB,MAAM6qB,GAAa,CACxBC,YAAa,CACXnjC,UAAW,4BAEbojC,YAAa,CACXC,WAAaliC,GAAkB,eAAeA,gBAEhDmiC,WAAY,CACVC,WAAY,qCACZC,eAAgB,yCAChBC,UAAW,oCACXC,QAAS,kCACTC,eAAgB,uCAChBC,cAAe,qCACfC,eAAgB,sCAChBC,SAAU,CACR99B,MAAO,kCACPu9B,WAAY,uCACZQ,YAAa,yCAEfC,uBAAwB,0CAE1BC,sBAAuB,CACrBC,KAAM,IAAM,6BACZC,SAAU,gCACVC,WAAY,uBACZC,gBAAiB,oBAEnBC,eAAgB,CACdl5B,MAAO,+BAETm5B,WAAY,CACVC,SAAU,CACRC,SAAU,CACRC,wBAAyB,4CACzBC,eAAgB,kCAChBC,IAAK,eACLC,IAAK,eACLC,MAAO,iBACPC,YAAa,wBACbC,OAAQ,kBACRC,WAAY,uBACZC,KAAM,yBAGVC,uBAAwB,CACtBC,SAAU,4CAEZC,OAAQ,CACNC,aAAc,YAEhBC,WAAY,CACVC,WAAY,CACVC,mBAAoB,6BACpBC,aAAc,4BACdC,eAAgB,8BAChBC,aAAc,4BACdC,cAAe,6BACfC,oBAAqB,wBACrBC,eAAgB,8BAChBC,kBAAmB,iCACnBC,WAAY,0BACZC,oBAAqB,kCACrBC,mBAAoB,mCACpBC,sBAAuB,0BACvBC,sBAAuB,sCACvBC,WAAY,0BACZC,mBAAoB,yCACpBC,mBAAoB,mCACpBC,mCAAoC,uDAEtCC,YAAa,CAEXC,QAAS,gDACTC,aAAc,oCACdz/B,QAAS,iCACT0/B,OAAQ,wCACRC,OAAQ,gCACRC,KAAM,kBACNvvC,KAAM,8BACNwvC,UAAW,uBACXC,QAAS,CAKPC,aAAc,4BACdC,MAAO,+BACPC,gBAAiB,+BACjBC,aAAc,6BAEhBxS,KAAM,CACJyS,WAAY,qCACZC,iBAAkB,uCAClBC,eAAgB,CACdjE,WAAY,mCACZkE,aAAc,8BACdC,YAAa,2BACbC,WAAY,0BACZC,iBAAkB,iCAClBC,kBAAmB,kCACnBC,SAAU,wBACVC,eAAgB,gCAChBC,iBAAkB,gCAClBrnB,MAAO,uBAIbsnB,eAAgB,8BAChBC,oBAAqB,CACnBn7B,UAAW,yBACXo7B,WAAY,CACVC,YAAa,wCAEfC,YAAa,CACXC,YAAa,yCAIfjI,YAAa,CACX+H,YAAa,yCAEfG,eAAgB,oCAChBC,YAAa,sCACbC,aAAc,wCAEhBC,YAAa,CACXC,QAAS,iCACTxnC,MAAO,0CACPynC,KAAM,yCACNvoC,KAAM,yCACNwoC,uBAAwB,iEAI9BC,KAAM,CACJC,cAAgB5nC,GAAkB,GAAGA,SACrC6nC,UAAY7nC,GAAkB,GAAGA,eACjC8nC,SAAW9nC,GAAkB,GAAGA,cAChC+nC,QAAS,CACPlpC,UAAW,gCACX0X,KAAM,6BAGVyxB,OAAQ,CACNC,MAAO,CACLjoC,MAAQA,GAAkB,4BAA4BA,IACtDqB,QAAS,4BACT6mC,YAAc7hC,GAAiB,iCAAiCA,IAChE8hC,UAAY9hC,GAAiB,+BAA+BA,IAC5D+hC,KAAOpoC,GAAkB,0BAA0BA,IACnDqoC,iBAAmBroC,GAAkB,GAAGA,UACxCsoC,iBAAmBC,GAAiB,gBAAgBA,IACpDC,OAASA,GAAmB,4BAA4BA,IACxDC,WAAY,IAAM,oBAClBC,YAAa,CACX7pC,UAAW,qCACX8pC,SAAU,yBAEZC,sBAAuB,wCAEzBC,cAAe,CACbC,MAAO,CACLjqC,UAAW,kBACXkqC,iBAAkB,CAChBC,cAAe,kBAEjBC,OAAQ,CACNC,gBAAkB3yC,GAAiB,aAAaA,IAChD4yC,iBAAkB,mBAEpBC,MAAO,CACLjM,OAAQ,IAAM,0CAGlBkM,SAAU,CAIR9rC,MAAO,kBACP+rC,QAAS,+BAEXC,SAAU,CACRC,SAAU,+BAEZrU,KAAM,CACJt2B,UAAW,IAAM,kBAEnBq3B,MAAO,CACLv1B,OAAQ,eACR8sB,OAAQ,eACRruB,KAAM,4BAIZqqC,UAAW,CACTC,WAAanzC,GAAiB,gCAAgCA,KAEhEozC,OAAQ,CACNC,QAAS,CACP5pC,MAAQA,GAAkB,gBAAgBA,IAC1C6pC,OAAQ,gBACRC,SAAU,kBACVC,MAAO,2BACPC,iBAAkB,IAAM,6BACxBjpC,SAAU,+BAEZkpC,oBAAqB,CACnBC,WAAY,2CACZC,aAAc,8CACdC,iBAAkB,+BAGtBC,YAAa,CACXT,QAAS,CACPvoC,QAAS,oCAEXipC,YAAa,CACXjpC,QAAS,+CACT2I,OAAQ,kCACRugC,WAAal0C,GAAiB,GAAGA,0BACjCm0C,WAAaxqC,GAAkB,oDAAoDA,KAGrFyqC,SAAU,CACRppC,QAAS,8CAEXqpC,YAAa,qDACbC,gBAAiB,gCACjBC,iBAAkB,iCAClBC,gBAAiB,gCAGjBC,cAAe,uDACfC,qBAAsB,sDACtBC,eAAgB,gDAChBC,iBAAkB,wDAClBC,eAAgB,gDAEhBC,cAAe,sBAEjBC,eAAgB,CACdC,KAAM,CACJhqC,QAAS,gCAEXiqC,MAAO,CACLjqC,QAAS,iCAEXkqC,KAAM,CACJlqC,QAAS,4CAEXmqC,MAAO,CACLnqC,QAAS,gCACToqC,cAAe,uCACfC,eAAgB,IAAM,wBAG1BC,IAAK,CACH3rC,MAAQA,GAAkB,mBAAmBA,IAC7C4rC,OAAQ,IAAM,8BAEhBC,cAAe,CAIbC,UAAW,2BAIXC,eAAgB,gCAChBC,YAAa,uCACbC,iBAAkB,6CAEpB3I,SAAU,CACRjiC,QAAS,2BACT6qC,qBAAsB,yBACtBC,mBAAoB,mCACpBC,SAAU,kCACVC,qBAAsB,sCACtBC,cAAe,wCAEjBC,aAAc,CACZC,UAAW,cAEbC,gBAAiB,CACfvjB,KAAM,oBAERwjB,eAAgB,CACdC,aAAe3sC,GAAkB,eAAeA,IAChDA,MAAQy1B,GAAkB,0BAA0BA,IACpD52B,UAAY42B,GAAkB,oBAAoBA,KAEpDmX,SAAU,CACRvrC,QAAS,wCAEXwrC,WAAY,CACVC,YAAa,oCACbC,OAAQ,8BACRC,gBAAiB,+BACjBC,cAAe,wCACfC,cAAe,oCACfC,gBAAiB,2CACjBC,mBAAoB,gDACpBC,0BAA2B,wDAC3BC,yBAA0B,qDAC1BC,uBAAwB,mDACxBC,2BAA4B,uDAC5BC,yBAA0B,6DAE5B7/B,MAAO,CAIL8/B,MAAQ7/B,GAAqB,SAASA,IACtC8/B,QAAU9/B,GAAqB,qBAAqBA,KAEtD+/B,aAAc,CACZvsC,QAAS,2CACTwsC,aAAet3C,GAAiB,6BAA6BA,IAC7Du3C,qBAAuBv3C,GAAiB,qCAAqCA,IAC7Ew3C,6BAA+Bx3C,GAAiB,8CAA8CA,KAEhGy3C,WAAY,CACVnT,KAAOtkC,GAAiB,6BAA6BA,IACrD03C,4BAA6B,4CAC7BC,OAAQ,CACNC,UAAW,mCACXC,kBAAmB,4CAErBC,kBAAmB,CACjBC,YAAa,oCACbC,cAAe,2CACf1oC,SAAU,CACR2oC,WAAY,uBACZC,OAAQ,CACNjoC,OAAQ,yBACRkoC,mBAAoB,4CACpBC,oBAAqB,8CAEvBC,QAAS,CACPpoC,OAAQ,0BACRqoC,kBAAmB,4CAErBC,OAAQ,CACNtoC,OAAQ,yBACRuoC,iBAAkB,0CAClBC,oBAAqB,0CAI3BC,YAAa,qCACbC,yBAA0B,yCAC1BC,wBAAyB,wCACzBC,+BAAgC,iDAElCC,OAAQ,CACNC,cAAe,CACbjlC,OAAQ,iBAEVklC,OAAQ,CACNllC,OAAQ,2BAEVmlC,UAAW,CACTnlC,OAAQ,cAGZolC,QAAS,CACP9H,KAAM,mCACNthC,KAAM,6BAERqpC,WAAY,CACV7wC,UAAW,0BACX8wC,eAAgB,8BAChBC,eAAgB,+BAChBC,cAAe,CACbC,WAAY,oCACZ5F,WAAY,oCACZ6F,WAAY,oCACZC,eAAgB,iCAChBC,aAAc,6BACdC,sBAAuB,wDACvBC,uBAAwB,8CACxBC,iBAAkB,iCAClBC,qBAAsB,qCACtBC,0BAA2B,2CAC3BC,yBAA0B,0CAC1BC,uBAAwB,wCACxBC,sBAAuB,yCAI3BC,YAAa,CACX7xC,UAAW,IAAM,gBACjBwH,KAAOsP,GAAoB,GAAGA,IAC9Bg7B,WAAa3wC,GAAkB,eAAeA,KAEhD4wC,uBAAwB,CACtBvmC,OAASrK,GAAkB,mCAAmCA,KAEhE6wC,WAAY,CACVC,UAAW,uBAEbC,aAAc,CACZC,MAAQhxC,GAAoBA,EAAQ,6BAA6BA,IAAU,4BAC3E+sC,OAAS/sC,GACPA,EAAQ,6BAA6BA,WAAiB,oCAE1DixC,oBAAqB,CACnB5qC,KAAOrG,GAAkB,6BAA6BA,IACtDpE,QAAS,IAAM,wCAEjBwQ,OAAQ,CACN5F,OAAQ,4BACR0qC,iBAAkB,iCAClBjnC,MAAO,IAAM,kCACbknC,YAAa,IAAM,8BAErBC,kBAAmB,CACjB/vC,QAAS,+BAEXgwC,sBAAuB,CACrBhwC,QAAS,kCAEXiwC,aAAc,CAIZzyC,UAAW,iCACX0yC,YAAa,6CACbtnC,MAAO,mCAETunC,qBAAsB,CACpB3yC,UAAW,uDAEb4yC,iBAAkB,CAChB5yC,UAAW,kDAIXoL,MAAO,IAAM,iCACbynC,QAAS,mCACTC,eAAgB,wCAChBC,cAAe,CACbD,eAAgB,+BAChBE,sBAAuB,0CAG3BC,eAAgB,CAIdjzC,UAAW,oCACX0yC,YAAa,gDACbQ,yBAA0B,4DAE5BC,gBAAiB,CAIfnzC,UAAW,kCACX0yC,YAAa,8CACbxkC,YAAa,mCAEfklC,YAAa,CACXC,QAAS,gCAEXz5B,WAAY,CAAE5Z,UAAW,2BACzBszC,aAAc,CACZC,cAAe,6BACfjL,YAAa,2BACbkL,YAAa,iCACbC,YAAa,2BACbC,oBAAqB,qCAEvBC,YAAa,CACXnoC,OAAS9T,GAAiB,mCAAmCA,IAC7DyT,OAASzT,GAAiB,mCAAmCA,KAE/D82B,OAAQ,CAINolB,QAAS,iBACTC,UAAW,6BAIXtkB,MAAO,eACPukB,QAAS,2BACTC,MAAO,2BACPC,eAAiBC,GAAsB,+BAA+BA,IACtEC,aAAeD,GAAsB,6BAA6BA,IAClEE,cAAgB3sC,GAAiB,GAAG07B,GAAW1U,OAAO4lB,kBAAkB5sC,IACxE6sC,cAAgB7sC,GAAiB,2BAA2BA,IAC5D8sC,aAAeC,GAAuB,6BAA6BA,IACnEC,cAAgBD,GAAuB,8BAA8BA,IACrEH,eAAgB,qCAElBK,eAAgB,CACdz0C,UAAW,uCACX00C,SAAU,sCACV/zC,KAAM,8BAERg0C,iBAAkB,CAChBj9B,KAAM,iCAERk9B,iBAAkB,CAIhBppC,OAAS9T,GAAiB,yBAAyBA,IACnDm9C,SAAWn9C,GAAiB,qCAAqCA,KAEnEo9C,qBAAsB,CACpBC,WAAY,yBAEd/+B,WAAY,CACVhW,UAAW,qCAEbg1C,kBAAmB,CACjBC,WAAY,4CAEdC,oBAAqB,CACnBC,SAAU,wCACVC,OAAQ,8BAEVC,oBAAqB,CACnB39C,KAAM,qCACN09C,OAAQ,uCAEVE,qBAAsB,CACpB9yC,QAAS,gDAEX+yC,qBAAsB,CACpBvZ,KAAOtkC,GAAiB,0BAA0BA,KAEpD89C,YAAa,CACX99C,KAAM,2BAER+9C,aAAc,CACZt0C,MAAQA,GAAkB,mCAAmCA,KAE/Du0C,YAAa,CACXC,kBAAmB,gCACnBC,sBAAuB,gCACvBC,UAAW,8BACXC,cAAe,kCACfC,mBAAoB,mCACpBC,kBAAoBC,GAAkB,mCAAmCA,KAE3EC,WAAY,CACVC,WAAY,sCACZC,aAAc,qCAEhBC,aAAc,CACZ5/B,QAAS,iBAEX6/B,cAAe,CACblrC,MAAO,QAETmrC,uBAAwB,CACtB/qC,OAAQ,sBAEVgrC,UAAW,CACTC,eAAgB,8BAChBC,oBAAqB,qCAEvBC,YAAa,CACXC,qBAAsB,qCACtBC,4BAA6B,kCAC7BjkB,OAAQ,CACNkkB,WAAY,sCACZC,gBAAiB,mDAGrB1/B,QAAS,CACPrX,UAAW,uBAEbg3C,iBAAkB,CAChBC,YAAa,uCACbC,WAAY,mBACZC,cAAe,uBAEjBC,eAAgB,CACdC,aAAc,4BACdC,kBAAmB,iCACnBC,YAAa,2BACbC,kBAAmB,iCACnBC,YAAa,2BACbC,eAAgB,8BAChBC,oBAAqB,oCACrBC,mBAAoB,mCACpBC,kBAAmB,kCACnBC,kBAAmB,kCACnBC,oBAAqB,qCAEvBC,eAAgB,CACdh4C,UAAW,iCCtlBFkL,GAAgG,CAC3G+sC,MCJmB,CACnBC,MAAO,CACL9kC,IAAK,SACL+kC,SAAU,mCACVC,SAAU,mCACVhD,OAAQ,2BACRiD,KAAM,2CAERC,KAAM,CACJllC,IAAK,KAEPmxB,WAAY,CACV7sC,KAAM,yDACNkpB,OAAQ,0CACRpP,SAAU,0DACV+mC,YAAa,6DACb1J,MAAO,+CAET2J,YAAa,CACXplC,IAAK,eACLqlC,YAAch5C,GAA2B,yBAAyBA,KAEpEi5C,eAAgB,CACdtlC,IAAMulC,GAA0B,qBAAqBA,IACrDC,SAAU,2CAEZC,cAAe,CACbzlC,IAAK,mBAEL0lC,kBAAoBC,GAAuB,2BAA2BA,IACtEC,oBAAsBD,GAAuB,uBAAuBA,KAEtE5mB,aAAc,CACZvR,OAAQ,2CAEVq4B,aAAc,CACZ7lC,IAAK,iBACL0+B,WAAa3wC,GAAkB,eAAeA,IAC9C+3C,YAAa,4BACbC,UAAW,0BACXC,mBAAoB,gDAEtBC,UAAW,CACTjmC,IAAMkmC,GAAgB,MAAMA,IAC5BC,QAAS,CAIPC,IAAK,uBACLC,MAAO,mCACPC,mBAAoB,mCACpBC,YAAa,2BACbC,gBAAiB,gDACjBC,eAAgB,CACd75C,UAAW,+BACX85C,UAAW,oCACXC,UAAW,0CACXxQ,KAAM,CACJvpC,UAAW,oCACXg6C,gBAAiB,gDACjBC,gBAAiB,gDACjBC,cAAe,gDAGnBC,gBAAiB,CACfn6C,UAAW,gCACX+5C,UAAW,2CACXjR,KAAM,CACJ9oC,UAAW,qCACXo6C,aAAc,iDAGlBC,iBAAkB,CAChB9lB,KAAM,iDACN+lB,KAAM,6CACNC,KAAM,+CAGVC,SAAU,iCACVtR,QAAS,CACPuR,QAAS,oBACTC,YAAa,gCACbC,kBAAoBnzC,GAAiB,0DAA0DA,IAC/FozC,uCAAyCpzC,GACvC,oFAAoFA,IACtFqzC,iCAAkC,mBAClCC,oCAAsCtzC,GACpC,gFAAgFA,IAClFmvC,YAAa,CACXoE,mBAAoB,iCACpBC,gBAAkBh1C,GAAkB,mDAAmDA,IACvFi1C,iBAAmBj1C,GAAkB,oDAAoDA,MAG7Fk1C,SAAU,CACR/e,QAAS,CACP+O,MAAO,wCAETH,QAAS,CACPoQ,gBAAiB,8DACjBC,aAAe5zC,GAAiB,mCAAmCA,IACnE6zC,cAAe,+CACfC,gBAAiB,kDAIjBC,SAAU,oCACVp6C,MAAO,WAETw1C,YAAa,CACX6E,KAAM,CAIJC,iBAAkBvY,GAAW0R,iBAAiBppC,OAAO,wBACrDkwC,mBAAoBxY,GAAW0R,iBAAiBC,SAAS,wBACzDnM,YAAa,gCAEfwS,SAAU,CACRxjD,KAAM,+CAERikD,cAAe,CACbC,kBAAmB,uCACnBC,YAAa,4BACbC,mBAAoB,kCACpBl7B,OAAQ,iCACR7U,MAAO,gCACPgwC,OAAQ,gCACRC,KAAM,gCAGVxF,UAAW,CACTgF,KAAM,CAIJS,eAAgB/Y,GAAW0R,iBAAiBppC,OAAO,gBACnD0wC,iBAAkBhZ,GAAW0R,iBAAiBC,SAAS,gBACvDsH,UAAW,sCACXrhC,MAAO,wBACPshC,mBAAqBC,GAAyB,oCAAoCA,IAClFC,yBAA2BD,GAAyB,0CAA0CA,IAC9FE,uBAAyBF,GAAyB,wCAAwCA,IAC1FG,yBAA2BH,GAAyB,0CAA0CA,IAC9FI,yBAA2BJ,GAAyB,0CAA0CA,IAC9FK,sBAAwBL,GAAyB,uCAAuCA,KAE1FM,KAAM,CACJ5R,QAAS,CACP6R,WAAY,8BACZC,aAAc,kCAIdC,cAAe,mCACfC,iBAAkB,kCAClBC,mBAAoB,8CACpBC,kBAAmB,mCACnBC,oBAAqB,+CACrBC,kBAAmB,mCACnBC,oBAAqB,+CACrBC,kBAAmB,mCACnBC,oBAAqB,+CACrBC,4BAA6B,gDAC7BC,iCAAkC,qDAClCC,+BAAgC,oDAChCC,sBAAuB,uDACvBC,aAAc,+CACd9R,YAAa,4CAEf+R,cAAe,CACbC,6BAA8B3a,GAAW0P,iBAAiBC,QAC1DiL,0BAA2B,4CAC3BC,4BAA6B,wDAC7BC,uBAAwB,yCACxBC,yBAA0B,qDAC1BC,uBAAwB,yCACxBC,yBAA0B,qDAC1BC,uBAAwB,0EACxBC,6BAA8B,4CAC9BC,8BAA+B,6CAC/BC,oCAAqC,oDAEvCC,iBAAkB,CAChBC,0BAA2B,4CAC3BC,4BAA6B,yDAE/BC,mBAAoB,CAClBC,iBAAkB,mDAEpBC,gBAAiB,CACfC,yBAA0B,2CAC1BC,2BAA4B,wDAE9BC,eAAgB,CACdC,iBAAkB,qCAEpBC,iBAAkB,CAChBC,oBAAqB,gDACrBC,oBAAqB,oDACrBC,wBAAyB,iDACzBC,iBAAkB,wDAEpBC,gBAAiB,CACfC,iBAAkBtc,GAAW0P,iBAAiBC,QAC9C4M,SAAU,0CACVC,WAAY,6CAEdC,qBAAsB,CACpBf,iBAAkB1b,GAAW0P,iBAAiBC,QAC9C4M,SAAU,gDACVC,WAAY,sDAKpB/I,YAAa,CACXiJ,OAAQ,iCAEVC,KAAM,CACJC,SAAU,CACRl9C,cAAe,CACbm9C,eAAgB,gDAKxBC,WAAY,CACV5sC,IAAK,cAIL6sC,WAAa9+C,GAAkB,yBAAyBA,KAE1D++C,qBAAsB,CACpBC,QAAS,6BACTC,KAAM,yBAERC,mBAAoB,CAClBD,KAAM,sDACNE,cAAe,kEACfC,cAAe,kEACfC,YAAa,iEAEfC,gBAAiB,CACfC,oBAAqB,0BAEvBC,oBAAqB,CACnBC,gBAAiB,CACfC,qBAAsB,uDACtBC,kBAAmB,4DACnBC,qBAAsB,0DACtBC,YAAa,4CACbC,wBAAyB,6DACzBC,aAAc,6CACdC,aAAc,6CACdC,aAAc,8CACdC,cAAe,+CACfC,iBAAkB,iDAClBC,8BAA+B,iEAC/BC,mCAAoC,8DACpCC,gCAAiC,2DACjCC,sBAAuB,4DACvBC,0BAA2B,CACzBC,UAAW,6CACXC,UAAW,0CACXC,kBAAmB,mDACnBC,yBAA0B,2DAC1BC,iBAAkB,kDAClBC,YAAa,mDACbC,YAAa,qDAGjBC,cAAe,CACb/uC,IAAMzc,GAAgB,uBAAuBA,IAC7CyrD,gBAAiB,sCACjBf,cAAe,uCACfD,aAAc,wCAGlBiB,qBAAsB,CACpBC,gBAAiB,CACftiD,UAAW,gDACXuiD,oBAAqB,sDACrBC,iBAAkB,kDAClBC,cAAe,gDAEjBC,gBAAiB,CACf1iD,UAAW,gDACX2iD,YAAa,iCACbC,kBAAmB,gCACnBC,gBAAiB,iDACjBC,SAAU,CACRC,YAAa,CACXC,aAAc,mDACdC,aAAc,oDAEhBC,WAAY,CACVF,aAAc,kDACdC,aAAc,mDAEhBE,qBAAsB,uDAExB1S,cAAe,CACb2S,sBAAuB,wDACvBC,wBAAyB,yDACzBZ,cAAe,+CACfa,mBAAoB,oDACpBC,mBAAoB,+DAGxBC,cAAe,CACbpwC,IAAMzc,GAAgB,uBAAuBA,IAC7CqJ,UAAW,8CACXyjD,gBAAiB,4CACjBhB,cAAe,+CAGnBiB,sBAAuB,CACrBC,aAAc,CACZ3jD,UAAW,8CACX4jD,WAAY,yCACZC,uBAAwB,+CACxBC,iBAAkB,iDAClBC,sBAAuB,sDACvBd,aAAc,6CAGlBrC,gBAAiB,CACfoD,KAAM,wBACNC,aAAc,CACZjkD,UAAW,iCACXmB,MAAO,yBACP+iD,kBAAmB,uCAErBt1B,OAAQ,2BAEVu1B,qBAAsB,CACpBC,YAAa,sCACbJ,KAAM,8BACNK,SAAU,6BAEZC,kBAAmB,CACjBpgB,KAAM,2BACNqgB,eAAgB,sCAChB5G,aAAc,qCAEhB6G,6BAA8B,CAC5B7G,aAAc,4CAEhB8G,QAAS,CACPrxC,IAAK,WACL23B,QAAS,CACP/qC,UAAW,sBACX0kD,MAAO,gBACP5pC,MAAO,gBACP6pC,WAAY,oCAEdjX,aAAc,CACZ1tC,UAAW,6BAGf4kD,UAAW,CACTxxC,IAAM4wC,GAAiB,WAAWA,KAEpCa,YAAa,CACXb,KAAM,oBACN/+C,KAAM,eACN6/C,SAAU,oBACVC,qBAAsB,uCAExBC,WAAY,CACVhB,KAAM,cACNiB,cAAe,oCACfC,aAAc,oCAEhBC,aAAc,CACZztD,KAAM,gBACN+L,SAAU,oBACV2hD,WAAY,yCAEdC,iBAAkB,CAChBvqC,MAAO,CACLva,KAAM,sCACN8a,IAAM3jB,GAAiB,qCAAqCA,IAC5D4tD,SAAWhM,GAAgB,eAAeA,cAE5CiM,cAAe,CACbrhB,KAAM,8BACNshB,UAAW,oCACXxC,aAAc,yCAGlBx0B,OAAQ,CACNpb,IAAK,iBACLqyC,WAAY,CACVryC,IAAK,iCAGTsyC,iBAAkB,CAChBC,SAAU,CACRC,WAAY,+BACZC,aAAc,wCACdC,eAAgB,iCAChBC,YAAa,8CAGjBC,aAAc,CACZC,KAAM,CACJC,SAAU,4BACVC,SAAU,4BACVC,gBAAiB,oCACjBC,sBAAuB,0CACvBC,MAAO,yBAETC,IAAK,CACHnzC,IAAK,cAEPozC,MAAO,CACLpzC,IAAK,gBAEPqzC,iBAAkB,CAChBzmD,UAAW,4CAEb0mD,kBAAmB,CACjB1mD,UAAW,oCAEb2mD,cAAe,CACb3mD,UAAW,+BAEb4mD,iBAAkB,CAChB5mD,UAAW,mCAEb6mD,8BAA+B,CAC7B7mD,UAAW,gDACX8mD,oBAAqB,CACnBhC,SAAWxL,GAAgB,oCAAoCA,OAIrEyN,YAAa,CACX3zC,IAAK,aDpbP4zC,WAAY9jB,ynCEsBd,MAAMhE,GAAgB,CACpBC,EACA33B,EACAoG,EACAD,KAEkB,YAAdwxB,EACF33B,EAAK23B,GAAavxB,EAASpH,KAAKgB,GAAkCA,EAAK9I,SAEvE8I,EAAK23B,GAAavxB,EAASlP,MACT,aAAdygC,IACF33B,EAAKuzB,QAAU,KAGnBptB,EAASnG,EAAK,EAGVy/C,OAAqB,cACzBrxC,EACA3C,EACAnG,EACAo6C,EACAC,EACAnjD,EACAojD,GAEA,MAAM,YAAEt3B,GAAgBla,EACxB,IAAKka,EACH,MAAO,GAGT,MAAM,UAAEjW,GAAciW,EAEtB,IAAKjW,IAAc7V,EACjB,MAAO,GAGT,MAAMqjD,EAAWrjD,EAAOqjD,SACxB,IAAKA,EACH,MAAO,GAGT,MAAMC,EAAc,OAAOD,mCAA0Cv6C,EAAWrE,KAAK,4EAEtD4+C,4EAEAA,OAAcA,MAEvC7tC,QAAgB+tC,EAAAA,GAAAA,eACpBt0C,EAAW8iB,4BAA4BngB,MAAM,CAC3C4xC,UAAW,8BACX/jD,SAAU,GACVS,WAAY,EACZujD,WAAY,CAAC,EACblM,SAAU,GACVmM,UAAW,EACXC,IAAKC,EAAAA,QAAQC,QACbC,QAAS,CACP,SACKlyC,GAAAA,CACHia,kBAAmB,CACjBhW,YACAjE,MAAO0xC,GAETv6C,UAAW7D,GAAekzB,gBAG9BgrB,MAAOA,IAASW,EAAAA,EAAAA,0BAGpB,GAAIvuC,EAAQ3S,KAAKhR,OAAS,EAAG,CAC3B,MAAMiP,EAAoB0U,EAAQ3S,KAAK,GACvC,GAAI/B,EAAO25B,OAAO5oC,OAAS,EAAG,CAC5B,MAGMuR,EAH0F6S,KAAK+tC,MACnGljD,EAAO25B,OAAO,GAAGr3B,OAAO6gD,UAAU,IAEVZ,GAAU7gD,KAAK9H,IACvC,IAAIsH,EAAQtH,EAAM2oD,GAIlB,MAHwB,KAApB3oD,EAAM2oD,KACRrhD,EAAQ,WAEH,CAAEA,MAAOA,EAAMxP,WAAYkI,MAAOA,EAAM2oD,GAAU7wD,WAAY0xD,MAAOxpD,EAAMwpD,MAAO,IAI3F,OAFAhB,EAAY7/C,IAAIggD,EAAUjgD,GAC1B+/C,EAAeD,GACR9/C,CACT,CACF,CAEA,MAAO,EACT,aAxEEwO,EACA3C,EACAnG,EACAo6C,EACAC,EACAnjD,EACAojD,qCAPyB,OAgG3B,MAAMe,GAAUtrD,IACd,MAAM,KAAEgK,EAAI,WAAEuhD,EAAU,SAAEC,EAAQ,UAAEC,EAAS,WAAEnrC,GAAetgB,EACxDgD,GAAQC,EAAAA,EAAAA,aACRC,GAASwoD,EAAAA,EAAAA,iBAAgB1oD,GAEzB2oD,EAAsBjvD,IAC1BsD,EAAM4rD,aAAa,MAAK5hD,IACxBtN,EAAEmvD,kBACFnvD,EAAEovD,gBAAgB,EAGpB,OACE,SAACv6C,MAAAA,GAAAA,GAAAA,CACC1R,IAAK2rD,EACLzoD,WAAWiB,EAAAA,EAAAA,IACTd,EAAO4H,OACP2gD,GAAavoD,EAAO6oD,cACpBzrC,GAAcpd,EAAO8oD,eACrBhiD,EAAKuW,YAAcrd,EAAO+oD,iBAExBV,GAAAA,CACJ/6C,cAAanC,GAAU87C,WAAWz5C,OAAO5F,OACzCxG,MAAO0F,EAAK1F,MACZuB,QAAS8lD,EACTO,UAAWP,EACXQ,KAAK,WACLC,eAAc9rC,EACd1F,SAAU,YAEV,SAACrJ,MAAAA,CAAIxO,UAAWG,EAAOmpD,qBACrB,SAAC7qC,EAAAA,SAAQA,CAAC3f,MAAOye,EAAYnX,MAAOa,EAAKb,MAAQ,GAAGa,EAAKb,YAAYa,EAAKqhD,SAAW,WAMvFiB,GACJtsD,IAMA,MAAM,MACJ+Y,EAAK,WACL3C,EAAU,YACVi0C,EAAW,eACXC,EAAc,gBACdiC,EAAe,WACfC,EAAU,KACV7hD,EAAI,SACJmG,EAAQ,SACRiyB,EAAQ,oBACR73B,EAAmB,MACnBq/C,GACEvqD,GACGysD,EAASC,IAAc7nD,EAAAA,EAAAA,WAAS,OAEH8F,EAAhB0/C,EADpB,MAAO9/C,EAAQkR,IAAa5W,EAAAA,EAAAA,UAC1BoG,EAAmD,QAAjCo/C,EAAAA,EAAY5oD,IAAiB,QAAbkJ,EAAAA,EAAK6/C,gBAAL7/C,IAAAA,EAAAA,EAAiB,WAAjC0/C,IAAAA,EAAAA,EAAwC,GAAIn/C,KAEzD6F,EAAU47C,IAAe9nD,EAAAA,EAAAA,UAC9B8F,EAAKuzB,QAAUvzB,EAAKuzB,QAAQv0B,KAAKxC,IAAY,CAAEtF,MAAOsF,EAAQgC,MAAkB,KAAXhC,EAAgB,UAAYA,MAAa,IAG1GylD,EAAc,iCAElB,GADAF,GAAW,GACP/hD,EAAK6/C,UAA8B,KAAlB7/C,EAAK6/C,SAAiB,KACZ7/C,EAA7B,MAAMkiD,EAAOxC,EAAY5oD,IAAiB,QAAbkJ,EAAAA,EAAK6/C,gBAAL7/C,IAAAA,EAAAA,EAAiB,IAC9C,GAAKkiD,EAgBH,OAFApxC,EAAUxQ,EAAkB4hD,EAAM3hD,IAClCwhD,GAAW,GACJ71C,QAAQC,QAAQ+1C,GAhBd,CACT,MAAMC,QAAgB1C,GACpBrxC,EACA3C,EACAm2C,EACAlC,EACAC,EACA3/C,EACA4/C,GAIF,OAFA9uC,EAAUxQ,EAAkB6hD,EAAS5hD,IACrCwhD,GAAW,GACJI,CACT,CAKF,CAEA,OAAOj2C,QAAQC,QAD+B,GAEhD,sDAzBoB,GA2BpB,OACE,UAACosB,EAAAA,gBAAeA,CAAC3/B,QAAQ,kBACvB,SAACmN,EAAAA,OAAMA,CACLyyB,kBAAgB,EAChB9xB,YAAY,WACZxP,MAAO8I,EAAK6/C,SAAW,CAAE3oD,MAAO8I,EAAK6/C,SAAUrhD,MAAOwB,EAAK6/C,UAAa,KACxElgD,QAASW,EACPuhD,EAAW7iD,KAAKhP,IAAU,CAAEwO,MAAOxO,EAAMkH,MAAOlH,MAChDuQ,GAEF4F,SAAWpU,GAAM2lC,GAAc,WAAY13B,EAAMjO,EAAGoU,GACpDwI,MAAO,MAET,SAACyzC,EAAAA,aAAYA,CACXlrD,MAAO8I,EAAKqiD,UAAY,CAAE7jD,MAA0B,OAAnBwB,EAAKqiD,UAAqB,IAAM,KAAMnrD,MAAO8I,EAAKqiD,gBAAc9rD,EACjGoJ,QAAS,CACP,CAAEnB,MAAO,IAAKtH,MAAO,MACrB,CAAEsH,MAAO,KAAMtH,MAAO,OAExBiP,SAAWpU,GAAM2lC,GAAc,YAAa13B,EAAMjO,EAAGoU,GACrD4iB,aAAc,QAEhB,SAACu5B,EAAAA,iBAAgBA,CACfC,mBAAmB,EACnB/pB,kBAAgB,EAChB9xB,YAAY,QACZxP,MAAOkP,EACP67C,YAAaA,EACb/8B,UAAW48B,EACXU,WAAYP,EACZ97C,SAAWpU,IACTiwD,EAAYjwD,GACK,IAAbA,EAAE1D,QACJqpC,GAAc,UAAW13B,EAAMoG,EAAUD,EAC3C,EAEFwI,MAAO,GACP8zC,eAAgB7iD,EAChBoR,aAAW,EACXwuC,WAAY,CAAEmB,WACd+B,mBAAmB,EACnBC,YAAa,IAAMjrB,GAAc,UAAW13B,EAAMoG,EAAUD,GAC5Dy8C,qBAAqB,KAEvB,SAACx5B,GAAeA,CAACnjB,aAAW,gBAAgBiK,KAAK,QAAQlJ,QAAQ,YAAY9L,QAASk9B,EAAUpoC,KAAK,o0BCxRpG,MAAM6yD,GAAS,CACpBC,oBAAqB,CAAEtkD,MAAO,sBAAuB5E,YAAa,8BAClE4/B,aAAc,CACZh7B,MAAO,eACP5E,YAAa,kFAEfmpD,aAAc,CAAEvkD,MAAO,gBAAiB5E,YAAa,2DACrDopD,WAAY,CACVxkD,MAAO,aACP5E,YAAa,0EAEfqpD,UAAW,CAAEzkD,MAAO,aAAc5E,YAAa,qDAC/CspD,SAAU,CAAE1kD,MAAO,WAAY5E,YAAa,8CAC5CupD,OAAQ,CACN3kD,MAAO,SACP5E,YACE,uIAgBOwpD,GAAiB,CAC5B,cACA,WACA,KACA,OACA,YACA,qBACA,YACA,mBACA,kBAIWC,GAAS,CACpBC,MAAO,eACPC,oBAAqB,aACrBC,QAAS,cACTC,eAAgB,gBAChBC,YAAa,aACbC,uBAAwB,wBACxBC,UAAW,WACXC,aAAc,cACdC,UAAW,WACXC,uBAAwB,wBACxBC,YAAa,aACbC,mBAAoB,kBACpBC,eAAgB,cAChBC,iBAAkB,aAClBC,mBAAoB,eACpBtnD,SAAU,aACVmK,GAAI,KACJo9C,KAAM,OACNC,UAAW,YACXC,OAAQ,UACRC,SAAU,OACVt0D,KAAM,OACNu0D,aAAc,cACdC,eAAgB,gBAChBC,mBAAoB,oBACpBC,0BAA2B,2BAC3BC,kBAAmB,oBACnBC,WAAY,aACZC,WAAY,YACZC,QAAS,UACTC,UAAW,gBACXC,eAAgB,gBAChBC,qBAAsB,sBACtBC,QAAS,UAIEC,GAA4B,SACpChC,IAAAA,CACH7jD,SAAU,WACVyM,QAAS,UACT9Q,KAAM,SAIKmqD,GAAqB,SAC7BjC,IAAAA,CACHhkD,KAAM,OACNkmD,WAAY,aACZhsD,OAAQ,SACRvJ,KAAM,mBAIKw1D,IAAeC,EAAAA,EAAAA,MAAKpC,GAAQ,CAAC,WAAY,KAAM,UAAW,sBAG1DqC,IAAkBD,EAAAA,EAAAA,MAC7B,SACKpC,IAAAA,CACHz3C,IAAK,QAEP,CAAC,YA2CU+5C,GAA6D,CACxE7C,oBAAqBuC,GACrB7rB,aAAc8rB,GACdvC,aAAcyC,GACdxC,YApC8ByC,EAAAA,EAAAA,MAC9B,SACKpC,IAAAA,CACHuC,SAAU,WACVn7C,QAAS,UACTo7C,UAAW,YACXC,kBAAmB,oBACnBC,iBAAkB,mBAClBC,gBAAiB,kBACjBC,cAAe,gBACfh6C,QAAS,UACTJ,OAAQ,SACRq6C,cAAe,gBACfC,aAAc,eACdC,YAAa,cACbC,UAAW,YACXC,UAAW,YACXC,cAAe,gBACfv2D,KAAM,kBAER,CAAC,WAAY,KAAM,OAAQ,oBAAqB,YAiBhDizD,UAAWyC,GACXxC,SA7C4B,CAC5BqC,WAAY,aACZ52D,OAAQ,SACRid,IAAK,OA2CLu3C,QAf0BsC,EAAAA,EAAAA,MAC1B,CACEx5C,QAAS,UACTs6C,cAAe,iBAEjB,CAAC,WAAY,KAAM,OAAQ,oBAAqB,k0BC9H3C,SAASt9B,GAAY7a,EAA0B4b,GACpD,OAAO,SACF5b,GAAAA,CACHka,YAAa,SACRla,EAAMka,aAAW,CACpBY,aAAcc,KAGpB,CAEO,SAASw8B,GAAcp4C,EAA0B9I,GACtD,OAAO,SACF8I,GAAAA,CACHka,YAAa,SACRla,EAAMka,aAAW,CACpBhjB,gBAGN,CAYO,SAAS0jB,GACd5a,EACA2a,EACAI,OAEK/a,GAAiB,QAAjBA,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmB8a,eACtBC,EAAa,CAAEjyB,MAAO6xB,GAE1B,CDqGyBj6B,OAAOwqB,QAAQqsC,IAAc7lD,QACpD,CAACkB,GAAMzO,EAAGQ,KAAQ,SAAKiO,GAAAA,CAAK,CAACzO,GAAIzD,OAAOP,MAAKk3D,EAAAA,EAAAA,MAAK1yD,EAAGqwD,KAAiBniD,KAAK,QAC3E,CAAC,GExJH,MAmEA,GAnEgB,EAAGmN,QAAO3C,aAAY4C,gBAAe9N,sBAAqBq/C,gBAoBFxxC,EAKlEA,EAA8BA,EAA+BA,EAxBjE,MAAM,YAAEka,GAAgBla,EAClBwzC,GAAkBt5B,aAAAA,EAAAA,EAAahjB,YAAagjB,EAAYhjB,WAAaxW,OAAOP,KAAKo3D,IAEjFc,EAAqB,IAAIvmD,IAAI,CACjC,mBACA,qBACA,UACA,WACA,KACA,SACA,eACA,qBACA,cAEI2hD,GAAa6E,EAAAA,EAAAA,MAAK9E,EAAgB5iD,KAAKhP,GAASlB,OAAOP,KAAKo3D,GAAa31D,MAAQ+mC,QAAQv6B,QAC5FwD,IAAUymD,EAAmBrmD,IAAIJ,MAG7B0/C,EAAaC,IAAkBzlD,EAAAA,EAAAA,UAAS,IAAIke,KAC7CuuC,GAAev/C,EAAAA,EAAAA,UAAQ,SAAMgH,EAAAA,SAA0B,QAA1BA,EAAiB,QAAjBA,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmBmlB,eAAnBnlB,IAAAA,EAAAA,EAA8B,EAAE,GAAE,CAAkB,QAAjBA,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmBmlB,WAClFA,EAASqzB,IAAiB1sD,EAAAA,EAAAA,UAASysD,GA0B1C,OAxBAxlD,EAAAA,EAAAA,YAAU,KACRw+C,EAAe,IAAIvnC,IAAAA,GAClB,CAAkB,QAAjBhK,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmBiE,UAA4B,QAAjBjE,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmB9I,WAA6B,QAAjB8I,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmBy4C,eAuBlF,SAACjhD,EAAAA,MAAKA,CAACpH,MAAM,oBACX,SAAC23B,GAAUA,CACTpO,MAAOwL,EACPptB,SAxBe8xB,IACnB,IAAI6uB,GAAc,EAClB,MAAM5uB,EAAkCD,EAAQj5B,KAAK/L,QAOvCA,EACDA,EACEA,EAHb,OAJE6zD,KADiB,KAAf7zD,EAAE4sD,UAAmB5sD,EAAEsgC,SAAWtgC,EAAEsgC,QAAQllC,OAAS,GAAqB,KAAhB4E,EAAEovD,WAKzD,CACLxC,SAAoB,QAAV5sD,EAAAA,EAAE4sD,gBAAF5sD,IAAAA,EAAAA,EAAc,GACxBsgC,QAAkB,QAATtgC,EAAAA,EAAEsgC,eAAFtgC,IAAAA,EAAAA,EAAa,GACtBovD,UAAsB,QAAXpvD,EAAAA,EAAEovD,iBAAFpvD,IAAAA,EAAAA,EAAe,KAC3B,IAEH2zD,EAAc1uB,IACV4uB,GAAgBH,EAAat4D,OAAS,GAA2B,IAAtB6pC,EAAW7pC,SACxDggB,EDZC,SAAoBD,EAA0BmlB,GACnD,OAAO,SACFnlB,GAAAA,CACHka,YAAa,SACRla,EAAMka,aAAW,CACpBiL,aAGN,CCIoBwzB,CAAW34C,EAAO8pB,GAClC,EAQI9B,YH6DuB/gC,EG7DI,CACzB+Y,QACA3C,aACAi0C,cACAC,iBACAiC,kBACAC,aACAthD,sBACAq/C,SHsDR,SACE5/C,EACAmG,EACAiyB,GAEA,OAAO,SAACupB,GAAAA,GAAAA,GAAAA,CAAAA,EAAWtsD,GAAAA,CAAO2K,KAAMA,EAAMmG,SAAUA,EAAUiyB,SAAUA,IACtE,OAPK,IAAwB/iC,GInE/B,GA9CuB,EAAG+Y,QAAO7N,sBAAqB8N,wBAkC5CD,EAjCR,MAAMwe,EAA+B99B,OAAOwqB,QAAQupC,IAAQ7jD,KAAI,EAAE7P,EAAK+H,MAAY,CACjFsH,MAAOtH,EAAMsH,MACb5E,YAAa1C,EAAM0C,YACnB1C,MAAO/H,MAEHg6B,GAAexc,EAAAA,EAAAA,cAClBsE,IACC,MAAM3C,EAAWk4C,GACfp4C,EACA6C,EAAOjS,KAAKhP,QAASA,SAAU,QAAVA,EAAAA,EAAKkH,aAALlH,IAAAA,EAAAA,EAAc,EAAE,KAEvCqe,EAAcC,EAAS,GAEzB,CAACD,EAAeD,IAGZzO,GAAUyH,EAAAA,EAAAA,UAAQ,IAAM,IAAIwlB,EAAQrsB,IAAsB,CAACqsB,EAAQrsB,QAiBjE6N,EAPR,OACE,SAACxI,GAAKA,CAACpH,MAAM,uBACX,SAACuS,EAAAA,YAAWA,CACVrK,YAAY,qBACZV,QAAQ,kCACR9O,MAAOwI,EACL,IAAIktB,KAAWrsB,EAAoBZ,SACN,QAA7ByO,EAAiB,QAAjBA,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmB9I,kBAAnB8I,IAAAA,EAAAA,EAdkB,MACxB,MAAM44C,EAAgBp6B,EAAO5tB,KAAKlM,GAAMA,EAAEoE,QACpC+vD,EAAeT,GAAcp4C,EAAO44C,GAE1C,OADA34C,EAAc44C,GACPD,CAAa,EAUmBE,IAEnC/gD,SAAUgjB,EACVxpB,QAASA,EACT4tB,kBAAgB,EAChBvc,aAAW,EACX/K,aAAYvC,GAAiC2B,kBAAkBC,WAAW3B,YC+HlF,GApJ0B,EACxByK,QACA3C,aACAnC,iBACA/I,sBACA4F,WACA0K,WACA+uC,gBAgBuDxxC,EACfA,EAkDfA,EA+DCA,EAlH6BA,EAAvD,MAAOy4C,EAAaM,IAAkBjtD,EAAAA,EAAAA,UAA+C,QAA9BkU,EAAiB,QAAjBA,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmBy4C,mBAAnBz4C,IAAAA,EAAAA,EAAkC,IACnFg5C,GCvD4B78C,EDuDuB,QAAjB6D,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmBy4C,YCtDrD3xD,GAAM,IAAAmyD,WACV,IAAAlmD,YAAU,WACNjM,EAAIK,QAAUgV,CAClB,IACOrV,EAAIK,SALA,IAAqBgV,EAC5BrV,GDwDNiM,EAAAA,EAAAA,YAAU,SACJiN,GAAiB,QAAjBA,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmBy4C,cACjBO,IAAwBh5C,EAAMka,YAAYu+B,aAC5CM,EAAe/4C,EAAMka,YAAYu+B,YAErC,GACC,CAACM,EAAgBC,EAAqBh5C,EAAOy4C,IAEhD,MAAM19B,GAAexc,EAAAA,EAAAA,cAClB0J,IACKA,EAAG9c,kBAAkBm/B,mBACvByuB,EAAe9wC,EAAG9c,OAAOrC,OACrBkX,EAAM7I,YAAc7D,GAAe4lD,eAAqC,KAApBjxC,EAAG9c,OAAOrC,OAEhEiP,EHnEH,SAA+BiI,GACpC,OAAO,SACFA,GAAAA,CACHA,WAAO7X,EACPgP,UAAW7D,GAAe6lD,YAC1Bj/B,iBAAa/xB,GAEjB,CG4DmBixD,CAAsBp5C,IAEnC,GAEF,CAACjI,EAAUiI,IAGPuqB,GAAahsB,EAAAA,EAAAA,cAChB0J,IACC,MAAM/H,EHnEL,SAA6BF,EAA0By4C,GAC5D,OAAO,SACFz4C,GAAAA,CACHka,YAAa,SACRla,EAAMka,aAAW,CACpBu+B,iBAGN,CG2DuBY,CAAoBr5C,EAAOy4C,GAC5C1gD,EAASmI,EAAS,GAEpB,CAACnI,EAAU0gD,EAAaz4C,QAsBDA,EAnBzB,OACE,SAAC8D,OAAAA,CAAKrM,cAAanC,GAAiC2B,kBAAkB7M,UAAUoL,gBAC9E,UAACgK,GAAUA,WACRQ,EAAM7I,YAAc7D,GAAe4lD,gBAClC,SAACz5C,GAASA,WACR,SAACM,GAAgBA,WACf,SAACshB,GAAaA,CACZrhB,MAAOA,EACP3C,WAAYA,EACZnC,eAAgBA,EAChB/I,oBAAqBA,EACrB8N,cAAelI,EACf0K,SAAUA,EACV0S,qBAAsB,CACpBzQ,GAAgBG,aAChBH,GAAgBI,cAChBJ,GAAgBK,SAChBL,GAAgBO,UAElBhB,UAAuC,QAA5BjE,EAAiB,QAAjBA,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmBiE,iBAAnBjE,IAAAA,EAAAA,EAAgC,GAC3C7I,UAAU,SACVie,WAnEK,CAAC3P,EAAkBuP,SAKdpB,EACMA,EAL5B,OAA4B,IAAxBoB,EAAa/0B,SAIgE,QAA3D2zB,EAAAA,GAAqBnO,EAAI0C,IAAK1C,EAAIrU,UAAU3B,uBAA5CmkB,IAAAA,OAAAA,EAAAA,EAA6DvhB,kBAIlE,QAHWuhB,EAAAA,GAC1BoB,EAAa,GAAG7M,IAChB6M,EAAa,GAAG5jB,UAChB3B,uBAH0BmkB,IAAAA,OAAAA,EAAAA,EAGTvhB,cAEyB,EAyDhC6R,eAAgB,CAACD,EAAWlM,KAI1B,SAACupB,GAAsBA,CAACrd,UAAWA,EAAuBlM,SAAUA,IAEtE8e,gBAAiB,IAAM,uDACvB26B,MAAOA,SAKf,SAAC/xC,GAASA,WACR,UAACM,GAAgBA,YACf,SAACu5C,GAAcA,CACbj8C,WAAYA,EACZ4C,cAAelI,EACfiI,MAAOA,EACPyC,SAAUA,EACVtQ,oBAAqBA,EACrBq/C,MAAOA,KAET,SAACh6C,GAAKA,CAACpH,MAAM,yBACX,SAACiI,EAAAA,MAAKA,CACJQ,GAAG,0CACH/P,MAAO2vD,EACP1gD,SAAUgjB,EACVta,OAAQ8pB,EACRhqB,MAAO,aAKf,SAACd,GAASA,WACR,SAACM,GAAgBA,WACf,SAACw5C,GAAOA,CACNl8C,WAAYA,EACZ4C,cAAelI,EACfiI,MAAOA,EACPyC,SAAUA,EACVtQ,oBAAqBA,EACrBq/C,MAAOA,SAIb,SAAC/xC,GAASA,WACR,SAACM,GAAgBA,WACf,SAACwhB,GAAaA,CACZlkB,WAAYA,EACZoF,SAAUA,EACVzC,MAAOA,EACP7N,oBAAqBA,EACrB8N,cAAelI,EACfH,QAAQ,uBACRrG,QAAS,CACP,CAAEnB,MAAO,QAAStH,MAAOyK,GAAakuB,OACtC,CAAErxB,MAAO,QAAStH,MAAOyK,GAAaimD,QAExC7+B,aAAcpnB,GAAakuB,MAC3B5G,YAAaA,GACbC,aAA+B,QAAjB9a,EAAAA,EAAMka,mBAANla,IAAAA,OAAAA,EAAAA,EAAmB8a,aACjC02B,MAAOA,EACP52B,OAAQA,eEvKhB6+B,GAAe,EAAGnuD,eACtB,MAAMnB,GAAS,IAAA6U,YAAW,IAC1B,OAAuB,kBAAoB,MAAO,CAAEhV,UAAWG,EAAO+U,MAAQ5T,EAAS,EAEnF,GAAarB,IAAU,CAC3BiV,MAAM,IAAA7U,KAAI,CACR8B,QAAS,OACTkT,SAAU,OACVhT,WAAY,SACZqM,IAAKzO,EAAMO,QAAQ,GACnBkvD,UAAWzvD,EAAMO,QAAQ,OCV7B,IAAI,GAAY9J,OAAOkC,eACnB,GAAalC,OAAOuI,iBACpB,GAAoBvI,OAAOyI,0BAC3B,GAAsBzI,OAAOoC,sBAC7B,GAAepC,OAAOC,UAAUE,eAChC,GAAeH,OAAOC,UAAU4I,qBAChC,GAAkB,CAACZ,EAAK5H,EAAK+H,IAAU/H,KAAO4H,EAAM,GAAUA,EAAK5H,EAAK,CAAE0H,YAAY,EAAMgB,cAAc,EAAMC,UAAU,EAAMZ,UAAWH,EAAI5H,GAAO+H,EACtJ,GAAiB,CAAChJ,EAAGC,KACvB,IAAK,IAAI6I,KAAQ7I,IAAMA,EAAI,CAAC,GACtB,GAAae,KAAKf,EAAG6I,IACvB,GAAgB9I,EAAG8I,EAAM7I,EAAE6I,IAC/B,GAAI,GACF,IAAK,IAAIA,KAAQ,GAAoB7I,GAC/B,GAAae,KAAKf,EAAG6I,IACvB,GAAgB9I,EAAG8I,EAAM7I,EAAE6I,IAEjC,OAAO9I,CAAC,EAEN,GAAgB,CAACA,EAAGC,IAAM,GAAWD,EAAG,GAAkBC,IAa9D,SAAS45D,GAAa1sD,GACpB,IAAIC,EAAKD,GAAMmD,MAAOwpD,GAAc1sD,EAAIjG,EAb1B,EAAC1G,EAAQ4M,KACvB,IAAIhC,EAAS,CAAC,EACd,IAAK,IAAIvC,KAAQrI,EACX,GAAaO,KAAKP,EAAQqI,IAASuE,EAAQC,QAAQxE,GAAQ,IAC7DuC,EAAOvC,GAAQrI,EAAOqI,IAC1B,GAAc,MAAVrI,GAAkB,GACpB,IAAK,IAAIqI,KAAQ,GAAoBrI,GAC/B4M,EAAQC,QAAQxE,GAAQ,GAAK,GAAa9H,KAAKP,EAAQqI,KACzDuC,EAAOvC,GAAQrI,EAAOqI,IAE5B,OAAOuC,CAAM,EAGmC,CAAU+B,EAAI,CAAC,UAC/D,MAAM/C,GAAS,IAAA6U,YAAW2zC,KACnB95C,IAAM,IAAA/M,WAAS,IAAMu/B,KAAKC,SAAS1qC,SAAS,IAAIkN,MAAM,KACvDsjD,EAAa,CACjByI,mBACAC,kBACAC,YAAaD,IAEf,OAAuB,kBAAoB,MAAO,CAAE9vD,UAAWG,EAAO+U,MAAQ06C,GAA6B,kBAAoB,QAAS,CAAE5vD,UAAWG,EAAOiG,MAAOsH,QAASmB,GAAM+gD,EAAW,IAAK,KAAyB,kBAAoB,EAAAjiD,OAAQ,GAAc,GAAe,CAAEqiD,iBAAiB,EAAMpiD,QAASiB,GAAM5R,GAAQ,CAAEmqD,gBACxU,CACA,MAAMyI,GAAmB5yD,IACvB,MAAM,SAAEqE,GAAarE,EACfkD,GAAS,IAAA6U,YAAW2zC,IAC1B,OAAuB,kBAAoB,EAAAkH,gBAAmB,GAAc,GAAe,CAAC,EAAG5yD,GAAQ,CAAE+C,WAAW,IAAAiB,IAAGhE,EAAM+C,UAAWG,EAAOC,aAAekB,EAAS,EAEnKwuD,GAAkB7yD,IACtB,MAAM,UAAE+C,EAAS,SAAEsB,GAAarE,EAC1BkD,GAAS,IAAA6U,YAAW2zC,IAC1B,OAAuB,kBAAoB,MAAO,CAAE3oD,WAAW,IAAAiB,IAAGjB,EAAWG,EAAO8vD,iBAAmB3uD,EAAS,EAE5GqnD,GAAmB1oD,IAAU,CACjCiV,MAAM,IAAA7U,KAAI,CACR8B,QAAS,OACT+N,SAAU,GACV7N,WAAY,WAEd+D,OAAO,IAAA/F,KAAI,CACTO,MAAOX,EAAMY,OAAOJ,KAAKK,UACzBwR,WAAY,WAEdlS,WAAW,IAAAC,KAAI,CACbuV,WAAY,OACZs6C,YAAa,gBAEfD,gBAAgB,IAAA5vD,KAAI,CAClB8B,QAAS,OACTE,WAAY,SACZ86B,KAAM,UACNv8B,MAAOX,EAAMY,OAAOJ,KAAKK,UACzBoP,SAAU,OC9DDigD,GAAc,EAAGn6C,QAAOC,oBACnC,MAAMm6C,EAA8D,CAClE,CAAEtxD,MAAOwK,GAAe+mD,aAAcjqD,MAAO,WAC7C,CAAEtH,MAAOwK,GAAekzB,aAAcp2B,MAAO,QAC7C,CAAEtH,MAAOwK,GAAe6lD,YAAa/oD,MAAO,UAC5C,CAAEtH,MAAOwK,GAAegnD,mBAAoBlqD,MAAO,yBAG/C2qB,GAAexc,EAAAA,EAAAA,cAClBsE,IACKA,EAAO/Z,OAAS+Z,EAAO/Z,QAAUkX,EAAM7I,WACzC8I,EAAc,CACZ+gB,MAAOhhB,EAAMghB,MACb3jB,WAAY2C,EAAM3C,WAClBlG,UAAW0L,EAAO/Z,OAEtB,GAEF,CAACmX,EAAeD,IAGlB,OACE,SAAC8D,OAAAA,CAAKrM,cAAanC,GAAiCpJ,OAAOqJ,iBACzD,SAACkkD,GAAYA,WACX,SAACE,GAAYA,CACXvpD,MAAM,UACNtH,MAAOkX,EAAM7I,YAAc7D,GAAe4lD,cAAgB5lD,GAAe6lD,YAAcn5C,EAAM7I,UAC7FmB,YAAY,aACZ6mB,kBAAgB,EAChB5tB,QAAS6oD,EACTriD,SAAUgjB,u1BChCL,SAASw/B,GAAav6C,OAmB/Bw6C,EAA4CA,EAI5CA,EAtBJ,IAAIA,EAAex6C,MA+BVw6C,EAuBT,OApDKA,EAAarjD,YAChBqjD,EAAe,SACVA,GAAAA,CACHrjD,UAAW7D,GAAe+mD,gBAI9BG,EAgEF,SAAwCx6C,OAGlCw6C,EAAAA,EAOAA,EAAAA,EATJ,IAAIA,EAAex6C,EAgBnB,OAdkC,QAA9Bw6C,EAAAA,EAAavgC,yBAAbugC,IAAAA,GAAqC,QAArCA,EAAAA,EAAgCx6C,aAAhCw6C,IAAAA,OAAAA,EAAAA,EAAuCxmC,MAAM,mBAC/CwmC,EAAe9+B,GACb8+B,EACAA,EAAavgC,kBAAkBja,MAAM6R,QAAQ,eAAgB,qBAI/B,QAA9B2oC,EAAAA,EAAavgC,yBAAbugC,IAAAA,GAAqC,QAArCA,EAAAA,EAAgCx6C,aAAhCw6C,IAAAA,OAAAA,EAAAA,EAAuCxmC,MAAM,iBAC/CwmC,EAAe9+B,GACb8+B,EACAA,EAAavgC,kBAAkBja,MAAM6R,QAAQ,aAAc,kBAIxD2oC,CACT,CAlFiBC,CAA+BD,GAC1CA,EAAarjD,YAAc7D,GAAe+mD,cAAgBG,EAAargC,eACzEqgC,EA8CJ,SAA2Bx6C,OAGrBw6C,EAFJ,IAAIA,EAAex6C,MASVw6C,EALLA,GAFyB,QAAzBA,EAAAA,EAAargC,oBAAbqgC,IAAAA,OAAAA,EAAAA,EAA2B/sD,gBAAyD,SAAxC+sD,EAAargC,aAAa3sB,YAKxEgtD,EAAeE,GAAoBF,EAJd1vB,EAAmBv9B,sBACH,QAAnCitD,EAAAA,EAAargC,aAAa3sB,iBAA1BgtD,IAAAA,EAAAA,EAAuC,OACvCA,EAAargC,aAAa1sB,gBAII,QAAzB+sD,EAAAA,EAAargC,oBAAbqgC,IAAAA,UAAAA,EAA2B/sD,eAGpC,OAAO+sD,CACT,CA5DmBG,CAAkBH,GACjCA,EAiFJ,SAAmCx6C,OAE/BA,EAE0BA,EAA5B,SAFoB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBvQ,kBAlGW,WAkGQuQ,EAAMma,aAAa1qB,mBAEd,QAAlBuQ,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoB46C,kBACvC,SACF56C,GAAAA,CACHma,aAAc,SACTna,EAAMma,cAAY,CACrB1qB,gBAAiBuQ,EAAMma,aAAaygC,iBACpCA,sBAAkBzyD,MAKjB6X,CACT,CAjGmB66C,CAA0BL,GACzCA,EAkGJ,SAA2Cx6C,OAGpBw6C,EAOdA,EACAA,EAVP,IAAIA,EAAex6C,EAEnB,MAAM86C,EAAwC,QAAzBN,EAAAA,EAAargC,oBAAbqgC,IAAAA,OAAAA,EAAAA,EAA2B3pD,cAG5C2pD,EAOJ,OATIM,GAAiC,SAAjBA,IAClBN,EzBnCG,SACLx6C,EACAnP,EAAY,GACZk5B,EAAW,KACX5E,EAAoB,QAEInlB,EAAAA,EAExB,OAAO4nB,GAAoB5nB,EAAO,IAF0B,QAApCA,EAAkB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoBqa,wBAApBra,IAAAA,EAAAA,EAAwC,GAI9D,CACEnP,YACAk5B,WACA5E,YAGN,CyBmBmB41B,CAAsBP,EAAcM,EAAc,KAAM,EAC5C,QAAzBN,EAAAA,EAAargC,oBAAbqgC,IAAAA,OAAAA,EAAAA,EAA2BnxB,kBAAmB,MAIlB,QAAzBmxB,EAAAA,EAAargC,oBAAbqgC,IAAAA,UAAAA,EAA2B3pD,UACF,QAAzB2pD,EAAAA,EAAargC,oBAAbqgC,IAAAA,UAAAA,EAA2BnxB,gBAE3BmxB,CACT,CAhHmBQ,CAAkCR,GACjDA,EAiHJ,SAAuCx6C,GACrC,MAAMi7C,EAAoBj7C,EAAMma,aAEhC,IAAK8gC,EACH,OAAOj7C,EAGT,MAAMk7C,EAAqC,GACrC7gC,EAAmB4gC,EAAkB5gC,iBAC3C,OAAIA,GAAoBA,EAAiBp6B,OAAS,IAChDo6B,EAAiB5pB,SAASrC,IACxB,MAAM+sD,EAAc,CAAEtqD,UAAWzC,EAAOyC,UAAWk5B,SAAU37B,EAAO27B,UACpE,IAAK37B,EAAO+2B,SAAW/2B,EAAOA,OAC5B8sD,EAAW3rD,KAAK,SAAK4rD,GAAAA,CAAah2B,QAAS,CAAC/2B,EAAOA,eAC9C,CACL,IAAIgtD,GAAY,EAChB,GAAIhtD,EAAO+2B,SAAW/2B,EAAOA,OAAQ,CACnC,IAAK,MAAMitD,KAAajtD,EAAO+2B,QAC7B,GAAI/2B,EAAOA,SAAWitD,EAAW,CAC/BD,GAAY,EACZ,KACF,CAEGA,GAA+B,MAAlBhtD,EAAOA,QACvBA,EAAO+2B,QAAQ51B,KAAKnB,EAAOA,QAE7B8sD,EAAW3rD,KAAK,SAAK4rD,GAAAA,CAAah2B,QAAS/2B,EAAO+2B,UACpD,CACF,KAEE+1B,EAAWj7D,OAAS,GACf,SAAK+f,GAAAA,CAAOma,aAAc,SAAK8gC,GAAAA,CAAmB5gC,iBAAkB6gC,MAGxEl7C,CACT,CApJmBs7C,CAA8Bd,GAC7CA,EAqJJ,SAAyCx6C,OACnCA,EAAJ,IAAsB,QAAlBA,EAAAA,EAAMma,oBAANna,IAAAA,OAAAA,EAAAA,EAAoB2S,eAAgB3S,EAAMma,aAAaxH,YAAYP,WAAW,KAAM,CACtF,MAAM/V,EAAUuX,GAAqB5T,EAAMma,aAAaxH,aAClD4oC,GAAkBl/C,aAAAA,EAAAA,EAAS9F,gBAAgB8F,aAAAA,EAAAA,EAAS7F,iBAAiB6F,aAAAA,EAAAA,EAASsV,cACpF,OAAO,SACF3R,GAAAA,CACHzJ,aAAc8F,aAAAA,EAAAA,EAAS9F,aACvB4jB,aAAc,SACTna,EAAMma,cAAY,CACrBlW,UAAW,CAAC,CAAEzN,cAAe6F,aAAAA,EAAAA,EAAS7F,cAAemb,aAActV,aAAAA,EAAAA,EAASsV,eAC5EliB,gBAAiB4M,aAAAA,EAAAA,EAAS5M,gBAC1BkjB,YAAa4oC,OAAkBpzD,EAAY6X,EAAMma,aAAaxH,eAGpE,CAEA,OAAO3S,CACT,CAtKmBw7C,CAAgChB,MAGpB,QAAzBA,EAAAA,EAAargC,oBAAbqgC,IAAAA,OAAAA,EAAAA,EAA2BhkD,iBAA0C,QAAzBgkD,EAAAA,EAAargC,oBAAbqgC,IAAAA,OAAAA,EAAAA,EAA2B7oC,iBACzE6oC,EAoKJ,SAAqCx6C,OAG/Bw6C,EAA4CA,EAFhD,IAAIA,EAAex6C,MAgBVw6C,EACAA,GAfoB,QAAzBA,EAAAA,EAAargC,oBAAbqgC,IAAAA,OAAAA,EAAAA,EAA2BhkD,iBAA0C,QAAzBgkD,EAAAA,EAAargC,oBAAbqgC,IAAAA,OAAAA,EAAAA,EAA2B7oC,gBACzE6oC,EAAe,SACVA,GAAAA,CACHrgC,aAAc,SACTqgC,EAAargC,cAAY,CAC5BlW,UAAW,CACT,CACEzN,cAAegkD,EAAargC,aAAa3jB,cACzCmb,aAAc6oC,EAAargC,aAAaxI,mBAMhB,QAAzB6oC,EAAAA,EAAargC,oBAAbqgC,IAAAA,UAAAA,EAA2BhkD,cACF,QAAzBgkD,EAAAA,EAAargC,oBAAbqgC,IAAAA,UAAAA,EAA2B7oC,cAGpC,OAAO6oC,CACT,CA1LmBiB,CAA4BjB,KAGX,QAA9BA,EAAAA,EAAavgC,yBAAbugC,IAAAA,OAAAA,EAAAA,EAAgC7jD,YAClC6jD,EAAe,SACVA,GAAAA,CACHvgC,kBAAmB,SACdugC,EAAavgC,mBAAiB,CACjChW,UAAW,CAACu2C,EAAavgC,kBAAkBtjB,cAIV,QAA9B6jD,EAAAA,EAAavgC,yBAAbugC,IAAAA,UAAAA,EAAgC7jD,UAGrC6jD,EAAavgC,wBAAsE9xB,IAAjDqyD,EAAavgC,kBAAkB6B,gBAEjE0+B,EADEA,EAAavgC,kBAAkByhC,cAClB,SACVlB,GAAAA,CACHvgC,kBAAmB,SACdugC,EAAavgC,mBAAiB,CACjC6B,eAAe,MAIJ,SACV0+B,GAAAA,CACHvgC,kBAAmB,SACdugC,EAAavgC,mBAAiB,CACjC6B,eAAe,OAMhB0+B,CACT,CC5DA,MAAMmB,GAAgB,CACpBxkD,UAAW7D,GAAe+mD,cAwC5B,GAZyB,CAACr6C,EAA0B47C,KAClD,MAAMC,GAAgB7iD,EAAAA,EAAAA,UAAQ,IAfX,CAACgH,IAEpB,MACM87C,EAduB,CAAC97C,IAC1BA,EAAM7I,YAAc7D,GAAe4lD,eAAiC,KAAhBl5C,EAAMA,OAAiBA,EAAMka,cACnFla,EAAMka,YAAc,CAClBu+B,YAAaz4C,EAAMA,MACnB8a,aAAcvnB,GAAaimD,QAIxBx5C,GAMkB+7C,EADJC,EAAAA,EAAAA,UAAS,CAAC,EAAGh8C,EAAO27C,KAEnCM,EAAgB1B,GAAauB,GAInC,OAAOI,KAAUD,EAAej8C,GAASA,EAAQi8C,CAAa,EAO1BE,CAAan8C,IAAQ,CAACA,IAQ1D,OANAjN,EAAAA,EAAAA,YAAU,KACJ8oD,IAAkB77C,GACpB47C,EAAcC,EAChB,GACC,CAACA,EAAe77C,EAAO47C,IAEnBC,CAAa,2HCZtB,MA2GMO,GAAqB,EACzBnrD,OACAiK,iBACAb,mBACA2F,QACA3C,aACAlL,sBACA4F,WACA0K,WACA+uC,YAEA,OAAQxxC,EAAM7I,WACZ,KAAK7D,GAAe+mD,aAClB,OACE,SAACgC,GAAqBA,CACpBprD,KAAMA,EACN+O,MAAOA,EACP3C,WAAYA,EACZtF,SAAUA,EACV5F,oBAAqBA,EACrBsQ,SAAUA,IAIhB,KAAKnP,GAAekzB,aAClB,OACE,SAAC81B,GAAeA,CACdrrD,KAAMA,EACNiK,eAAgBA,EAChBb,iBAAkBA,EAClB2F,MAAOA,EACP3C,WAAYA,EACZtF,SAAUA,EACV5F,oBAAqBA,EACrBsQ,SAAUA,EACVid,UAAW8xB,IAIjB,KAAKl+C,GAAegnD,mBAClB,OACE,SAACiC,GAAcA,CACbrhD,eAAgBA,EAChB8E,MAAOA,EACP3C,WAAYA,EACZtF,SAAUA,EACV5F,oBAAqBA,EACrBsQ,SAAUA,IAIhB,KAAKnP,GAAe6lD,YACpB,KAAK7lD,GAAe4lD,cAClB,OACE,SAACsD,GAAiBA,CAChBthD,eAAgBA,EAChB8E,MAAOA,EACP3C,WAAYA,EACZtF,SAAUA,EACV5F,oBAAqBA,EACrBsQ,SAAUA,EACV+uC,MAAOA,IAIb,QACE,MAAM5vD,EAAOoe,EAAM7I,UACnB,OACE,SAACgC,EAAAA,MAAKA,CAAC5N,MAAM,+BACA,yBAAT3J,GAA4C,uBAATA,KACnC,gCACGA,EAAK,wCAAsC,KAC5C,SAAC9B,IAAAA,CACCoL,KAAK,yHACLC,OAAO,SACPC,IAAI,sBACL,uBAEI,IAAI,oGAET,SAACgV,EAAAA,WAAUA,CAACE,OAAO,QAAQ1E,UAAQ,EAACyE,SAAS,OAAOvX,MAAOub,KAAKC,UAAUtE,EAAO,KAAM,UAKnG,EAGIy8C,GAAgB,KAElB,SAACtjD,EAAAA,MAAKA,CAAC5N,MAAM,sCAAsCkM,cAAanC,GAAiCS,wBAC/F,gCAAE,kIAEkB,KAClB,SAACjW,IAAAA,CACCoL,KAAK,2GACLC,OAAO,SACPC,IAAI,sBACL,kBAEI,IAAI,6BAOXsxD,GAAwB,KAE1B,SAACvjD,EAAAA,MAAKA,CACJ5N,MAAM,oCACNkM,cAAanC,GAAiCU,gCAE9C,gCAAE,4NAE6G,KAC7G,SAAClW,IAAAA,CACCoL,KAAK,2GACLC,OAAO,SACPC,IAAI,sBACL,kBAEI,IAAI,6BCtQV,SAASuxD,GAAW7zD,GACvB,MAAwB,mBAAVA,CAClB,CCcA,IAAI8zD,GAAgB,SAAS74D,EAAGhE,GAI9B,OAHA68D,GAAgBl8D,OAAOsuB,gBAClB,CAAE6tC,UAAW,cAAgBz8D,OAAS,SAAU2D,EAAGhE,GAAKgE,EAAE84D,UAAY98D,CAAG,GAC1E,SAAUgE,EAAGhE,GAAK,IAAK,IAAIwE,KAAKxE,EAAOW,OAAOC,UAAUE,eAAeC,KAAKf,EAAGwE,KAAIR,EAAEQ,GAAKxE,EAAEwE,GAAI,EAC7Fq4D,GAAc74D,EAAGhE,EAC1B,EAEO,SAAS+8D,GAAU/4D,EAAGhE,GAC3B,GAAiB,mBAANA,GAA0B,OAANA,EAC3B,MAAM,IAAIg9D,UAAU,uBAAyBC,OAAOj9D,GAAK,iCAE7D,SAASk9D,IAAO/gD,KAAKlc,YAAc+D,CAAG,CADtC64D,GAAc74D,EAAGhE,GAEjBgE,EAAEpD,UAAkB,OAANZ,EAAaW,OAAOgqB,OAAO3qB,IAAMk9D,EAAGt8D,UAAYZ,EAAEY,UAAW,IAAIs8D,EACjF,CA2IO,SAASC,GAAS10D,GACvB,IAAI20D,EAAsB,mBAAXv5D,QAAyBA,OAAOw5D,SAAU/4D,EAAI84D,GAAK30D,EAAE20D,GAAIj9D,EAAI,EAC5E,GAAImE,EAAG,OAAOA,EAAEvD,KAAK0H,GACrB,GAAIA,GAAyB,iBAAbA,EAAEvI,OAAqB,MAAO,CAC1C0kD,KAAM,WAEF,OADIn8C,GAAKtI,GAAKsI,EAAEvI,SAAQuI,OAAI,GACrB,CAAEM,MAAON,GAAKA,EAAEtI,KAAMm9D,MAAO70D,EACxC,GAEJ,MAAM,IAAIu0D,UAAUI,EAAI,0BAA4B,kCACtD,CAEO,SAASG,GAAO90D,EAAGlE,GACxB,IAAID,EAAsB,mBAAXT,QAAyB4E,EAAE5E,OAAOw5D,UACjD,IAAK/4D,EAAG,OAAOmE,EACf,IAAmB/D,EAAYd,EAA3BzD,EAAImE,EAAEvD,KAAK0H,GAAO+0D,EAAK,GAC3B,IACI,WAAc,IAANj5D,GAAgBA,KAAM,MAAQG,EAAIvE,EAAEykD,QAAQ0Y,MAAME,EAAGhuD,KAAK9K,EAAEqE,MACxE,CACA,MAAOsP,GAASzU,EAAI,CAAEyU,MAAOA,EAAS,CACtC,QACI,IACQ3T,IAAMA,EAAE44D,OAASh5D,EAAInE,EAAU,SAAImE,EAAEvD,KAAKZ,EAClD,CACA,QAAU,GAAIyD,EAAG,MAAMA,EAAEyU,KAAO,CACpC,CACA,OAAOmlD,CACT,CAkBO,SAASC,GAAct9B,EAAInB,EAAM0+B,GACtC,GAAIA,GAA6B,IAArBx7D,UAAUhC,OAAc,IAAK,IAA4Bs9D,EAAxBr9D,EAAI,EAAGkE,EAAI26B,EAAK9+B,OAAYC,EAAIkE,EAAGlE,KACxEq9D,GAAQr9D,KAAK6+B,IACRw+B,IAAIA,EAAKn9D,MAAMO,UAAUmN,MAAMhN,KAAKi+B,EAAM,EAAG7+B,IAClDq9D,EAAGr9D,GAAK6+B,EAAK7+B,IAGrB,OAAOggC,EAAG38B,OAAOg6D,GAAMn9D,MAAMO,UAAUmN,MAAMhN,KAAKi+B,GACpD,CArE6Br+B,OAAOgqB,OA2GXhqB,OAAOgqB,OA2DkB,mBAApBgzC,iBAAiCA,gBC7TxD,ICICC,GDJGC,KCIHD,GDJ0C,SAAUE,GACxD,OAAO,SAAiCz/C,GACpCy/C,EAAO3hD,MACPA,KAAK2B,QAAUO,EACTA,EAAOne,OAAS,4CAA8Cme,EAAOxN,KAAI,SAAU+M,EAAKzd,GAAK,OAAOA,EAAI,EAAI,KAAOyd,EAAI/c,UAAY,IAAGiS,KAAK,QAC3I,GACNqJ,KAAKpa,KAAO,sBACZoa,KAAKkC,OAASA,CAClB,CACJ,CCLmB0/C,EAJF,SAAUC,GACnBtpD,MAAM3T,KAAKi9D,GACXA,EAASC,OAAQ,IAAIvpD,OAAQupD,KACjC,KAESr9D,UAAYD,OAAOgqB,OAAOjW,MAAM9T,WACzCg9D,GAASh9D,UAAUX,YAAc29D,GAC1BA,ICRJ,SAASM,GAAUC,EAAKtsD,GAC3B,GAAIssD,EAAK,CACL,IAAIx/C,EAAQw/C,EAAI9wD,QAAQwE,GACxB,GAAK8M,GAASw/C,EAAIr/C,OAAOH,EAAO,EACpC,CACJ,CCDA,IAAImG,GAAgB,WAChB,SAASA,EAAas5C,GAClBjiD,KAAKiiD,gBAAkBA,EACvBjiD,KAAKkiD,QAAS,EACdliD,KAAKmiD,WAAa,KAClBniD,KAAKoiD,YAAc,IACvB,CA+GqB,IACbC,EAIR,OAnHA15C,EAAalkB,UAAU69D,YAAc,WACjC,IAAIC,EAAKxxD,EAAIyxD,EAAKxxD,EACdkR,EACJ,IAAKlC,KAAKkiD,OAAQ,CACdliD,KAAKkiD,QAAS,EACd,IAAIC,EAAaniD,KAAKmiD,WACtB,GAAIA,EAEA,GADAniD,KAAKmiD,WAAa,KACdj+D,MAAMC,QAAQg+D,GACd,IACI,IAAK,IAAIM,EAAezB,GAASmB,GAAaO,EAAiBD,EAAaha,QAASia,EAAevB,KAAMuB,EAAiBD,EAAaha,OACrHia,EAAe91D,MACrB+1D,OAAO3iD,KAExB,CACA,MAAO4iD,GAASL,EAAM,CAAErmD,MAAO0mD,EAAS,CACxC,QACI,IACQF,IAAmBA,EAAevB,OAASpwD,EAAK0xD,EAAaI,SAAS9xD,EAAGnM,KAAK69D,EACtF,CACA,QAAU,GAAIF,EAAK,MAAMA,EAAIrmD,KAAO,CACxC,MAGAimD,EAAWQ,OAAO3iD,MAG1B,IAAI8iD,EAAmB9iD,KAAKiiD,gBAC5B,GAAIxB,GAAWqC,GACX,IACIA,GACJ,CACA,MAAOr7D,GACHya,EAASza,aAAai6D,GAAsBj6D,EAAEya,OAAS,CAACza,EAC5D,CAEJ,IAAI26D,EAAcpiD,KAAKoiD,YACvB,GAAIA,EAAa,CACbpiD,KAAKoiD,YAAc,KACnB,IACI,IAAK,IAAIW,EAAgB/B,GAASoB,GAAcY,EAAkBD,EAActa,QAASua,EAAgB7B,KAAM6B,EAAkBD,EAActa,OAAQ,CACnJ,IAAIwa,EAAYD,EAAgBp2D,MAChC,IACIs2D,GAAcD,EAClB,CACA,MAAOxhD,GACHS,EAASA,QAAuCA,EAAS,GACrDT,aAAeigD,GACfx/C,EAASo/C,GAAcA,GAAc,GAAIF,GAAOl/C,IAAUk/C,GAAO3/C,EAAIS,SAGrEA,EAAO7O,KAAKoO,EAEpB,CACJ,CACJ,CACA,MAAO0hD,GAASX,EAAM,CAAEtmD,MAAOinD,EAAS,CACxC,QACI,IACQH,IAAoBA,EAAgB7B,OAASnwD,EAAK+xD,EAAcF,SAAS7xD,EAAGpM,KAAKm+D,EACzF,CACA,QAAU,GAAIP,EAAK,MAAMA,EAAItmD,KAAO,CACxC,CACJ,CACA,GAAIgG,EACA,MAAM,IAAIw/C,GAAoBx/C,EAEtC,CACJ,EACAyG,EAAalkB,UAAUkR,IAAM,SAAUytD,GACnC,IAAIryD,EACJ,GAAIqyD,GAAYA,IAAapjD,KACzB,GAAIA,KAAKkiD,OACLgB,GAAcE,OAEb,CACD,GAAIA,aAAoBz6C,EAAc,CAClC,GAAIy6C,EAASlB,QAAUkB,EAASC,WAAWrjD,MACvC,OAEJojD,EAASE,WAAWtjD,KACxB,EACCA,KAAKoiD,YAA0C,QAA3BrxD,EAAKiP,KAAKoiD,mBAAgC,IAAPrxD,EAAgBA,EAAK,IAAIsC,KAAK+vD,EAC1F,CAER,EACAz6C,EAAalkB,UAAU4+D,WAAa,SAAUpwC,GAC1C,IAAIkvC,EAAaniD,KAAKmiD,WACtB,OAAOA,IAAelvC,GAAW/uB,MAAMC,QAAQg+D,IAAeA,EAAW3wD,SAASyhB,EACtF,EACAtK,EAAalkB,UAAU6+D,WAAa,SAAUrwC,GAC1C,IAAIkvC,EAAaniD,KAAKmiD,WACtBniD,KAAKmiD,WAAaj+D,MAAMC,QAAQg+D,IAAeA,EAAW9uD,KAAK4f,GAASkvC,GAAcA,EAAa,CAACA,EAAYlvC,GAAUA,CAC9H,EACAtK,EAAalkB,UAAU8+D,cAAgB,SAAUtwC,GAC7C,IAAIkvC,EAAaniD,KAAKmiD,WAClBA,IAAelvC,EACfjT,KAAKmiD,WAAa,KAEbj+D,MAAMC,QAAQg+D,IACnBJ,GAAUI,EAAYlvC,EAE9B,EACAtK,EAAalkB,UAAUk+D,OAAS,SAAUS,GACtC,IAAIhB,EAAcpiD,KAAKoiD,YACvBA,GAAeL,GAAUK,EAAagB,GAClCA,aAAoBz6C,GACpBy6C,EAASG,cAAcvjD,KAE/B,EACA2I,EAAa66C,QACLnB,EAAQ,IAAI15C,GACVu5C,QAAS,EACRG,GAEJ15C,CACX,CA3HmB,GAkInB,SAASu6C,GAAcD,GACfxC,GAAWwC,GACXA,IAGAA,EAAUX,aAElB,CAZgC35C,GAAa66C,MCjItC,IAAI,GACW,KADX,GAEgB,KAFhB,IAIgC,EAJhC,IAKmB,ECJnBC,GAAkB,CACzBC,WAAY,SAAUC,EAASC,GAE3B,IADA,IAAIh3C,EAAO,GACFi3C,EAAK,EAAGA,EAAK99D,UAAUhC,OAAQ8/D,IACpCj3C,EAAKi3C,EAAK,GAAK99D,UAAU89D,GAE7B,IAAIC,EAAWL,GAAgBK,SAC/B,OAAIA,aAA2C,EAASA,EAASJ,YACtDI,EAASJ,WAAWzpD,MAAM6pD,EAAUxC,GAAc,CAACqC,EAASC,GAAUxC,GAAOx0C,KAEjF82C,WAAWzpD,WAAM,EAAQqnD,GAAc,CAACqC,EAASC,GAAUxC,GAAOx0C,IAC7E,EACAm3C,aAAc,SAAUC,GACpB,IAAIF,EAAWL,GAAgBK,SAC/B,QAASA,aAA2C,EAASA,EAASC,eAAiBA,cAAcC,EACzG,EACAF,cAAU73D,GCjBP,SAASg4D,KAAS,CCAlB,IAAIC,GAA8CC,GAAmB,SAAKl4D,OAAWA,GAOrF,SAASk4D,GAAmB10D,EAAM7C,EAAOsP,GAC5C,MAAO,CACHzM,KAAMA,EACN7C,MAAOA,EACPsP,MAAOA,EAEf,CCZA,ICQIkoD,GAAc,SAAUzC,GAExB,SAASyC,EAAWC,GAChB,INsHuBz3D,EMtHnB03D,EAAQ3C,EAAO/8D,KAAKob,OAASA,KAWjC,OAVAskD,EAAMC,WAAY,EACdF,GACAC,EAAMD,YAAcA,INmHDz3D,EMlHAy3D,aNmHF17C,IACpB/b,GAAS,WAAYA,GAAS6zD,GAAW7zD,EAAM+1D,SAAWlC,GAAW7zD,EAAM+I,MAAQ8qD,GAAW7zD,EAAM01D,eMnH7F+B,EAAY1uD,IAAI2uD,IAIpBA,EAAMD,YAAcG,GAEjBF,CACX,CAwDA,OAtEA1D,GAAUwD,EAAYzC,GAetByC,EAAW51C,OAAS,SAAUi6B,EAAMvsC,EAAOuoD,GACvC,OAAO,IAAIC,GAAejc,EAAMvsC,EAAOuoD,EAC3C,EACAL,EAAW3/D,UAAUgkD,KAAO,SAAU77C,GAC9BoT,KAAKukD,UACLI,GF1BL,SAA0B/3D,GAC7B,OAAOu3D,GAAmB,IAAKv3D,OAAOX,EAC1C,CEwBsC24D,CAAiBh4D,GAAQoT,MAGnDA,KAAK6kD,MAAMj4D,EAEnB,EACAw3D,EAAW3/D,UAAUyX,MAAQ,SAAUuF,GAC/BzB,KAAKukD,UACLI,GFpCDR,GAAmB,SAAKl4D,EEoCqBwV,GAAMzB,OAGlDA,KAAKukD,WAAY,EACjBvkD,KAAK8kD,OAAOrjD,GAEpB,EACA2iD,EAAW3/D,UAAUggE,SAAW,WACxBzkD,KAAKukD,UACLI,GAA0BT,GAAuBlkD,OAGjDA,KAAKukD,WAAY,EACjBvkD,KAAK+kD,YAEb,EACAX,EAAW3/D,UAAU69D,YAAc,WAC1BtiD,KAAKkiD,SACNliD,KAAKukD,WAAY,EACjB5C,EAAOl9D,UAAU69D,YAAY19D,KAAKob,MAClCA,KAAKqkD,YAAc,KAE3B,EACAD,EAAW3/D,UAAUogE,MAAQ,SAAUj4D,GACnCoT,KAAKqkD,YAAY5b,KAAK77C,EAC1B,EACAw3D,EAAW3/D,UAAUqgE,OAAS,SAAUrjD,GACpC,IACIzB,KAAKqkD,YAAYnoD,MAAMuF,EAC3B,CACA,QACIzB,KAAKsiD,aACT,CACJ,EACA8B,EAAW3/D,UAAUsgE,UAAY,WAC7B,IACI/kD,KAAKqkD,YAAYI,UACrB,CACA,QACIzkD,KAAKsiD,aACT,CACJ,EACO8B,CACX,CAxEiB,CAwEfz7C,IAEEq8C,GAAQ33C,SAAS5oB,UAAU2wB,KAC/B,SAASA,GAAKvB,EAAIoxC,GACd,OAAOD,GAAMpgE,KAAKivB,EAAIoxC,EAC1B,CACA,IAAIC,GAAoB,WACpB,SAASA,EAAiBC,GACtBnlD,KAAKmlD,gBAAkBA,CAC3B,CAqCA,OApCAD,EAAiBzgE,UAAUgkD,KAAO,SAAU77C,GACxC,IAAIu4D,EAAkBnlD,KAAKmlD,gBAC3B,GAAIA,EAAgB1c,KAChB,IACI0c,EAAgB1c,KAAK77C,EACzB,CACA,MAAOsP,GACHkpD,GAAqBlpD,EACzB,CAER,EACAgpD,EAAiBzgE,UAAUyX,MAAQ,SAAUuF,GACzC,IAAI0jD,EAAkBnlD,KAAKmlD,gBAC3B,GAAIA,EAAgBjpD,MAChB,IACIipD,EAAgBjpD,MAAMuF,EAC1B,CACA,MAAOvF,GACHkpD,GAAqBlpD,EACzB,MAGAkpD,GAAqB3jD,EAE7B,EACAyjD,EAAiBzgE,UAAUggE,SAAW,WAClC,IAAIU,EAAkBnlD,KAAKmlD,gBAC3B,GAAIA,EAAgBV,SAChB,IACIU,EAAgBV,UACpB,CACA,MAAOvoD,GACHkpD,GAAqBlpD,EACzB,CAER,EACOgpD,CACX,CAzCuB,GA0CnBR,GAAkB,SAAU/C,GAE5B,SAAS+C,EAAeW,EAAgBnpD,EAAOuoD,GAC3C,IACIU,EASIG,EAVJhB,EAAQ3C,EAAO/8D,KAAKob,OAASA,KAyBjC,OAvBIygD,GAAW4E,KAAoBA,EAC/BF,EAAkB,CACd1c,KAAO4c,QAAuDA,OAAiBp5D,EAC/EiQ,MAAOA,QAAqCA,OAAQjQ,EACpDw4D,SAAUA,QAA2CA,OAAWx4D,GAKhEq4D,GAAS,KACTgB,EAAY9gE,OAAOgqB,OAAO62C,IAChB/C,YAAc,WAAc,OAAOgC,EAAMhC,aAAe,EAClE6C,EAAkB,CACd1c,KAAM4c,EAAe5c,MAAQrzB,GAAKiwC,EAAe5c,KAAM6c,GACvDppD,MAAOmpD,EAAenpD,OAASkZ,GAAKiwC,EAAenpD,MAAOopD,GAC1Db,SAAUY,EAAeZ,UAAYrvC,GAAKiwC,EAAeZ,SAAUa,KAIvEH,EAAkBE,EAG1Bf,EAAMD,YAAc,IAAIa,GAAiBC,GAClCb,CACX,CACA,OA7BA1D,GAAU8D,EAAgB/C,GA6BnB+C,CACX,CA/BqB,CA+BnBN,IAEF,SAASgB,GAAqBlpD,GACtB,ICjKD,SAA8BuF,GACjCgiD,GAAgBC,YAAW,WAEvB,IADuB,GAKnB,MAAMjiD,EALa,GAEFA,EAKzB,GACJ,CD2JQ8jD,CAAqBrpD,EAE7B,CAIA,SAASyoD,GAA0Ba,EAAcC,GAC7C,IAAIC,EAAwB,GAC5BA,GAAyBjC,GAAgBC,YAAW,WAAc,OAAOgC,EAAsBF,EAAcC,EAAa,GAC9H,CACO,IAAIjB,GAAiB,CACxBtC,QAAQ,EACRzZ,KAAMwb,GACN/nD,MAVJ,SAA6BuF,GACzB,MAAMA,CACV,EASIgjD,SAAUR,IEhLV0B,GAAsB,SAAUhE,GAEhC,SAASgE,EAAmBtB,EAAauB,EAAQC,EAAYC,EAASC,EAAYC,GAC9E,IAAI1B,EAAQ3C,EAAO/8D,KAAKob,KAAMqkD,IAAgBrkD,KAuC9C,OAtCAskD,EAAMyB,WAAaA,EACnBzB,EAAM0B,kBAAoBA,EAC1B1B,EAAMO,MAAQe,EACR,SAAUh5D,GACR,IACIg5D,EAAOh5D,EACX,CACA,MAAO6U,GACH4iD,EAAYnoD,MAAMuF,EACtB,CACJ,EACEkgD,EAAOl9D,UAAUogE,MACvBP,EAAMQ,OAASgB,EACT,SAAUrkD,GACR,IACIqkD,EAAQrkD,EACZ,CACA,MAAOA,GACH4iD,EAAYnoD,MAAMuF,EACtB,CACA,QACIzB,KAAKsiD,aACT,CACJ,EACEX,EAAOl9D,UAAUqgE,OACvBR,EAAMS,UAAYc,EACZ,WACE,IACIA,GACJ,CACA,MAAOpkD,GACH4iD,EAAYnoD,MAAMuF,EACtB,CACA,QACIzB,KAAKsiD,aACT,CACJ,EACEX,EAAOl9D,UAAUsgE,UAChBT,CACX,CASA,OAnDA1D,GAAU+E,EAAoBhE,GA2C9BgE,EAAmBlhE,UAAU69D,YAAc,WACvC,IAAIvxD,EACJ,IAAKiP,KAAKgmD,mBAAqBhmD,KAAKgmD,oBAAqB,CACrD,IAAIC,EAAWjmD,KAAKkiD,OACpBP,EAAOl9D,UAAU69D,YAAY19D,KAAKob,OACjCimD,IAAwC,QAA1Bl1D,EAAKiP,KAAK+lD,kBAA+B,IAAPh1D,GAAyBA,EAAGnM,KAAKob,MACtF,CACJ,EACO2lD,CACX,CArDyB,CAqDvBvB,ICxDK,SAAS1vD,GAAIwxD,EAASjB,GACzB,OCCoBkB,EDDL,SAAU9hE,EAAQohE,GAC7B,IAAIjjD,EAAQ,EACZne,EAAO+hE,UDFJ,IAAIT,GCEmCF,GAAY,SAAU74D,GAC5D64D,EAAWhd,KAAKyd,EAAQthE,KAAKqgE,EAASr4D,EAAO4V,KACjD,QDLsDqjD,OAAYC,OAASC,GCM/E,ECHO,SAAU1hE,GACb,GALD,SAAiBA,GACpB,OAAOo8D,GAAWp8D,aAAuC,EAASA,EAAOgiE,KAC7E,CAGYC,CAAQjiE,GACR,OAAOA,EAAOgiE,MAAK,SAAUE,GACzB,IACI,OAAOJ,EAAKI,EAAcvmD,KAC9B,CACA,MAAOyB,GACHzB,KAAK9D,MAAMuF,EACf,CACJ,IAEJ,MAAM,IAAIo/C,UAAU,yCACxB,EAbG,IAAiBsF,CDKxB,CECA,MAAMK,GAA2B,yCAEjC,SAASC,GAA0BC,GACjC,OAAKA,EAAaC,UAIXD,EAAaC,UAAUjyD,KAAKmf,IACjC,MAAM+yC,EACJ/yC,EAAGgzC,YACHhzC,EAAGgzC,WACAhxC,MAAM,MACNnhB,KAAKoyD,IACJ,MAAMhvC,EAAQgvC,EAAIhvC,MAAM0uC,IACxB,IAAK1uC,EACH,OAGF,MAAO,CAAElyB,EAAMF,EAAM+4B,GAAgB3G,EAErC,MAAO,CACLlyB,OACAF,OACA+4B,eACAsoC,gBAAiBtoC,EAClB,IAEFvsB,QAAWzJ,KAAuCA,IAEvD,MAAO,CACL7C,KAAMiuB,EAAGjuB,KACT6I,KAAMolB,EAAGplB,KACTu4D,gBAAiBJ,GAAU,GAC5B,IA7BM,EA+BX,snCCxBe,MAAMK,WAAoCC,EAAAA,sBAwBvDC,YAAAA,GAEE,OAAQnnD,KAAKonD,oBACf,CAEAC,WAAAA,CAAY3xD,OAGJA,EACCA,EACDA,EAAAA,EAJN,SACgB,IAAdA,EAAKw0C,SACqB,QAAtBx0C,EAAAA,EAAKqoB,yBAALroB,IAAAA,OAAAA,EAAAA,EAAwBoO,UACS,QAAhCpO,EAAAA,EAAKqoB,kBAAkBhW,iBAAvBrS,IAAAA,OAAAA,EAAAA,EAAkC3R,UAAY2R,EAAKqoB,kBAAkBoF,cACtD,QAAhBztB,EAAAA,EAAKsoB,mBAALtoB,IAAAA,GAA2B,QAA3BA,EAAAA,EAAkBqS,iBAAlBrS,IAAAA,OAAAA,EAAAA,EAA6B3R,QAErC,CAEMsa,gBAAAA,qBAAN,gBACE,IAAK,EAAK8oD,eACR,MAAO,GAGT,MAAMl2C,EAAO,GAAG,EAAKq2C,0CACrB,aAAa,EAAKC,YAA4Ct2C,GAAMpS,MAAM7L,GACjEF,EAAe+B,mBAAmB7B,IAE7C,GATA,GAWMw0D,aAAAA,CAAcntD,qBAApB,gBACE,MAAMotD,QAAiB,EAAKC,iBAAiBrtD,GAE7C,OACE3F,EAAAA,EAAAA,KAAI+yD,EAAS76D,OAAQ8J,IACZ,CACLnI,KAAMmI,EAAI9Q,KACVgH,MAAO8J,EAAIiG,QAET,EAEV,GAXA,GAaQ+qD,gBAAAA,CAAiBrtD,GACvB,MAAM2E,EAAiBgB,KAAKS,YAAYkV,QAAQtb,GAAgB2F,KAAK2nD,uBAE/DC,EACJ5nD,KAAKsnD,iBACL,IAAItoD,sFACN,OAAOgB,KAAKunD,YAAyCK,EACvD,CAEMC,WAAAA,CAAYpxC,qBAAlB,gBACE,MAAMxF,EAAO,GAAG,EAAK62C,kBAAkBrxC,aAGvC,aADmB,EAAK8wC,YAAYt2C,EAEtC,GALA,GAOMiT,cAAAA,CAAezN,qBAArB,gBACE,MAAMsxC,EAAkB,EAAKtnD,YAAYkV,QAAQc,EAAa,CAAC,EAAGpgB,IAElE,ODvDG,SACLqwD,EACAsB,EACAC,GAEA,MAAM5lC,EAAW,CACfz8B,KAAMoiE,EACN1lC,OAAQokC,EAAapkC,OACrBqkC,UAAWF,GAA0BC,GACrCwB,aAAc,EACdC,aAAc,EACdC,aAAc,IAmEhB,OA/DA/lC,EAASskC,UAAUtzD,KACjB,CACEzN,KAAM,gBACN6I,KAAM,WACNu4D,gBAAiB,CACf,CACEphE,KAAM,aACNF,KAAM,gBACN+4B,aAAc,KACdsoC,gBAAiB,QAIvB,CACEnhE,KAAM,cACN6I,KAAM,yCACNu4D,gBAAiB,IAEnB,CACEphE,KAAM,YACN6I,KAAM,yCACNu4D,gBAAiB,IAEnB,CACEphE,KAAM,iBACN6I,KAAM,oDACNu4D,gBAAiB,CACf,CACEphE,KAAM,SACNF,KAAM,gBACN+4B,aAAc,SACdsoC,gBAAiB,YAIvB,CACEnhE,KAAM,cACN6I,KAAM,qCACNu4D,gBAAiB,CACf,CACEphE,KAAM,UACNF,KAAM,gBACN+4B,aAAc,UACdsoC,gBAAiB,WAEnB,CACEnhE,KAAM,SACNF,KAAM,gBACN+4B,aAAc,SACdsoC,gBAAiB,aAclB,CACLsB,YAAa,SACbC,QAAS,CACPC,iBAAkBP,EAClBQ,UAAW,CAACnmC,IAEdA,SAAUA,EACVomC,uBAd6BR,EAAkBvzD,KAAKjM,IAC7C,CACL7C,KAAM,IAAI6C,EAAE7C,OACZF,KAAM,cAaZ,CChCWgjE,OADgB,EAAKb,YAAYE,GACQA,EAAiB,EAAKtnD,YAAYkoD,eACpF,GAJA,GAMAC,sBAAAA,CAAuB35D,EAA2B0mD,GAChD,IAAIjgD,EACJ,GAAIzG,EAAOgM,YAAc7D,GAAekzB,cAAgBr7B,EAAO8uB,kBAAmB,CAChFroB,EAAOzG,EAAO8uB,kBACd,MAAMhW,EAAY/H,KAAK6oD,oCAAoCnzD,EAAKqS,UAAW4tC,GAC3E,IAAIxyB,EAAYnjB,KAAKS,YAAYkV,QAAQjgB,EAAKytB,UAAWwyB,GAEpDxyB,GAAcpb,IAAa/H,KAAK8oD,iBACnC3lC,EAAYnjB,KAAK8oD,gBAGnB,MAAMhlD,EAAQ9D,KAAKS,YAAYkV,QAAQjgB,EAAKoO,MAAO6xC,EAAYt/C,IAE/D,OAAO,SACFpH,GAAAA,CACHgM,UAAWhM,EAAOgM,WAAa7D,GAAekzB,aAE9CvM,kBAAmB,CACjBa,aAAclpB,EAAKkpB,aACnB9a,QACAiE,YAEAob,YACAvD,cAAelqB,EAAKkqB,cACpBI,eAAgBtqB,EAAKsqB,eACrBF,WAAY9f,KAAKS,YAAYkV,QAAQjgB,EAAKoqB,WAAY61B,KAG5D,CAEA,GAAI1mD,EAAOgM,YAAc7D,GAAe6lD,aAAehuD,EAAO+uB,YAAa,KAItDtoB,EAoBuBzG,EAvB1CyG,EAAOzG,EAAO+uB,YACd,MAAMjW,EAAY/H,KAAK6oD,oCAAoCnzD,EAAKqS,UAAW4tC,GACrE7xC,EAAQ9D,KAAKS,YAAYkV,QAAQjgB,EAAKoO,MAAO6xC,EAAYt/C,IACzD2E,EAA4B,QAAftF,EAAAA,EAAKsF,kBAALtF,IAAAA,OAAAA,EAAAA,EAAiBhB,KAAKlM,GAAMwX,KAAKS,YAAYkV,QAAQntB,EAAGmtD,SAC1DjgD,EAAjB,MAAMuzB,GAAuB,QAAZvzB,EAAAA,EAAKuzB,eAALvzB,IAAAA,EAAAA,EAAgB,IAC9BxD,QAAQpK,KAAQA,EAAEytD,WAClB7gD,KAAK5M,QACoBA,EAAxB,MAAMihE,EAA2B,QAATjhE,EAAAA,EAAEmhC,eAAFnhC,IAAAA,OAAAA,EAAAA,EAAW4M,KAAKxC,GAAW8N,KAAKS,YAAYkV,QAAQzjB,QAAAA,EAAU,GAAIyjD,KAC1F,MAAO,CACLJ,SAAUv1C,KAAKS,YAAYkV,QAAQ7tB,EAAEytD,SAAUI,GAC/CoC,UAAWjwD,EAAEiwD,WAAa,KAC1B9uB,QAAS8/B,GAAmB,GAC7B,IAGL,OAAO,SACF95D,GAAAA,CACHgM,UAAWhM,EAAOgM,WAAa7D,GAAe6lD,YAE9Cj/B,YAAa,CACXY,aAAclpB,EAAKkpB,aACnB9a,QACAiE,YACAw0C,YAAav8C,KAAKS,YAAYkV,QAA0B,QAAlB1mB,EAAAA,EAAO+uB,mBAAP/uB,IAAAA,OAAAA,EAAAA,EAAoBstD,YAAa5G,GACvE1sB,UACAjuB,eAGN,CAEA,OAAO/L,CACT,CAEQ45D,mCAAAA,CACN9gD,EACA4tC,GAEA,IAAK5tC,EACH,OAEF,MAAMihD,EAA8B,GAQpC,OAPAjhD,EAAUxT,SAAShM,IACAyX,KAAKS,YAAYkV,QAAQptB,EAAGotD,EAAY,OACjC9/B,MAAM,KACvBthB,SAAS3H,IACdo8D,EAAkB31D,KAAKzG,EAAM,GAC7B,IAEGo8D,CACT,CAMAC,6BAAAA,GACE,OAAOjpD,KAAKkpD,iBAAiBzxD,SAAS0xD,4BACxC,CAEMC,6BAAAA,qBAAN,oBAKStuD,EAJP,OAAI,EAAK6sD,sBACA,EAAKA,sBAGS,QAAhB7sD,SADqB,EAAKuD,oBACZ,UAAdvD,IAAAA,OAAAA,EAAAA,EAAkBlO,KAC3B,GANA,GAQMy8D,iBAAAA,qBAAN,oBAWoBC,EAVlB,GAAI,EAAKR,eACP,OAAO,EAAKA,eAGd,MAAM9pD,QAAuB,EAAKoqD,gCAClC,IAAKpqD,EACH,OAGF,MACMmkB,EAAyB,QAAbmmC,SADO,EAAK9B,cAAcxoD,IACf,UAAXsqD,IAAAA,OAAAA,EAAAA,EAAe18D,MAMjC,OAJIu2B,IACF,EAAK2lC,eAAiB3lC,GAGjBA,CACT,GAlBA,GAoBQikC,kBAAAA,GAGN,GAAiB,iBAFA5vD,GAAYwI,KAAKkpD,kBAED,CAC/B,IAAKlpD,KAAKupD,mBAAmBvpD,KAAKkpD,iBAAiBzxD,SAASE,UAC1D,MAAO,CACLkgC,OAAQ,QACRl2B,QAAS,oCAIb,IAAK3B,KAAKupD,mBAAmBvpD,KAAKkpD,iBAAiBzxD,SAASG,UAC1D,MAAO,CACLigC,OAAQ,QACRl2B,QAAS,mCAGf,CAGF,CAEQ4nD,kBAAAA,CAAmB1jD,GACzB,MAAwB,iBAAVA,GAAsBA,EAAM9hB,OAAS,CACrD,CAEMokC,qCAAAA,qBAAN,gBACE,aAAa,EAAKo/B,YAAY,GAAG,EAAKO,2BACxC,GAFA,GAIMxjC,sBAAAA,CAAuBxgB,EAA0BkF,qBAAvD,oBAKkClF,EAAAA,EAJhC,MAAMrD,GAAcC,EAAAA,EAAAA,kBAEd3L,EAAO,CACXiU,MAAOA,EACPvO,SAAUgG,EAAYkV,QAA+B,QAAvB7R,EAAAA,EAAMia,yBAANja,IAAAA,GAAkC,QAAlCA,EAAAA,EAAyBiE,iBAAzBjE,IAAAA,OAAAA,EAAAA,EAAqC,IACnE7I,UAAW6I,EAAM7I,UACjB4nB,KAAMpiB,EAAYkV,QAAQ,WAC1BqO,GAAIvjB,EAAYkV,QAAQ,UAE1B,aAAa,EAAK6zC,aAAa,GAAG,EAAK1B,+BAAgC/yD,EACzE,GAXA,GA5NAjR,WAAAA,CACE,EACA,GAA4C4c,EAAAA,EAAAA,mBAE5CF,MAAM0oD,oEAZRpB,GAAAA,KAAAA,oBAAAA,GAGAH,GAAAA,KAAAA,6BAAAA,GAEAL,GAAAA,KAAAA,wBAAAA,GACAwB,GAAAA,KAAAA,sBAAAA,QAGUI,iBAAAA,OACSzoD,YAAAA,EAIjBT,KAAK8nD,aAAe,eACpB9nD,KAAKsnD,iBAAmB,GAAGlxD,kBAE3B4J,KAAK2nD,sBAAwB3nD,KAAKkpD,iBAAiBzxD,SAASuH,gBAAkB,EAChF,unCCRF,SAASyqD,GAAS/zD,GAChB,SAAUA,GAHiB,WAGTA,EACpB,CAEe,MAAMg0D,WAA+BxC,EAAAA,sBAwBlDC,YAAAA,GAEE,OAAQnnD,KAAKonD,oBACf,CAEAC,WAAAA,CAAY3xD,OAERA,EAGSA,EAAwCA,EACnBA,EAKrBA,EACAA,EAXX,MAAMi0D,GACJj0D,SAAkB,QAAlBA,EAAAA,EAAMuoB,oBAANvoB,IAAAA,OAAAA,EAAAA,EAAoBqS,YACpBrS,EAAKuoB,aAAalW,UAAUhkB,OAAS,GACrC2R,EAAKuoB,aAAalW,UAAUqV,OAAO70B,GAAMkhE,GAASlhE,EAAE+R,gBAAkBmvD,GAASlhE,EAAEktB,iBACjFg0C,IAAS/zD,SAAkB,QAAlBA,EAAAA,EAAMuoB,oBAANvoB,IAAAA,OAAAA,EAAAA,EAAoBgpD,oBAAoBhpD,SAAkB,QAAlBA,EAAAA,EAAMuoB,oBAANvoB,IAAAA,OAAAA,EAAAA,EAAoBnC,kBACjEq2D,EAAiBH,GAA0B,QAAjB/zD,EAAAA,EAAKuoB,oBAALvoB,IAAAA,OAAAA,EAAAA,EAAmB+gB,aAEnD,SACgB,IAAd/gB,EAAKw0C,OACJyf,IAAeC,IAChBH,GAAS/zD,SAAkB,QAAlBA,EAAAA,EAAMuoB,oBAANvoB,IAAAA,OAAAA,EAAAA,EAAoBhC,cAC7B+1D,GAAS/zD,SAAkB,QAAlBA,EAAAA,EAAMuoB,oBAANvoB,IAAAA,OAAAA,EAAAA,EAAoBwoB,aAEjC,CAEA0qC,sBAAAA,CAAuB35D,EAA2B0mD,OAkC9BoK,EAjClB,MAAM8J,EAAoB56D,EAAOgvB,aAEjC,IAAK4rC,EACH,MAAM,IAAItxD,MAAM,oDAIdsxD,EAAkBpzC,cACpBozC,EAAkBpzC,YAAczW,KAAKS,YAAYkV,QAAQk0C,EAAkBpzC,YAAak/B,IAEtFkU,EAAkBnL,mBACpBmL,EAAkBnL,iBAAmB1+C,KAAKS,YAAYkV,QAAQk0C,EAAkBnL,iBAAkB/I,IAIhGkU,EAAkBv4D,WAAau4D,EAAkBt4D,eAAiD,SAAhCs4D,EAAkBv4D,YACtFu4D,EAAkBv4D,UAAYs9B,EAAmBv9B,sBAC/Cw4D,EAAkBv4D,UAClBu4D,EAAkBt4D,gBAItB,MAAMu4D,EAAiBzL,GAAapvD,GAC9B8wD,EAAgB+J,EAAe7rC,aAErC,IAAK8hC,EACH,MAAM,IAAIxnD,MAAM,oDAGlB,MAAMyG,EAAiBgB,KAAKS,YAAYkV,QACtCm0C,EAAezvD,cAAgB2F,KAAK2nD,sBACpChS,GAEI5tC,EAAmC,QAAvBg4C,EAAAA,EAAch4C,iBAAdg4C,IAAAA,OAAAA,EAAAA,EAAyBrrD,KAAKnM,GAAMyX,KAAK+pD,yBAAyBxhE,EAAGotD,KAAalpB,OAC9Fl5B,EAAkByM,KAAKS,YAAYkV,QAAQoqC,EAAcxsD,gBAAiBoiD,GAC1Eh/B,EAAkB3W,KAAKS,YAAYkV,QAAQoqC,EAAcppC,gBAAiBg/B,GAC1ErkD,EAAY0O,KAAKS,YAAYkV,SAASoqC,EAAczuD,WAAa,IAAI5M,WAAYixD,GACjFz3B,EAAcle,KAAKS,YAAYkV,QAAQoqC,EAAc7hC,YAAay3B,GAClE7mB,EAAM9uB,KAAKS,YAAYkV,QAAQoqC,EAAcjxB,KAAO,GAAI6mB,OAEpCoK,EAA1B,MAAM5hC,GAAkD,QAA9B4hC,EAAAA,EAAc5hC,wBAAd4hC,IAAAA,EAAAA,EAAkC,IACzD7tD,QAAQpK,GAAMA,EAAE6M,WAA6B,SAAhB7M,EAAE6M,YAC/BD,KAAK5M,QACYA,EAAhB,MAAMmhC,EAAmB,QAATnhC,EAAAA,EAAEmhC,eAAFnhC,IAAAA,OAAAA,EAAAA,EAAW4M,KAAKxC,GAAW8N,KAAKS,YAAYkV,QAAQzjB,QAAAA,EAAU,GAAIyjD,KAClF,MAAO,CACLhhD,UAAWqL,KAAKS,YAAYkV,QAAQ7tB,EAAE6M,UAAWghD,GACjD9nB,SAAU/lC,EAAE+lC,UAAY,KACxB5E,QAASA,GAAW,GACrB,IAGC+gC,EAAmC,SACpCjK,GAAAA,CACHh4C,YACAxU,kBACAojB,kBACArlB,YACA8+B,oBAAqB2vB,EAAc3vB,oBACnC18B,WAAYsM,KAAKS,YAAYkV,QAAQoqC,EAAcrsD,WAAYiiD,GAC/Dn7C,OAAQwF,KAAKS,YAAYkV,QAAQoqC,EAAcvlD,OAAQm7C,GACvDz3B,YAAaA,EACbC,mBACA2Q,IAAKA,GAAO,KACZjI,MAAOk5B,EAAcl5B,QAGvB,OAAO,SACF53B,GAAAA,CACHoL,aAAc2E,EACd/D,UAAW7D,GAAe+mD,aAC1BlgC,aAAc+rC,GAElB,CAEM3rD,gBAAAA,qBAAN,gBACE,OAAK,EAAK8oD,eAIH,EAAKI,YACV,GAAG,EAAKO,qDACRjpD,MAAM7L,GACCF,EAAe+B,mBAAmB7B,KANlC,EAQX,GAVA,GAYAi3D,iBAAAA,CAAkBjrD,GAChB,OAAOgB,KAAKunD,YACV,GAAGvnD,KAAK8nD,8BAA8B9oD,gCAA6CgB,KAAKkqD,iCACxFrrD,MAAM7L,GACCF,EAAeC,oBAAmCC,EAAQ,OAAQ,SAE7E,CAEMm3D,gBAAAA,CAAiBrmD,EAAmCsmD,qBAA1D,gBACE,MAAMC,EAAW,EAAKN,yBAAyBjmD,GAAOpP,KACpD,EAAGnB,kBAAiByL,iBAAgB1E,gBAAeE,aACjD,MAAM8vD,GAAuBp0C,EAAAA,EAAAA,YAAW3iB,aAAAA,EAAAA,EAAiB4C,cAAe,sCACpE,oCACA5C,EACJ,IAAI+N,EAAM,GAAG,EAAKwmD,8BAA8B9oD,IAC5C1E,IACFgH,GAAO,mBAAmBhH,KAE5BgH,GAAO,0BAA0B,EAAK4oD,gCACtC,MAAMjhC,EAAoB,GAa1B,OAZIqhC,GACFrhC,EAAQ51B,KAAK,oBAAoBi3D,MAE/B9vD,GACFyuB,EAAQ51B,KAAK,gBAAgBmH,MAE3ByuB,EAAQllC,OAAS,IACnBud,GAAO,YAAY2nB,EAAQtyB,KAAK,YAE9ByzD,IACF9oD,GAAO,eAAe8oD,KAEjB,EAAK7C,YAAYjmD,GAAKzC,KAAK,+BAAO7L,GACvC,IAAIG,EAA+C,GACnD,IAAI+iB,EAAAA,EAAAA,YAAW3iB,aAAAA,EAAAA,EAAiB4C,cAAe,sCAAuC,CACpFhD,EAAOL,EAAeQ,mBAAmBN,EAAQ,qCACjD,IAAK,IAAIhP,EAAI,EAAGA,EAAImP,EAAKpP,OAAQC,IAC/BmP,EAAKnP,GAAGuK,MAAQ,WAChB4E,EAAKnP,GAAG4I,OAAS,UAErB,MACEuG,EAAOL,EAAeQ,mBAAmBN,EAAQO,GAGnD,GAAIP,EAAOu3D,SAAU,CAEnB,MACMC,EADU,IAAIC,IAAIz3D,EAAOu3D,UACLG,aAAal+D,IAAI,cAC3C,IAAKg+D,EACH,MAAMjyD,MAAM,gDAEd,MAAMoyD,QAAiB,EAAKR,iBAAiB,CAAE52D,kBAAiByL,iBAAgB1E,iBAAiBkwD,GACjGr3D,EAAOA,EAAK9L,OAAOsjE,EACrB,CAEA,OAAOx3D,CACT,oBAxByCH,mCAAP,OA2BtC,aAAc4O,QAAQgpD,IAAIP,IAAW59B,MACvC,GApDA,GAsDA6D,mBAAAA,CAAoBxsB,EAAiC0S,EAAuBhc,GAC1E,MAAM8G,EAAM+T,GAAWgB,wCACrBrW,KAAK8nD,aACL9nD,KAAK6qD,kBAEL7qD,KAAK8qD,+BAA+BhnD,GACpC0S,EACAxW,KAAKS,YACLjG,GAEF,OAAOwF,KAAKunD,YAAYjmD,GACrBzC,MAAM7L,GACEF,EAAeC,oBACpBC,EACA,iCACA,oCAGH6L,MAAM7L,IACL,GAAIsO,EAAInL,cAAc3E,SAAS,qCAAsC,CACnE,MAAMu5D,EAAoB,CACxB,oCACA,iDACA,iDACA,kDACA,mDAEF,IAAK,MAAMxwD,KAAawwD,GACjB33D,EAAAA,EAAAA,MAAKJ,EAAQ,CAAC,QAASuH,EAAUpE,iBACpCnD,EAAOK,KAAK,CAAEzG,MAAO2N,EAAWhM,KAAMgM,GAG5C,CACA,OAAOvH,CAAM,IAEd2U,OAAOqjD,IACN3pC,QAAQnlB,MAAM,oCAAoC8uD,KAC3C,KAEb,CAEAx6B,cAAAA,CAAe1sB,EAA4ByR,EAA6B/a,GACtE,MAAM+b,EAAahB,EAAoBvV,KAAK6qD,kBAAoB7qD,KAAKuW,WAC/DjV,EAAM+T,GAAWqB,mCACrB1W,KAAK8nD,aACLvxC,EAEAvW,KAAK8qD,+BAA+BhnD,GACpC9D,KAAKS,YACL8U,EACA/a,GAEF,OAAOwF,KAAKunD,YAAYjmD,GAAKzC,MAAM7L,GAC1BF,EAAeC,oBAAoBC,EAAQ,sBAAuB,eAE7E,CAEA+8B,iBAAAA,CAAkBjsB,EAA+ByR,EAA6B/a,GAC5E,MAAM,WAAE9G,GAAeoQ,EACjByS,EAAahB,EAAoBvV,KAAK6qD,kBAAoB7qD,KAAKuW,WAC/DjV,EAAM+T,GAAWqB,mCACrB1W,KAAK8nD,aACLvxC,EAEAvW,KAAK8qD,+BAA+BhnD,GACpC9D,KAAKS,YACL8U,EACA/a,GAEF,OAAOwF,KAAKunD,YAAYjmD,GAAKzC,MAAM7L,GAC1BF,EAAeW,cAAcT,EAAQgN,KAAKS,YAAYkV,QAAQjiB,KAEzE,CAEQ0zD,kBAAAA,GAGN,GAAiB,iBAFA5vD,GAAYwI,KAAKkpD,kBAED,CAC/B,IAAKlpD,KAAKupD,mBAAmBvpD,KAAKkpD,iBAAiBzxD,SAASE,UAC1D,MAAO,CACLkgC,OAAQ,QACRl2B,QAAS,oCAIb,IAAK3B,KAAKupD,mBAAmBvpD,KAAKkpD,iBAAiBzxD,SAASG,UAC1D,MAAO,CACLigC,OAAQ,QACRl2B,QAAS,mCAGf,CAGF,CAEQ4nD,kBAAAA,CAAmB1jD,GACzB,MAAwB,iBAAVA,GAAsBA,EAAM9hB,OAAS,CACrD,CAEQ+mE,8BAAAA,CAAqEhnD,EAAU6xC,GAQrF,OAAO31C,KAAK+pD,yBAAyBjmD,EAAO6xC,GAAY,EAC1D,CAEQoU,wBAAAA,CAA+DjmD,EAAU6xC,GAC/E,MAAMsV,EAAoD,CAAC,MAAKnnD,IAuBhE,OAtBatf,OAAOP,KAAK6f,GACpBvP,SAAS1P,IACZ,MAAMqmE,EAAWlrD,KAAKS,YAAYkV,QAAQs1C,EAAe,GAAGpmE,GAAM8wD,EAAY,OAC9E,GAAIuV,EAAS15D,SAAS,KAAM,CAC1B,MAAM25D,EAAWD,EAASr1C,MAAM,KAC1Bu1C,EAAiB,IAAIH,GAC3BE,EAAS52D,SAAQ,CAAC3H,EAAO5I,KACvBonE,EAAe72D,SAASjM,IACZ,IAANtE,EACFsE,EAAEzD,GAAO+H,EAETq+D,EAAe53D,KAAK,SAAK/K,GAAAA,CAAG,CAACzD,GAAM+H,IACrC,GACA,GAEN,MACEq+D,EAAe12D,SAASjM,IACtBA,EAAEzD,GAAOqmE,CAAQ,GAErB,IAGKD,CACT,CAEMI,WAAAA,CAAYC,qBAAlB,gBACE,aAAa,EAAK/D,YAChB,GAAGnxD,eAAqCk1D,iBAA4B,EAAKC,qBAE7E,GAJA,GAMMC,YAAAA,CAAa1wD,qBAAnB,gBACE,MAAM2wD,EAAc,IAAI39C,IACxB,IAAK,MAAMzT,KAAgBS,EAAe,CACxC,MAAM4wD,EAAe54D,EAAekC,qBAC5B,EAAKuyD,YACT,GAAGnxD,mBAAyC,EAAKqK,YAAYkV,QAAQtb,4BACnE,EAAKsxD,wBAIX,IAAK,MAAMz2D,KAAYw2D,EACrBD,EAAYl2D,IAAIL,EAAStP,KAAMsP,EAEnC,CAEA,OAAOu2D,CACT,GAhBA,GAtUA3nE,WAAAA,CACE,EACA,GAA4C4c,EAAAA,EAAAA,mBAE5CF,MAAM0oD,oEAfR3yC,GAAAA,KAAAA,kBAAAA,GACAs0C,GAAAA,KAAAA,yBAAAA,GACAX,GAAAA,KAAAA,qCAAAA,GACAqB,GAAAA,KAAAA,0BAAAA,GACAI,GAAAA,KAAAA,2BAAAA,GACAhE,GAAAA,KAAAA,6BAAAA,GACAxpD,GAAAA,KAAAA,wBAAAA,GACA2pD,GAAAA,KAAAA,oBAAAA,QAKUoB,iBAAAA,OACSzoD,YAAAA,OAbnB8V,WAAa,kBACbs0C,kBAAoB,0BACpBX,8BAAgC,kBAChCqB,mBAAqB,kBACrBI,oBAAsB,aAapB3rD,KAAK2nD,sBAAwBuB,EAAiBzxD,SAASuH,eACvDgB,KAAK7B,iBAAmB+qD,EAAiBzxD,SAAS0G,iBAElD6B,KAAK8nD,aAAe1xD,CACtB,2HCpDa,MAAMw1D,WAAqC1E,EAAAA,sBAIxDG,WAAAA,CAAY3xD,OACDA,EAAT,SAAgC,QAAvBA,EAAAA,EAAKuO,0BAALvO,IAAAA,OAAAA,EAAAA,EAAyBoO,UAAWpO,EAAKoF,eAAiBpF,EAAKoF,cAAc/W,OAAS,CACjG,CAEA6kE,sBAAAA,CAAuB35D,EAA2B0mD,GAChD,MAAMkW,GAAKnrD,EAAAA,EAAAA,kBACLhL,EAAOzG,EAAOgV,mBACpB,IAAKvO,EACH,OAAOzG,EAET,MAAM68D,EAAgBD,EAAGlD,eAAej0D,KAAKjM,GAAM,IAAIA,EAAE7C,SACnDmmE,EAAkBC,IAAAA,KAAO/8D,EAAO6L,eAAgByM,GAAQykD,IAAAA,SAAWF,EAAevkD,KAKlFzM,EAAgB,IAJY+wD,EAC/Bl2C,QAAQo2C,EAAiBpW,GAAaltD,GAAyBA,IAC/DotB,MAAM,KACN3jB,QAAQzJ,GAAMA,EAAE1E,OAAS,OAGvBioE,IAAAA,OAAS/8D,EAAO6L,eAAgByM,IAASykD,IAAAA,SAAWF,EAAevkD,MAElEzD,EAAQ+nD,EAAGl2C,QAAQjgB,EAAKoO,MAAO6xC,EAAYt/C,IAEjD,sXAAO,4UACFpH,GAAAA,CACHgM,UAAW7D,GAAegnD,mBAC1BtjD,gBACAmJ,mBAAoB,CAClB2a,aAAc,QACd9a,UAGN,qwBCjBF,MAEMmoD,GCM2B,CAC/B,+BACA,kCACA,2BACA,qCACA,qCACA,kCACA,oCACA,iDACA,+BACA,6CACA,0CACA,mDACA,oDACA,qDACA,8BACA,gDACA,4CACA,iCACA,4DACA,gCACA,+BACA,yCACA,oCACA,mCACA,wBACA,kCACA,4CACA,kDACA,yBACA,mCACA,8BACA,uCACA,2CACA,iDACA,2CACA,4CACA,uCACA,gDACA,yCACA,0BACA,oCACA,4CACA,0CACA,2CACA,sCACA,kDACA,wCACA,8CACA,8CACA,yCACA,oCACA,6CACA,kCACA,8CACA,2CACA,8BACA,2CACA,kCACA,yCACA,sCACA,kCACA,uCACA,mCACA,wCACA,+BACA,iCACA,uCACA,+BACA,4CACA,2CACA,oCACA,sCACA,oDACA,oDACA,4CACA,+CACA,6CACA,iCACA,+CACA,4BACA,yCACA,uCACA,+CACA,yCACA,wCACA,qCACA,8BACA,iCACA,wCACA,oCACA,mCACA,6BACA,8BACA,gCACA,iDACA,yCACA,qDACA,+BACA,oCACA,oDACA,mDACA,oDACA,8CACA,uCACA,gCACA,yCACA,yBACA,+BACA,iCACA,4BACA,yCACA,2BACA,sCACA,sCACA,iDACA,4BACA,+CACA,+CACA,+DACA,gDACA,gCACA,2CACA,mDACA,iCACA,6BACA,gDACA,wDACA,wCACA,mCACA,iCACA,gCACA,wCACA,6BACA,yCACA,yCACA,sCACA,+BACA,kCACA,gCACA,sCACA,oCACA,8CACA,0CACA,8CACA,uDACA,6CACA,oCACA,uDACA,mCACA,qCACA,wCACA,sCACA,qCACA,2CACA,2CACA,oCACA,gCACA,0CACA,2CACA,yCACA,kCACA,2CACA,mDACA,wCACA,yDACA,6CACA,2CACA,2CACA,oCACA,2BACA,4BACA,uCACA,wCACA,8CACA,6BACA,oCACA,6BACA,oCACA,mDACA,kCACA,yCACA,gDACA,sCACA,kCACA,iDACA,mCACA,4CACA,qCACA,8CACA,iCACA,iCACA,2CACA,kCACA,qCACA,oCACA,iDACA,iDACA,kDACA,kDACA,wCACA,gCACA,uCACA,4CACA,0CACA,+BACA,4CACA,0CACA,0CACA,wCACA,4CACA,yDACA,kCACA,8CACA,oCACA,gDACA,4BACA,sBACA,4BACA,4BACA,2CDlOwDv3D,KAAKjM,GAAM,IAAIA,OAAMkO,KAAK,KAIrE,MAAMu1D,WAA2BhF,EAAAA,sBAexC1rC,gBAAAA,CACJ91B,EACAymE,qBAFF,gBAIE,MAAMrxD,QAAsB,EAAKuD,mBAEjC,IAAK8tD,EACH,OAAOrxD,EAGT,IAAIiN,EAAYjN,EAChB,MAAMuvD,EAAW8B,EAAiBz3D,KAAK82B,GAAc,gBACnD,GAAIA,EAAUnxB,aAAc,CAC1B,MAAM+xD,EAAmB,kBAAkB5gC,EAAUnxB,+BAA+BmxB,EAAUlxB,gBAE9F,GAAIkxB,EAAUlxB,gBAAkBge,GAAQvQ,EAAWqkD,GAAmB,CACpE,MAAMC,QAAuB,EAAKC,kCAAkC9gC,EAAUnxB,aAAc3U,GAC5FqiB,EAA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","sources":["webpack://grafana-azure-monitor-datasource/../../../../../node_modules/fast-deep-equal/index.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/hoist-non-react-statics/dist/hoist-non-react-statics.cjs.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/hoist-non-react-statics/node_modules/react-is/cjs/react-is.production.min.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/hoist-non-react-statics/node_modules/react-is/index.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/react/cjs/react-jsx-runtime.production.min.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/react/jsx-runtime.js","webpack://grafana-azure-monitor-datasource/external amd \"@emotion/css\"","webpack://grafana-azure-monitor-datasource/external amd \"@grafana/data\"","webpack://grafana-azure-monitor-datasource/external amd \"@grafana/runtime\"","webpack://grafana-azure-monitor-datasource/external amd \"@grafana/ui\"","webpack://grafana-azure-monitor-datasource/external amd \"@kusto/monaco-kusto\"","webpack://grafana-azure-monitor-datasource/external amd \"lodash\"","webpack://grafana-azure-monitor-datasource/external amd \"prismjs\"","webpack://grafana-azure-monitor-datasource/external amd \"react\"","webpack://grafana-azure-monitor-datasource/external amd \"rxjs\"","webpack://grafana-azure-monitor-datasource/webpack/bootstrap","webpack://grafana-azure-monitor-datasource/webpack/runtime/compat get default export","webpack://grafana-azure-monitor-datasource/webpack/runtime/define property getters","webpack://grafana-azure-monitor-datasource/webpack/runtime/hasOwnProperty shorthand","webpack://grafana-azure-monitor-datasource/webpack/runtime/make namespace object","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/DataSourceDescription.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/GenericConfigSection.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/ConfigEditor/ConfigSection/ConfigSection.js","webpack://grafana-azure-monitor-datasource/./time_grain_converter.ts","webpack://grafana-azure-monitor-datasource/./azure_monitor/response_parser.ts","webpack://grafana-azure-monitor-datasource/./utils/common.ts","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/react-use/esm/useEffectOnce.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/azure-sdk/dist/esm/clouds.js","webpack://grafana-azure-monitor-datasource/./dataquery.gen.ts","webpack://grafana-azure-monitor-datasource/./types/types.ts","webpack://grafana-azure-monitor-datasource/./credentials.ts","webpack://grafana-azure-monitor-datasource/./e2e/selectors.ts","webpack://grafana-azure-monitor-datasource/./components/ConfigEditor/AppRegistrationCredentials.tsx","webpack://grafana-azure-monitor-datasource/./components/ConfigEditor/CurrentUserFallbackCredentials.tsx","webpack://grafana-azure-monitor-datasource/./components/ConfigEditor/AzureCredentialsForm.tsx","webpack://grafana-azure-monitor-datasource/./components/ConfigEditor/BasicLogsToggle.tsx","webpack://grafana-azure-monitor-datasource/./components/ConfigEditor/DefaultSubscription.tsx","webpack://grafana-azure-monitor-datasource/./components/ConfigEditor/MonitorConfig.tsx","webpack://grafana-azure-monitor-datasource/./components/ConfigEditor/ConfigEditor.tsx","webpack://grafana-azure-monitor-datasource/./utils/messageFromError.ts","webpack://grafana-azure-monitor-datasource/./utils/useLastError.ts","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/Stack.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorRows.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorRow.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorFieldGroup.js","webpack://grafana-azure-monitor-datasource/./components/ArgQueryEditor/QueryField.tsx","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/Space.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorField.js","webpack://grafana-azure-monitor-datasource/./components/shared/Field.tsx","webpack://grafana-azure-monitor-datasource/./components/ArgQueryEditor/SubscriptionField.tsx","webpack://grafana-azure-monitor-datasource/./components/ArgQueryEditor/ArgQueryEditor.tsx","webpack://grafana-azure-monitor-datasource/./components/ResourcePicker/AdvancedMulti.tsx","webpack://grafana-azure-monitor-datasource/./components/ResourcePicker/types.ts","webpack://grafana-azure-monitor-datasource/./components/ResourcePicker/EntryIcon.tsx","webpack://grafana-azure-monitor-datasource/./components/ResourcePicker/styles.ts","webpack://grafana-azure-monitor-datasource/./components/ResourcePicker/NestedEntry.tsx","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/immer/dist/immer.mjs","webpack://grafana-azure-monitor-datasource/./azure_monitor/url_builder.ts","webpack://grafana-azure-monitor-datasource/./components/ResourcePicker/utils.ts","webpack://grafana-azure-monitor-datasource/./components/ResourcePicker/NestedRow.tsx","webpack://grafana-azure-monitor-datasource/./components/ResourcePicker/Search.tsx","webpack://grafana-azure-monitor-datasource/./components/ResourcePicker/ResourcePicker.tsx","webpack://grafana-azure-monitor-datasource/./components/ResourceField/ResourceField.tsx","webpack://grafana-azure-monitor-datasource/./components/shared/FormatAsField.tsx","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/AccessoryButton.js","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/AdvancedResourcePicker.tsx","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/setQueryValue.ts","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/LogsManagement.tsx","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/QueryField.tsx","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/TimeManagement.tsx","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/useMigrations.ts","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/utils.ts","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/LogsQueryEditor.tsx","webpack://grafana-azure-monitor-datasource/../../../../../packages/grafana-ui/src/themes/ThemeContext.tsx","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/RawQuery.tsx","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/syntax.ts","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/AzureCheatSheet.tsx","webpack://grafana-azure-monitor-datasource/./components/LogsQueryEditor/AzureCheatSheetModal.tsx","webpack://grafana-azure-monitor-datasource/./azureMetadata/resourceTypes.ts","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/AdvancedResourcePicker.tsx","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/setQueryValue.ts","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/AggregationField.tsx","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorList.js","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/DimensionFields.tsx","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/LegendFormatField.tsx","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/MetricNameField.tsx","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/MetricNamespaceField.tsx","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/TimeGrainField.tsx","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/TopField.tsx","webpack://grafana-azure-monitor-datasource/./utils/useAsyncState.ts","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/dataHooks.ts","webpack://grafana-azure-monitor-datasource/./components/MetricsQueryEditor/MetricsQueryEditor.tsx","webpack://grafana-azure-monitor-datasource/../../../../../packages/grafana-e2e-selectors/src/selectors/components.ts","webpack://grafana-azure-monitor-datasource/../../../../../packages/grafana-e2e-selectors/src/selectors/index.ts","webpack://grafana-azure-monitor-datasource/../../../../../packages/grafana-e2e-selectors/src/selectors/pages.ts","webpack://grafana-azure-monitor-datasource/./components/TracesQueryEditor/Filter.tsx","webpack://grafana-azure-monitor-datasource/./components/TracesQueryEditor/consts.ts","webpack://grafana-azure-monitor-datasource/./components/TracesQueryEditor/setQueryValue.ts","webpack://grafana-azure-monitor-datasource/./components/TracesQueryEditor/Filters.tsx","webpack://grafana-azure-monitor-datasource/./components/TracesQueryEditor/TraceTypeField.tsx","webpack://grafana-azure-monitor-datasource/./components/TracesQueryEditor/TracesQueryEditor.tsx","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/react-use/esm/usePrevious.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/EditorHeader.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/@grafana/experimental/dist/esm/QueryEditor/InlineSelect.js","webpack://grafana-azure-monitor-datasource/./components/QueryEditor/QueryHeader.tsx","webpack://grafana-azure-monitor-datasource/./utils/migrateQuery.ts","webpack://grafana-azure-monitor-datasource/./components/QueryEditor/usePreparedQuery.ts","webpack://grafana-azure-monitor-datasource/./components/QueryEditor/QueryEditor.tsx","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/util/isFunction.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/tslib/tslib.es6.mjs","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/util/arrRemove.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/Subscription.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/config.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/util/noop.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/NotificationFactories.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/util/errorContext.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/Subscriber.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/operators/map.js","webpack://grafana-azure-monitor-datasource/../../../../../node_modules/rxjs/dist/esm5/internal/util/lift.js","webpack://grafana-azure-monitor-datasource/./azure_log_analytics/utils.ts","webpack://grafana-azure-monitor-datasource/./azure_log_analytics/azure_log_analytics_datasource.ts","webpack://grafana-azure-monitor-datasource/./azure_monitor/azure_monitor_datasource.ts","webpack://grafana-azure-monitor-datasource/./azure_resource_graph/azure_resource_graph_datasource.ts","webpack://grafana-azure-monitor-datasource/./resourcePicker/resourcePickerData.ts","webpack://grafana-azure-monitor-datasource/./azureMetadata/logsResourceTypes.ts","webpack://grafana-azure-monitor-datasource/./utils/migrateAnnotation.ts","webpack://grafana-azure-monitor-datasource/./grafanaTemplateVariableFns.ts","webpack://grafana-azure-monitor-datasource/./components/VariableEditor/GrafanaTemplateVariableFn.tsx","webpack://grafana-azure-monitor-datasource/./components/VariableEditor/VariableEditor.tsx","webpack://grafana-azure-monitor-datasource/./variables.ts","webpack://grafana-azure-monitor-datasource/./datasource.ts","webpack://grafana-azure-monitor-datasource/./module.ts","webpack://grafana-azure-monitor-datasource/./tracking.ts"],"sourcesContent":["'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","'use strict';\n\nvar reactIs = require('react-is');\n\n/**\n * Copyright 2015, Yahoo! Inc.\n * Copyrights licensed under the New BSD License. See the accompanying LICENSE file for terms.\n */\nvar REACT_STATICS = {\n  childContextTypes: true,\n  contextType: true,\n  contextTypes: true,\n  defaultProps: true,\n  displayName: true,\n  getDefaultProps: true,\n  getDerivedStateFromError: true,\n  getDerivedStateFromProps: true,\n  mixins: true,\n  propTypes: true,\n  type: true\n};\nvar KNOWN_STATICS = {\n  name: true,\n  length: true,\n  prototype: true,\n  caller: true,\n  callee: true,\n  arguments: true,\n  arity: true\n};\nvar FORWARD_REF_STATICS = {\n  '$$typeof': true,\n  render: true,\n  defaultProps: true,\n  displayName: true,\n  propTypes: true\n};\nvar MEMO_STATICS = {\n  '$$typeof': true,\n  compare: true,\n  defaultProps: true,\n  displayName: true,\n  propTypes: true,\n  type: true\n};\nvar TYPE_STATICS = {};\nTYPE_STATICS[reactIs.ForwardRef] = FORWARD_REF_STATICS;\nTYPE_STATICS[reactIs.Memo] = MEMO_STATICS;\n\nfunction getStatics(component) {\n  // React v16.11 and below\n  if (reactIs.isMemo(component)) {\n    return MEMO_STATICS;\n  } // React v16.12 and above\n\n\n  return TYPE_STATICS[component['$$typeof']] || REACT_STATICS;\n}\n\nvar defineProperty = Object.defineProperty;\nvar getOwnPropertyNames = Object.getOwnPropertyNames;\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar getPrototypeOf = Object.getPrototypeOf;\nvar objectPrototype = Object.prototype;\nfunction hoistNonReactStatics(targetComponent, sourceComponent, blacklist) {\n  if (typeof sourceComponent !== 'string') {\n    // don't hoist over string (html) components\n    if (objectPrototype) {\n      var inheritedComponent = getPrototypeOf(sourceComponent);\n\n      if (inheritedComponent && inheritedComponent !== objectPrototype) {\n        hoistNonReactStatics(targetComponent, inheritedComponent, blacklist);\n      }\n    }\n\n    var keys = getOwnPropertyNames(sourceComponent);\n\n    if (getOwnPropertySymbols) {\n      keys = keys.concat(getOwnPropertySymbols(sourceComponent));\n    }\n\n    var targetStatics = getStatics(targetComponent);\n    var sourceStatics = getStatics(sourceComponent);\n\n    for (var i = 0; i < keys.length; ++i) {\n      var key = keys[i];\n\n      if (!KNOWN_STATICS[key] && !(blacklist && blacklist[key]) && !(sourceStatics && sourceStatics[key]) && !(targetStatics && targetStatics[key])) {\n        var descriptor = getOwnPropertyDescriptor(sourceComponent, key);\n\n        try {\n          // Avoid failures from read-only properties\n          defineProperty(targetComponent, key, descriptor);\n        } catch (e) {}\n      }\n    }\n  }\n\n  return targetComponent;\n}\n\nmodule.exports = hoistNonReactStatics;\n","/** @license React v16.13.1\n * react-is.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';var b=\"function\"===typeof Symbol&&Symbol.for,c=b?Symbol.for(\"react.element\"):60103,d=b?Symbol.for(\"react.portal\"):60106,e=b?Symbol.for(\"react.fragment\"):60107,f=b?Symbol.for(\"react.strict_mode\"):60108,g=b?Symbol.for(\"react.profiler\"):60114,h=b?Symbol.for(\"react.provider\"):60109,k=b?Symbol.for(\"react.context\"):60110,l=b?Symbol.for(\"react.async_mode\"):60111,m=b?Symbol.for(\"react.concurrent_mode\"):60111,n=b?Symbol.for(\"react.forward_ref\"):60112,p=b?Symbol.for(\"react.suspense\"):60113,q=b?\nSymbol.for(\"react.suspense_list\"):60120,r=b?Symbol.for(\"react.memo\"):60115,t=b?Symbol.for(\"react.lazy\"):60116,v=b?Symbol.for(\"react.block\"):60121,w=b?Symbol.for(\"react.fundamental\"):60117,x=b?Symbol.for(\"react.responder\"):60118,y=b?Symbol.for(\"react.scope\"):60119;\nfunction z(a){if(\"object\"===typeof a&&null!==a){var u=a.$$typeof;switch(u){case c:switch(a=a.type,a){case l:case m:case e:case g:case f:case p:return a;default:switch(a=a&&a.$$typeof,a){case k:case n:case t:case r:case h:return a;default:return u}}case d:return u}}}function A(a){return z(a)===m}exports.AsyncMode=l;exports.ConcurrentMode=m;exports.ContextConsumer=k;exports.ContextProvider=h;exports.Element=c;exports.ForwardRef=n;exports.Fragment=e;exports.Lazy=t;exports.Memo=r;exports.Portal=d;\nexports.Profiler=g;exports.StrictMode=f;exports.Suspense=p;exports.isAsyncMode=function(a){return A(a)||z(a)===l};exports.isConcurrentMode=A;exports.isContextConsumer=function(a){return z(a)===k};exports.isContextProvider=function(a){return z(a)===h};exports.isElement=function(a){return\"object\"===typeof a&&null!==a&&a.$$typeof===c};exports.isForwardRef=function(a){return z(a)===n};exports.isFragment=function(a){return z(a)===e};exports.isLazy=function(a){return z(a)===t};\nexports.isMemo=function(a){return z(a)===r};exports.isPortal=function(a){return z(a)===d};exports.isProfiler=function(a){return z(a)===g};exports.isStrictMode=function(a){return z(a)===f};exports.isSuspense=function(a){return z(a)===p};\nexports.isValidElementType=function(a){return\"string\"===typeof a||\"function\"===typeof a||a===e||a===m||a===g||a===f||a===p||a===q||\"object\"===typeof a&&null!==a&&(a.$$typeof===t||a.$$typeof===r||a.$$typeof===h||a.$$typeof===k||a.$$typeof===n||a.$$typeof===w||a.$$typeof===x||a.$$typeof===y||a.$$typeof===v)};exports.typeOf=z;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-is.production.min.js');\n} else {\n  module.exports = require('./cjs/react-is.development.js');\n}\n","/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var f=require(\"react\"),k=Symbol.for(\"react.element\"),l=Symbol.for(\"react.fragment\"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};\nfunction q(c,a,g){var b,d={},e=null,h=null;void 0!==g&&(e=\"\"+g);void 0!==a.key&&(e=\"\"+a.key);void 0!==a.ref&&(h=a.ref);for(b in a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps,a)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l;exports.jsx=q;exports.jsxs=q;\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('./cjs/react-jsx-runtime.production.min.js');\n} else {\n  module.exports = require('./cjs/react-jsx-runtime.development.js');\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__89__;","module.exports = __WEBPACK_EXTERNAL_MODULE__781__;","module.exports = __WEBPACK_EXTERNAL_MODULE__531__;","module.exports = __WEBPACK_EXTERNAL_MODULE__7__;","module.exports = __WEBPACK_EXTERNAL_MODULE__831__;","module.exports = __WEBPACK_EXTERNAL_MODULE__241__;","module.exports = __WEBPACK_EXTERNAL_MODULE__146__;","module.exports = __WEBPACK_EXTERNAL_MODULE__959__;","module.exports = __WEBPACK_EXTERNAL_MODULE__269__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import React from 'react';\nimport { css, cx } from '@emotion/css';\nimport { useTheme2 } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst DataSourceDescription = ({ dataSourceName, docsLink, hasRequiredFields = true, className }) => {\n  const theme = useTheme2();\n  const styles = {\n    container: css({\n      p: {\n        margin: 0\n      },\n      \"p + p\": {\n        marginTop: theme.spacing(2)\n      }\n    }),\n    text: css(__spreadProps(__spreadValues({}, theme.typography.body), {\n      color: theme.colors.text.secondary,\n      a: css({\n        color: theme.colors.text.link,\n        textDecoration: \"underline\",\n        \"&:hover\": {\n          textDecoration: \"none\"\n        }\n      })\n    }))\n  };\n  return /* @__PURE__ */ React.createElement(\"div\", { className: cx(styles.container, className) }, /* @__PURE__ */ React.createElement(\"p\", { className: styles.text }, \"Before you can use the \", dataSourceName, \" data source, you must configure it below or in the config file. For detailed instructions,\", \" \", /* @__PURE__ */ React.createElement(\"a\", { href: docsLink, target: \"_blank\", rel: \"noreferrer\" }, \"view the documentation\"), \".\"), hasRequiredFields && /* @__PURE__ */ React.createElement(\"p\", { className: styles.text }, /* @__PURE__ */ React.createElement(\"i\", null, \"Fields marked with * are required\")));\n};\n\nexport { DataSourceDescription };\n//# sourceMappingURL=DataSourceDescription.js.map\n","import React, { useState } from 'react';\nimport { css } from '@emotion/css';\nimport { useTheme2, IconButton } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nconst GenericConfigSection = ({\n  children,\n  title,\n  description,\n  isCollapsible = false,\n  isInitiallyOpen = true,\n  kind = \"section\",\n  className\n}) => {\n  const { colors, typography, spacing } = useTheme2();\n  const [isOpen, setIsOpen] = useState(isCollapsible ? isInitiallyOpen : true);\n  const iconName = isOpen ? \"angle-up\" : \"angle-down\";\n  const isSubSection = kind === \"sub-section\";\n  const collapsibleButtonAriaLabel = `${isOpen ? \"Collapse\" : \"Expand\"} section ${title}`;\n  const styles = {\n    header: css({\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      alignItems: \"center\"\n    }),\n    title: css({\n      margin: 0\n    }),\n    subtitle: css({\n      margin: 0,\n      fontWeight: typography.fontWeightRegular\n    }),\n    descriptionText: css(__spreadProps(__spreadValues({\n      marginTop: spacing(isSubSection ? 0.25 : 0.5),\n      marginBottom: 0\n    }, typography.bodySmall), {\n      color: colors.text.secondary\n    })),\n    content: css({\n      marginTop: spacing(2)\n    })\n  };\n  return /* @__PURE__ */ React.createElement(\"div\", { className }, /* @__PURE__ */ React.createElement(\"div\", { className: styles.header }, kind === \"section\" ? /* @__PURE__ */ React.createElement(\"h3\", { className: styles.title }, title) : /* @__PURE__ */ React.createElement(\"h6\", { className: styles.subtitle }, title), isCollapsible && /* @__PURE__ */ React.createElement(\n    IconButton,\n    {\n      name: iconName,\n      onClick: () => setIsOpen(!isOpen),\n      type: \"button\",\n      size: \"xl\",\n      \"aria-label\": collapsibleButtonAriaLabel\n    }\n  )), description && /* @__PURE__ */ React.createElement(\"p\", { className: styles.descriptionText }, description), isOpen && /* @__PURE__ */ React.createElement(\"div\", { className: styles.content }, children));\n};\n\nexport { GenericConfigSection };\n//# sourceMappingURL=GenericConfigSection.js.map\n","import React from 'react';\nimport { GenericConfigSection } from './GenericConfigSection.js';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst ConfigSection = (_a) => {\n  var _b = _a, { children } = _b, props = __objRest(_b, [\"children\"]);\n  return /* @__PURE__ */ React.createElement(GenericConfigSection, __spreadProps(__spreadValues({}, props), { kind: \"section\" }), children);\n};\n\nexport { ConfigSection };\n//# sourceMappingURL=ConfigSection.js.map\n","import { includes, filter } from 'lodash';\n\nimport { rangeUtil } from '@grafana/data';\n\nexport default class TimeGrainConverter {\n  static createISO8601Duration(timeGrain: string | number, timeGrainUnit: string) {\n    const timeIntervals = ['hour', 'minute', 'h', 'm'];\n    if (includes(timeIntervals, timeGrainUnit)) {\n      return `PT${timeGrain}${timeGrainUnit[0].toUpperCase()}`;\n    }\n\n    return `P${timeGrain}${timeGrainUnit[0].toUpperCase()}`;\n  }\n\n  static createISO8601DurationFromInterval(interval: string) {\n    const timeGrain = +interval.slice(0, interval.length - 1);\n    const unit = interval[interval.length - 1];\n\n    if (interval.indexOf('ms') > -1) {\n      return TimeGrainConverter.createISO8601Duration(1, 'm');\n    }\n\n    if (interval[interval.length - 1] === 's') {\n      let toMinutes = (timeGrain * 60) % 60;\n\n      if (toMinutes < 1) {\n        toMinutes = 1;\n      }\n\n      return TimeGrainConverter.createISO8601Duration(toMinutes, 'm');\n    }\n\n    return TimeGrainConverter.createISO8601Duration(timeGrain, unit);\n  }\n\n  static findClosestTimeGrain(interval: string, allowedTimeGrains: string[]) {\n    const timeGrains = filter(allowedTimeGrains, (o) => o !== 'auto');\n\n    let closest = timeGrains[0];\n    const intervalMs = rangeUtil.intervalToMs(interval);\n\n    for (let i = 0; i < timeGrains.length; i++) {\n      // abs (num - val) < abs (num - curr):\n      if (intervalMs > rangeUtil.intervalToMs(timeGrains[i])) {\n        if (i + 1 < timeGrains.length) {\n          closest = timeGrains[i + 1];\n        } else {\n          closest = timeGrains[i];\n        }\n      }\n    }\n\n    return closest;\n  }\n\n  static createTimeGrainFromISO8601Duration(duration: string) {\n    let offset = 1;\n    if (duration.substring(0, 2) === 'PT') {\n      offset = 2;\n    }\n\n    const value = duration.substring(offset, duration.length - 1);\n    const unit = duration.substring(duration.length - 1);\n\n    return value + ' ' + TimeGrainConverter.timeUnitToText(+value, unit);\n  }\n\n  static timeUnitToText(value: number, unit: string) {\n    let text = '';\n\n    if (unit === 'S') {\n      text = 'second';\n    }\n    if (unit === 'M') {\n      text = 'minute';\n    }\n    if (unit === 'H') {\n      text = 'hour';\n    }\n    if (unit === 'D') {\n      text = 'day';\n    }\n\n    if (value > 1) {\n      return text + 's';\n    }\n\n    return text;\n  }\n\n  static createKbnUnitFromISO8601Duration(duration: string) {\n    if (duration === 'auto') {\n      return 'auto';\n    }\n\n    let offset = 1;\n    if (duration.substring(0, 2) === 'PT') {\n      offset = 2;\n    }\n\n    const value = duration.substring(offset, duration.length - 1);\n    const unit = duration.substring(duration.length - 1);\n\n    return value + TimeGrainConverter.timeUnitToKbn(+value, unit);\n  }\n\n  static timeUnitToKbn(value: number, unit: string) {\n    if (unit === 'S') {\n      return 's';\n    }\n    if (unit === 'M') {\n      return 'm';\n    }\n    if (unit === 'H') {\n      return 'h';\n    }\n    if (unit === 'D') {\n      return 'd';\n    }\n\n    return '';\n  }\n}\n","import { find, get } from 'lodash';\n\nimport { FetchResponse } from '@grafana/runtime';\n\nimport TimeGrainConverter from '../time_grain_converter';\nimport {\n  AzureMonitorLocalizedValue,\n  AzureMonitorLocations,\n  AzureMonitorMetricAvailabilityMetadata,\n  AzureMonitorMetricsMetadataResponse,\n  AzureMonitorOption,\n  AzureAPIResponse,\n  Location,\n  Subscription,\n  Resource,\n} from '../types';\nexport default class ResponseParser {\n  static parseResponseValues<T>(\n    result: AzureAPIResponse<T>,\n    textFieldName: string,\n    valueFieldName: string\n  ): Array<{ text: string; value: string }> {\n    const list: Array<{ text: string; value: string }> = [];\n\n    if (!result) {\n      return list;\n    }\n\n    for (let i = 0; i < result.value.length; i++) {\n      if (!find(list, ['value', get(result.value[i], valueFieldName)])) {\n        const value = get(result.value[i], valueFieldName);\n        const text = get(result.value[i], textFieldName, value);\n\n        list.push({\n          text: text,\n          value: value,\n        });\n      }\n    }\n    return list;\n  }\n\n  static parseResourceNames(\n    result: AzureAPIResponse<Resource>,\n    metricNamespace?: string\n  ): Array<{ text: string; value: string }> {\n    const list: Array<{ text: string; value: string }> = [];\n\n    if (!result) {\n      return list;\n    }\n\n    for (let i = 0; i < result.value.length; i++) {\n      if (\n        typeof result.value[i].type === 'string' &&\n        (!metricNamespace || result.value[i].type.toLocaleLowerCase() === metricNamespace.toLocaleLowerCase())\n      ) {\n        list.push({\n          text: result.value[i].name,\n          value: result.value[i].name,\n        });\n      }\n    }\n\n    return list;\n  }\n\n  static parseMetadata(result: AzureMonitorMetricsMetadataResponse, metricName: string) {\n    const defaultAggTypes = ['None', 'Average', 'Minimum', 'Maximum', 'Total', 'Count'];\n    const metricData = result?.value.find((v) => v.name.value === metricName);\n\n    if (!metricData) {\n      return {\n        primaryAggType: '',\n        supportedAggTypes: defaultAggTypes,\n        supportedTimeGrains: [],\n        dimensions: [],\n      };\n    }\n\n    return {\n      primaryAggType: metricData.primaryAggregationType,\n      supportedAggTypes: metricData.supportedAggregationTypes || defaultAggTypes,\n\n      supportedTimeGrains: [\n        { label: 'Auto', value: 'auto' },\n        ...ResponseParser.parseTimeGrains(metricData.metricAvailabilities ?? []),\n      ],\n      dimensions: ResponseParser.parseDimensions(metricData.dimensions ?? []),\n    };\n  }\n\n  static parseTimeGrains(metricAvailabilities: AzureMonitorMetricAvailabilityMetadata[]): AzureMonitorOption[] {\n    const timeGrains: AzureMonitorOption[] = [];\n\n    if (!metricAvailabilities) {\n      return timeGrains;\n    }\n\n    metricAvailabilities.forEach((avail) => {\n      if (avail.timeGrain) {\n        timeGrains.push({\n          label: TimeGrainConverter.createTimeGrainFromISO8601Duration(avail.timeGrain),\n          value: avail.timeGrain,\n        });\n      }\n    });\n\n    return timeGrains;\n  }\n\n  static parseDimensions(metadataDimensions: AzureMonitorLocalizedValue[]) {\n    return metadataDimensions.map((dimension) => {\n      return {\n        label: dimension.localizedValue || dimension.value,\n        value: dimension.value,\n      };\n    });\n  }\n\n  static parseSubscriptions(result: AzureAPIResponse<Subscription>): Array<{ text: string; value: string }> {\n    const list: Array<{ text: string; value: string }> = [];\n\n    if (!result) {\n      return list;\n    }\n\n    const valueFieldName = 'subscriptionId';\n    const textFieldName = 'displayName';\n    for (let i = 0; i < result.value.length; i++) {\n      if (!find(list, ['value', get(result.value[i], valueFieldName)])) {\n        list.push({\n          text: `${get(result.value[i], textFieldName)}`,\n          value: get(result.value[i], valueFieldName),\n        });\n      }\n    }\n\n    return list;\n  }\n\n  static parseSubscriptionsForSelect(\n    result?: FetchResponse<AzureAPIResponse<Subscription>>\n  ): Array<{ label: string; value: string }> {\n    const list: Array<{ label: string; value: string }> = [];\n\n    if (!result) {\n      return list;\n    }\n\n    const valueFieldName = 'subscriptionId';\n    const textFieldName = 'displayName';\n    for (let i = 0; i < result.data.value.length; i++) {\n      if (!find(list, ['value', get(result.data.value[i], valueFieldName)])) {\n        list.push({\n          label: `${get(result.data.value[i], textFieldName)} - ${get(result.data.value[i], valueFieldName)}`,\n          value: get(result.data.value[i], valueFieldName),\n        });\n      }\n    }\n\n    return list;\n  }\n\n  static parseLocations(result: AzureAPIResponse<Location>) {\n    const locations: AzureMonitorLocations[] = [];\n\n    if (!result) {\n      return locations;\n    }\n\n    for (const location of result.value) {\n      locations.push({ name: location.name, displayName: location.displayName, supportsLogs: undefined });\n    }\n\n    return locations;\n  }\n}\n","import { map } from 'lodash';\n\nimport { SelectableValue, VariableWithMultiSupport } from '@grafana/data';\n\nimport { AzureMonitorOption, VariableOptionGroup } from '../types';\n\nexport const hasOption = (options: AzureMonitorOption[], value: string): boolean =>\n  options.some((v) => (v.options ? hasOption(v.options, value) : v.value === value));\n\nexport const findOptions = (options: AzureMonitorOption[], values: string[] = []) => {\n  if (values.length === 0) {\n    return [];\n  }\n  const set = values.reduce((accum, item) => {\n    accum.add(item);\n    return accum;\n  }, new Set());\n  return options.filter((option) => set.has(option.value));\n};\n\nexport const toOption = (v: { text: string; value: string }) => ({ value: v.value, label: v.text });\n\nexport const addValueToOptions = (\n  values: Array<AzureMonitorOption | SelectableValue>,\n  variableOptionGroup: VariableOptionGroup,\n  value?: string\n) => {\n  const options = [...values, variableOptionGroup];\n\n  const optionValues = values.map((m) => m.value.toLowerCase()).concat(variableOptionGroup.options.map((p) => p.value));\n  if (value && !optionValues.includes(value.toLowerCase())) {\n    options.push({ label: value, value });\n  }\n\n  return options;\n};\n\n// Route definitions shared with the backend.\n// Check: /pkg/tsdb/azuremonitor/azuremonitor-resource-handler.go <registerRoutes>\nexport const routeNames = {\n  azureMonitor: 'azuremonitor',\n  logAnalytics: 'loganalytics',\n  appInsights: 'appinsights',\n  resourceGraph: 'resourcegraph',\n};\n\nexport function interpolateVariable(\n  value: string | number | Array<string | number>,\n  variable: VariableWithMultiSupport\n) {\n  if (typeof value === 'string') {\n    // When enabling multiple responses, quote the value to mimic the array result below\n    // even if only one response is selected. This does not apply if only the \"include all\"\n    // option is enabled but with a custom value.\n    if (variable.multi || (variable.includeAll && !variable.allValue)) {\n      return \"'\" + value + \"'\";\n    } else {\n      return value;\n    }\n  }\n\n  if (typeof value === 'number') {\n    return value;\n  }\n\n  const quotedValues = map(value, (val) => {\n    if (typeof value === 'number') {\n      return value;\n    }\n\n    return \"'\" + val + \"'\";\n  });\n  return quotedValues.join(',');\n}\n","import { useEffect } from 'react';\nvar useEffectOnce = function (effect) {\n    useEffect(effect, []);\n};\nexport default useEffectOnce;\n","import { config } from '@grafana/runtime';\n\nconst predefinedClouds = [\n  {\n    name: \"AzureCloud\",\n    displayName: \"Azure\"\n  },\n  {\n    name: \"AzureChinaCloud\",\n    displayName: \"Azure China\"\n  },\n  {\n    name: \"AzureUSGovernment\",\n    displayName: \"Azure US Government\"\n  }\n];\nfunction getAzureClouds() {\n  const settingsEx = config.azure;\n  if (Array.isArray(settingsEx.clouds) && settingsEx.clouds.length > 0) {\n    return settingsEx.clouds;\n  }\n  return predefinedClouds;\n}\n\nexport { getAzureClouds };\n//# sourceMappingURL=clouds.js.map\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as common from '@grafana/schema';\n\nexport interface AzureMonitorQuery extends common.DataQuery {\n  /**\n   * Azure Monitor Logs sub-query properties.\n   */\n  azureLogAnalytics?: AzureLogsQuery;\n  /**\n   * Azure Monitor Metrics sub-query properties.\n   */\n  azureMonitor?: AzureMetricQuery;\n  /**\n   * Azure Resource Graph sub-query properties.\n   */\n  azureResourceGraph?: AzureResourceGraphQuery;\n  /**\n   * Application Insights Traces sub-query properties.\n   */\n  azureTraces?: AzureTracesQuery;\n  /**\n   * @deprecated Legacy template variable support.\n   */\n  grafanaTemplateVariableFn?: GrafanaTemplateVariableQuery;\n  namespace?: string;\n  /**\n   * Used only for exemplar queries from Prometheus\n   */\n  query?: string;\n  region?: string;\n  resource?: string;\n  /**\n   * Template variables params. These exist for backwards compatiblity with legacy template variables.\n   */\n  resourceGroup?: string;\n  /**\n   * Azure subscription containing the resource(s) to be queried.\n   */\n  subscription?: string;\n  /**\n   * Subscriptions to be queried via Azure Resource Graph.\n   */\n  subscriptions?: Array<string>;\n}\n\nexport const defaultAzureMonitorQuery: Partial<AzureMonitorQuery> = {\n  subscriptions: [],\n};\n\n/**\n * Defines the supported queryTypes. GrafanaTemplateVariableFn is deprecated\n */\nexport enum AzureQueryType {\n  AzureMonitor = 'Azure Monitor',\n  AzureResourceGraph = 'Azure Resource Graph',\n  AzureTraces = 'Azure Traces',\n  GrafanaTemplateVariableFn = 'Grafana Template Variable Function',\n  LocationsQuery = 'Azure Regions',\n  LogAnalytics = 'Azure Log Analytics',\n  MetricNamesQuery = 'Azure Metric Names',\n  NamespacesQuery = 'Azure Namespaces',\n  ResourceGroupsQuery = 'Azure Resource Groups',\n  ResourceNamesQuery = 'Azure Resource Names',\n  SubscriptionsQuery = 'Azure Subscriptions',\n  TraceExemplar = 'traceql',\n  WorkspacesQuery = 'Azure Workspaces',\n}\n\nexport interface AzureMetricQuery {\n  /**\n   * The aggregation to be used within the query. Defaults to the primaryAggregationType defined by the metric.\n   */\n  aggregation?: string;\n  /**\n   * Aliases can be set to modify the legend labels. e.g. {{ resourceGroup }}. See docs for more detail.\n   */\n  alias?: string;\n  /**\n   * Time grains that are supported by the metric.\n   */\n  allowedTimeGrainsMs?: Array<number>;\n  /**\n   * Used as the value for the metricNamespace property when it's different from the resource namespace.\n   */\n  customNamespace?: string;\n  /**\n   * @deprecated This property was migrated to dimensionFilters and should only be accessed in the migration\n   */\n  dimension?: string;\n  /**\n   * @deprecated This property was migrated to dimensionFilters and should only be accessed in the migration\n   */\n  dimensionFilter?: string;\n  /**\n   * Filters to reduce the set of data returned. Dimensions that can be filtered on are defined by the metric.\n   */\n  dimensionFilters?: Array<AzureMetricDimension>;\n  /**\n   * @deprecated Use metricNamespace instead\n   */\n  metricDefinition?: string;\n  /**\n   * The metric to query data for within the specified metricNamespace. e.g. UsedCapacity\n   */\n  metricName?: string;\n  /**\n   * metricNamespace is used as the resource type (or resource namespace).\n   * It's usually equal to the target metric namespace. e.g. microsoft.storage/storageaccounts\n   * Kept the name of the variable as metricNamespace to avoid backward incompatibility issues.\n   */\n  metricNamespace?: string;\n  /**\n   * The Azure region containing the resource(s).\n   */\n  region?: string;\n  /**\n   * @deprecated Use resources instead\n   */\n  resourceGroup?: string;\n  /**\n   * @deprecated Use resources instead\n   */\n  resourceName?: string;\n  /**\n   * @deprecated Use resourceGroup, resourceName and metricNamespace instead\n   */\n  resourceUri?: string;\n  /**\n   * Array of resource URIs to be queried.\n   */\n  resources?: Array<AzureMonitorResource>;\n  /**\n   * The granularity of data points to be queried. Defaults to auto.\n   */\n  timeGrain?: string;\n  /**\n   * @deprecated\n   */\n  timeGrainUnit?: string;\n  /**\n   * Maximum number of records to return. Defaults to 10.\n   */\n  top?: string;\n}\n\nexport const defaultAzureMetricQuery: Partial<AzureMetricQuery> = {\n  allowedTimeGrainsMs: [],\n  dimensionFilters: [],\n  resources: [],\n};\n\n/**\n * Azure Monitor Logs sub-query properties\n */\nexport interface AzureLogsQuery {\n  /**\n   * If set to true the query will be run as a basic logs query\n   */\n  basicLogsQuery?: boolean;\n  /**\n   * If set to true the dashboard time range will be used as a filter for the query. Otherwise the query time ranges will be used. Defaults to false.\n   */\n  dashboardTime?: boolean;\n  /**\n   * @deprecated Use dashboardTime instead\n   */\n  intersectTime?: boolean;\n  /**\n   * KQL query to be executed.\n   */\n  query?: string;\n  /**\n   * @deprecated Use resources instead\n   */\n  resource?: string;\n  /**\n   * Array of resource URIs to be queried.\n   */\n  resources?: Array<string>;\n  /**\n   * Specifies the format results should be returned as.\n   */\n  resultFormat?: ResultFormat;\n  /**\n   * If dashboardTime is set to true this value dictates which column the time filter will be applied to. Defaults to the first tables timeSpan column, the first datetime column found, or TimeGenerated\n   */\n  timeColumn?: string;\n  /**\n   * Workspace ID. This was removed in Grafana 8, but remains for backwards compat.\n   */\n  workspace?: string;\n}\n\nexport const defaultAzureLogsQuery: Partial<AzureLogsQuery> = {\n  resources: [],\n};\n\n/**\n * Application Insights Traces sub-query properties\n */\nexport interface AzureTracesQuery {\n  /**\n   * Filters for property values.\n   */\n  filters?: Array<AzureTracesFilter>;\n  /**\n   * Operation ID. Used only for Traces queries.\n   */\n  operationId?: string;\n  /**\n   * KQL query to be executed.\n   */\n  query?: string;\n  /**\n   * Array of resource URIs to be queried.\n   */\n  resources?: Array<string>;\n  /**\n   * Specifies the format results should be returned as.\n   */\n  resultFormat?: ResultFormat;\n  /**\n   * Types of events to filter by.\n   */\n  traceTypes?: Array<string>;\n}\n\nexport const defaultAzureTracesQuery: Partial<AzureTracesQuery> = {\n  filters: [],\n  resources: [],\n  traceTypes: [],\n};\n\nexport interface AzureTracesFilter {\n  /**\n   * Values to filter by.\n   */\n  filters: Array<string>;\n  /**\n   * Comparison operator to use. Either equals or not equals.\n   */\n  operation: string;\n  /**\n   * Property name, auto-populated based on available traces.\n   */\n  property: string;\n}\n\nexport const defaultAzureTracesFilter: Partial<AzureTracesFilter> = {\n  filters: [],\n};\n\nexport enum ResultFormat {\n  Logs = 'logs',\n  Table = 'table',\n  TimeSeries = 'time_series',\n  Trace = 'trace',\n}\n\nexport interface AzureResourceGraphQuery {\n  /**\n   * Azure Resource Graph KQL query to be executed.\n   */\n  query?: string;\n  /**\n   * Specifies the format results should be returned as. Defaults to table.\n   */\n  resultFormat?: string;\n}\n\nexport interface AzureMonitorResource {\n  metricNamespace?: string;\n  region?: string;\n  resourceGroup?: string;\n  resourceName?: string;\n  subscription?: string;\n}\n\nexport interface AzureMetricDimension {\n  /**\n   * Name of Dimension to be filtered on.\n   */\n  dimension?: string;\n  /**\n   * @deprecated filter is deprecated in favour of filters to support multiselect.\n   */\n  filter?: string;\n  /**\n   * Values to match with the filter.\n   */\n  filters?: Array<string>;\n  /**\n   * String denoting the filter operation. Supports 'eq' - equals,'ne' - not equals, 'sw' - starts with. Note that some dimensions may not support all operators.\n   */\n  operator?: string;\n}\n\nexport const defaultAzureMetricDimension: Partial<AzureMetricDimension> = {\n  filters: [],\n};\n\nexport type GrafanaTemplateVariableQueryType = ('AppInsightsMetricNameQuery' | 'AppInsightsGroupByQuery' | 'SubscriptionsQuery' | 'ResourceGroupsQuery' | 'ResourceNamesQuery' | 'MetricNamespaceQuery' | 'MetricNamesQuery' | 'WorkspacesQuery' | 'UnknownQuery');\n\nexport interface BaseGrafanaTemplateVariableQuery {\n  rawQuery?: string;\n}\n\nexport interface UnknownQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'UnknownQuery';\n}\n\nexport interface AppInsightsMetricNameQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'AppInsightsMetricNameQuery';\n}\n\nexport interface AppInsightsGroupByQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'AppInsightsGroupByQuery';\n  metricName: string;\n}\n\nexport interface SubscriptionsQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'SubscriptionsQuery';\n}\n\nexport interface ResourceGroupsQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'ResourceGroupsQuery';\n  subscription: string;\n}\n\nexport interface ResourceNamesQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'ResourceNamesQuery';\n  metricNamespace: string;\n  resourceGroup: string;\n  subscription: string;\n}\n\nexport interface MetricNamespaceQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'MetricNamespaceQuery';\n  metricNamespace?: string;\n  resourceGroup: string;\n  resourceName?: string;\n  subscription: string;\n}\n\n/**\n * @deprecated Use MetricNamespaceQuery instead\n */\nexport interface MetricDefinitionsQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'MetricDefinitionsQuery';\n  metricNamespace?: string;\n  resourceGroup: string;\n  resourceName?: string;\n  subscription: string;\n}\n\nexport interface MetricNamesQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'MetricNamesQuery';\n  metricNamespace: string;\n  resourceGroup: string;\n  resourceName: string;\n  subscription: string;\n}\n\nexport interface WorkspacesQuery extends BaseGrafanaTemplateVariableQuery {\n  kind: 'WorkspacesQuery';\n  subscription: string;\n}\n\nexport type GrafanaTemplateVariableQuery = (AppInsightsMetricNameQuery | AppInsightsGroupByQuery | SubscriptionsQuery | ResourceGroupsQuery | ResourceNamesQuery | MetricNamespaceQuery | MetricDefinitionsQuery | MetricNamesQuery | WorkspacesQuery | UnknownQuery);\n\nexport interface AzureMonitorDataQuery {}\n","import { ScalarParameter, TabularParameter, Function, EntityGroup } from '@kusto/monaco-kusto';\n\nimport {\n  DataSourceInstanceSettings,\n  DataSourceJsonData,\n  DataSourceSettings,\n  PanelData,\n  SelectableValue,\n  TimeRange,\n} from '@grafana/data';\n\nimport Datasource from '../datasource';\n\nimport { AzureLogAnalyticsMetadataTable } from './logAnalyticsMetadata';\nimport { AzureMonitorQuery, ResultFormat } from './query';\n\nexport type AzureDataSourceSettings = DataSourceSettings<AzureDataSourceJsonData, AzureDataSourceSecureJsonData>;\nexport type AzureDataSourceInstanceSettings = DataSourceInstanceSettings<AzureDataSourceJsonData>;\n\nexport interface DatasourceValidationResult {\n  status: 'success' | 'error';\n  message: string;\n  title?: string;\n}\n\n/**\n * Azure clouds known to Azure Monitor.\n */\nexport enum AzureCloud {\n  Public = 'AzureCloud',\n  China = 'AzureChinaCloud',\n  USGovernment = 'AzureUSGovernment',\n  None = '',\n}\n\nexport type AzureAuthType = 'msi' | 'clientsecret' | 'workloadidentity' | 'currentuser';\n\nexport type ConcealedSecret = symbol;\n\ninterface AzureCredentialsBase {\n  authType: AzureAuthType;\n}\n\nexport interface AzureManagedIdentityCredentials extends AzureCredentialsBase {\n  authType: 'msi';\n}\n\nexport interface AzureWorkloadIdentityCredentials extends AzureCredentialsBase {\n  authType: 'workloadidentity';\n}\n\nexport interface AzureClientSecretCredentials extends AzureCredentialsBase {\n  authType: 'clientsecret';\n  azureCloud?: string;\n  tenantId?: string;\n  clientId?: string;\n  clientSecret?: string | ConcealedSecret;\n}\nexport interface AadCurrentUserCredentials extends AzureCredentialsBase {\n  authType: 'currentuser';\n  serviceCredentials?:\n    | AzureClientSecretCredentials\n    | AzureManagedIdentityCredentials\n    | AzureWorkloadIdentityCredentials;\n  serviceCredentialsEnabled?: boolean;\n}\n\nexport type AzureCredentials =\n  | AadCurrentUserCredentials\n  | AzureManagedIdentityCredentials\n  | AzureClientSecretCredentials\n  | AzureWorkloadIdentityCredentials;\n\nexport interface AzureDataSourceJsonData extends DataSourceJsonData {\n  cloudName: string;\n  azureAuthType?: AzureAuthType;\n\n  // monitor\n  tenantId?: string;\n  clientId?: string;\n  subscriptionId?: string;\n  oauthPassThru?: boolean;\n  azureCredentials?: AzureCredentials;\n  basicLogsEnabled?: boolean;\n\n  // logs\n  /** @deprecated Azure Logs credentials */\n  azureLogAnalyticsSameAs?: boolean;\n  /** @deprecated Azure Logs credentials */\n  logAnalyticsTenantId?: string;\n  /** @deprecated Azure Logs credentials */\n  logAnalyticsClientId?: string;\n  /** @deprecated Azure Logs credentials */\n  logAnalyticsSubscriptionId?: string;\n  /** @deprecated Azure Logs credentials */\n  logAnalyticsDefaultWorkspace?: string;\n\n  // App Insights\n  appInsightsAppId?: string;\n\n  enableSecureSocksProxy?: boolean;\n}\n\nexport interface AzureDataSourceSecureJsonData {\n  clientSecret?: string;\n  appInsightsApiKey?: string;\n}\n\n// Represents an errors that come back from frontend requests.\n// Not totally sure how accurate this type is.\nexport type AzureMonitorErrorish = Error | string | React.ReactElement;\n\n// Azure Monitor API Types\nexport interface AzureMonitorMetricsMetadataResponse {\n  value: AzureMonitorMetricMetadataItem[];\n}\n\nexport interface AzureMonitorMetricMetadataItem {\n  id: string;\n  resourceId: string;\n  primaryAggregationType: string;\n  supportedAggregationTypes: string[];\n  name: AzureMonitorLocalizedValue;\n  dimensions?: AzureMonitorLocalizedValue[];\n  metricAvailabilities?: AzureMonitorMetricAvailabilityMetadata[];\n}\n\nexport interface AzureMonitorMetricAvailabilityMetadata {\n  timeGrain: string;\n  retention: string;\n}\n\nexport interface AzureMonitorLocalizedValue {\n  value: string;\n  localizedValue: string;\n}\n\nexport interface AzureLogsVariable {\n  text: string;\n  value: string;\n}\n\nexport interface AzureMonitorOption<T = string> {\n  label: string;\n  value: T;\n  options?: AzureMonitorOption[];\n}\n\nexport type VariableOptionGroup = { label: string; options: AzureMonitorOption[] };\n\nexport interface AzureQueryEditorFieldProps {\n  data?: PanelData;\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  subscriptionId?: string;\n  variableOptionGroup: VariableOptionGroup;\n  schema?: EngineSchema;\n  range?: TimeRange;\n\n  onQueryChange: (newQuery: AzureMonitorQuery) => void;\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n}\n\n// To avoid a type issue we redeclare the EngineSchema type from @kusto/monaco-kusto\nexport interface EngineSchema {\n  clusterType: 'Engine';\n  cluster: {\n    connectionString: string;\n    databases: Database[];\n  };\n  database: Database | undefined;\n  globalScalarParameters?: ScalarParameter[];\n  globalTabularParameters?: TabularParameter[];\n}\n\nexport interface Database {\n  name: string;\n  tables: AzureLogAnalyticsMetadataTable[];\n  functions: Function[];\n  majorVersion: number;\n  minorVersion: number;\n  entityGroups: EntityGroup[];\n}\n\nexport interface FormatAsFieldProps extends AzureQueryEditorFieldProps {\n  inputId: string;\n  options: Array<SelectableValue<ResultFormat>>;\n  defaultValue: ResultFormat;\n  setFormatAs: (query: AzureMonitorQuery, formatAs: ResultFormat) => AzureMonitorQuery;\n  resultFormat?: ResultFormat;\n  onLoad: (\n    query: AzureMonitorQuery,\n    defaultValue: ResultFormat,\n    handleChange: (change: SelectableValue<ResultFormat>) => void\n  ) => void;\n}\n\nexport interface AzureResourceSummaryItem {\n  subscriptionName: string;\n  resourceGroupName: string | undefined;\n  resourceName: string | undefined;\n}\n\nexport interface RawAzureSubscriptionItem {\n  subscriptionName: string;\n  subscriptionId: string;\n}\n\nexport interface RawAzureResourceGroupItem {\n  resourceGroupURI: string;\n  resourceGroupName: string;\n}\n\nexport interface RawAzureResourceItem {\n  id: string;\n  name: string;\n  subscriptionId: string;\n  resourceGroup: string;\n  type: string;\n  location: string;\n}\n\nexport interface AzureGraphResponse<T = unknown> {\n  data: T;\n  // skipToken is used for pagination, to get the next page\n  $skipToken?: string;\n}\n\n// https://docs.microsoft.com/en-us/rest/api/azureresourcegraph/resourcegraph(2021-03-01)/resources/resources#queryrequestoptions\nexport interface AzureResourceGraphOptions {\n  $skip: number;\n  $skipToken: string;\n  $top: number;\n  allowPartialScopes: boolean;\n  resultFormat: 'objectArray' | 'table';\n}\n\n// Azure Monitor Metrics query API data fetcher argument types.\n// The types prefixed by Legacy are applicable to pre-version 9 of Grafana\n// that do not have a resourceUri, instead the resourceUri is built up from\n// the subscription, resource group, metric definition (a.k.a. resource type)\n// and the resource name.\nexport type GetMetricNamespacesQuery = AzureGetMetricNamespacesQuery | LegacyAzureGetMetricNamespacesQuery;\nexport type GetMetricNamesQuery = AzureGetMetricNamesQuery | LegacyAzureGetMetricNamesQuery;\nexport type GetMetricMetadataQuery = AzureGetMetricMetadataQuery | LegacyAzureGetMetricMetadataQuery;\n\nexport interface AzureGetMetricNamespacesQuery {\n  resourceUri: string;\n}\nexport interface LegacyAzureGetMetricNamespacesQuery {\n  subscription: string;\n  resourceGroup: string;\n  metricNamespace?: string;\n  resourceName?: string;\n}\n\nexport interface AzureGetMetricNamesQuery {\n  resourceUri: string;\n  metricNamespace?: string;\n  customNamespace?: string;\n}\n\nexport interface LegacyAzureGetMetricNamesQuery {\n  subscription: string;\n  resourceGroup: string;\n  resourceName: string;\n  metricNamespace: string;\n  customNamespace?: string;\n}\n\nexport interface AzureGetMetricMetadataQuery {\n  resourceUri: string;\n  metricNamespace: string;\n  customNamespace?: string;\n  metricName: string;\n}\n\nexport interface LegacyAzureGetMetricMetadataQuery {\n  subscription: string;\n  resourceGroup: string;\n  resourceName: string;\n  metricNamespace: string;\n  customNamespace?: string;\n  metricName: string;\n}\n\nexport interface AzureGetResourceNamesQuery {\n  subscriptionId: string;\n  resourceGroup?: string;\n  metricNamespace?: string;\n  region?: string;\n}\n\nexport interface AzureMonitorLocations {\n  displayName: string;\n  name: string;\n  supportsLogs?: boolean;\n}\n\nexport interface AzureMonitorProvidersResponse {\n  namespace: string;\n  resourceTypes: ProviderResourceType[];\n}\n\nexport interface ProviderResourceType {\n  resourceType: string;\n  locations: string[];\n  apiVersions: string[];\n  capabilities: string;\n}\n\nexport interface AzureAPIResponse<T> {\n  value: T[];\n  count?: {\n    type: string;\n    value: number;\n  };\n  status?: number;\n  statusText?: string;\n}\n\nexport interface Location {\n  id: string;\n  name: string;\n  displayName: string;\n  regionalDisplayName: string;\n  metadata: LocationMetadata;\n}\n\ninterface LocationMetadata {\n  regionType: string;\n  regionCategory: string;\n  geographyGroup: string;\n  longitude: string;\n  latitude: string;\n  physicalLocation: string;\n  pairedRegion: LocationPairedRegion[];\n}\n\ninterface LocationPairedRegion {\n  name: string;\n  id: string;\n}\n\nexport interface Subscription {\n  id: string;\n  authorizationSource: string;\n  subscriptionId: string;\n  tenantId: string;\n  displayName: string;\n  state: string;\n  subscriptionPolicies: {\n    locationPlacementId: string;\n    quotaId: string;\n    spendingLimit: string;\n  };\n}\n\nexport interface Workspace {\n  properties: {\n    customerId: string;\n    provisioningState: string;\n    sku: {\n      name: string;\n    };\n    retentionInDays: number;\n    publicNetworkAccessForQuery: string;\n    publicNetworkAccessForIngestion: string;\n  };\n  id: string;\n  name: string;\n  type: string;\n  location: string;\n  tags: Record<string, string>;\n}\n\nexport interface Resource {\n  changedTime: string;\n  createdTime: string;\n  extendedLocation: { name: string; type: string };\n  id: string;\n  identity: { principalId: string; tenantId: string; type: string; userAssignedIdentities: string[] };\n  kind: string;\n  location: string;\n  managedBy: string;\n  name: string;\n  plan: { name: string; product: string; promotionCode: string; publisher: string; version: string };\n  properties: Record<string, string>;\n  provisioningState: string;\n  sku: { capacity: number; family: string; model: string; name: string; size: string; tier: string };\n  tags: Record<string, string>;\n  type: string;\n}\n\nexport interface ResourceGroup {\n  id: string;\n  location: string;\n  managedBy: string;\n  name: string;\n  properties: { provisioningState: string };\n  tags: object;\n  type: string;\n}\n\nexport interface Namespace {\n  classification: {\n    Custom: string;\n    Platform: string;\n    Qos: string;\n  };\n  id: string;\n  name: string;\n  properties: { metricNamespaceName: string };\n  type: string;\n}\n\nexport interface Metric {\n  displayDescription: string;\n  errorCode: string;\n  errorMessage: string;\n  id: string;\n  name: AzureMonitorLocalizedValue;\n  timeseries: Array<{ data: MetricValue[]; metadatavalues: MetricMetadataValue[] }>;\n  type: string;\n  unit: string;\n}\n\ninterface MetricValue {\n  average: number;\n  count: number;\n  maximum: number;\n  minimum: number;\n  timeStamp: string;\n  total: number;\n}\n\ninterface MetricMetadataValue {\n  name: AzureMonitorLocalizedValue;\n  value: string;\n}\n\nexport type Category = {\n  displayName: string;\n  id: string;\n  related: {\n    queries: string[];\n    tables: string[];\n  };\n};\n\nexport type CheatsheetQuery = {\n  body: string;\n  description: string;\n  displayName: string;\n  id: string;\n  properties: {\n    ExampleQuery: boolean;\n    QueryAttributes: {\n      isMultiResource: boolean;\n    };\n  };\n  related: {\n    categories: string[];\n    resourceTypes: string[];\n    tables: string[];\n  };\n  tags: {\n    Topic: string[];\n  };\n};\n\nexport type CheatsheetQueries = {\n  [key: string]: CheatsheetQuery[];\n};\n\nexport type DropdownCategories = {\n  [key: string]: boolean;\n};\n","import { getAzureClouds } from '@grafana/azure-sdk';\nimport { config } from '@grafana/runtime';\n\nimport {\n  AadCurrentUserCredentials,\n  AzureAuthType,\n  AzureClientSecretCredentials,\n  AzureCloud,\n  AzureCredentials,\n  AzureDataSourceInstanceSettings,\n  AzureDataSourceSettings,\n  ConcealedSecret,\n} from './types';\n\nconst concealed: ConcealedSecret = Symbol('Concealed client secret');\n\nexport function getAuthType(options: AzureDataSourceSettings | AzureDataSourceInstanceSettings): AzureAuthType {\n  if (!options.jsonData.azureAuthType) {\n    // If authentication type isn't explicitly specified and datasource has client credentials,\n    // then this is existing datasource which is configured for app registration (client secret)\n    if (options.jsonData.tenantId && options.jsonData.clientId) {\n      return 'clientsecret';\n    }\n\n    // For newly created datasource with no configuration, managed identity is the default authentication type\n    // if they are enabled in Grafana config\n    return config.azure.managedIdentityEnabled ? 'msi' : 'clientsecret';\n  }\n\n  return options.jsonData.azureAuthType;\n}\n\nfunction resolveLegacyCloudName(cloudName: string | undefined): string | undefined {\n  if (!cloudName) {\n    // if undefined, allow the code to fallback to calling getDefaultAzureCloud() since that has the complete logic for handling an empty cloud name\n    return undefined;\n  }\n  switch (cloudName) {\n    case 'azuremonitor':\n      return AzureCloud.Public;\n    case 'chinaazuremonitor':\n      return AzureCloud.China;\n    case 'govazuremonitor':\n      return AzureCloud.USGovernment;\n    default:\n      return cloudName;\n  }\n}\n\nfunction getDefaultAzureCloud(): string {\n  const cloudName = resolveLegacyCloudName(config.azure.cloud);\n\n  switch (cloudName) {\n    case AzureCloud.Public:\n    case AzureCloud.None:\n      return AzureCloud.Public;\n    case AzureCloud.China:\n      return AzureCloud.China;\n    case AzureCloud.USGovernment:\n      return AzureCloud.USGovernment;\n    default:\n      const cloudInfo = getAzureClouds();\n\n      for (const cloud of cloudInfo) {\n        if (cloud.name === config.azure.cloud) {\n          return cloud.name;\n        }\n      }\n      throw new Error(`The cloud '${config.azure.cloud}' is unsupported.`);\n  }\n}\n\nexport function getAzureCloud(options: AzureDataSourceSettings | AzureDataSourceInstanceSettings): string {\n  const authType = getAuthType(options);\n  switch (authType) {\n    case 'msi':\n    case 'workloadidentity':\n      // In case of managed identity and workload identity, the cloud is always same as where Grafana is hosted\n      return getDefaultAzureCloud();\n    case 'clientsecret':\n    case 'currentuser':\n      return resolveLegacyCloudName(options.jsonData.cloudName) || getDefaultAzureCloud();\n  }\n}\n\nfunction getSecret(options: AzureDataSourceSettings): undefined | string | ConcealedSecret {\n  if (options.secureJsonFields.clientSecret) {\n    // The secret is concealed on server\n    return concealed;\n  } else {\n    const secret = options.secureJsonData?.clientSecret;\n    return typeof secret === 'string' && secret.length > 0 ? secret : undefined;\n  }\n}\n\nexport function isCredentialsComplete(credentials: AzureCredentials, ignoreSecret = false): boolean {\n  switch (credentials.authType) {\n    case 'msi':\n    case 'workloadidentity':\n    case 'currentuser':\n      return true;\n    case 'clientsecret':\n      return !!(\n        credentials.azureCloud &&\n        credentials.tenantId &&\n        credentials.clientId &&\n        // When ignoreSecret is set we consider the credentials complete without checking the secret\n        !!(ignoreSecret || credentials.clientSecret)\n      );\n  }\n}\n\nexport function instanceOfAzureCredential<T extends AzureCredentials>(\n  authType: AzureAuthType,\n  object?: AzureCredentials\n): object is T {\n  if (!object) {\n    return false;\n  }\n  return object.authType === authType;\n}\n\nexport function getCredentials(options: AzureDataSourceSettings): AzureCredentials {\n  const authType = getAuthType(options);\n  const credentials = options.jsonData.azureCredentials;\n  switch (authType) {\n    case 'msi':\n    case 'workloadidentity':\n      if (\n        (authType === 'msi' && config.azure.managedIdentityEnabled) ||\n        (authType === 'workloadidentity' && config.azure.workloadIdentityEnabled)\n      ) {\n        return {\n          authType,\n        };\n      } else {\n        // If authentication type is managed identity or workload identity but either method is disabled in Grafana config,\n        // then we should fallback to an empty app registration (client secret) configuration\n        return {\n          authType: 'clientsecret',\n          azureCloud: getDefaultAzureCloud(),\n        };\n      }\n    case 'clientsecret':\n      return {\n        authType,\n        azureCloud: resolveLegacyCloudName(options.jsonData.cloudName) || getDefaultAzureCloud(),\n        tenantId: options.jsonData.tenantId,\n        clientId: options.jsonData.clientId,\n        clientSecret: getSecret(options),\n      };\n  }\n  if (instanceOfAzureCredential<AadCurrentUserCredentials>(authType, credentials)) {\n    if (instanceOfAzureCredential<AzureClientSecretCredentials>('clientsecret', credentials.serviceCredentials)) {\n      const serviceCredentials = { ...credentials.serviceCredentials, clientSecret: getSecret(options) };\n      return {\n        authType,\n        serviceCredentialsEnabled: credentials.serviceCredentialsEnabled,\n        serviceCredentials,\n      };\n    }\n    return {\n      authType,\n      serviceCredentialsEnabled: credentials.serviceCredentialsEnabled,\n      serviceCredentials: credentials.serviceCredentials,\n    };\n  }\n  return {\n    authType: 'clientsecret',\n    azureCloud: getDefaultAzureCloud(),\n  };\n}\n\nexport function updateCredentials(\n  options: AzureDataSourceSettings,\n  credentials: AzureCredentials\n): AzureDataSourceSettings {\n  switch (credentials.authType) {\n    case 'msi':\n    case 'workloadidentity':\n      if (credentials.authType === 'msi' && !config.azure.managedIdentityEnabled) {\n        throw new Error('Managed Identity authentication is not enabled in Grafana config.');\n      }\n      if (credentials.authType === 'workloadidentity' && !config.azure.workloadIdentityEnabled) {\n        throw new Error('Workload Identity authentication is not enabled in Grafana config.');\n      }\n\n      options = {\n        ...options,\n        jsonData: {\n          ...options.jsonData,\n          azureAuthType: credentials.authType,\n          azureCredentials: {\n            authType: credentials.authType,\n          },\n        },\n      };\n\n      return options;\n\n    case 'clientsecret':\n      options = {\n        ...options,\n        jsonData: {\n          ...options.jsonData,\n          azureAuthType: credentials.authType,\n          cloudName: resolveLegacyCloudName(credentials.azureCloud) || getDefaultAzureCloud(),\n          tenantId: credentials.tenantId,\n          clientId: credentials.clientId,\n          azureCredentials: {\n            authType: credentials.authType,\n            azureCloud: resolveLegacyCloudName(credentials.azureCloud) || getDefaultAzureCloud(),\n            tenantId: credentials.tenantId,\n            clientId: credentials.clientId,\n          },\n        },\n        secureJsonData: {\n          ...options.secureJsonData,\n          clientSecret: typeof credentials.clientSecret === 'string' ? credentials.clientSecret : undefined,\n        },\n        secureJsonFields: {\n          ...options.secureJsonFields,\n          clientSecret: typeof credentials.clientSecret === 'symbol',\n        },\n      };\n  }\n  if (instanceOfAzureCredential<AadCurrentUserCredentials>('currentuser', credentials)) {\n    const serviceCredentials = credentials.serviceCredentials;\n    let clientSecret: string | symbol | undefined;\n    if (instanceOfAzureCredential<AzureClientSecretCredentials>('clientsecret', serviceCredentials)) {\n      clientSecret = serviceCredentials.clientSecret;\n      // Do this to not expose the secret in unencrypted JSON data\n      delete serviceCredentials.clientSecret;\n    }\n    options = {\n      ...options,\n      jsonData: {\n        ...options.jsonData,\n        azureAuthType: credentials.authType,\n        azureCredentials: {\n          authType: 'currentuser',\n          serviceCredentialsEnabled: credentials.serviceCredentialsEnabled,\n          serviceCredentials,\n        },\n        oauthPassThru: true,\n        disableGrafanaCache: true,\n      },\n      secureJsonData: {\n        ...options.secureJsonData,\n        clientSecret: typeof clientSecret === 'string' ? clientSecret : undefined,\n      },\n      secureJsonFields: {\n        ...options.secureJsonFields,\n        clientSecret: typeof clientSecret === 'symbol',\n      },\n    };\n  }\n  return options;\n}\n","import { E2ESelectors } from '@grafana/e2e-selectors';\n\nexport const components = {\n  configEditor: {\n    authType: {\n      select: 'data-testid auth-type',\n    },\n    azureCloud: {\n      input: 'data-testid azure-cloud',\n    },\n    tenantID: {\n      input: 'data-testid tenant-id',\n    },\n    clientID: {\n      input: 'data-testid client-id',\n    },\n    clientSecret: {\n      input: 'data-testid client-secret',\n    },\n    loadSubscriptions: {\n      button: 'data-testid load-subscriptions',\n    },\n    defaultSubscription: {\n      input: 'data-testid default-subscription',\n    },\n    serviceCredentialsEnabled: {\n      button: 'data-testid service-credentials-enabled',\n    },\n  },\n  queryEditor: {\n    header: {\n      select: 'data-testid azure-monitor-experimental-header',\n    },\n    userAuthAlert: 'data-testid azure-monitor-user-auth-invalid-auth-provider-alert',\n    userAuthFallbackAlert: 'data-testid azure-monitor-user-auth-fallback-alert',\n    resourcePicker: {\n      select: {\n        button: 'data-testid resource-picker-select',\n      },\n      search: {\n        input: 'data-testid resource-picker-search',\n      },\n      apply: {\n        button: 'data-testid resource-picker-apply',\n      },\n      cancel: {\n        button: 'data-testid resource-picker-cancel',\n      },\n      advanced: {\n        collapse: 'data-testid resource-picker-advanced',\n        subscription: {\n          input: 'data-testid resource-picker-subscription',\n        },\n        resourceGroup: {\n          input: 'data-testid resource-picker-resource-group',\n        },\n        namespace: {\n          input: 'data-testid resource-picker-namespace',\n        },\n        region: {\n          input: 'data-testid resource-picker-region',\n        },\n        resource: {\n          input: 'data-testid resource-picker-resource',\n        },\n      },\n    },\n    metricsQueryEditor: {\n      container: { input: 'data-testid azure-monitor-metrics-query-editor-with-experimental-ui' },\n      metricName: {\n        input: 'data-testid metric-name',\n      },\n    },\n    logsQueryEditor: {\n      container: { input: 'data-testid azure-monitor-logs-query-editor-with-experimental-ui' },\n      formatSelection: {\n        input: 'data-testid format-selection',\n      },\n    },\n    argsQueryEditor: {\n      container: {\n        input: 'data-testid azure-monitor-arg-query-editor',\n      },\n      subscriptions: {\n        input: 'data-testid azure-monitor-args-subscription',\n      },\n    },\n    tracesQueryEditor: {\n      container: {\n        input: 'data-testid azure-monitor-traces-query-editor-with-experimental-ui',\n      },\n      traceTypes: {\n        select: 'data-testid azure-monitor-traces-query-editor-trace-types',\n      },\n    },\n  },\n  variableEditor: {\n    queryType: {\n      input: 'data-testid query-type',\n    },\n    subscription: {\n      input: 'data-testid subscription',\n    },\n    resourceGroup: {\n      input: 'data-testid resource-group',\n    },\n    namespace: {\n      input: 'data-testid namespace',\n    },\n    resource: {\n      input: 'data-testid resource',\n    },\n    region: {\n      input: 'data-testid region',\n    },\n  },\n};\n\nexport const selectors: { components: E2ESelectors<typeof components> } = {\n  components: components,\n};\n","import { ChangeEvent } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Field, Select, Input, Button } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\nimport { AzureClientSecretCredentials, AzureCredentials } from '../../types';\n\nexport interface AppRegistrationCredentialsProps {\n  credentials: AzureClientSecretCredentials;\n  azureCloudOptions?: SelectableValue[];\n  onCredentialsChange: (updatedCredentials: AzureCredentials) => void;\n  disabled?: boolean;\n}\n\nexport const AppRegistrationCredentials = (props: AppRegistrationCredentialsProps) => {\n  const { azureCloudOptions, disabled, credentials, onCredentialsChange } = props;\n\n  const onAzureCloudChange = (selected: SelectableValue<string>) => {\n    const updated: AzureCredentials = {\n      ...credentials,\n      azureCloud: selected.value,\n    };\n    onCredentialsChange(updated);\n  };\n\n  const onTenantIdChange = (event: ChangeEvent<HTMLInputElement>) => {\n    const updated: AzureCredentials = {\n      ...credentials,\n      tenantId: event.target.value,\n    };\n    onCredentialsChange(updated);\n  };\n\n  const onClientIdChange = (event: ChangeEvent<HTMLInputElement>) => {\n    const updated: AzureCredentials = {\n      ...credentials,\n      clientId: event.target.value,\n    };\n    onCredentialsChange(updated);\n  };\n\n  const onClientSecretChange = (event: ChangeEvent<HTMLInputElement>) => {\n    const updated: AzureCredentials = {\n      ...credentials,\n      clientSecret: event.target.value,\n    };\n    onCredentialsChange(updated);\n  };\n\n  const onClientSecretReset = () => {\n    const updated: AzureCredentials = {\n      ...credentials,\n      clientSecret: '',\n    };\n    onCredentialsChange(updated);\n  };\n\n  return (\n    <>\n      {azureCloudOptions && (\n        <Field\n          label=\"Azure Cloud\"\n          data-testid={selectors.components.configEditor.azureCloud.input}\n          htmlFor=\"azure-cloud-type\"\n          disabled={disabled}\n        >\n          <Select\n            inputId=\"azure-cloud-type\"\n            aria-label=\"Azure Cloud\"\n            className=\"width-15\"\n            value={azureCloudOptions.find((opt) => opt.value === credentials.azureCloud)}\n            options={azureCloudOptions}\n            onChange={onAzureCloudChange}\n          />\n        </Field>\n      )}\n      <Field\n        label=\"Directory (tenant) ID\"\n        required={credentials.authType === 'clientsecret'}\n        data-testid={selectors.components.configEditor.tenantID.input}\n        htmlFor=\"tenant-id\"\n        invalid={credentials.authType === 'clientsecret' && !credentials.tenantId}\n        error={'Tenant ID is required'}\n      >\n        <Input\n          aria-label=\"Tenant ID\"\n          className=\"width-30\"\n          placeholder=\"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\"\n          value={credentials.tenantId || ''}\n          onChange={onTenantIdChange}\n          disabled={disabled}\n        />\n      </Field>\n      <Field\n        label=\"Application (client) ID\"\n        required={credentials.authType === 'clientsecret'}\n        data-testid={selectors.components.configEditor.clientID.input}\n        htmlFor=\"client-id\"\n        invalid={credentials.authType === 'clientsecret' && !credentials.clientId}\n        error={'Client ID is required'}\n      >\n        <Input\n          className=\"width-30\"\n          aria-label=\"Client ID\"\n          placeholder=\"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\"\n          value={credentials.clientId || ''}\n          onChange={onClientIdChange}\n          disabled={disabled}\n        />\n      </Field>\n      {!disabled &&\n        (typeof credentials.clientSecret === 'symbol' ? (\n          <Field label=\"Client Secret\" htmlFor=\"client-secret\" required>\n            <div className=\"width-30\" style={{ display: 'flex', gap: '4px' }}>\n              <Input\n                aria-label=\"Client Secret\"\n                placeholder=\"configured\"\n                disabled={true}\n                data-testid={'client-secret'}\n              />\n              <Button variant=\"secondary\" type=\"button\" onClick={onClientSecretReset} disabled={disabled}>\n                Reset\n              </Button>\n            </div>\n          </Field>\n        ) : (\n          <Field\n            label=\"Client Secret\"\n            data-testid={selectors.components.configEditor.clientSecret.input}\n            required\n            htmlFor=\"client-secret\"\n            invalid={!credentials.clientSecret}\n            error={'Client secret is required'}\n          >\n            <Input\n              className=\"width-30\"\n              aria-label=\"Client Secret\"\n              placeholder=\"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\"\n              value={credentials.clientSecret || ''}\n              onChange={onClientSecretChange}\n              id=\"client-secret\"\n              disabled={disabled}\n            />\n          </Field>\n        ))}\n    </>\n  );\n};\n","import { useMemo } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { ConfigSection } from '@grafana/experimental';\nimport { config } from '@grafana/runtime';\nimport { Select, Field, RadioButtonGroup, Alert, Stack } from '@grafana/ui';\n\nimport { instanceOfAzureCredential } from '../../credentials';\nimport { selectors } from '../../e2e/selectors';\nimport { AadCurrentUserCredentials, AzureAuthType, AzureCredentials } from '../../types';\n\nimport { AppRegistrationCredentials } from './AppRegistrationCredentials';\n\nexport interface Props {\n  managedIdentityEnabled: boolean;\n  workloadIdentityEnabled: boolean;\n  userIdentityEnabled: boolean;\n  credentials: AadCurrentUserCredentials;\n  azureCloudOptions?: SelectableValue[];\n  onCredentialsChange: (updatedCredentials: AzureCredentials) => void;\n  disabled?: boolean;\n  children?: JSX.Element;\n}\n\nexport const CurrentUserFallbackCredentials = (props: Props) => {\n  const {\n    credentials,\n    azureCloudOptions,\n    onCredentialsChange,\n    disabled,\n    managedIdentityEnabled,\n    workloadIdentityEnabled,\n  } = props;\n\n  const authTypeOptions = useMemo(() => {\n    let opts: Array<SelectableValue<Exclude<AzureAuthType, 'currentuser'>>> = [\n      {\n        value: 'clientsecret',\n        label: 'App Registration',\n      },\n    ];\n\n    if (managedIdentityEnabled) {\n      opts.push({\n        value: 'msi',\n        label: 'Managed Identity',\n      });\n    }\n\n    if (workloadIdentityEnabled) {\n      opts.push({\n        value: 'workloadidentity',\n        label: 'Workload Identity',\n      });\n    }\n\n    return opts;\n  }, [managedIdentityEnabled, workloadIdentityEnabled]);\n\n  const onAuthTypeChange = (selected: SelectableValue<Exclude<AzureAuthType, 'currentuser'>>) => {\n    const defaultAuthType = managedIdentityEnabled\n      ? 'msi'\n      : workloadIdentityEnabled\n        ? 'workloadidentity'\n        : 'clientsecret';\n    const updated: AadCurrentUserCredentials = {\n      ...credentials,\n      serviceCredentials: {\n        authType: selected.value || defaultAuthType,\n      },\n    };\n    onCredentialsChange(updated);\n  };\n\n  const onServiceCredentialsEnabledChange = (value: boolean) => {\n    let updated: AzureCredentials = {\n      ...credentials,\n      serviceCredentialsEnabled: value,\n    };\n    if (!value) {\n      updated = { ...updated, serviceCredentials: undefined };\n    }\n    onCredentialsChange(updated);\n  };\n\n  const onServiceCredentialsChange = (serviceCredentials: AzureCredentials) => {\n    if (!instanceOfAzureCredential('currentuser', serviceCredentials)) {\n      onCredentialsChange({ ...credentials, serviceCredentials: serviceCredentials });\n    }\n  };\n\n  if (!config.azure.userIdentityFallbackCredentialsEnabled) {\n    return (\n      <Alert severity=\"info\" title=\"Fallback Credentials Disabled\">\n        <>\n          Fallback credentials have been disabled. As user-based authentication only inherently supports requests with a\n          user in scope, features such as alerting, recorded queries, or reporting will not function as expected. Please\n          review the{' '}\n          <a\n            href=\"https://grafana.com/docs/grafana/latest/datasources/azuremonitor/deprecated-application-insights/\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n          >\n            documentation\n          </a>{' '}\n          for more details.\n        </>\n      </Alert>\n    );\n  }\n\n  return (\n    <ConfigSection title=\"Fallback Service Credentials\" isCollapsible={true}>\n      <Alert severity=\"info\" title=\"Service Credentials\">\n        <Stack direction={'column'}>\n          <div>\n            User-based authentication does not inherently support Grafana features that make requests to the data source\n            without a users details available to the request. An example of this is alerting. If you wish to ensure that\n            features that do not have a user in the context of the request still function, please provide fallback\n            credentials below.\n          </div>\n          <div>\n            <b>\n              Note: Features like alerting will be restricted to the access level of the fallback credentials rather\n              than the user. This may present confusion for users and should be clarified.\n            </b>\n          </div>\n        </Stack>\n      </Alert>\n      <Field\n        label=\"Service Credentials\"\n        description=\"Choose if fallback service credentials are enabled or disabled for this data source\"\n        data-testid={selectors.components.configEditor.serviceCredentialsEnabled.button}\n      >\n        <RadioButtonGroup\n          options={[\n            { label: 'Enabled', value: true },\n            { label: 'Disabled', value: false },\n          ]}\n          value={credentials.serviceCredentialsEnabled ?? false}\n          size={'md'}\n          onChange={(val) => onServiceCredentialsEnabledChange(val)}\n        />\n      </Field>\n      {credentials.serviceCredentialsEnabled ? (\n        <>\n          {authTypeOptions.length > 0 && (\n            <Field\n              label=\"Authentication\"\n              description=\"Choose the type of authentication to Azure services\"\n              data-testid={selectors.components.configEditor.authType.select}\n              htmlFor=\"authentication-type\"\n            >\n              <Select\n                className=\"width-15\"\n                value={authTypeOptions.find((opt) => opt.value === credentials.serviceCredentials?.authType)}\n                options={authTypeOptions}\n                onChange={onAuthTypeChange}\n                disabled={disabled}\n              />\n            </Field>\n          )}\n          {credentials.serviceCredentials?.authType === 'clientsecret' && (\n            <AppRegistrationCredentials\n              credentials={credentials.serviceCredentials}\n              azureCloudOptions={azureCloudOptions}\n              onCredentialsChange={onServiceCredentialsChange}\n              disabled={disabled}\n            />\n          )}\n        </>\n      ) : null}\n      {props.children}\n    </ConfigSection>\n  );\n};\n\nexport default CurrentUserFallbackCredentials;\n","import { useMemo } from 'react';\n\nimport { getAzureClouds } from '@grafana/azure-sdk';\nimport { SelectableValue } from '@grafana/data';\nimport { ConfigSection } from '@grafana/experimental';\nimport { Select, Field } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\nimport { AzureAuthType, AzureCredentials } from '../../types';\n\nimport { AppRegistrationCredentials } from './AppRegistrationCredentials';\nimport CurrentUserFallbackCredentials from './CurrentUserFallbackCredentials';\n\nexport interface Props {\n  managedIdentityEnabled: boolean;\n  workloadIdentityEnabled: boolean;\n  userIdentityEnabled: boolean;\n  credentials: AzureCredentials;\n  azureCloudOptions?: SelectableValue[];\n  onCredentialsChange: (updatedCredentials: AzureCredentials) => void;\n  disabled?: boolean;\n  children?: JSX.Element;\n}\n\nexport function getAzureCloudOptions(): Array<SelectableValue<string>> {\n  const cloudInfo = getAzureClouds();\n\n  return cloudInfo.map((cloud) => ({\n    value: cloud.name,\n    label: cloud.displayName,\n  }));\n}\n\nexport const AzureCredentialsForm = (props: Props) => {\n  const {\n    credentials,\n    onCredentialsChange,\n    disabled,\n    managedIdentityEnabled,\n    workloadIdentityEnabled,\n    userIdentityEnabled,\n  } = props;\n\n  const authTypeOptions = useMemo(() => {\n    let opts: Array<SelectableValue<AzureAuthType>> = [\n      {\n        value: 'clientsecret',\n        label: 'App Registration',\n      },\n    ];\n\n    if (managedIdentityEnabled) {\n      opts.push({\n        value: 'msi',\n        label: 'Managed Identity',\n      });\n    }\n\n    if (workloadIdentityEnabled) {\n      opts.push({\n        value: 'workloadidentity',\n        label: 'Workload Identity',\n      });\n    }\n\n    if (userIdentityEnabled) {\n      opts.unshift({\n        value: 'currentuser',\n        label: 'Current User',\n      });\n    }\n\n    return opts;\n  }, [managedIdentityEnabled, workloadIdentityEnabled, userIdentityEnabled]);\n\n  const onAuthTypeChange = (selected: SelectableValue<AzureAuthType>) => {\n    const defaultAuthType = managedIdentityEnabled\n      ? 'msi'\n      : workloadIdentityEnabled\n        ? 'workloadidentity'\n        : userIdentityEnabled\n          ? 'currentuser'\n          : 'clientsecret';\n    const updated: AzureCredentials = {\n      ...credentials,\n      authType: selected.value || defaultAuthType,\n    };\n    onCredentialsChange(updated);\n  };\n\n  return (\n    <ConfigSection title=\"Authentication\">\n      {authTypeOptions.length > 1 && (\n        <Field\n          label=\"Authentication\"\n          description=\"Choose the type of authentication to Azure services\"\n          data-testid={selectors.components.configEditor.authType.select}\n          htmlFor=\"authentication-type\"\n        >\n          <Select\n            className=\"width-15\"\n            value={authTypeOptions.find((opt) => opt.value === credentials.authType)}\n            options={authTypeOptions}\n            onChange={onAuthTypeChange}\n            disabled={disabled}\n          />\n        </Field>\n      )}\n      {credentials.authType === 'clientsecret' && (\n        <AppRegistrationCredentials\n          credentials={credentials}\n          azureCloudOptions={getAzureCloudOptions()}\n          onCredentialsChange={onCredentialsChange}\n          disabled={disabled}\n        />\n      )}\n      {props.children}\n      {credentials.authType === 'currentuser' && (\n        <CurrentUserFallbackCredentials\n          credentials={credentials}\n          azureCloudOptions={getAzureCloudOptions()}\n          onCredentialsChange={onCredentialsChange}\n          disabled={disabled}\n          managedIdentityEnabled={managedIdentityEnabled}\n          workloadIdentityEnabled={workloadIdentityEnabled}\n          userIdentityEnabled={userIdentityEnabled}\n        />\n      )}\n    </ConfigSection>\n  );\n};\n\nexport default AzureCredentialsForm;\n","import { css } from '@emotion/css';\nimport * as React from 'react';\n\nimport { Field, Switch, useTheme2 } from '@grafana/ui';\n\nimport { AzureDataSourceJsonData } from '../../types';\n\nexport interface Props {\n  options: AzureDataSourceJsonData;\n  onBasicLogsEnabledChange: (basicLogsEnabled: boolean) => void;\n}\n\nexport const BasicLogsToggle = (props: Props) => {\n  const { options, onBasicLogsEnabledChange } = props;\n\n  const theme = useTheme2();\n  const styles = {\n    text: css({\n      ...theme.typography.body,\n      color: theme.colors.text.secondary,\n      fontSize: '11px',\n      a: css({\n        color: theme.colors.text.link,\n        textDecoration: 'underline',\n        '&:hover': {\n          textDecoration: 'none',\n        },\n      }),\n    }),\n  };\n  const onChange = (e: React.ChangeEvent<HTMLInputElement>) => onBasicLogsEnabledChange(e.target.checked);\n  const description = (\n    <p className={styles.text}>\n      Enabling this feature incurs Azure Monitor per-query costs on dashboard panels that query tables configured for{' '}\n      <a\n        href=\"https://learn.microsoft.com/en-us/azure/azure-monitor/logs/basic-logs-configure?tabs=portal-1\"\n        target=\"__blank\"\n        rel=\"noreferrer\"\n      >\n        Basic Logs\n      </a>\n      .\n    </p>\n  );\n  return (\n    <Field description={description} label=\"Enable Basic Logs\">\n      <div>\n        <Switch aria-label=\"Basic Logs\" onChange={onChange} value={options.basicLogsEnabled ?? false} />\n      </div>\n    </Field>\n  );\n};\n","import { useEffect, useReducer } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Select, Button, Field } from '@grafana/ui';\n\nimport { isCredentialsComplete } from '../../credentials';\nimport { selectors } from '../../e2e/selectors';\nimport { AzureCredentials, AzureDataSourceJsonData } from '../../types';\n\nexport interface Props {\n  options: AzureDataSourceJsonData;\n  credentials: AzureCredentials;\n  getSubscriptions?: () => Promise<SelectableValue[]>;\n  subscriptions: Array<SelectableValue<string>>;\n  onSubscriptionsChange: (receivedSubscriptions: Array<SelectableValue<string>>) => void;\n  onSubscriptionChange: (subscriptionId?: string) => void;\n  disabled?: boolean;\n}\n\nexport const DefaultSubscription = (props: Props) => {\n  const {\n    credentials,\n    disabled,\n    options,\n    subscriptions,\n    getSubscriptions,\n    onSubscriptionChange,\n    onSubscriptionsChange,\n  } = props;\n  const hasRequiredFields = isCredentialsComplete(credentials);\n  const [loadSubscriptionsClicked, onLoadSubscriptions] = useReducer((val) => val + 1, 0);\n\n  useEffect(() => {\n    if (!getSubscriptions || !hasRequiredFields) {\n      updateSubscriptions([]);\n      return;\n    }\n    let canceled = false;\n    getSubscriptions().then((result) => {\n      if (!canceled) {\n        updateSubscriptions(result, loadSubscriptionsClicked);\n      }\n    });\n    return () => {\n      canceled = true;\n    };\n    // This effect is intended to be called only once initially and on Load Subscriptions click\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [loadSubscriptionsClicked]);\n\n  const updateSubscriptions = (received: Array<SelectableValue<string>>, autoSelect = false) => {\n    onSubscriptionsChange(received);\n    if (getSubscriptions) {\n      if (autoSelect && !options.subscriptionId && received.length > 0) {\n        // Selecting the default subscription if subscriptions received but no default subscription selected\n        onChange(received[0]);\n      } else if (options.subscriptionId) {\n        const found = received.find((opt) => opt.value === options.subscriptionId);\n        if (!found) {\n          // Unselecting the default subscription if it isn't found among the received subscriptions\n          onChange(undefined);\n        }\n      }\n    }\n  };\n\n  const onChange = (selected: SelectableValue<string> | undefined) => onSubscriptionChange(selected?.value);\n\n  return (\n    <>\n      <Field\n        label=\"Default Subscription\"\n        data-testid={selectors.components.configEditor.defaultSubscription.input}\n        htmlFor=\"default-subscription\"\n      >\n        <div className=\"width-30\" style={{ display: 'flex', gap: '4px' }}>\n          <Select\n            inputId=\"default-subscription\"\n            aria-label=\"Default Subscription\"\n            value={\n              options.subscriptionId ? subscriptions.find((opt) => opt.value === options.subscriptionId) : undefined\n            }\n            options={subscriptions}\n            onChange={onChange}\n            disabled={disabled}\n          />\n          <Button\n            variant=\"secondary\"\n            type=\"button\"\n            onClick={onLoadSubscriptions}\n            disabled={!hasRequiredFields || disabled}\n            data-testid={selectors.components.configEditor.loadSubscriptions.button}\n          >\n            Load Subscriptions\n          </Button>\n        </div>\n      </Field>\n    </>\n  );\n};\n","import { useMemo, useState } from 'react';\nimport { useEffectOnce } from 'react-use';\n\nimport { SelectableValue } from '@grafana/data';\nimport { config } from '@grafana/runtime';\n\nimport { getCredentials, updateCredentials } from '../../credentials';\nimport { AzureDataSourceSettings, AzureCredentials } from '../../types';\n\nimport { AzureCredentialsForm, getAzureCloudOptions } from './AzureCredentialsForm';\nimport { BasicLogsToggle } from './BasicLogsToggle';\nimport { DefaultSubscription } from './DefaultSubscription';\n\nexport interface Props {\n  options: AzureDataSourceSettings;\n  updateOptions: (optionsFunc: (options: AzureDataSourceSettings) => AzureDataSourceSettings) => void;\n  getSubscriptions: () => Promise<Array<SelectableValue<string>>>;\n}\n\nexport const MonitorConfig = (props: Props) => {\n  const { updateOptions, getSubscriptions, options } = props;\n  const [subscriptions, setSubscriptions] = useState<Array<SelectableValue<string>>>([]);\n  const credentials = useMemo(() => getCredentials(props.options), [props.options]);\n\n  const onCredentialsChange = (credentials: AzureCredentials, subscriptionId?: string): void => {\n    if (!subscriptionId) {\n      setSubscriptions([]);\n    }\n    updateOptions((options) =>\n      updateCredentials({ ...options, jsonData: { ...options.jsonData, subscriptionId } }, credentials)\n    );\n  };\n\n  const onSubscriptionsChange = (receivedSubscriptions: Array<SelectableValue<string>>) =>\n    setSubscriptions(receivedSubscriptions);\n\n  const onSubscriptionChange = (subscriptionId?: string) =>\n    updateOptions((options) => ({ ...options, jsonData: { ...options.jsonData, subscriptionId } }));\n\n  const onBasicLogsEnabledChange = (enableBasicLogs: boolean) =>\n    updateOptions((options) => ({ ...options, jsonData: { ...options.jsonData, basicLogsEnabled: enableBasicLogs } }));\n\n  // The auth type needs to be set on the first load of the data source\n  useEffectOnce(() => {\n    if (!options.jsonData.authType || !credentials.authType) {\n      onCredentialsChange(credentials, options.jsonData.subscriptionId);\n    }\n  });\n\n  return (\n    <>\n      <AzureCredentialsForm\n        managedIdentityEnabled={config.azure.managedIdentityEnabled}\n        workloadIdentityEnabled={config.azure.workloadIdentityEnabled}\n        userIdentityEnabled={config.azure.userIdentityEnabled}\n        credentials={credentials}\n        azureCloudOptions={getAzureCloudOptions()}\n        onCredentialsChange={onCredentialsChange}\n        disabled={props.options.readOnly}\n      >\n        <>\n          <DefaultSubscription\n            subscriptions={subscriptions}\n            credentials={credentials}\n            getSubscriptions={getSubscriptions}\n            disabled={props.options.readOnly}\n            onSubscriptionsChange={onSubscriptionsChange}\n            onSubscriptionChange={onSubscriptionChange}\n            options={options.jsonData}\n          />\n          <BasicLogsToggle options={options.jsonData} onBasicLogsEnabledChange={onBasicLogsEnabledChange} />\n        </>\n      </AzureCredentialsForm>\n    </>\n  );\n};\n\nexport default MonitorConfig;\n","import { PureComponent } from 'react';\n\nimport { DataSourcePluginOptionsEditorProps, SelectableValue, updateDatasourcePluginOption } from '@grafana/data';\nimport { ConfigSection, DataSourceDescription } from '@grafana/experimental';\nimport { getBackendSrv, getTemplateSrv, isFetchError, TemplateSrv, config } from '@grafana/runtime';\nimport { Alert, Divider, SecureSocksProxySettings } from '@grafana/ui';\n\nimport ResponseParser from '../../azure_monitor/response_parser';\nimport {\n  AzureAPIResponse,\n  AzureDataSourceJsonData,\n  AzureDataSourceSecureJsonData,\n  AzureDataSourceSettings,\n  Subscription,\n} from '../../types';\nimport { routeNames } from '../../utils/common';\n\nimport { MonitorConfig } from './MonitorConfig';\n\nexport type Props = DataSourcePluginOptionsEditorProps<AzureDataSourceJsonData, AzureDataSourceSecureJsonData>;\n\ninterface ErrorMessage {\n  title: string;\n  description: string;\n  details?: string;\n}\n\nexport interface State {\n  unsaved: boolean;\n  error?: ErrorMessage;\n}\n\nexport class ConfigEditor extends PureComponent<Props, State> {\n  templateSrv: TemplateSrv = getTemplateSrv();\n  baseURL: string;\n\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      unsaved: false,\n    };\n    this.baseURL = `/api/datasources/${this.props.options.id}/resources/${routeNames.azureMonitor}/subscriptions`;\n  }\n\n  private updateOptions = (optionsFunc: (options: AzureDataSourceSettings) => AzureDataSourceSettings): void => {\n    const updated = optionsFunc(this.props.options);\n    this.props.onOptionsChange(updated);\n\n    this.setState({ unsaved: true });\n  };\n\n  private saveOptions = async (): Promise<void> => {\n    if (this.state.unsaved) {\n      await getBackendSrv()\n        .put(`/api/datasources/${this.props.options.id}`, this.props.options)\n        .then((result: { datasource: AzureDataSourceSettings }) => {\n          updateDatasourcePluginOption(this.props, 'version', result.datasource.version);\n        });\n\n      this.setState({ unsaved: false });\n    }\n  };\n\n  private getSubscriptions = async (): Promise<Array<SelectableValue<string>>> => {\n    await this.saveOptions();\n\n    const query = `?api-version=2019-03-01`;\n    try {\n      const result = await getBackendSrv()\n        .fetch<AzureAPIResponse<Subscription>>({\n          url: this.baseURL + query,\n          method: 'GET',\n        })\n        .toPromise();\n\n      this.setState({ error: undefined });\n      return ResponseParser.parseSubscriptionsForSelect(result);\n    } catch (err) {\n      if (isFetchError(err)) {\n        this.setState({\n          error: {\n            title: 'Error requesting subscriptions',\n            description: 'Could not request subscriptions from Azure. Check your credentials and try again.',\n            details: err?.data?.message,\n          },\n        });\n      }\n      return Promise.resolve([]);\n    }\n  };\n\n  render() {\n    const { options, onOptionsChange } = this.props;\n    const { error } = this.state;\n\n    return (\n      <>\n        <DataSourceDescription\n          dataSourceName=\"Azure Monitor\"\n          docsLink=\"https://grafana.com/docs/grafana/latest/datasources/azure-monitor/\"\n          hasRequiredFields\n        />\n        <Divider />\n        <MonitorConfig options={options} updateOptions={this.updateOptions} getSubscriptions={this.getSubscriptions} />\n        {error && (\n          <Alert severity=\"error\" title={error.title}>\n            <p>{error.description}</p>\n            {error.details && <details style={{ whiteSpace: 'pre-wrap' }}>{error.details}</details>}\n          </Alert>\n        )}\n        {config.secureSocksDSProxyEnabled && (\n          <>\n            <Divider />\n            <ConfigSection\n              title=\"Additional settings\"\n              description=\"Additional settings are optional settings that can be configured for more control over your data source. This includes Secure Socks Proxy.\"\n              isCollapsible={true}\n              isInitiallyOpen={options.jsonData.enableSecureSocksProxy !== undefined}\n            >\n              <SecureSocksProxySettings options={options} onOptionsChange={onOptionsChange} />\n            </ConfigSection>\n          </>\n        )}\n      </>\n    );\n  }\n}\n\nexport default ConfigEditor;\n","import { isValidElement } from 'react';\n\nimport { AzureMonitorErrorish } from '../types';\n\nexport function messageFromElement(error: AzureMonitorErrorish): AzureMonitorErrorish | undefined {\n  if (isValidElement(error)) {\n    return error;\n  } else {\n    return messageFromError(error);\n  }\n}\n\nexport default function messageFromError(error: any): string | undefined {\n  if (!error || typeof error !== 'object') {\n    return undefined;\n  }\n\n  if (typeof error.message === 'string') {\n    return error.message;\n  }\n\n  if (typeof error.data?.error?.message === 'string') {\n    return error.data.error.message;\n  }\n\n  // Copied from the old Angular code - this might be checking for errors in places\n  // that the new code just doesnt use.\n  // As new error objects are discovered they should be added to the above code, rather\n  // than below\n  const maybeAMessage =\n    error.error?.data?.error?.innererror?.innererror?.message ||\n    error.error?.data?.error?.innererror?.message ||\n    error.error?.data?.error?.message ||\n    error.error?.data?.message ||\n    error.data?.message ||\n    error;\n\n  if (typeof maybeAMessage === 'string') {\n    return maybeAMessage;\n  } else if (maybeAMessage && maybeAMessage.toString) {\n    return maybeAMessage.toString();\n  }\n\n  return undefined;\n}\n","import { useState, useCallback, useMemo } from 'react';\n\nimport { AzureMonitorErrorish } from '../types';\n\nimport { messageFromElement } from './messageFromError';\n\ntype SourcedError = [string, AzureMonitorErrorish];\n\nexport default function useLastError() {\n  const [errors, setErrors] = useState<SourcedError[]>([]);\n\n  // Handles errors from any child components that request data to display their options\n  const addError = useCallback((errorSource: string, error: AzureMonitorErrorish | undefined) => {\n    setErrors((errors) => {\n      const errorsCopy = [...errors];\n      const index = errors.findIndex(([vSource]) => vSource === errorSource);\n\n      // If there's already an error, remove it. If we're setting a new error\n      // below, we'll move it to the front\n      if (index > -1) {\n        errorsCopy.splice(index, 1);\n      }\n\n      // And then add the new error to the top of the array. If error is defined, it was already\n      // removed above.\n      if (error) {\n        errorsCopy.unshift([errorSource, error]);\n      }\n\n      return errorsCopy;\n    });\n  }, []);\n\n  const errorMessage = useMemo(() => {\n    const recentError = errors[0];\n    return recentError && messageFromElement(recentError[1]);\n  }, [errors]);\n\n  return [errorMessage, addError] as const;\n}\n","import { css } from '@emotion/css';\nimport React, { useCallback } from 'react';\nimport { useStyles2 } from '@grafana/ui';\n\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst Stack = (_a) => {\n  var _b = _a, { children } = _b, props = __objRest(_b, [\"children\"]);\n  const styles = useStyles2(useCallback((theme) => getStyles(theme, props), [props]));\n  return /* @__PURE__ */ React.createElement(\"div\", { className: styles.root }, children);\n};\nconst getStyles = (theme, props) => {\n  var _a, _b, _c;\n  return {\n    root: css({\n      display: \"flex\",\n      flexDirection: (_a = props.direction) != null ? _a : \"row\",\n      flexWrap: ((_b = props.wrap) != null ? _b : true) ? \"wrap\" : void 0,\n      alignItems: props.alignItems,\n      gap: theme.spacing((_c = props.gap) != null ? _c : 2),\n      flexGrow: props.flexGrow\n    })\n  };\n};\n\nexport { Stack };\n//# sourceMappingURL=Stack.js.map\n","import React from 'react';\nimport { Stack } from './Stack.js';\n\nconst EditorRows = ({ children }) => {\n  return /* @__PURE__ */ React.createElement(Stack, { gap: 0.5, direction: \"column\" }, children);\n};\n\nexport { EditorRows };\n//# sourceMappingURL=EditorRows.js.map\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport { Stack } from './Stack.js';\nimport { useStyles2 } from '@grafana/ui';\n\nconst EditorRow = ({ children }) => {\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React.createElement(\"div\", { className: styles.root }, /* @__PURE__ */ React.createElement(Stack, { gap: 2 }, children));\n};\nconst getStyles = (theme) => {\n  return {\n    root: css({\n      padding: theme.spacing(1),\n      backgroundColor: theme.colors.background.secondary,\n      borderRadius: theme.shape.borderRadius(1)\n    })\n  };\n};\n\nexport { EditorRow };\n//# sourceMappingURL=EditorRow.js.map\n","import React from 'react';\nimport { Stack } from './Stack.js';\n\nconst EditorFieldGroup = ({ children }) => {\n  return /* @__PURE__ */ React.createElement(Stack, { gap: 1 }, children);\n};\n\nexport { EditorFieldGroup };\n//# sourceMappingURL=EditorFieldGroup.js.map\n","import { useCallback } from 'react';\n\nimport { CodeEditor } from '@grafana/ui';\n\nimport { AzureQueryEditorFieldProps } from '../../types';\n\nconst QueryField = ({ query, onQueryChange }: AzureQueryEditorFieldProps) => {\n  const onChange = useCallback(\n    (newQuery: string) => {\n      onQueryChange({\n        ...query,\n        azureResourceGraph: {\n          ...query.azureResourceGraph,\n          query: newQuery,\n        },\n      });\n    },\n    [onQueryChange, query]\n  );\n\n  return (\n    <CodeEditor\n      value={query.azureResourceGraph?.query ?? ''}\n      language=\"kusto\"\n      height={200}\n      width=\"100%\"\n      showMiniMap={false}\n      onBlur={onChange}\n      onSave={onChange}\n    />\n  );\n};\n\nexport default QueryField;\n","import { cx, css } from '@emotion/css';\nimport React, { useCallback } from 'react';\nimport { useStyles2 } from '@grafana/ui';\n\nconst Space = ({\n  v = 0,\n  h = 0,\n  layout = \"block\"\n}) => {\n  const styles = useStyles2(useCallback((theme) => getStyles(theme, {\n    v,\n    h,\n    layout\n  }), [v, h, layout]));\n  return /* @__PURE__ */ React.createElement(\"span\", { className: cx(styles.wrapper) });\n};\nconst getStyles = (theme, props) => {\n  var _a, _b;\n  return {\n    wrapper: css([\n      {\n        paddingRight: theme.spacing((_a = props.h) != null ? _a : 0),\n        paddingBottom: theme.spacing((_b = props.v) != null ? _b : 0)\n      },\n      props.layout === \"inline\" && {\n        display: \"inline-block\"\n      },\n      props.layout === \"block\" && {\n        display: \"block\"\n      }\n    ])\n  };\n};\n\nexport { Space };\n//# sourceMappingURL=Space.js.map\n","import { css } from '@emotion/css';\nimport React, { useCallback } from 'react';\nimport { Space } from './Space.js';\nimport { useStyles2, ReactUtils, Tooltip, Icon, Field } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst EditorField = (props) => {\n  var _b;\n  const _a = props, { label, optional, tooltip, tooltipInteractive, children, width } = _a, fieldProps = __objRest(_a, [\"label\", \"optional\", \"tooltip\", \"tooltipInteractive\", \"children\", \"width\"]);\n  const styles = useStyles2(useCallback((theme) => getStyles(theme, width), [width]));\n  const childInputId = (fieldProps == null ? void 0 : fieldProps.htmlFor) || ((_b = ReactUtils) == null ? void 0 : _b.getChildId(children));\n  const labelEl = /* @__PURE__ */ React.createElement(React.Fragment, null, /* @__PURE__ */ React.createElement(\"label\", { className: styles.label, htmlFor: childInputId }, label, optional && /* @__PURE__ */ React.createElement(\"span\", { className: styles.optional }, \" - optional\"), tooltip && /* @__PURE__ */ React.createElement(Tooltip, { placement: \"top\", content: tooltip, theme: \"info\", interactive: tooltipInteractive }, /* @__PURE__ */ React.createElement(Icon, { tabIndex: 0, name: \"info-circle\", size: \"sm\", className: styles.icon }))), /* @__PURE__ */ React.createElement(Space, { v: 0.5 }));\n  return /* @__PURE__ */ React.createElement(\"div\", { className: styles.root }, /* @__PURE__ */ React.createElement(Field, __spreadValues({ className: styles.field, label: labelEl }, fieldProps), children));\n};\nconst getStyles = (theme, width) => {\n  return {\n    root: css({\n      minWidth: theme.spacing(width != null ? width : 0)\n    }),\n    label: css({\n      fontSize: 12,\n      fontWeight: theme.typography.fontWeightMedium\n    }),\n    optional: css({\n      fontStyle: \"italic\",\n      color: theme.colors.text.secondary\n    }),\n    field: css({\n      marginBottom: 0\n      // GrafanaUI/Field has a bottom margin which we must remove\n    }),\n    icon: css({\n      color: theme.colors.text.secondary,\n      marginLeft: theme.spacing(1),\n      \":hover\": {\n        color: theme.colors.text.primary\n      }\n    })\n  };\n};\n\nexport { EditorField };\n//# sourceMappingURL=EditorField.js.map\n","import { EditorField } from '@grafana/experimental';\nimport { InlineField } from '@grafana/ui';\nimport { Props as InlineFieldProps } from '@grafana/ui/src/components/Forms/InlineField';\n\ninterface Props extends InlineFieldProps {\n  label: string;\n  inlineField?: boolean;\n  labelWidth?: number;\n}\n\nconst DEFAULT_LABEL_WIDTH = 18;\n\nexport const Field = (props: Props) => {\n  const { labelWidth, inlineField, ...remainingProps } = props;\n\n  if (!inlineField) {\n    return <EditorField width={labelWidth || DEFAULT_LABEL_WIDTH} {...remainingProps} />;\n  } else {\n    return <InlineField labelWidth={labelWidth || DEFAULT_LABEL_WIDTH} {...remainingProps} />;\n  }\n};\n","import { useEffect, useMemo, useState } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { FieldValidationMessage, MultiSelect } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\nimport { AzureMonitorQuery, AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { findOptions } from '../../utils/common';\nimport { Field } from '../shared/Field';\n\ninterface SubscriptionFieldProps extends AzureQueryEditorFieldProps {\n  onQueryChange: (newQuery: AzureMonitorQuery) => void;\n  subscriptions: AzureMonitorOption[];\n}\n\nconst SubscriptionField = ({ query, subscriptions, variableOptionGroup, onQueryChange }: SubscriptionFieldProps) => {\n  const [error, setError] = useState<boolean>(false);\n  const [values, setValues] = useState<Array<SelectableValue<string>>>([]);\n  const options = useMemo(() => [...subscriptions, variableOptionGroup], [subscriptions, variableOptionGroup]);\n\n  useEffect(() => {\n    if (query.subscriptions && query.subscriptions.length > 0) {\n      setValues(findOptions([...subscriptions, ...variableOptionGroup.options], query.subscriptions));\n      setError(false);\n    } else {\n      setError(true);\n    }\n  }, [query.subscriptions, subscriptions, variableOptionGroup.options]);\n\n  const onChange = (change: Array<SelectableValue<string>>) => {\n    const containsSelectAll = change.filter((c) => c.value === 'Select all subscriptions');\n    if (!change || change.length === 0) {\n      setValues([]);\n      onQueryChange({\n        ...query,\n        subscriptions: [],\n      });\n      setError(true);\n    } else if (containsSelectAll.length > 0) {\n      const allSubs = subscriptions.map((c) => c.value ?? '').filter((c) => c !== 'Select all subscriptions');\n      onQueryChange({\n        ...query,\n        subscriptions: allSubs,\n      });\n    } else {\n      const newSubs = change.map((c) => c.value ?? '');\n      onQueryChange({\n        ...query,\n        subscriptions: newSubs,\n      });\n      setValues(findOptions([...subscriptions, ...variableOptionGroup.options], newSubs));\n      setError(false);\n    }\n  };\n\n  return (\n    <Field label=\"Subscriptions\" data-testid={selectors.components.queryEditor.argsQueryEditor.subscriptions.input}>\n      <>\n        <MultiSelect\n          isClearable\n          value={values}\n          inputId=\"azure-monitor-subscriptions-field\"\n          onChange={onChange}\n          options={options}\n          width={38}\n        />\n        {error ? <FieldValidationMessage>At least one subscription must be chosen.</FieldValidationMessage> : null}\n      </>\n    </Field>\n  );\n};\n\nexport default SubscriptionField;\n","import { intersection } from 'lodash';\nimport { useState, useMemo } from 'react';\n\nimport { EditorFieldGroup, EditorRow, EditorRows } from '@grafana/experimental';\n\nimport Datasource from '../../datasource';\nimport { selectors } from '../../e2e/selectors';\nimport { AzureMonitorErrorish, AzureMonitorOption, AzureMonitorQuery } from '../../types';\n\nimport QueryField from './QueryField';\nimport SubscriptionField from './SubscriptionField';\n\ninterface ArgQueryEditorProps {\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  subscriptionId?: string;\n  onChange: (newQuery: AzureMonitorQuery) => void;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n}\n\nconst ERROR_SOURCE = 'arg-subscriptions';\n\nfunction selectSubscriptions(\n  fetchedSubscriptions: string[],\n  currentSubscriptions?: string[],\n  currentSubscription?: string\n) {\n  let querySubscriptions = currentSubscriptions || [];\n  if (querySubscriptions.length === 0 && currentSubscription) {\n    querySubscriptions = [currentSubscription];\n  }\n  if (querySubscriptions.length === 0 && fetchedSubscriptions.length) {\n    querySubscriptions = [fetchedSubscriptions[0]];\n  }\n\n  const templateVars = querySubscriptions.filter((sub) => sub.includes('$'));\n  const commonSubscriptions = intersection(querySubscriptions, fetchedSubscriptions).concat(templateVars);\n  if (fetchedSubscriptions.length && querySubscriptions.length > commonSubscriptions.length) {\n    // If not all of the query subscriptions are in the list of fetched subscriptions, then\n    // select only the ones present (or the first one if none is present)\n    querySubscriptions = commonSubscriptions.length > 0 ? commonSubscriptions : [fetchedSubscriptions[0]];\n  }\n  return querySubscriptions;\n}\n\nconst ArgQueryEditor = ({\n  query,\n  datasource,\n  subscriptionId,\n  variableOptionGroup,\n  onChange,\n  setError,\n}: ArgQueryEditorProps) => {\n  const [subscriptions, setSubscriptions] = useState<AzureMonitorOption[]>([]);\n  useMemo(() => {\n    datasource\n      .getSubscriptions()\n      .then((results) => {\n        const selectAllSubscriptionOption = [\n          { label: 'Select all subscriptions', value: 'Select all subscriptions', description: 'Select all' },\n        ];\n        const fetchedSubscriptions = results.map((v) => ({ label: v.text, value: v.value, description: v.value }));\n        setSubscriptions(selectAllSubscriptionOption.concat(fetchedSubscriptions));\n        setError(ERROR_SOURCE, undefined);\n\n        onChange({\n          ...query,\n          subscriptions: selectSubscriptions(\n            fetchedSubscriptions.map((v) => v.value),\n            query.subscriptions,\n            query.subscription\n          ),\n        });\n      })\n      .catch((err) => setError(ERROR_SOURCE, err));\n    // We are only interested in re-fetching subscriptions if the data source changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [datasource]);\n\n  return (\n    <span data-testid={selectors.components.queryEditor.argsQueryEditor.container.input}>\n      <EditorRows>\n        <EditorRow>\n          <EditorFieldGroup>\n            <SubscriptionField\n              subscriptions={subscriptions}\n              query={query}\n              datasource={datasource}\n              subscriptionId={subscriptionId}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n            />\n          </EditorFieldGroup>\n        </EditorRow>\n      </EditorRows>\n      <QueryField\n        query={query}\n        datasource={datasource}\n        subscriptionId={subscriptionId}\n        variableOptionGroup={variableOptionGroup}\n        onQueryChange={onChange}\n        setError={setError}\n      />\n    </span>\n  );\n};\n\nexport default ArgQueryEditor;\n","import { useState } from 'react';\nimport * as React from 'react';\n\nimport { Collapse, Space } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\nimport { AzureMonitorResource } from '../../types';\n\nexport interface ResourcePickerProps<T> {\n  resources: T[];\n  onChange: (resources: T[]) => void;\n  renderAdvanced: (resources: T[], onChange: (resources: T[]) => void) => React.ReactNode;\n}\n\nconst AdvancedMulti = ({ resources, onChange, renderAdvanced }: ResourcePickerProps<string | AzureMonitorResource>) => {\n  const [isAdvancedOpen, setIsAdvancedOpen] = useState(!!resources.length && JSON.stringify(resources).includes('$'));\n\n  return (\n    <div data-testid={selectors.components.queryEditor.resourcePicker.advanced.collapse}>\n      <Collapse\n        collapsible\n        label=\"Advanced\"\n        isOpen={isAdvancedOpen}\n        onToggle={() => setIsAdvancedOpen(!isAdvancedOpen)}\n      >\n        {renderAdvanced(resources, onChange)}\n        <Space v={2} />\n      </Collapse>\n    </div>\n  );\n};\n\nexport default AdvancedMulti;\n","export enum ResourceRowType {\n  Subscription = 'Subscription',\n  ResourceGroup = 'ResourceGroup',\n  Resource = 'Resource',\n  VariableGroup = 'TemplateVariableGroup',\n  Variable = 'TemplateVariable',\n}\n\nexport interface ResourceRow {\n  id: string; // azure's raw data id usually passes along a uri (except in the case of subscriptions), to make things less confusing for ourselves we parse the id string out of the uri or vice versa\n  uri: string; // ex: /subscriptions/subid123\n  name: string;\n  type: ResourceRowType;\n  typeLabel: string;\n  location?: string;\n  children?: ResourceRowGroup;\n}\n\nexport type ResourceRowGroup = ResourceRow[];\n","import { Icon } from '@grafana/ui';\n\nimport { ResourceRow, ResourceRowType } from './types';\n\ninterface EntryIconProps {\n  entry: ResourceRow;\n  isOpen: boolean;\n}\n\nexport const EntryIcon = ({ isOpen, entry: { type } }: EntryIconProps) => {\n  switch (type) {\n    case ResourceRowType.Subscription:\n      return <Icon name=\"layer-group\" />;\n\n    case ResourceRowType.ResourceGroup:\n      return <Icon name={isOpen ? 'folder-open' : 'folder'} />;\n\n    case ResourceRowType.Resource:\n      return <Icon name=\"cube\" />;\n\n    case ResourceRowType.VariableGroup:\n      return <Icon name=\"x\" />;\n\n    case ResourceRowType.Variable:\n      return <Icon name=\"x\" />;\n\n    default:\n      return null;\n  }\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  table: css({\n    width: '100%',\n    tableLayout: 'fixed',\n    overflow: 'scroll',\n  }),\n\n  scrollableTable: css({\n    overflow: 'auto',\n  }),\n\n  tableScroller: css({\n    maxHeight: '16vh',\n  }),\n\n  selectedTableScroller: css({\n    maxHeight: '13vh',\n  }),\n\n  header: css({\n    background: theme.colors.background.secondary,\n  }),\n\n  row: css({\n    borderBottom: `1px solid ${theme.colors.border.weak}`,\n\n    '&:last-of-type': {\n      borderBottomColor: theme.colors.border.medium,\n    },\n  }),\n\n  disabledRow: css({\n    opacity: 0.5,\n  }),\n\n  cell: css({\n    padding: theme.spacing(1, 1, 1, 0),\n    width: '25%',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    '&:first-of-type': {\n      width: '50%',\n      padding: theme.spacing(1, 1, 1, 2),\n    },\n  }),\n\n  collapseButton: css({ margin: 0 }),\n\n  loadingCell: css({\n    textAlign: 'center',\n  }),\n\n  spinner: css({\n    marginBottom: 0,\n  }),\n\n  nestedEntry: css({\n    display: 'flex',\n    alignItems: 'center',\n  }),\n\n  entryContentItem: css({\n    margin: theme.spacing(0, 1, 0, 0),\n  }),\n\n  truncated: css({\n    minWidth: 0,\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n  }),\n\n  resourceField: css({\n    maxWidth: theme.spacing(36),\n    overflow: 'hidden',\n  }),\n\n  resourceFieldButton: css({\n    padding: '7px',\n    textAlign: 'left',\n  }),\n\n  nestedRowCheckbox: css({\n    zIndex: 0,\n  }),\n\n  selectionFooter: css({\n    background: theme.colors.background.primary,\n    paddingTop: theme.spacing(2),\n  }),\n\n  loadingWrapper: css({\n    textAlign: 'center',\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(2),\n    color: theme.colors.text.secondary,\n  }),\n\n  resultLimit: css({\n    margin: '4px 0',\n    fontStyle: 'italic',\n  }),\n\n  modal: css({\n    width: theme.breakpoints.values.lg,\n  }),\n});\n\nexport default getStyles;\n","import { cx } from '@emotion/css';\nimport { useCallback, useEffect } from 'react';\nimport * as React from 'react';\n\nimport { Checkbox, IconButton, useStyles2, useTheme2, Space } from '@grafana/ui';\n\nimport { EntryIcon } from './EntryIcon';\nimport getStyles from './styles';\nimport { ResourceRow } from './types';\n\ninterface NestedEntryProps {\n  level: number;\n  entry: ResourceRow;\n  isSelected: boolean;\n  isSelectable: boolean;\n  isOpen: boolean;\n  isDisabled: boolean;\n  scrollIntoView?: boolean;\n  onToggleCollapse: (row: ResourceRow) => void;\n  onSelectedChange: (row: ResourceRow, selected: boolean) => void;\n}\n\nexport const NestedEntry = ({\n  entry,\n  isSelected,\n  isDisabled,\n  isOpen,\n  isSelectable,\n  level,\n  scrollIntoView,\n  onToggleCollapse,\n  onSelectedChange,\n}: NestedEntryProps) => {\n  const theme = useTheme2();\n  const styles = useStyles2(getStyles);\n  const hasChildren = !!entry.children;\n\n  const handleToggleCollapse = useCallback(() => {\n    onToggleCollapse(entry);\n  }, [onToggleCollapse, entry]);\n\n  const handleSelectedChanged = useCallback(\n    (ev: React.ChangeEvent<HTMLInputElement>) => {\n      const isSelected = ev.target.checked;\n      onSelectedChange(entry, isSelected);\n    },\n    [entry, onSelectedChange]\n  );\n\n  const checkboxId = `${scrollIntoView ? 'table' : 'summary'}_checkbox_${entry.uri}`;\n\n  // Scroll to the selected element if it's not in the view\n  // Only do it once, when the component is mounted\n  useEffect(() => {\n    if (isSelected && scrollIntoView) {\n      document.getElementById(checkboxId)?.scrollIntoView({\n        behavior: 'smooth',\n        block: 'center',\n      });\n    }\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return (\n    <div className={styles.nestedEntry} style={{ marginLeft: level * (3 * theme.spacing.gridSize) }}>\n      {hasChildren ? (\n        <IconButton\n          className={styles.collapseButton}\n          name={isOpen ? 'angle-down' : 'angle-right'}\n          aria-label={isOpen ? `Collapse ${entry.name}` : `Expand ${entry.name}`}\n          onClick={handleToggleCollapse}\n          id={entry.id}\n        />\n      ) : (\n        <Space layout=\"inline\" h={2} />\n      )}\n\n      <Space layout=\"inline\" h={2} />\n\n      {isSelectable && (\n        <>\n          <Checkbox\n            id={checkboxId}\n            onChange={handleSelectedChanged}\n            disabled={isDisabled}\n            value={isSelected}\n            className={styles.nestedRowCheckbox}\n          />\n          <Space layout=\"inline\" h={2} />\n        </>\n      )}\n\n      <EntryIcon entry={entry} isOpen={isOpen} />\n      <Space layout=\"inline\" h={1} />\n\n      <label htmlFor={checkboxId} className={cx(styles.entryContentItem, styles.truncated)}>\n        {entry.name}\n      </label>\n    </div>\n  );\n};\n","// src/utils/env.ts\nvar NOTHING = Symbol.for(\"immer-nothing\");\nvar DRAFTABLE = Symbol.for(\"immer-draftable\");\nvar DRAFT_STATE = Symbol.for(\"immer-state\");\n\n// src/utils/errors.ts\nvar errors = process.env.NODE_ENV !== \"production\" ? [\n  // All error codes, starting by 0:\n  function(plugin) {\n    return `The plugin for '${plugin}' has not been loaded into Immer. To enable the plugin, import and call \\`enable${plugin}()\\` when initializing your application.`;\n  },\n  function(thing) {\n    return `produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${thing}'`;\n  },\n  \"This object has been frozen and should not be mutated\",\n  function(data) {\n    return \"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? \" + data;\n  },\n  \"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.\",\n  \"Immer forbids circular references\",\n  \"The first or second argument to `produce` must be a function\",\n  \"The third argument to `produce` must be a function or undefined\",\n  \"First argument to `createDraft` must be a plain object, an array, or an immerable object\",\n  \"First argument to `finishDraft` must be a draft returned by `createDraft`\",\n  function(thing) {\n    return `'current' expects a draft, got: ${thing}`;\n  },\n  \"Object.defineProperty() cannot be used on an Immer draft\",\n  \"Object.setPrototypeOf() cannot be used on an Immer draft\",\n  \"Immer only supports deleting array indices\",\n  \"Immer only supports setting array indices and the 'length' property\",\n  function(thing) {\n    return `'original' expects a draft, got: ${thing}`;\n  }\n  // Note: if more errors are added, the errorOffset in Patches.ts should be increased\n  // See Patches.ts for additional errors\n] : [];\nfunction die(error, ...args) {\n  if (process.env.NODE_ENV !== \"production\") {\n    const e = errors[error];\n    const msg = typeof e === \"function\" ? e.apply(null, args) : e;\n    throw new Error(`[Immer] ${msg}`);\n  }\n  throw new Error(\n    `[Immer] minified error nr: ${error}. Full error at: https://bit.ly/3cXEKWf`\n  );\n}\n\n// src/utils/common.ts\nvar getPrototypeOf = Object.getPrototypeOf;\nfunction isDraft(value) {\n  return !!value && !!value[DRAFT_STATE];\n}\nfunction isDraftable(value) {\n  if (!value)\n    return false;\n  return isPlainObject(value) || Array.isArray(value) || !!value[DRAFTABLE] || !!value.constructor?.[DRAFTABLE] || isMap(value) || isSet(value);\n}\nvar objectCtorString = Object.prototype.constructor.toString();\nfunction isPlainObject(value) {\n  if (!value || typeof value !== \"object\")\n    return false;\n  const proto = getPrototypeOf(value);\n  if (proto === null) {\n    return true;\n  }\n  const Ctor = Object.hasOwnProperty.call(proto, \"constructor\") && proto.constructor;\n  if (Ctor === Object)\n    return true;\n  return typeof Ctor == \"function\" && Function.toString.call(Ctor) === objectCtorString;\n}\nfunction original(value) {\n  if (!isDraft(value))\n    die(15, value);\n  return value[DRAFT_STATE].base_;\n}\nfunction each(obj, iter) {\n  if (getArchtype(obj) === 0 /* Object */) {\n    Reflect.ownKeys(obj).forEach((key) => {\n      iter(key, obj[key], obj);\n    });\n  } else {\n    obj.forEach((entry, index) => iter(index, entry, obj));\n  }\n}\nfunction getArchtype(thing) {\n  const state = thing[DRAFT_STATE];\n  return state ? state.type_ : Array.isArray(thing) ? 1 /* Array */ : isMap(thing) ? 2 /* Map */ : isSet(thing) ? 3 /* Set */ : 0 /* Object */;\n}\nfunction has(thing, prop) {\n  return getArchtype(thing) === 2 /* Map */ ? thing.has(prop) : Object.prototype.hasOwnProperty.call(thing, prop);\n}\nfunction get(thing, prop) {\n  return getArchtype(thing) === 2 /* Map */ ? thing.get(prop) : thing[prop];\n}\nfunction set(thing, propOrOldValue, value) {\n  const t = getArchtype(thing);\n  if (t === 2 /* Map */)\n    thing.set(propOrOldValue, value);\n  else if (t === 3 /* Set */) {\n    thing.add(value);\n  } else\n    thing[propOrOldValue] = value;\n}\nfunction is(x, y) {\n  if (x === y) {\n    return x !== 0 || 1 / x === 1 / y;\n  } else {\n    return x !== x && y !== y;\n  }\n}\nfunction isMap(target) {\n  return target instanceof Map;\n}\nfunction isSet(target) {\n  return target instanceof Set;\n}\nfunction latest(state) {\n  return state.copy_ || state.base_;\n}\nfunction shallowCopy(base, strict) {\n  if (isMap(base)) {\n    return new Map(base);\n  }\n  if (isSet(base)) {\n    return new Set(base);\n  }\n  if (Array.isArray(base))\n    return Array.prototype.slice.call(base);\n  const isPlain = isPlainObject(base);\n  if (strict === true || strict === \"class_only\" && !isPlain) {\n    const descriptors = Object.getOwnPropertyDescriptors(base);\n    delete descriptors[DRAFT_STATE];\n    let keys = Reflect.ownKeys(descriptors);\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      const desc = descriptors[key];\n      if (desc.writable === false) {\n        desc.writable = true;\n        desc.configurable = true;\n      }\n      if (desc.get || desc.set)\n        descriptors[key] = {\n          configurable: true,\n          writable: true,\n          // could live with !!desc.set as well here...\n          enumerable: desc.enumerable,\n          value: base[key]\n        };\n    }\n    return Object.create(getPrototypeOf(base), descriptors);\n  } else {\n    const proto = getPrototypeOf(base);\n    if (proto !== null && isPlain) {\n      return { ...base };\n    }\n    const obj = Object.create(proto);\n    return Object.assign(obj, base);\n  }\n}\nfunction freeze(obj, deep = false) {\n  if (isFrozen(obj) || isDraft(obj) || !isDraftable(obj))\n    return obj;\n  if (getArchtype(obj) > 1) {\n    obj.set = obj.add = obj.clear = obj.delete = dontMutateFrozenCollections;\n  }\n  Object.freeze(obj);\n  if (deep)\n    Object.entries(obj).forEach(([key, value]) => freeze(value, true));\n  return obj;\n}\nfunction dontMutateFrozenCollections() {\n  die(2);\n}\nfunction isFrozen(obj) {\n  return Object.isFrozen(obj);\n}\n\n// src/utils/plugins.ts\nvar plugins = {};\nfunction getPlugin(pluginKey) {\n  const plugin = plugins[pluginKey];\n  if (!plugin) {\n    die(0, pluginKey);\n  }\n  return plugin;\n}\nfunction loadPlugin(pluginKey, implementation) {\n  if (!plugins[pluginKey])\n    plugins[pluginKey] = implementation;\n}\n\n// src/core/scope.ts\nvar currentScope;\nfunction getCurrentScope() {\n  return currentScope;\n}\nfunction createScope(parent_, immer_) {\n  return {\n    drafts_: [],\n    parent_,\n    immer_,\n    // Whenever the modified draft contains a draft from another scope, we\n    // need to prevent auto-freezing so the unowned draft can be finalized.\n    canAutoFreeze_: true,\n    unfinalizedDrafts_: 0\n  };\n}\nfunction usePatchesInScope(scope, patchListener) {\n  if (patchListener) {\n    getPlugin(\"Patches\");\n    scope.patches_ = [];\n    scope.inversePatches_ = [];\n    scope.patchListener_ = patchListener;\n  }\n}\nfunction revokeScope(scope) {\n  leaveScope(scope);\n  scope.drafts_.forEach(revokeDraft);\n  scope.drafts_ = null;\n}\nfunction leaveScope(scope) {\n  if (scope === currentScope) {\n    currentScope = scope.parent_;\n  }\n}\nfunction enterScope(immer2) {\n  return currentScope = createScope(currentScope, immer2);\n}\nfunction revokeDraft(draft) {\n  const state = draft[DRAFT_STATE];\n  if (state.type_ === 0 /* Object */ || state.type_ === 1 /* Array */)\n    state.revoke_();\n  else\n    state.revoked_ = true;\n}\n\n// src/core/finalize.ts\nfunction processResult(result, scope) {\n  scope.unfinalizedDrafts_ = scope.drafts_.length;\n  const baseDraft = scope.drafts_[0];\n  const isReplaced = result !== void 0 && result !== baseDraft;\n  if (isReplaced) {\n    if (baseDraft[DRAFT_STATE].modified_) {\n      revokeScope(scope);\n      die(4);\n    }\n    if (isDraftable(result)) {\n      result = finalize(scope, result);\n      if (!scope.parent_)\n        maybeFreeze(scope, result);\n    }\n    if (scope.patches_) {\n      getPlugin(\"Patches\").generateReplacementPatches_(\n        baseDraft[DRAFT_STATE].base_,\n        result,\n        scope.patches_,\n        scope.inversePatches_\n      );\n    }\n  } else {\n    result = finalize(scope, baseDraft, []);\n  }\n  revokeScope(scope);\n  if (scope.patches_) {\n    scope.patchListener_(scope.patches_, scope.inversePatches_);\n  }\n  return result !== NOTHING ? result : void 0;\n}\nfunction finalize(rootScope, value, path) {\n  if (isFrozen(value))\n    return value;\n  const state = value[DRAFT_STATE];\n  if (!state) {\n    each(\n      value,\n      (key, childValue) => finalizeProperty(rootScope, state, value, key, childValue, path)\n    );\n    return value;\n  }\n  if (state.scope_ !== rootScope)\n    return value;\n  if (!state.modified_) {\n    maybeFreeze(rootScope, state.base_, true);\n    return state.base_;\n  }\n  if (!state.finalized_) {\n    state.finalized_ = true;\n    state.scope_.unfinalizedDrafts_--;\n    const result = state.copy_;\n    let resultEach = result;\n    let isSet2 = false;\n    if (state.type_ === 3 /* Set */) {\n      resultEach = new Set(result);\n      result.clear();\n      isSet2 = true;\n    }\n    each(\n      resultEach,\n      (key, childValue) => finalizeProperty(rootScope, state, result, key, childValue, path, isSet2)\n    );\n    maybeFreeze(rootScope, result, false);\n    if (path && rootScope.patches_) {\n      getPlugin(\"Patches\").generatePatches_(\n        state,\n        path,\n        rootScope.patches_,\n        rootScope.inversePatches_\n      );\n    }\n  }\n  return state.copy_;\n}\nfunction finalizeProperty(rootScope, parentState, targetObject, prop, childValue, rootPath, targetIsSet) {\n  if (process.env.NODE_ENV !== \"production\" && childValue === targetObject)\n    die(5);\n  if (isDraft(childValue)) {\n    const path = rootPath && parentState && parentState.type_ !== 3 /* Set */ && // Set objects are atomic since they have no keys.\n    !has(parentState.assigned_, prop) ? rootPath.concat(prop) : void 0;\n    const res = finalize(rootScope, childValue, path);\n    set(targetObject, prop, res);\n    if (isDraft(res)) {\n      rootScope.canAutoFreeze_ = false;\n    } else\n      return;\n  } else if (targetIsSet) {\n    targetObject.add(childValue);\n  }\n  if (isDraftable(childValue) && !isFrozen(childValue)) {\n    if (!rootScope.immer_.autoFreeze_ && rootScope.unfinalizedDrafts_ < 1) {\n      return;\n    }\n    finalize(rootScope, childValue);\n    if ((!parentState || !parentState.scope_.parent_) && typeof prop !== \"symbol\" && Object.prototype.propertyIsEnumerable.call(targetObject, prop))\n      maybeFreeze(rootScope, childValue);\n  }\n}\nfunction maybeFreeze(scope, value, deep = false) {\n  if (!scope.parent_ && scope.immer_.autoFreeze_ && scope.canAutoFreeze_) {\n    freeze(value, deep);\n  }\n}\n\n// src/core/proxy.ts\nfunction createProxyProxy(base, parent) {\n  const isArray = Array.isArray(base);\n  const state = {\n    type_: isArray ? 1 /* Array */ : 0 /* Object */,\n    // Track which produce call this is associated with.\n    scope_: parent ? parent.scope_ : getCurrentScope(),\n    // True for both shallow and deep changes.\n    modified_: false,\n    // Used during finalization.\n    finalized_: false,\n    // Track which properties have been assigned (true) or deleted (false).\n    assigned_: {},\n    // The parent draft state.\n    parent_: parent,\n    // The base state.\n    base_: base,\n    // The base proxy.\n    draft_: null,\n    // set below\n    // The base copy with any updated values.\n    copy_: null,\n    // Called by the `produce` function.\n    revoke_: null,\n    isManual_: false\n  };\n  let target = state;\n  let traps = objectTraps;\n  if (isArray) {\n    target = [state];\n    traps = arrayTraps;\n  }\n  const { revoke, proxy } = Proxy.revocable(target, traps);\n  state.draft_ = proxy;\n  state.revoke_ = revoke;\n  return proxy;\n}\nvar objectTraps = {\n  get(state, prop) {\n    if (prop === DRAFT_STATE)\n      return state;\n    const source = latest(state);\n    if (!has(source, prop)) {\n      return readPropFromProto(state, source, prop);\n    }\n    const value = source[prop];\n    if (state.finalized_ || !isDraftable(value)) {\n      return value;\n    }\n    if (value === peek(state.base_, prop)) {\n      prepareCopy(state);\n      return state.copy_[prop] = createProxy(value, state);\n    }\n    return value;\n  },\n  has(state, prop) {\n    return prop in latest(state);\n  },\n  ownKeys(state) {\n    return Reflect.ownKeys(latest(state));\n  },\n  set(state, prop, value) {\n    const desc = getDescriptorFromProto(latest(state), prop);\n    if (desc?.set) {\n      desc.set.call(state.draft_, value);\n      return true;\n    }\n    if (!state.modified_) {\n      const current2 = peek(latest(state), prop);\n      const currentState = current2?.[DRAFT_STATE];\n      if (currentState && currentState.base_ === value) {\n        state.copy_[prop] = value;\n        state.assigned_[prop] = false;\n        return true;\n      }\n      if (is(value, current2) && (value !== void 0 || has(state.base_, prop)))\n        return true;\n      prepareCopy(state);\n      markChanged(state);\n    }\n    if (state.copy_[prop] === value && // special case: handle new props with value 'undefined'\n    (value !== void 0 || prop in state.copy_) || // special case: NaN\n    Number.isNaN(value) && Number.isNaN(state.copy_[prop]))\n      return true;\n    state.copy_[prop] = value;\n    state.assigned_[prop] = true;\n    return true;\n  },\n  deleteProperty(state, prop) {\n    if (peek(state.base_, prop) !== void 0 || prop in state.base_) {\n      state.assigned_[prop] = false;\n      prepareCopy(state);\n      markChanged(state);\n    } else {\n      delete state.assigned_[prop];\n    }\n    if (state.copy_) {\n      delete state.copy_[prop];\n    }\n    return true;\n  },\n  // Note: We never coerce `desc.value` into an Immer draft, because we can't make\n  // the same guarantee in ES5 mode.\n  getOwnPropertyDescriptor(state, prop) {\n    const owner = latest(state);\n    const desc = Reflect.getOwnPropertyDescriptor(owner, prop);\n    if (!desc)\n      return desc;\n    return {\n      writable: true,\n      configurable: state.type_ !== 1 /* Array */ || prop !== \"length\",\n      enumerable: desc.enumerable,\n      value: owner[prop]\n    };\n  },\n  defineProperty() {\n    die(11);\n  },\n  getPrototypeOf(state) {\n    return getPrototypeOf(state.base_);\n  },\n  setPrototypeOf() {\n    die(12);\n  }\n};\nvar arrayTraps = {};\neach(objectTraps, (key, fn) => {\n  arrayTraps[key] = function() {\n    arguments[0] = arguments[0][0];\n    return fn.apply(this, arguments);\n  };\n});\narrayTraps.deleteProperty = function(state, prop) {\n  if (process.env.NODE_ENV !== \"production\" && isNaN(parseInt(prop)))\n    die(13);\n  return arrayTraps.set.call(this, state, prop, void 0);\n};\narrayTraps.set = function(state, prop, value) {\n  if (process.env.NODE_ENV !== \"production\" && prop !== \"length\" && isNaN(parseInt(prop)))\n    die(14);\n  return objectTraps.set.call(this, state[0], prop, value, state[0]);\n};\nfunction peek(draft, prop) {\n  const state = draft[DRAFT_STATE];\n  const source = state ? latest(state) : draft;\n  return source[prop];\n}\nfunction readPropFromProto(state, source, prop) {\n  const desc = getDescriptorFromProto(source, prop);\n  return desc ? `value` in desc ? desc.value : (\n    // This is a very special case, if the prop is a getter defined by the\n    // prototype, we should invoke it with the draft as context!\n    desc.get?.call(state.draft_)\n  ) : void 0;\n}\nfunction getDescriptorFromProto(source, prop) {\n  if (!(prop in source))\n    return void 0;\n  let proto = getPrototypeOf(source);\n  while (proto) {\n    const desc = Object.getOwnPropertyDescriptor(proto, prop);\n    if (desc)\n      return desc;\n    proto = getPrototypeOf(proto);\n  }\n  return void 0;\n}\nfunction markChanged(state) {\n  if (!state.modified_) {\n    state.modified_ = true;\n    if (state.parent_) {\n      markChanged(state.parent_);\n    }\n  }\n}\nfunction prepareCopy(state) {\n  if (!state.copy_) {\n    state.copy_ = shallowCopy(\n      state.base_,\n      state.scope_.immer_.useStrictShallowCopy_\n    );\n  }\n}\n\n// src/core/immerClass.ts\nvar Immer2 = class {\n  constructor(config) {\n    this.autoFreeze_ = true;\n    this.useStrictShallowCopy_ = false;\n    /**\n     * The `produce` function takes a value and a \"recipe function\" (whose\n     * return value often depends on the base state). The recipe function is\n     * free to mutate its first argument however it wants. All mutations are\n     * only ever applied to a __copy__ of the base state.\n     *\n     * Pass only a function to create a \"curried producer\" which relieves you\n     * from passing the recipe function every time.\n     *\n     * Only plain objects and arrays are made mutable. All other objects are\n     * considered uncopyable.\n     *\n     * Note: This function is __bound__ to its `Immer` instance.\n     *\n     * @param {any} base - the initial state\n     * @param {Function} recipe - function that receives a proxy of the base state as first argument and which can be freely modified\n     * @param {Function} patchListener - optional function that will be called with all the patches produced here\n     * @returns {any} a new state, or the initial state if nothing was modified\n     */\n    this.produce = (base, recipe, patchListener) => {\n      if (typeof base === \"function\" && typeof recipe !== \"function\") {\n        const defaultBase = recipe;\n        recipe = base;\n        const self = this;\n        return function curriedProduce(base2 = defaultBase, ...args) {\n          return self.produce(base2, (draft) => recipe.call(this, draft, ...args));\n        };\n      }\n      if (typeof recipe !== \"function\")\n        die(6);\n      if (patchListener !== void 0 && typeof patchListener !== \"function\")\n        die(7);\n      let result;\n      if (isDraftable(base)) {\n        const scope = enterScope(this);\n        const proxy = createProxy(base, void 0);\n        let hasError = true;\n        try {\n          result = recipe(proxy);\n          hasError = false;\n        } finally {\n          if (hasError)\n            revokeScope(scope);\n          else\n            leaveScope(scope);\n        }\n        usePatchesInScope(scope, patchListener);\n        return processResult(result, scope);\n      } else if (!base || typeof base !== \"object\") {\n        result = recipe(base);\n        if (result === void 0)\n          result = base;\n        if (result === NOTHING)\n          result = void 0;\n        if (this.autoFreeze_)\n          freeze(result, true);\n        if (patchListener) {\n          const p = [];\n          const ip = [];\n          getPlugin(\"Patches\").generateReplacementPatches_(base, result, p, ip);\n          patchListener(p, ip);\n        }\n        return result;\n      } else\n        die(1, base);\n    };\n    this.produceWithPatches = (base, recipe) => {\n      if (typeof base === \"function\") {\n        return (state, ...args) => this.produceWithPatches(state, (draft) => base(draft, ...args));\n      }\n      let patches, inversePatches;\n      const result = this.produce(base, recipe, (p, ip) => {\n        patches = p;\n        inversePatches = ip;\n      });\n      return [result, patches, inversePatches];\n    };\n    if (typeof config?.autoFreeze === \"boolean\")\n      this.setAutoFreeze(config.autoFreeze);\n    if (typeof config?.useStrictShallowCopy === \"boolean\")\n      this.setUseStrictShallowCopy(config.useStrictShallowCopy);\n  }\n  createDraft(base) {\n    if (!isDraftable(base))\n      die(8);\n    if (isDraft(base))\n      base = current(base);\n    const scope = enterScope(this);\n    const proxy = createProxy(base, void 0);\n    proxy[DRAFT_STATE].isManual_ = true;\n    leaveScope(scope);\n    return proxy;\n  }\n  finishDraft(draft, patchListener) {\n    const state = draft && draft[DRAFT_STATE];\n    if (!state || !state.isManual_)\n      die(9);\n    const { scope_: scope } = state;\n    usePatchesInScope(scope, patchListener);\n    return processResult(void 0, scope);\n  }\n  /**\n   * Pass true to automatically freeze all copies created by Immer.\n   *\n   * By default, auto-freezing is enabled.\n   */\n  setAutoFreeze(value) {\n    this.autoFreeze_ = value;\n  }\n  /**\n   * Pass true to enable strict shallow copy.\n   *\n   * By default, immer does not copy the object descriptors such as getter, setter and non-enumrable properties.\n   */\n  setUseStrictShallowCopy(value) {\n    this.useStrictShallowCopy_ = value;\n  }\n  applyPatches(base, patches) {\n    let i;\n    for (i = patches.length - 1; i >= 0; i--) {\n      const patch = patches[i];\n      if (patch.path.length === 0 && patch.op === \"replace\") {\n        base = patch.value;\n        break;\n      }\n    }\n    if (i > -1) {\n      patches = patches.slice(i + 1);\n    }\n    const applyPatchesImpl = getPlugin(\"Patches\").applyPatches_;\n    if (isDraft(base)) {\n      return applyPatchesImpl(base, patches);\n    }\n    return this.produce(\n      base,\n      (draft) => applyPatchesImpl(draft, patches)\n    );\n  }\n};\nfunction createProxy(value, parent) {\n  const draft = isMap(value) ? getPlugin(\"MapSet\").proxyMap_(value, parent) : isSet(value) ? getPlugin(\"MapSet\").proxySet_(value, parent) : createProxyProxy(value, parent);\n  const scope = parent ? parent.scope_ : getCurrentScope();\n  scope.drafts_.push(draft);\n  return draft;\n}\n\n// src/core/current.ts\nfunction current(value) {\n  if (!isDraft(value))\n    die(10, value);\n  return currentImpl(value);\n}\nfunction currentImpl(value) {\n  if (!isDraftable(value) || isFrozen(value))\n    return value;\n  const state = value[DRAFT_STATE];\n  let copy;\n  if (state) {\n    if (!state.modified_)\n      return state.base_;\n    state.finalized_ = true;\n    copy = shallowCopy(value, state.scope_.immer_.useStrictShallowCopy_);\n  } else {\n    copy = shallowCopy(value, true);\n  }\n  each(copy, (key, childValue) => {\n    set(copy, key, currentImpl(childValue));\n  });\n  if (state) {\n    state.finalized_ = false;\n  }\n  return copy;\n}\n\n// src/plugins/patches.ts\nfunction enablePatches() {\n  const errorOffset = 16;\n  if (process.env.NODE_ENV !== \"production\") {\n    errors.push(\n      'Sets cannot have \"replace\" patches.',\n      function(op) {\n        return \"Unsupported patch operation: \" + op;\n      },\n      function(path) {\n        return \"Cannot apply patch, path doesn't resolve: \" + path;\n      },\n      \"Patching reserved attributes like __proto__, prototype and constructor is not allowed\"\n    );\n  }\n  const REPLACE = \"replace\";\n  const ADD = \"add\";\n  const REMOVE = \"remove\";\n  function generatePatches_(state, basePath, patches, inversePatches) {\n    switch (state.type_) {\n      case 0 /* Object */:\n      case 2 /* Map */:\n        return generatePatchesFromAssigned(\n          state,\n          basePath,\n          patches,\n          inversePatches\n        );\n      case 1 /* Array */:\n        return generateArrayPatches(state, basePath, patches, inversePatches);\n      case 3 /* Set */:\n        return generateSetPatches(\n          state,\n          basePath,\n          patches,\n          inversePatches\n        );\n    }\n  }\n  function generateArrayPatches(state, basePath, patches, inversePatches) {\n    let { base_, assigned_ } = state;\n    let copy_ = state.copy_;\n    if (copy_.length < base_.length) {\n      ;\n      [base_, copy_] = [copy_, base_];\n      [patches, inversePatches] = [inversePatches, patches];\n    }\n    for (let i = 0; i < base_.length; i++) {\n      if (assigned_[i] && copy_[i] !== base_[i]) {\n        const path = basePath.concat([i]);\n        patches.push({\n          op: REPLACE,\n          path,\n          // Need to maybe clone it, as it can in fact be the original value\n          // due to the base/copy inversion at the start of this function\n          value: clonePatchValueIfNeeded(copy_[i])\n        });\n        inversePatches.push({\n          op: REPLACE,\n          path,\n          value: clonePatchValueIfNeeded(base_[i])\n        });\n      }\n    }\n    for (let i = base_.length; i < copy_.length; i++) {\n      const path = basePath.concat([i]);\n      patches.push({\n        op: ADD,\n        path,\n        // Need to maybe clone it, as it can in fact be the original value\n        // due to the base/copy inversion at the start of this function\n        value: clonePatchValueIfNeeded(copy_[i])\n      });\n    }\n    for (let i = copy_.length - 1; base_.length <= i; --i) {\n      const path = basePath.concat([i]);\n      inversePatches.push({\n        op: REMOVE,\n        path\n      });\n    }\n  }\n  function generatePatchesFromAssigned(state, basePath, patches, inversePatches) {\n    const { base_, copy_ } = state;\n    each(state.assigned_, (key, assignedValue) => {\n      const origValue = get(base_, key);\n      const value = get(copy_, key);\n      const op = !assignedValue ? REMOVE : has(base_, key) ? REPLACE : ADD;\n      if (origValue === value && op === REPLACE)\n        return;\n      const path = basePath.concat(key);\n      patches.push(op === REMOVE ? { op, path } : { op, path, value });\n      inversePatches.push(\n        op === ADD ? { op: REMOVE, path } : op === REMOVE ? { op: ADD, path, value: clonePatchValueIfNeeded(origValue) } : { op: REPLACE, path, value: clonePatchValueIfNeeded(origValue) }\n      );\n    });\n  }\n  function generateSetPatches(state, basePath, patches, inversePatches) {\n    let { base_, copy_ } = state;\n    let i = 0;\n    base_.forEach((value) => {\n      if (!copy_.has(value)) {\n        const path = basePath.concat([i]);\n        patches.push({\n          op: REMOVE,\n          path,\n          value\n        });\n        inversePatches.unshift({\n          op: ADD,\n          path,\n          value\n        });\n      }\n      i++;\n    });\n    i = 0;\n    copy_.forEach((value) => {\n      if (!base_.has(value)) {\n        const path = basePath.concat([i]);\n        patches.push({\n          op: ADD,\n          path,\n          value\n        });\n        inversePatches.unshift({\n          op: REMOVE,\n          path,\n          value\n        });\n      }\n      i++;\n    });\n  }\n  function generateReplacementPatches_(baseValue, replacement, patches, inversePatches) {\n    patches.push({\n      op: REPLACE,\n      path: [],\n      value: replacement === NOTHING ? void 0 : replacement\n    });\n    inversePatches.push({\n      op: REPLACE,\n      path: [],\n      value: baseValue\n    });\n  }\n  function applyPatches_(draft, patches) {\n    patches.forEach((patch) => {\n      const { path, op } = patch;\n      let base = draft;\n      for (let i = 0; i < path.length - 1; i++) {\n        const parentType = getArchtype(base);\n        let p = path[i];\n        if (typeof p !== \"string\" && typeof p !== \"number\") {\n          p = \"\" + p;\n        }\n        if ((parentType === 0 /* Object */ || parentType === 1 /* Array */) && (p === \"__proto__\" || p === \"constructor\"))\n          die(errorOffset + 3);\n        if (typeof base === \"function\" && p === \"prototype\")\n          die(errorOffset + 3);\n        base = get(base, p);\n        if (typeof base !== \"object\")\n          die(errorOffset + 2, path.join(\"/\"));\n      }\n      const type = getArchtype(base);\n      const value = deepClonePatchValue(patch.value);\n      const key = path[path.length - 1];\n      switch (op) {\n        case REPLACE:\n          switch (type) {\n            case 2 /* Map */:\n              return base.set(key, value);\n            case 3 /* Set */:\n              die(errorOffset);\n            default:\n              return base[key] = value;\n          }\n        case ADD:\n          switch (type) {\n            case 1 /* Array */:\n              return key === \"-\" ? base.push(value) : base.splice(key, 0, value);\n            case 2 /* Map */:\n              return base.set(key, value);\n            case 3 /* Set */:\n              return base.add(value);\n            default:\n              return base[key] = value;\n          }\n        case REMOVE:\n          switch (type) {\n            case 1 /* Array */:\n              return base.splice(key, 1);\n            case 2 /* Map */:\n              return base.delete(key);\n            case 3 /* Set */:\n              return base.delete(patch.value);\n            default:\n              return delete base[key];\n          }\n        default:\n          die(errorOffset + 1, op);\n      }\n    });\n    return draft;\n  }\n  function deepClonePatchValue(obj) {\n    if (!isDraftable(obj))\n      return obj;\n    if (Array.isArray(obj))\n      return obj.map(deepClonePatchValue);\n    if (isMap(obj))\n      return new Map(\n        Array.from(obj.entries()).map(([k, v]) => [k, deepClonePatchValue(v)])\n      );\n    if (isSet(obj))\n      return new Set(Array.from(obj).map(deepClonePatchValue));\n    const cloned = Object.create(getPrototypeOf(obj));\n    for (const key in obj)\n      cloned[key] = deepClonePatchValue(obj[key]);\n    if (has(obj, DRAFTABLE))\n      cloned[DRAFTABLE] = obj[DRAFTABLE];\n    return cloned;\n  }\n  function clonePatchValueIfNeeded(obj) {\n    if (isDraft(obj)) {\n      return deepClonePatchValue(obj);\n    } else\n      return obj;\n  }\n  loadPlugin(\"Patches\", {\n    applyPatches_,\n    generatePatches_,\n    generateReplacementPatches_\n  });\n}\n\n// src/plugins/mapset.ts\nfunction enableMapSet() {\n  class DraftMap extends Map {\n    constructor(target, parent) {\n      super();\n      this[DRAFT_STATE] = {\n        type_: 2 /* Map */,\n        parent_: parent,\n        scope_: parent ? parent.scope_ : getCurrentScope(),\n        modified_: false,\n        finalized_: false,\n        copy_: void 0,\n        assigned_: void 0,\n        base_: target,\n        draft_: this,\n        isManual_: false,\n        revoked_: false\n      };\n    }\n    get size() {\n      return latest(this[DRAFT_STATE]).size;\n    }\n    has(key) {\n      return latest(this[DRAFT_STATE]).has(key);\n    }\n    set(key, value) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (!latest(state).has(key) || latest(state).get(key) !== value) {\n        prepareMapCopy(state);\n        markChanged(state);\n        state.assigned_.set(key, true);\n        state.copy_.set(key, value);\n        state.assigned_.set(key, true);\n      }\n      return this;\n    }\n    delete(key) {\n      if (!this.has(key)) {\n        return false;\n      }\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareMapCopy(state);\n      markChanged(state);\n      if (state.base_.has(key)) {\n        state.assigned_.set(key, false);\n      } else {\n        state.assigned_.delete(key);\n      }\n      state.copy_.delete(key);\n      return true;\n    }\n    clear() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (latest(state).size) {\n        prepareMapCopy(state);\n        markChanged(state);\n        state.assigned_ = /* @__PURE__ */ new Map();\n        each(state.base_, (key) => {\n          state.assigned_.set(key, false);\n        });\n        state.copy_.clear();\n      }\n    }\n    forEach(cb, thisArg) {\n      const state = this[DRAFT_STATE];\n      latest(state).forEach((_value, key, _map) => {\n        cb.call(thisArg, this.get(key), key, this);\n      });\n    }\n    get(key) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      const value = latest(state).get(key);\n      if (state.finalized_ || !isDraftable(value)) {\n        return value;\n      }\n      if (value !== state.base_.get(key)) {\n        return value;\n      }\n      const draft = createProxy(value, state);\n      prepareMapCopy(state);\n      state.copy_.set(key, draft);\n      return draft;\n    }\n    keys() {\n      return latest(this[DRAFT_STATE]).keys();\n    }\n    values() {\n      const iterator = this.keys();\n      return {\n        [Symbol.iterator]: () => this.values(),\n        next: () => {\n          const r = iterator.next();\n          if (r.done)\n            return r;\n          const value = this.get(r.value);\n          return {\n            done: false,\n            value\n          };\n        }\n      };\n    }\n    entries() {\n      const iterator = this.keys();\n      return {\n        [Symbol.iterator]: () => this.entries(),\n        next: () => {\n          const r = iterator.next();\n          if (r.done)\n            return r;\n          const value = this.get(r.value);\n          return {\n            done: false,\n            value: [r.value, value]\n          };\n        }\n      };\n    }\n    [(DRAFT_STATE, Symbol.iterator)]() {\n      return this.entries();\n    }\n  }\n  function proxyMap_(target, parent) {\n    return new DraftMap(target, parent);\n  }\n  function prepareMapCopy(state) {\n    if (!state.copy_) {\n      state.assigned_ = /* @__PURE__ */ new Map();\n      state.copy_ = new Map(state.base_);\n    }\n  }\n  class DraftSet extends Set {\n    constructor(target, parent) {\n      super();\n      this[DRAFT_STATE] = {\n        type_: 3 /* Set */,\n        parent_: parent,\n        scope_: parent ? parent.scope_ : getCurrentScope(),\n        modified_: false,\n        finalized_: false,\n        copy_: void 0,\n        base_: target,\n        draft_: this,\n        drafts_: /* @__PURE__ */ new Map(),\n        revoked_: false,\n        isManual_: false\n      };\n    }\n    get size() {\n      return latest(this[DRAFT_STATE]).size;\n    }\n    has(value) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (!state.copy_) {\n        return state.base_.has(value);\n      }\n      if (state.copy_.has(value))\n        return true;\n      if (state.drafts_.has(value) && state.copy_.has(state.drafts_.get(value)))\n        return true;\n      return false;\n    }\n    add(value) {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (!this.has(value)) {\n        prepareSetCopy(state);\n        markChanged(state);\n        state.copy_.add(value);\n      }\n      return this;\n    }\n    delete(value) {\n      if (!this.has(value)) {\n        return false;\n      }\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareSetCopy(state);\n      markChanged(state);\n      return state.copy_.delete(value) || (state.drafts_.has(value) ? state.copy_.delete(state.drafts_.get(value)) : (\n        /* istanbul ignore next */\n        false\n      ));\n    }\n    clear() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      if (latest(state).size) {\n        prepareSetCopy(state);\n        markChanged(state);\n        state.copy_.clear();\n      }\n    }\n    values() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareSetCopy(state);\n      return state.copy_.values();\n    }\n    entries() {\n      const state = this[DRAFT_STATE];\n      assertUnrevoked(state);\n      prepareSetCopy(state);\n      return state.copy_.entries();\n    }\n    keys() {\n      return this.values();\n    }\n    [(DRAFT_STATE, Symbol.iterator)]() {\n      return this.values();\n    }\n    forEach(cb, thisArg) {\n      const iterator = this.values();\n      let result = iterator.next();\n      while (!result.done) {\n        cb.call(thisArg, result.value, result.value, this);\n        result = iterator.next();\n      }\n    }\n  }\n  function proxySet_(target, parent) {\n    return new DraftSet(target, parent);\n  }\n  function prepareSetCopy(state) {\n    if (!state.copy_) {\n      state.copy_ = /* @__PURE__ */ new Set();\n      state.base_.forEach((value) => {\n        if (isDraftable(value)) {\n          const draft = createProxy(value, state);\n          state.drafts_.set(value, draft);\n          state.copy_.add(draft);\n        } else {\n          state.copy_.add(value);\n        }\n      });\n    }\n  }\n  function assertUnrevoked(state) {\n    if (state.revoked_)\n      die(3, JSON.stringify(latest(state)));\n  }\n  loadPlugin(\"MapSet\", { proxyMap_, proxySet_ });\n}\n\n// src/immer.ts\nvar immer = new Immer2();\nvar produce = immer.produce;\nvar produceWithPatches = immer.produceWithPatches.bind(\n  immer\n);\nvar setAutoFreeze = immer.setAutoFreeze.bind(immer);\nvar setUseStrictShallowCopy = immer.setUseStrictShallowCopy.bind(immer);\nvar applyPatches = immer.applyPatches.bind(immer);\nvar createDraft = immer.createDraft.bind(immer);\nvar finishDraft = immer.finishDraft.bind(immer);\nfunction castDraft(value) {\n  return value;\n}\nfunction castImmutable(value) {\n  return value;\n}\nexport {\n  Immer2 as Immer,\n  applyPatches,\n  castDraft,\n  castImmutable,\n  createDraft,\n  current,\n  enableMapSet,\n  enablePatches,\n  finishDraft,\n  freeze,\n  DRAFTABLE as immerable,\n  isDraft,\n  isDraftable,\n  NOTHING as nothing,\n  original,\n  produce,\n  produceWithPatches,\n  setAutoFreeze,\n  setUseStrictShallowCopy\n};\n//# sourceMappingURL=immer.mjs.map","import { TemplateSrv } from '@grafana/runtime';\n\nimport { AzureMonitorResource, GetMetricNamespacesQuery, GetMetricNamesQuery } from '../types';\n\nexport default class UrlBuilder {\n  static buildResourceUri(templateSrv: TemplateSrv, resource: AzureMonitorResource, multipleResources?: boolean) {\n    const urlArray = [];\n    const { subscription, resourceGroup, metricNamespace, resourceName } = resource;\n    if (subscription) {\n      urlArray.push('/subscriptions', subscription);\n      if (resourceGroup && !multipleResources) {\n        urlArray.push('resourceGroups', resourceGroup);\n\n        if (metricNamespace && resourceName) {\n          const metricNamespaceProcessed = templateSrv.replace(metricNamespace);\n          const metricNamespaceArray = metricNamespace.split('/');\n          const resourceNameProcessed = templateSrv.replace(resourceName);\n          const resourceNameArray = resourceName.split('/');\n          const provider = metricNamespaceArray.shift();\n          if (provider) {\n            urlArray.push('providers', provider);\n          }\n\n          if (\n            metricNamespaceProcessed.toLowerCase().startsWith('microsoft.storage/storageaccounts/') &&\n            !resourceNameProcessed.endsWith('default')\n          ) {\n            resourceNameArray.push('default');\n          }\n\n          if (resourceNameArray.length > metricNamespaceArray.length) {\n            const parentResource = resourceNameArray.shift();\n            if (parentResource) {\n              urlArray.push(parentResource);\n            }\n          }\n\n          for (const i in metricNamespaceArray) {\n            urlArray.push(metricNamespaceArray[i]);\n            urlArray.push(resourceNameArray[i]);\n          }\n        }\n      }\n    }\n\n    return urlArray.join('/');\n  }\n\n  static buildAzureMonitorGetMetricNamespacesUrl(\n    baseUrl: string,\n    apiVersion: string,\n    query: GetMetricNamespacesQuery,\n    globalRegion: boolean,\n    templateSrv: TemplateSrv,\n    region?: string\n  ) {\n    let resourceUri: string;\n\n    if ('resourceUri' in query) {\n      resourceUri = query.resourceUri;\n    } else {\n      const { subscription, resourceGroup, metricNamespace, resourceName } = query;\n      resourceUri = UrlBuilder.buildResourceUri(templateSrv, {\n        subscription,\n        resourceGroup,\n        metricNamespace,\n        resourceName,\n      });\n    }\n\n    return `${baseUrl}${resourceUri}/providers/microsoft.insights/metricNamespaces?api-version=${apiVersion}${\n      region ? `&region=${region}` : globalRegion ? '&region=global' : ''\n    }`;\n  }\n\n  static buildAzureMonitorGetMetricNamesUrl(\n    baseUrl: string,\n    apiVersion: string,\n    query: GetMetricNamesQuery,\n    templateSrv: TemplateSrv,\n    multipleResources?: boolean,\n    region?: string\n  ) {\n    let resourceUri: string;\n    const { customNamespace, metricNamespace } = query;\n    if ('resourceUri' in query) {\n      resourceUri = query.resourceUri;\n    } else {\n      const { subscription, resourceGroup, metricNamespace, resourceName } = query;\n      resourceUri = UrlBuilder.buildResourceUri(\n        templateSrv,\n        {\n          subscription,\n          resourceGroup,\n          metricNamespace,\n          resourceName,\n        },\n        multipleResources\n      );\n    }\n    let url = `${baseUrl}${resourceUri}/providers/microsoft.insights/metricdefinitions?api-version=${apiVersion}`;\n    if (customNamespace) {\n      url += `&metricnamespace=${encodeURIComponent(customNamespace)}`;\n    }\n\n    if (multipleResources && !customNamespace && metricNamespace) {\n      url += `&metricnamespace=${encodeURIComponent(metricNamespace)}`;\n    }\n\n    if (region && multipleResources) {\n      url += `&region=${region}`;\n    }\n\n    return url;\n  }\n}\n","import { produce } from 'immer';\n\nimport { getTemplateSrv } from '@grafana/runtime';\n\nimport UrlBuilder from '../../azure_monitor/url_builder';\nimport { ResourcePickerQueryType } from '../../resourcePicker/resourcePickerData';\nimport { AzureMonitorResource, AzureMonitorQuery } from '../../types';\n\nimport { ResourceRow, ResourceRowGroup } from './types';\n\n// This regex matches URIs representing:\n//  - subscriptions: /subscriptions/44693801-6ee6-49de-9b2d-9106972f9572\n//  - resource groups: /subscriptions/44693801-6ee6-49de-9b2d-9106972f9572/resourceGroups/cloud-datasources\n//  - resources: /subscriptions/44693801-6ee6-49de-9b2d-9106972f9572/resourceGroups/cloud-datasources/providers/Microsoft.Compute/virtualMachines/GithubTestDataVM\nconst RESOURCE_URI_REGEX =\n  /\\/subscriptions\\/(?<subscription>[^/]+)(?:\\/resourceGroups\\/(?<resourceGroup>[^/]+)(?:\\/providers\\/(?<metricNamespaceAndResource>.+))?)?/i;\n\ntype RegexGroups = Record<string, string | undefined>;\n\nfunction parseNamespaceAndName(metricNamespaceAndName?: string) {\n  if (!metricNamespaceAndName) {\n    return {};\n  }\n  const stringArray = metricNamespaceAndName.split('/');\n  // The first two groups belong to the namespace (e.g. Microsoft.Storage/storageAccounts)\n  const namespaceArray = stringArray.splice(0, 2);\n  // The next element belong to the resource name (e.g. storageAcc1)\n  const resourceNameArray = stringArray.splice(0, 1);\n  // If there are more elements, keep adding them to the namespace and resource name, alternatively\n  // e.g (blobServices/default)\n  while (stringArray.length) {\n    const nextElem = stringArray.shift()!;\n    stringArray.length % 2 === 0 ? resourceNameArray.push(nextElem) : namespaceArray.push(nextElem);\n  }\n  return { metricNamespace: namespaceArray.join('/'), resourceName: resourceNameArray.join('/') };\n}\n\nexport function parseResourceURI(resourceURI: string): AzureMonitorResource {\n  const matches = RESOURCE_URI_REGEX.exec(resourceURI);\n  const groups: RegexGroups = matches?.groups ?? {};\n  const { subscription, resourceGroup, metricNamespaceAndResource } = groups;\n  const { metricNamespace, resourceName } = parseNamespaceAndName(metricNamespaceAndResource);\n\n  return { subscription, resourceGroup, metricNamespace, resourceName };\n}\n\nexport function parseMultipleResourceDetails(resources: Array<string | AzureMonitorResource>, location?: string) {\n  return resources.map((resource) => {\n    return parseResourceDetails(resource, location);\n  });\n}\n\nexport function parseResourceDetails(resource: string | AzureMonitorResource, location?: string) {\n  if (typeof resource === 'string') {\n    const res = parseResourceURI(resource);\n    if (location) {\n      res.region = location;\n    }\n    return res;\n  }\n  return resource;\n}\n\nexport function resourcesToStrings(resources: Array<string | AzureMonitorResource>) {\n  return resources.map((resource) => resourceToString(resource));\n}\n\nexport function resourceToString(resource?: string | AzureMonitorResource) {\n  return resource\n    ? typeof resource === 'string'\n      ? resource\n      : UrlBuilder.buildResourceUri(getTemplateSrv(), resource)\n    : '';\n}\n\nexport function isGUIDish(input: string) {\n  return !!input.match(/^[A-Z0-9]+/i);\n}\n\nfunction compareNamespaceAndName(\n  rowNamespace?: string,\n  rowName?: string,\n  resourceNamespace?: string,\n  resourceName?: string\n) {\n  // StorageAccounts subresources are not listed independently\n  if (resourceNamespace?.startsWith('microsoft.storage/storageaccounts')) {\n    resourceNamespace = 'microsoft.storage/storageaccounts';\n    if (resourceName?.endsWith('/default')) {\n      resourceName = resourceName.slice(0, -'/default'.length);\n    }\n  }\n  return rowNamespace === resourceNamespace && rowName === resourceName;\n}\n\nexport function matchURI(rowURI: string, resourceURI: string) {\n  const targetParams = parseResourceDetails(resourceURI);\n  const rowParams = parseResourceDetails(rowURI);\n\n  return (\n    rowParams?.subscription === targetParams?.subscription &&\n    rowParams?.resourceGroup?.toLowerCase() === targetParams?.resourceGroup?.toLowerCase() &&\n    compareNamespaceAndName(\n      rowParams?.metricNamespace?.toLowerCase(),\n      rowParams?.resourceName,\n      targetParams?.metricNamespace?.toLowerCase(),\n      targetParams?.resourceName\n    )\n  );\n}\n\nexport function findRows(rows: ResourceRowGroup, uris: string[]): ResourceRow[] {\n  const result: ResourceRow[] = [];\n  uris.forEach((uri) => {\n    const row = findRow(rows, uri);\n    if (row) {\n      result.push(row);\n    }\n  });\n  return result;\n}\n\nexport function findRow(rows: ResourceRowGroup, uri: string): ResourceRow | undefined {\n  for (const row of rows) {\n    if (matchURI(row.uri, uri)) {\n      return row;\n    }\n\n    if (row.children) {\n      const result = findRow(row.children, uri);\n\n      if (result) {\n        return result;\n      }\n    }\n  }\n\n  return undefined;\n}\n\nexport function addResources(rows: ResourceRowGroup, targetParentId: string, newResources: ResourceRowGroup) {\n  return produce(rows, (draftState) => {\n    const draftRow = findRow(draftState, targetParentId);\n\n    // we can't find the selected resource in our list of resources,\n    // probably means user has either mistyped in the input field\n    // or is using template variables.\n    // either way no need to throw, just show that none of the resources are checked\n    if (!draftRow) {\n      return;\n    }\n\n    draftRow.children = newResources;\n  });\n}\n\nexport function setResources(\n  query: AzureMonitorQuery,\n  type: ResourcePickerQueryType,\n  resources: Array<string | AzureMonitorResource>\n): AzureMonitorQuery {\n  if (type === 'logs') {\n    // Resource URI for LogAnalytics\n    return {\n      ...query,\n      azureLogAnalytics: {\n        ...query.azureLogAnalytics,\n        resources: resourcesToStrings(resources).filter((resource) => resource !== ''),\n      },\n    };\n  }\n  if (type === 'traces') {\n    // Resource URI for Traces\n    return {\n      ...query,\n      azureTraces: {\n        ...query.azureTraces,\n        resources: resourcesToStrings(resources).filter((resource) => resource !== ''),\n      },\n    };\n  }\n\n  // Resource object for metrics\n  const parsedResource = resources.length ? parseResourceDetails(resources[0]) : {};\n  return {\n    ...query,\n    subscription: parsedResource.subscription,\n    azureMonitor: {\n      ...query.azureMonitor,\n      metricNamespace: parsedResource.metricNamespace?.toLocaleLowerCase(),\n      region: parsedResource.region,\n      resources: parseMultipleResourceDetails(resources).filter(\n        (resource) =>\n          resource.resourceName !== '' &&\n          resource.metricNamespace !== '' &&\n          resource.subscription !== '' &&\n          resource.resourceGroup !== ''\n      ),\n      metricName: undefined,\n      aggregation: undefined,\n      timeGrain: '',\n      dimensionFilters: [],\n    },\n  };\n}\n","import { cx } from '@emotion/css';\nimport { useEffect, useState } from 'react';\n\nimport { FadeTransition, LoadingPlaceholder, useStyles2 } from '@grafana/ui';\n\nimport { NestedEntry } from './NestedEntry';\nimport getStyles from './styles';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from './types';\nimport { findRow } from './utils';\n\ninterface NestedRowProps {\n  row: ResourceRow;\n  level: number;\n  selectedRows: ResourceRowGroup;\n  requestNestedRows: (row: ResourceRow) => Promise<void>;\n  onRowSelectedChange: (row: ResourceRow, selected: boolean) => void;\n  selectableEntryTypes: ResourceRowType[];\n  disableRow: (row: ResourceRow, selectedRows: ResourceRowGroup) => boolean;\n  scrollIntoView?: boolean;\n}\n\nconst NestedRow = ({\n  row,\n  selectedRows,\n  level,\n  requestNestedRows,\n  onRowSelectedChange,\n  selectableEntryTypes,\n  scrollIntoView,\n  disableRow,\n}: NestedRowProps) => {\n  const styles = useStyles2(getStyles);\n  const [rowStatus, setRowStatus] = useState<'open' | 'closed' | 'loading'>('closed');\n\n  const isSelected = !!selectedRows.find((v) => v.uri.toLowerCase() === row.uri.toLowerCase());\n  const isDisabled = !isSelected && disableRow(row, selectedRows);\n  const isOpen = rowStatus === 'open';\n\n  const onRowToggleCollapse = async () => {\n    if (rowStatus === 'open') {\n      setRowStatus('closed');\n      return;\n    }\n    setRowStatus('loading');\n    requestNestedRows(row)\n      .then(() => setRowStatus('open'))\n      .catch(() => setRowStatus('closed'));\n  };\n\n  // opens the resource group on load of component if there was a previously saved selection\n  useEffect(() => {\n    // Assuming we don't have multi-select yet\n    const selectedRow = selectedRows[0];\n\n    const containsChild = selectedRow && !!findRow(row.children ?? [], selectedRow.uri);\n\n    if (containsChild) {\n      setRowStatus('open');\n    }\n  }, [selectedRows, row]);\n\n  return (\n    <>\n      <tr className={cx(styles.row, isDisabled && styles.disabledRow)} key={row.id}>\n        <td className={styles.cell}>\n          <NestedEntry\n            level={level}\n            isSelected={isSelected}\n            isDisabled={isDisabled}\n            isOpen={isOpen}\n            entry={row}\n            onToggleCollapse={onRowToggleCollapse}\n            onSelectedChange={onRowSelectedChange}\n            isSelectable={selectableEntryTypes.some((type) => type === row.type)}\n            scrollIntoView={scrollIntoView}\n          />\n        </td>\n\n        <td className={styles.cell}>{row.typeLabel}</td>\n\n        <td className={styles.cell}>{row.location ?? '-'}</td>\n      </tr>\n\n      {isOpen &&\n        row.children &&\n        Object.keys(row.children).length > 0 &&\n        row.children.map((childRow) => (\n          <NestedRow\n            key={childRow.uri}\n            row={childRow}\n            selectedRows={selectedRows}\n            level={level + 1}\n            requestNestedRows={requestNestedRows}\n            onRowSelectedChange={onRowSelectedChange}\n            selectableEntryTypes={selectableEntryTypes}\n            scrollIntoView={scrollIntoView}\n            disableRow={disableRow}\n          />\n        ))}\n\n      <FadeTransition visible={rowStatus === 'loading'}>\n        <tr>\n          <td className={cx(styles.cell, styles.loadingCell)} colSpan={3}>\n            <LoadingPlaceholder text=\"Loading...\" className={styles.spinner} />\n          </td>\n        </tr>\n      </FadeTransition>\n    </>\n  );\n};\n\nexport default NestedRow;\n","import { debounce } from 'lodash';\nimport { useEffect, useMemo, useState } from 'react';\n\nimport { Icon, Input } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\n\nconst Search = ({ searchFn }: { searchFn: (searchPhrase: string) => void }) => {\n  const [searchFilter, setSearchFilter] = useState('');\n\n  const debouncedSearch = useMemo(() => debounce(searchFn, 600), [searchFn]);\n  useEffect(() => {\n    return () => {\n      // Stop the invocation of the debounced function after unmounting\n      debouncedSearch.cancel();\n    };\n  }, [debouncedSearch]);\n\n  return (\n    <Input\n      aria-label=\"resource search\"\n      prefix={<Icon name=\"search\" />}\n      value={searchFilter}\n      onChange={(event) => {\n        const searchPhrase = event.currentTarget.value;\n        setSearchFilter(searchPhrase);\n        debouncedSearch(searchPhrase);\n      }}\n      placeholder=\"search for a resource\"\n      data-testid={selectors.components.queryEditor.resourcePicker.search.input}\n    />\n  );\n};\n\nexport default Search;\n","import { cx } from '@emotion/css';\nimport { useCallback, useEffect, useState } from 'react';\nimport * as React from 'react';\nimport { useEffectOnce } from 'react-use';\n\nimport { Alert, Button, LoadingPlaceholder, Modal, useStyles2, Space } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\nimport ResourcePickerData, { ResourcePickerQueryType } from '../../resourcePicker/resourcePickerData';\nimport { AzureMonitorResource } from '../../types';\nimport messageFromError from '../../utils/messageFromError';\n\nimport AdvancedMulti from './AdvancedMulti';\nimport NestedRow from './NestedRow';\nimport Search from './Search';\nimport getStyles from './styles';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from './types';\nimport { findRows, parseMultipleResourceDetails, resourcesToStrings, matchURI, resourceToString } from './utils';\n\ninterface ResourcePickerProps<T> {\n  resourcePickerData: ResourcePickerData;\n  resources: T[];\n  selectableEntryTypes: ResourceRowType[];\n  queryType: ResourcePickerQueryType;\n\n  onApply: (resources: T[]) => void;\n  onCancel: () => void;\n  disableRow: (row: ResourceRow, selectedRows: ResourceRowGroup) => boolean;\n  renderAdvanced: (resources: T[], onChange: (resources: T[]) => void) => React.ReactNode;\n  selectionNotice?: (selectedRows: ResourceRowGroup) => string;\n}\n\nconst ResourcePicker = ({\n  resourcePickerData,\n  resources,\n  onApply,\n  onCancel,\n  selectableEntryTypes,\n  queryType,\n  disableRow,\n  renderAdvanced,\n  selectionNotice,\n}: ResourcePickerProps<string | AzureMonitorResource>) => {\n  const styles = useStyles2(getStyles);\n\n  const [isLoading, setIsLoading] = useState(false);\n  const [rows, setRows] = useState<ResourceRowGroup>([]);\n  const [selectedRows, setSelectedRows] = useState<ResourceRowGroup>([]);\n  const [internalSelected, setInternalSelected] = useState(resources);\n  const [errorMessage, setErrorMessage] = useState<string | undefined>(undefined);\n  const [shouldShowLimitFlag, setShouldShowLimitFlag] = useState(false);\n  const selectionNoticeText = selectionNotice?.(selectedRows);\n\n  // Sync the resourceURI prop to internal state\n  useEffect(() => {\n    setInternalSelected(resources);\n  }, [resources]);\n\n  const loadInitialData = useCallback(async () => {\n    if (!isLoading) {\n      try {\n        setIsLoading(true);\n        const resources = await resourcePickerData.fetchInitialRows(\n          queryType,\n          parseMultipleResourceDetails(internalSelected ?? {})\n        );\n        setRows(resources);\n      } catch (error) {\n        setErrorMessage(messageFromError(error));\n      }\n      setIsLoading(false);\n    }\n  }, [internalSelected, isLoading, resourcePickerData, queryType]);\n\n  useEffectOnce(() => {\n    loadInitialData();\n  });\n\n  // Avoid using empty resources\n  const isValid = (r: string | AzureMonitorResource) =>\n    typeof r === 'string' ? r !== '' : r.subscription && r.resourceGroup && r.resourceName && r.metricNamespace;\n\n  // set selected row data whenever row or selection changes\n  useEffect(() => {\n    if (!internalSelected) {\n      setSelectedRows([]);\n    }\n\n    const sanitized = internalSelected.filter((r) => isValid(r));\n    const found = internalSelected && findRows(rows, resourcesToStrings(sanitized));\n    if (sanitized?.length > found.length) {\n      // Not all the selected items are in the current rows, so we need to generate the row\n      // information for those.\n      return setSelectedRows(resourcePickerData.parseRows(sanitized));\n    }\n    if (found && found.length) {\n      return setSelectedRows(found);\n    }\n    return setSelectedRows([]);\n  }, [internalSelected, rows, resourcePickerData]);\n\n  // Request resources for an expanded resource group\n  const requestNestedRows = useCallback(\n    async (parentRow: ResourceRow) => {\n      // clear error message (also when loading cached resources)\n      setErrorMessage(undefined);\n\n      // If we already have children, we don't need to re-fetch them.\n      if (parentRow.children?.length) {\n        return;\n      }\n\n      try {\n        const nestedRows = await resourcePickerData.fetchAndAppendNestedRow(rows, parentRow, queryType);\n        setRows(nestedRows);\n      } catch (error) {\n        setErrorMessage(messageFromError(error));\n        throw error;\n      }\n    },\n    [resourcePickerData, rows, queryType]\n  );\n\n  const handleSelectionChanged = useCallback(\n    (row: ResourceRow, isSelected: boolean) => {\n      if (isSelected) {\n        const newRes = queryType === 'logs' ? row.uri : parseMultipleResourceDetails([row.uri], row.location)[0];\n        const newSelected = internalSelected ? internalSelected.concat(newRes) : [newRes];\n        setInternalSelected(newSelected.filter((r) => isValid(r)));\n      } else {\n        const newInternalSelected = internalSelected?.filter((r) => {\n          return !matchURI(resourceToString(r), row.uri);\n        });\n        setInternalSelected(newInternalSelected);\n      }\n    },\n    [queryType, internalSelected, setInternalSelected]\n  );\n\n  const handleApply = useCallback(() => {\n    if (internalSelected) {\n      onApply(queryType === 'logs' ? internalSelected : parseMultipleResourceDetails(internalSelected));\n    }\n  }, [queryType, internalSelected, onApply]);\n\n  const handleSearch = useCallback(\n    async (searchWord: string) => {\n      // clear errors and warnings\n      setErrorMessage(undefined);\n      setShouldShowLimitFlag(false);\n\n      if (!searchWord) {\n        loadInitialData();\n        return;\n      }\n\n      try {\n        setIsLoading(true);\n        const searchResults = await resourcePickerData.search(searchWord, queryType);\n        setRows(searchResults);\n        if (searchResults.length >= resourcePickerData.resultLimit) {\n          setShouldShowLimitFlag(true);\n        }\n      } catch (err) {\n        setErrorMessage(messageFromError(err));\n      }\n      setIsLoading(false);\n    },\n    [loadInitialData, resourcePickerData, queryType]\n  );\n\n  return (\n    <>\n      <Search searchFn={handleSearch} />\n      {shouldShowLimitFlag ? (\n        <p className={styles.resultLimit}>Showing first {resourcePickerData.resultLimit} results</p>\n      ) : (\n        <Space v={2} />\n      )}\n\n      <table className={styles.table}>\n        <thead>\n          <tr className={cx(styles.row, styles.header)}>\n            <td className={styles.cell}>Scope</td>\n            <td className={styles.cell}>Type</td>\n            <td className={styles.cell}>Location</td>\n          </tr>\n        </thead>\n      </table>\n\n      <div className={cx(styles.scrollableTable, styles.tableScroller)}>\n        <table className={styles.table}>\n          <tbody>\n            {isLoading && (\n              <tr className={cx(styles.row)}>\n                <td className={styles.cell}>\n                  <LoadingPlaceholder text={'Loading...'} />\n                </td>\n              </tr>\n            )}\n            {!isLoading && rows.length === 0 && (\n              <tr className={cx(styles.row)}>\n                <td className={styles.cell} aria-live=\"polite\">\n                  No resources found\n                </td>\n              </tr>\n            )}\n            {!isLoading &&\n              rows.map((row) => (\n                <NestedRow\n                  key={row.uri}\n                  row={row}\n                  selectedRows={selectedRows}\n                  level={0}\n                  requestNestedRows={requestNestedRows}\n                  onRowSelectedChange={handleSelectionChanged}\n                  selectableEntryTypes={selectableEntryTypes}\n                  scrollIntoView={true}\n                  disableRow={disableRow}\n                />\n              ))}\n          </tbody>\n        </table>\n      </div>\n\n      <footer className={styles.selectionFooter}>\n        {selectedRows.length > 0 && (\n          <>\n            <h5>Selection</h5>\n\n            <div className={cx(styles.scrollableTable, styles.selectedTableScroller)}>\n              <table className={styles.table}>\n                <tbody>\n                  {selectedRows.map((row) => (\n                    <NestedRow\n                      key={row.uri}\n                      row={row}\n                      selectedRows={selectedRows}\n                      level={0}\n                      requestNestedRows={requestNestedRows}\n                      onRowSelectedChange={handleSelectionChanged}\n                      selectableEntryTypes={selectableEntryTypes}\n                      disableRow={() => false}\n                    />\n                  ))}\n                </tbody>\n              </table>\n            </div>\n            <Space v={2} />\n            {selectionNoticeText?.length ? (\n              <Alert title=\"\" severity=\"info\">\n                {selectionNoticeText}\n              </Alert>\n            ) : null}\n          </>\n        )}\n\n        <AdvancedMulti\n          resources={internalSelected}\n          onChange={(r) => setInternalSelected(r)}\n          renderAdvanced={renderAdvanced}\n        />\n\n        {errorMessage && (\n          <>\n            <Space v={2} />\n            <Alert severity=\"error\" title=\"An error occurred while requesting resources from Azure Monitor\">\n              {errorMessage}\n            </Alert>\n          </>\n        )}\n\n        <Modal.ButtonRow>\n          <Button onClick={onCancel} variant=\"secondary\" fill=\"outline\">\n            Cancel\n          </Button>\n          <Button\n            disabled={!!errorMessage || !internalSelected.every(isValid)}\n            onClick={handleApply}\n            data-testid={selectors.components.queryEditor.resourcePicker.apply.button}\n          >\n            Apply\n          </Button>\n        </Modal.ButtonRow>\n      </footer>\n    </>\n  );\n};\n\nexport default ResourcePicker;\n","import { cx } from '@emotion/css';\nimport { useCallback, useEffect, useState } from 'react';\nimport * as React from 'react';\n\nimport { Button, Icon, Modal, useStyles2, IconName } from '@grafana/ui';\n\nimport Datasource from '../../datasource';\nimport { selectors } from '../../e2e/selectors';\nimport { ResourcePickerQueryType } from '../../resourcePicker/resourcePickerData';\nimport { AzureQueryEditorFieldProps, AzureMonitorResource } from '../../types';\nimport ResourcePicker from '../ResourcePicker';\nimport getStyles from '../ResourcePicker/styles';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from '../ResourcePicker/types';\nimport { parseMultipleResourceDetails, setResources } from '../ResourcePicker/utils';\nimport { Field } from '../shared/Field';\n\ninterface ResourceFieldProps<T> extends AzureQueryEditorFieldProps {\n  selectableEntryTypes: ResourceRowType[];\n  queryType: ResourcePickerQueryType;\n  resources: T[];\n  inlineField?: boolean;\n  labelWidth?: number;\n  disableRow: (row: ResourceRow, selectedRows: ResourceRowGroup) => boolean;\n  renderAdvanced: (resources: T[], onChange: (resources: T[]) => void) => React.ReactNode;\n  selectionNotice?: (selectedRows: ResourceRowGroup) => string;\n}\n\ntype Props = ResourceFieldProps<string | AzureMonitorResource>;\n\nconst ResourceField = ({\n  query,\n  datasource,\n  onQueryChange,\n  selectableEntryTypes,\n  queryType,\n  resources,\n  inlineField,\n  labelWidth,\n  disableRow,\n  renderAdvanced,\n  selectionNotice,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n  const [pickerIsOpen, setPickerIsOpen] = useState(false);\n\n  const handleOpenPicker = useCallback(() => {\n    setPickerIsOpen(true);\n  }, []);\n\n  const closePicker = useCallback(() => {\n    setPickerIsOpen(false);\n  }, []);\n\n  const handleApply = useCallback(\n    (resources: Array<string | AzureMonitorResource>) => {\n      onQueryChange(setResources(query, queryType, resources));\n      closePicker();\n    },\n    [closePicker, onQueryChange, query, queryType]\n  );\n\n  return (\n    <span data-testid={selectors.components.queryEditor.resourcePicker.select.button}>\n      <Modal\n        className={styles.modal}\n        title=\"Select a resource\"\n        isOpen={pickerIsOpen}\n        onDismiss={closePicker}\n        // The growing number of rows added to the modal causes a focus\n        // error in the modal, making it impossible to click on new elements\n        trapFocus={false}\n      >\n        <ResourcePicker\n          resourcePickerData={datasource.resourcePickerData}\n          resources={resources}\n          onApply={handleApply}\n          onCancel={closePicker}\n          selectableEntryTypes={selectableEntryTypes}\n          queryType={queryType}\n          disableRow={disableRow}\n          renderAdvanced={renderAdvanced}\n          selectionNotice={selectionNotice}\n        />\n      </Modal>\n      <Field label=\"Resource\" inlineField={inlineField} labelWidth={labelWidth}>\n        <Button className={styles.resourceFieldButton} variant=\"secondary\" onClick={handleOpenPicker} type=\"button\">\n          <ResourceLabel resources={resources} datasource={datasource} />\n        </Button>\n      </Field>\n    </span>\n  );\n};\n\ninterface ResourceLabelProps<T> {\n  resources: T[];\n  datasource: Datasource;\n}\n\nconst ResourceLabel = ({ resources, datasource }: ResourceLabelProps<string | AzureMonitorResource>) => {\n  const [resourcesComponents, setResourcesComponents] = useState(parseMultipleResourceDetails(resources));\n\n  useEffect(() => {\n    setResourcesComponents(parseMultipleResourceDetails(resources));\n  }, [resources]);\n\n  if (!resources.length) {\n    return <>Select a resource</>;\n  }\n\n  return <FormattedResource resources={resourcesComponents} />;\n};\n\ninterface FormattedResourceProps {\n  resources: AzureMonitorResource[];\n}\n\nconst FormattedResource = ({ resources }: FormattedResourceProps) => {\n  const styles = useStyles2(getStyles);\n\n  let icon: IconName = 'cube';\n  const items: string[] = [];\n  resources.forEach((resource) => {\n    if (resource.resourceName) {\n      items.push(resource.resourceName.split('/')[0]);\n      return;\n    }\n    if (resource.resourceGroup) {\n      icon = 'folder';\n      items.push(resource.resourceGroup);\n      return;\n    }\n    if (resource.subscription) {\n      icon = 'layer-group';\n      items.push(resource.subscription);\n      return;\n    }\n  });\n  return (\n    <span className={cx(styles.truncated, styles.resourceField)}>\n      <Icon name={icon} />\n      {items.join(', ')}\n    </span>\n  );\n};\n\nexport default ResourceField;\n","import { useCallback, useMemo } from 'react';\nimport { useEffectOnce } from 'react-use';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Select } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\nimport { FormatAsFieldProps, ResultFormat } from '../../types';\n\nimport { Field } from './Field';\n\nconst FormatAsField = ({\n  query,\n  variableOptionGroup,\n  onQueryChange,\n  inputId,\n  options: formatOptions,\n  defaultValue,\n  onLoad,\n  setFormatAs,\n  resultFormat,\n}: FormatAsFieldProps) => {\n  const options = useMemo(() => [...formatOptions, variableOptionGroup], [variableOptionGroup, formatOptions]);\n\n  const handleChange = useCallback(\n    (change: SelectableValue<ResultFormat>) => {\n      const { value } = change;\n      if (!value) {\n        return;\n      }\n\n      const newQuery = setFormatAs(query, value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query, setFormatAs]\n  );\n\n  useEffectOnce(() => {\n    //sets to default if the value is not found in the list\n    if (!formatOptions.find((item) => item.value === resultFormat)) {\n      handleChange({ value: defaultValue });\n    }\n    onLoad(query, defaultValue, handleChange);\n  });\n\n  return (\n    <Field label=\"Format as\" data-testid={selectors.components.queryEditor.logsQueryEditor.formatSelection.input}>\n      <Select\n        inputId={`${inputId}-format-as-field`}\n        value={resultFormat}\n        onChange={handleChange}\n        options={options}\n        width={38}\n      />\n    </Field>\n  );\n};\n\nexport default FormatAsField;\n","import { cx, css } from '@emotion/css';\nimport { useStyles2, Button } from '@grafana/ui';\nimport React from 'react';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nconst AccessoryButton = (_a) => {\n  var _b = _a, { className } = _b, props = __objRest(_b, [\"className\"]);\n  const styles = useStyles2(getButtonStyles);\n  return /* @__PURE__ */ React.createElement(Button, __spreadProps(__spreadValues({}, props), { className: cx(className, styles.button) }));\n};\nconst getButtonStyles = (theme) => ({\n  button: css({\n    paddingLeft: theme.spacing(3 / 2),\n    paddingRight: theme.spacing(3 / 2)\n  })\n});\n\nexport { AccessoryButton };\n//# sourceMappingURL=AccessoryButton.js.map\n","import { css } from '@emotion/css';\nimport { useEffect } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { AccessoryButton } from '@grafana/experimental';\nimport { Icon, Input, Tooltip, Label, Button, useStyles2 } from '@grafana/ui';\n\nexport interface ResourcePickerProps<T> {\n  resources: T[];\n  onChange: (resources: T[]) => void;\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  resourceList: css({ width: '100%', display: 'flex', marginBlock: theme.spacing(1) }),\n});\n\nconst AdvancedResourcePicker = ({ resources, onChange }: ResourcePickerProps<string>) => {\n  const styles = useStyles2(getStyles);\n\n  useEffect(() => {\n    // Ensure there is at least one resource\n    if (resources.length === 0) {\n      onChange(['']);\n    }\n  }, [resources, onChange]);\n\n  const onResourceChange = (index: number, resource: string) => {\n    const newResources = [...resources];\n    newResources[index] = resource;\n    onChange(newResources);\n  };\n\n  const removeResource = (index: number) => {\n    const newResources = [...resources];\n    newResources.splice(index, 1);\n    onChange(newResources);\n  };\n\n  const addResource = () => {\n    onChange(resources.concat(''));\n  };\n\n  return (\n    <>\n      <Label>\n        <h6>\n          Resource URI(s){' '}\n          <Tooltip\n            content={\n              <>\n                Manually edit the{' '}\n                <a\n                  href=\"https://docs.microsoft.com/en-us/azure/azure-monitor/logs/log-standard-columns#_resourceid\"\n                  rel=\"noopener noreferrer\"\n                  target=\"_blank\"\n                >\n                  resource uri\n                </a>\n                . Supports the use of multiple template variables (ex: /subscriptions/$subId/resourceGroups/$rg)\n              </>\n            }\n            placement=\"right\"\n            interactive={true}\n          >\n            <Icon name=\"info-circle\" />\n          </Tooltip>\n        </h6>\n      </Label>\n      {resources.map((resource, index) => (\n        <div key={`resource-${index + 1}`}>\n          <div className={styles.resourceList}>\n            <Input\n              id={`input-advanced-resource-picker-${index + 1}`}\n              value={resource}\n              onChange={(event) => onResourceChange(index, event.currentTarget.value)}\n              placeholder=\"ex: /subscriptions/$subId\"\n              data-testid={`input-advanced-resource-picker-${index + 1}`}\n            />\n            <AccessoryButton\n              aria-label=\"remove\"\n              icon=\"times\"\n              variant=\"secondary\"\n              onClick={() => removeResource(index)}\n              data-testid={`remove-resource`}\n              hidden={resources.length === 1}\n            />\n          </div>\n        </div>\n      ))}\n      <Button aria-label=\"Add\" icon=\"plus\" variant=\"secondary\" onClick={addResource} type=\"button\">\n        Add resource URI\n      </Button>\n    </>\n  );\n};\n\nexport default AdvancedResourcePicker;\n","import { SelectableValue } from '@grafana/data';\n\nimport { AzureMonitorQuery, ResultFormat } from '../../types';\n\nexport function setKustoQuery(query: AzureMonitorQuery, kustoQuery: string): AzureMonitorQuery {\n  return {\n    ...query,\n    azureLogAnalytics: {\n      ...query.azureLogAnalytics,\n      query: kustoQuery,\n    },\n  };\n}\n\nexport function setFormatAs(query: AzureMonitorQuery, formatAs: ResultFormat): AzureMonitorQuery {\n  return {\n    ...query,\n    azureLogAnalytics: {\n      ...query.azureLogAnalytics,\n      resultFormat: formatAs,\n    },\n  };\n}\n\nexport function setDashboardTime(query: AzureMonitorQuery, dashboardTime: string): AzureMonitorQuery {\n  return {\n    ...query,\n    azureLogAnalytics: {\n      ...query.azureLogAnalytics,\n      dashboardTime: dashboardTime === 'dashboard' ? true : false,\n    },\n  };\n}\n\nexport function setTimeColumn(query: AzureMonitorQuery, timeColumn: string): AzureMonitorQuery {\n  return {\n    ...query,\n    azureLogAnalytics: {\n      ...query.azureLogAnalytics,\n      timeColumn,\n    },\n  };\n}\n\nexport function setBasicLogsQuery(query: AzureMonitorQuery, basicLogsQuery: boolean): AzureMonitorQuery {\n  return {\n    ...query,\n    azureLogAnalytics: {\n      ...query.azureLogAnalytics,\n      basicLogsQuery,\n    },\n  };\n}\nexport function onLoad(\n  query: AzureMonitorQuery,\n  defaultValue: ResultFormat,\n  handleChange: (change: SelectableValue<ResultFormat>) => void\n) {\n  if (!query.azureLogAnalytics) {\n    handleChange({ value: defaultValue });\n    return;\n  }\n  if (!query.azureLogAnalytics.resultFormat) {\n    handleChange({ value: ResultFormat.TimeSeries });\n  }\n}\n","import { useState } from 'react';\n\nimport { ConfirmModal, InlineField, RadioButtonGroup } from '@grafana/ui';\n\nimport { AzureQueryEditorFieldProps } from '../../types';\n\nimport { setBasicLogsQuery, setDashboardTime, setKustoQuery } from './setQueryValue';\n\nexport function LogsManagement({ query, onQueryChange: onChange }: AzureQueryEditorFieldProps) {\n  const [basicLogsAckOpen, setBasicLogsAckOpen] = useState<boolean>(false);\n  return (\n    <>\n      <ConfirmModal\n        isOpen={basicLogsAckOpen}\n        title=\"Basic Logs Queries\"\n        body=\"Are you sure you want to switch to Basic Logs?\"\n        description=\"Basic Logs queries incur cost based on the amount of data scanned.\"\n        confirmText=\"Confirm\"\n        onConfirm={() => {\n          setBasicLogsAckOpen(false);\n          let updatedBasicLogsQuery = setBasicLogsQuery(query, true);\n          // if basic logs selected, set dashboard time\n          updatedBasicLogsQuery = setDashboardTime(updatedBasicLogsQuery, 'dashboard');\n          onChange(setKustoQuery(updatedBasicLogsQuery, ''));\n        }}\n        onDismiss={() => {\n          setBasicLogsAckOpen(false);\n          onChange(setBasicLogsQuery(query, false));\n        }}\n        confirmButtonVariant=\"primary\"\n      />\n      <InlineField label=\"Logs\" tooltip={<span>Specifies whether to run a Basic or Analytics Logs query.</span>}>\n        <RadioButtonGroup\n          options={[\n            { label: 'Analytics', value: false },\n            { label: 'Basic', value: true },\n          ]}\n          value={query.azureLogAnalytics?.basicLogsQuery ?? false}\n          size={'md'}\n          onChange={(val) => {\n            setBasicLogsAckOpen(val);\n            if (!val) {\n              const updatedBasicLogsQuery = setBasicLogsQuery(query, val);\n              onChange(setKustoQuery(updatedBasicLogsQuery, ''));\n            }\n          }}\n        />\n      </InlineField>\n    </>\n  );\n}\n","import { EngineSchema, getKustoWorker } from '@kusto/monaco-kusto';\nimport { useCallback, useEffect, useState } from 'react';\n\nimport { CodeEditor, Monaco, MonacoEditor } from '@grafana/ui';\n\nimport { AzureQueryEditorFieldProps } from '../../types';\n\nimport { setKustoQuery } from './setQueryValue';\n\ninterface MonacoEditorValues {\n  editor: MonacoEditor;\n  monaco: Monaco;\n}\n\nconst QueryField = ({ query, onQueryChange, schema }: AzureQueryEditorFieldProps) => {\n  const [monaco, setMonaco] = useState<MonacoEditorValues | undefined>();\n\n  useEffect(() => {\n    if (!schema || !monaco) {\n      return;\n    }\n\n    const setupEditor = async ({ monaco, editor }: MonacoEditorValues, schema: EngineSchema) => {\n      try {\n        const model = editor.getModel();\n        if (model) {\n          const kustoWorker = await getKustoWorker();\n          const kustoMode = await kustoWorker(model?.uri);\n          await kustoMode.setSchema(schema);\n        }\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    setupEditor(monaco, schema).catch((err) => console.error(err));\n  }, [schema, monaco]);\n\n  const handleEditorMount = useCallback((editor: MonacoEditor, monaco: Monaco) => {\n    setMonaco({ monaco, editor });\n  }, []);\n\n  const onChange = useCallback(\n    (newQuery: string) => {\n      onQueryChange(setKustoQuery(query, newQuery));\n    },\n    [onQueryChange, query]\n  );\n\n  return (\n    <CodeEditor\n      value={query.azureLogAnalytics?.query ?? ''}\n      language=\"kusto\"\n      height={200}\n      width=\"100%\"\n      showMiniMap={false}\n      onBlur={onChange}\n      onSave={onChange}\n      onEditorDidMount={handleEditorMount}\n    />\n  );\n};\n\nexport default QueryField;\n","import { useCallback, useEffect, useState } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { InlineField, RadioButtonGroup, Select } from '@grafana/ui';\n\nimport { AzureQueryEditorFieldProps } from '../../types';\n\nimport { setDashboardTime, setTimeColumn } from './setQueryValue';\n\nexport function TimeManagement({ query, onQueryChange: onChange, schema }: AzureQueryEditorFieldProps) {\n  const [defaultTimeColumns, setDefaultTimeColumns] = useState<SelectableValue[] | undefined>();\n  const [timeColumns, setTimeColumns] = useState<SelectableValue[] | undefined>();\n  const [disabledTimePicker, setDisabledTimePicker] = useState<boolean>(false);\n\n  const setDefaultColumn = useCallback((column: string) => onChange(setTimeColumn(query, column)), [query, onChange]);\n\n  useEffect(() => {\n    if (schema && query.azureLogAnalytics?.dashboardTime) {\n      const timeColumnOptions: SelectableValue[] = [];\n      const timeColumnsSet: Set<string> = new Set();\n      const defaultColumnsMap: Map<string, SelectableValue> = new Map();\n      const db = schema.database;\n      if (db) {\n        for (const table of db.tables) {\n          const cols = table.columns.reduce<SelectableValue[]>((prev, curr, i) => {\n            if (curr.type === 'datetime') {\n              if (!table.timespanColumn || table.timespanColumn !== curr.name) {\n                prev.push({ value: curr.name, label: `${table.name} > ${curr.name}` });\n                timeColumnsSet.add(curr.name);\n              }\n            }\n            return prev;\n          }, []);\n          timeColumnOptions.push(...cols);\n          if (table.timespanColumn && !defaultColumnsMap.has(table.timespanColumn)) {\n            defaultColumnsMap.set(table.timespanColumn, {\n              value: table.timespanColumn,\n              label: table.timespanColumn,\n            });\n          }\n        }\n      }\n      setTimeColumns(timeColumnOptions);\n      const defaultColumns = Array.from(defaultColumnsMap.values());\n      setDefaultTimeColumns(defaultColumns);\n\n      // Set default value\n      if (\n        !query.azureLogAnalytics.timeColumn ||\n        (query.azureLogAnalytics.timeColumn &&\n          !timeColumnsSet.has(query.azureLogAnalytics.timeColumn) &&\n          !defaultColumnsMap.has(query.azureLogAnalytics.timeColumn))\n      ) {\n        if (defaultColumns && defaultColumns.length) {\n          setDefaultColumn(defaultColumns[0].value);\n          setDefaultColumn(defaultColumns[0].value);\n          return;\n        } else if (timeColumnOptions && timeColumnOptions.length) {\n          setDefaultColumn(timeColumnOptions[0].value);\n          return;\n        } else {\n          setDefaultColumn('TimeGenerated');\n          return;\n        }\n      }\n    }\n  }, [schema, query.azureLogAnalytics?.dashboardTime, query.azureLogAnalytics?.timeColumn, setDefaultColumn]);\n\n  const handleTimeColumnChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setTimeColumn(query, change.value);\n      onChange(newQuery);\n    },\n    [onChange, query]\n  );\n\n  useEffect(() => {\n    if (query.azureLogAnalytics?.basicLogsQuery) {\n      setDisabledTimePicker(true);\n    } else {\n      setDisabledTimePicker(false);\n    }\n  }, [query.azureLogAnalytics?.basicLogsQuery]);\n  return (\n    <>\n      <InlineField\n        label=\"Time-range\"\n        tooltip={\n          <span>\n            Specifies the time-range used to query. The <code>Query</code> option will only use time-ranges specified in\n            the query. <code>Dashboard</code> will only use the Grafana time-range.\n          </span>\n        }\n      >\n        <RadioButtonGroup\n          options={[\n            { label: 'Query', value: 'query' },\n            { label: 'Dashboard', value: 'dashboard' },\n          ]}\n          value={query.azureLogAnalytics?.dashboardTime ? 'dashboard' : 'query'}\n          size={'md'}\n          onChange={(val) => onChange(setDashboardTime(query, val))}\n          disabled={disabledTimePicker}\n          disabledOptions={disabledTimePicker ? ['query'] : []}\n        />\n      </InlineField>\n      {query.azureLogAnalytics?.dashboardTime && (\n        <InlineField\n          label=\"Time Column\"\n          tooltip={\n            <span>\n              Specifies the time column used for filtering. Defaults to the first tables <code>timeSpan</code> column,\n              the first <code>datetime</code> column found or <code>TimeGenerated</code>.\n            </span>\n          }\n        >\n          <Select\n            options={[\n              {\n                label: 'Default time columns',\n                options: defaultTimeColumns ?? [{ value: 'TimeGenerated', label: 'TimeGenerated' }],\n              },\n              {\n                label: 'Other time columns',\n                options: timeColumns ?? [],\n              },\n            ]}\n            onChange={handleTimeColumnChange}\n            value={\n              query.azureLogAnalytics?.timeColumn\n                ? query.azureLogAnalytics?.timeColumn\n                : defaultTimeColumns\n                  ? defaultTimeColumns[0]\n                  : timeColumns\n                    ? timeColumns[0]\n                    : { value: 'TimeGenerated', label: 'TimeGenerated' }\n            }\n            allowCustomValue\n          />\n        </InlineField>\n      )}\n    </>\n  );\n}\n","import { useEffect, useState } from 'react';\n\nimport Datasource from '../../datasource';\nimport { AzureMonitorQuery } from '../../types';\nimport { isGUIDish } from '../ResourcePicker/utils';\n\nasync function migrateWorkspaceQueryToResourceQuery(\n  datasource: Datasource,\n  query: AzureMonitorQuery,\n  onChange: (newQuery: AzureMonitorQuery) => void\n) {\n  if (query.azureLogAnalytics?.workspace !== undefined && !query.azureLogAnalytics.resources) {\n    const isWorkspaceGUID = isGUIDish(query.azureLogAnalytics.workspace);\n    let resource: string;\n\n    if (isWorkspaceGUID) {\n      resource = await datasource.resourcePickerData.getResourceURIFromWorkspace(query.azureLogAnalytics.workspace);\n    } else {\n      // The value of workspace is probably a template variable so we just migrate it over as-is\n      resource = query.azureLogAnalytics.workspace;\n    }\n\n    const newQuery = {\n      ...query,\n      azureLogAnalytics: {\n        ...query.azureLogAnalytics,\n        resource: resource,\n        workspace: undefined,\n      },\n    };\n\n    delete newQuery.azureLogAnalytics.workspace;\n\n    onChange(newQuery);\n  }\n}\n\ninterface ErrorMessage {\n  title: string;\n  message: string;\n}\n\nexport default function useMigrations(\n  datasource: Datasource,\n  query: AzureMonitorQuery,\n  onChange: (newQuery: AzureMonitorQuery) => void\n) {\n  const [migrationError, setMigrationError] = useState<ErrorMessage>();\n\n  useEffect(() => {\n    migrateWorkspaceQueryToResourceQuery(datasource, query, onChange).catch((err) =>\n      setMigrationError({\n        title: 'Unable to migrate workspace as a resource',\n        message: err.message,\n      })\n    );\n  }, [datasource, query, onChange]);\n\n  return migrationError;\n}\n","import { getTemplateSrv } from '@grafana/runtime';\n\nimport { parseResourceURI } from '../ResourcePicker/utils';\n\nexport function shouldShowBasicLogsToggle(resources: string[], basicLogsEnabled: boolean) {\n  const selectedResource = getTemplateSrv()?.replace(resources[0]);\n  return (\n    basicLogsEnabled &&\n    resources.length === 1 &&\n    parseResourceURI(selectedResource).metricNamespace?.toLowerCase() === 'microsoft.operationalinsights/workspaces'\n  );\n}\n\nexport function calculateTimeRange(from: number, to: number): number {\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n  const timeRange = (to - from) / day;\n\n  return timeRange;\n}\n","import { useEffect, useState } from 'react';\n\nimport { PanelData, TimeRange } from '@grafana/data';\nimport { EditorFieldGroup, EditorRow, EditorRows } from '@grafana/experimental';\nimport { getTemplateSrv } from '@grafana/runtime';\nimport { Alert, LinkButton, Text, TextLink } from '@grafana/ui';\n\nimport Datasource from '../../datasource';\nimport { selectors } from '../../e2e/selectors';\nimport { AzureMonitorErrorish, AzureMonitorOption, AzureMonitorQuery, ResultFormat, EngineSchema } from '../../types';\nimport ResourceField from '../ResourceField';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from '../ResourcePicker/types';\nimport { parseResourceDetails } from '../ResourcePicker/utils';\nimport FormatAsField from '../shared/FormatAsField';\n\nimport AdvancedResourcePicker from './AdvancedResourcePicker';\nimport { LogsManagement } from './LogsManagement';\nimport QueryField from './QueryField';\nimport { TimeManagement } from './TimeManagement';\nimport { onLoad, setBasicLogsQuery, setFormatAs, setKustoQuery } from './setQueryValue';\nimport useMigrations from './useMigrations';\nimport { shouldShowBasicLogsToggle } from './utils';\n\ninterface LogsQueryEditorProps {\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  basicLogsEnabled: boolean;\n  subscriptionId?: string;\n  onChange: (newQuery: AzureMonitorQuery) => void;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n  hideFormatAs?: boolean;\n  timeRange?: TimeRange;\n  data?: PanelData;\n}\n\nconst LogsQueryEditor = ({\n  query,\n  datasource,\n  basicLogsEnabled,\n  subscriptionId,\n  variableOptionGroup,\n  onChange,\n  setError,\n  hideFormatAs,\n  timeRange,\n  data,\n}: LogsQueryEditorProps) => {\n  const migrationError = useMigrations(datasource, query, onChange);\n  const [showBasicLogsToggle, setShowBasicLogsToggle] = useState<boolean>(\n    shouldShowBasicLogsToggle(query.azureLogAnalytics?.resources || [], basicLogsEnabled)\n  );\n  const [dataIngestedWarning, setDataIngestedWarning] = useState<React.ReactNode | null>(null);\n  const templateSrv = getTemplateSrv();\n  const from = templateSrv?.replace('$__from');\n  const to = templateSrv?.replace('$__to');\n\n  const disableRow = (row: ResourceRow, selectedRows: ResourceRowGroup) => {\n    if (selectedRows.length === 0) {\n      // Only if there is some resource(s) selected we should disable rows\n      return false;\n    }\n    const rowResourceNS = parseResourceDetails(row.uri, row.location).metricNamespace?.toLowerCase();\n    const selectedRowSampleNs = parseResourceDetails(\n      selectedRows[0].uri,\n      selectedRows[0].location\n    ).metricNamespace?.toLowerCase();\n    // Only resources with the same metricNamespace can be selected\n    return rowResourceNS !== selectedRowSampleNs;\n  };\n  const [schema, setSchema] = useState<EngineSchema | undefined>();\n\n  useEffect(() => {\n    if (query.azureLogAnalytics?.resources && query.azureLogAnalytics.resources.length) {\n      datasource.azureLogAnalyticsDatasource.getKustoSchema(query.azureLogAnalytics.resources[0]).then((schema) => {\n        setSchema(schema);\n      });\n    }\n  }, [query.azureLogAnalytics?.resources, datasource.azureLogAnalyticsDatasource]);\n\n  useEffect(() => {\n    if (shouldShowBasicLogsToggle(query.azureLogAnalytics?.resources || [], basicLogsEnabled)) {\n      setShowBasicLogsToggle(true);\n    } else {\n      setShowBasicLogsToggle(false);\n    }\n  }, [basicLogsEnabled, query.azureLogAnalytics?.resources, templateSrv]);\n\n  useEffect(() => {\n    if ((!basicLogsEnabled || !showBasicLogsToggle) && query.azureLogAnalytics?.basicLogsQuery) {\n      const updatedBasicLogsQuery = setBasicLogsQuery(query, false);\n      onChange(setKustoQuery(updatedBasicLogsQuery, ''));\n    }\n  }, [basicLogsEnabled, onChange, query, showBasicLogsToggle]);\n\n  useEffect(() => {\n    const getBasicLogsUsage = async (query: AzureMonitorQuery) => {\n      try {\n        if (showBasicLogsToggle && query.azureLogAnalytics?.basicLogsQuery && !!query.azureLogAnalytics.query) {\n          const querySplit = query.azureLogAnalytics.query.split('|');\n          // Basic Logs queries are required to start the query with a table\n          const table = querySplit[0].trim();\n          const dataIngested = await datasource.azureLogAnalyticsDatasource.getBasicLogsQueryUsage(query, table);\n          const textToShow = !!dataIngested\n            ? `This query is processing ${dataIngested} GiB when run. `\n            : 'This is a Basic Logs query and incurs cost per GiB scanned. ';\n          setDataIngestedWarning(\n            <>\n              <Text color=\"primary\">\n                {textToShow}{' '}\n                <TextLink\n                  href=\"https://learn.microsoft.com/en-us/azure/azure-monitor/logs/basic-logs-configure?tabs=portal-1\"\n                  external\n                >\n                  Learn More\n                </TextLink>\n              </Text>\n            </>\n          );\n        } else {\n          setDataIngestedWarning(null);\n        }\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    getBasicLogsUsage(query).catch((err) => console.error(err));\n  }, [datasource.azureLogAnalyticsDatasource, query, showBasicLogsToggle, from, to]);\n  let portalLinkButton = null;\n\n  if (data?.series) {\n    const querySeries = data.series.find((result) => result.refId === query.refId);\n    if (querySeries && querySeries.meta?.custom?.azurePortalLink) {\n      portalLinkButton = (\n        <>\n          <LinkButton\n            size=\"md\"\n            target=\"_blank\"\n            style={{ marginTop: '22px' }}\n            href={querySeries.meta?.custom?.azurePortalLink}\n          >\n            View query in Azure Portal\n          </LinkButton>\n        </>\n      );\n    }\n  }\n\n  return (\n    <span data-testid={selectors.components.queryEditor.logsQueryEditor.container.input}>\n      <EditorRows>\n        <EditorRow>\n          <EditorFieldGroup>\n            <ResourceField\n              query={query}\n              datasource={datasource}\n              inlineField={true}\n              labelWidth={10}\n              subscriptionId={subscriptionId}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n              selectableEntryTypes={[\n                ResourceRowType.Subscription,\n                ResourceRowType.ResourceGroup,\n                ResourceRowType.Resource,\n                ResourceRowType.Variable,\n              ]}\n              resources={query.azureLogAnalytics?.resources ?? []}\n              queryType=\"logs\"\n              disableRow={disableRow}\n              renderAdvanced={(resources, onChange) => (\n                // It's required to cast resources because the resource picker\n                // specifies the type to string | AzureMonitorResource.\n                // eslint-disable-next-line\n                <AdvancedResourcePicker resources={resources as string[]} onChange={onChange} />\n              )}\n              selectionNotice={() => 'You may only choose items of the same resource type.'}\n            />\n            {showBasicLogsToggle && (\n              <LogsManagement\n                query={query}\n                datasource={datasource}\n                variableOptionGroup={variableOptionGroup}\n                onQueryChange={onChange}\n                setError={setError}\n              />\n            )}\n            <TimeManagement\n              query={query}\n              datasource={datasource}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n              schema={schema}\n            />\n          </EditorFieldGroup>\n        </EditorRow>\n        <QueryField\n          query={query}\n          datasource={datasource}\n          subscriptionId={subscriptionId}\n          variableOptionGroup={variableOptionGroup}\n          onQueryChange={onChange}\n          setError={setError}\n          schema={schema}\n        />\n        {dataIngestedWarning}\n        <EditorRow>\n          <EditorFieldGroup>\n            {!hideFormatAs && (\n              <FormatAsField\n                query={query}\n                datasource={datasource}\n                subscriptionId={subscriptionId}\n                variableOptionGroup={variableOptionGroup}\n                onQueryChange={onChange}\n                setError={setError}\n                inputId={'azure-monitor-logs'}\n                options={[\n                  { label: 'Log', value: ResultFormat.Logs },\n                  { label: 'Time series', value: ResultFormat.TimeSeries },\n                  { label: 'Table', value: ResultFormat.Table },\n                ]}\n                defaultValue={ResultFormat.Logs}\n                setFormatAs={setFormatAs}\n                resultFormat={query.azureLogAnalytics?.resultFormat}\n                onLoad={onLoad}\n              />\n            )}\n            {portalLinkButton}\n            {migrationError && <Alert title={migrationError.title}>{migrationError.message}</Alert>}\n          </EditorFieldGroup>\n        </EditorRow>\n      </EditorRows>\n    </span>\n  );\n};\n\nexport default LogsQueryEditor;\n","import hoistNonReactStatics from 'hoist-non-react-statics';\nimport memoize from 'micro-memoize';\nimport { useContext } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme, GrafanaTheme2, ThemeContext } from '@grafana/data';\n\nimport { Themeable, Themeable2 } from '../types/theme';\n\nimport { stylesFactory } from './stylesFactory';\n\ntype Omit<T, K> = Pick<T, Exclude<keyof T, K>>;\ntype Subtract<T, K> = Omit<T, keyof K>;\n\n/**\n * Mock used in tests\n */\nlet ThemeContextMock: React.Context<GrafanaTheme2> | null = null;\n\n// Used by useStyles()\nexport const memoizedStyleCreators = new WeakMap();\n\n/** @deprecated use withTheme2 */\n/** @public */\nexport const withTheme = <P extends Themeable, S extends {} = {}>(Component: React.ComponentType<P>) => {\n  const WithTheme: React.FunctionComponent<Subtract<P, Themeable>> = (props) => {\n    /**\n     * If theme context is mocked, let's use it instead of the original context\n     * This is used in tests when mocking theme using mockThemeContext function defined below\n     */\n    const ContextComponent = ThemeContextMock || ThemeContext;\n    return (\n      // @ts-ignore\n      <ContextComponent.Consumer>{(theme) => <Component {...props} theme={theme.v1} />}</ContextComponent.Consumer>\n    );\n  };\n\n  WithTheme.displayName = `WithTheme(${Component.displayName})`;\n  hoistNonReactStatics(WithTheme, Component);\n  type Hoisted = typeof WithTheme & S;\n  return WithTheme as Hoisted;\n};\n\n/** @alpha */\nexport const withTheme2 = <P extends Themeable2, S extends {} = {}>(Component: React.ComponentType<P>) => {\n  const WithTheme: React.FunctionComponent<Subtract<P, Themeable2>> = (props) => {\n    /**\n     * If theme context is mocked, let's use it instead of the original context\n     * This is used in tests when mocking theme using mockThemeContext function defined below\n     */\n    const ContextComponent = ThemeContextMock || ThemeContext;\n    return (\n      // @ts-ignore\n      <ContextComponent.Consumer>{(theme) => <Component {...props} theme={theme} />}</ContextComponent.Consumer>\n    );\n  };\n\n  WithTheme.displayName = `WithTheme(${Component.displayName})`;\n  hoistNonReactStatics(WithTheme, Component);\n  type Hoisted = typeof WithTheme & S;\n  return WithTheme as Hoisted;\n};\n\n/** @deprecated use useTheme2 */\n/** @public */\nexport function useTheme(): GrafanaTheme {\n  return useContext(ThemeContextMock || ThemeContext).v1;\n}\n\n/** @public */\nexport function useTheme2(): GrafanaTheme2 {\n  return useContext(ThemeContextMock || ThemeContext);\n}\n\n/**\n * Hook for using memoized styles with access to the theme.\n *\n * NOTE: For memoization to work, you need to ensure that the function\n * you pass in doesn't change, or only if it needs to. (i.e. declare\n * your style creator outside of a function component or use `useCallback()`.)\n * */\n/** @deprecated use useStyles2 */\n/** @public */\nexport function useStyles<T>(getStyles: (theme: GrafanaTheme) => T) {\n  const theme = useTheme();\n\n  let memoizedStyleCreator: typeof getStyles = memoizedStyleCreators.get(getStyles);\n\n  if (!memoizedStyleCreator) {\n    memoizedStyleCreator = stylesFactory(getStyles);\n    memoizedStyleCreators.set(getStyles, memoizedStyleCreator);\n  }\n\n  return memoizedStyleCreator(theme);\n}\n\n/**\n * Hook for using memoized styles with access to the theme. Pass additional\n * arguments to the getStyles function as additional arguments to this hook.\n *\n * Prefer using primitive values (boolean, number, string, etc) for\n * additional arguments for better performance\n *\n * ```\n * const getStyles = (theme, isDisabled, isOdd) => {css(...)}\n * [...]\n * const styles = useStyles2(getStyles, true, Boolean(index % 2))\n * ```\n *\n * NOTE: For memoization to work, ensure that all arguments don't change\n * across renders (or only change if they need to)\n *\n * @public\n * */\nexport function useStyles2<T extends unknown[], CSSReturnValue>(\n  getStyles: (theme: GrafanaTheme2, ...args: T) => CSSReturnValue,\n  ...additionalArguments: T\n): CSSReturnValue {\n  const theme = useTheme2();\n\n  let memoizedStyleCreator: typeof getStyles = memoizedStyleCreators.get(getStyles);\n\n  if (!memoizedStyleCreator) {\n    memoizedStyleCreator = memoize(getStyles, { maxSize: 10 }); // each getStyles function will memoize 10 different sets of props\n    memoizedStyleCreators.set(getStyles, memoizedStyleCreator);\n  }\n\n  return memoizedStyleCreator(theme, ...additionalArguments);\n}\n\n/**\n * Enables theme context mocking\n */\n/** @public */\nexport const mockThemeContext = (theme: Partial<GrafanaTheme2>) => {\n  ThemeContextMock = React.createContext(theme as GrafanaTheme2);\n\n  return () => {\n    ThemeContextMock = null;\n  };\n};\n","import { css, cx } from '@emotion/css';\nimport Prism, { Grammar } from 'prismjs';\n\nimport { GrafanaTheme2 } from '@grafana/data/src';\nimport { useTheme2 } from '@grafana/ui/src';\n\nexport interface Props {\n  query: string;\n  lang: {\n    grammar: Grammar;\n    name: string;\n  };\n  className?: string;\n}\nexport function RawQuery({ query, lang, className }: Props) {\n  const theme = useTheme2();\n  const styles = getStyles(theme);\n  const highlighted = Prism.highlight(query, lang.grammar, lang.name);\n\n  return (\n    <div\n      className={cx(styles.editorField, 'prism-syntax-highlight', className)}\n      aria-label=\"selector\"\n      dangerouslySetInnerHTML={{ __html: highlighted }}\n    />\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    editorField: css({\n      fontFamily: theme.typography.fontFamilyMonospace,\n      fontSize: theme.typography.bodySmall.fontSize,\n    }),\n  };\n};\n","import { Grammar } from 'prismjs';\n\nimport { CompletionItem } from '@grafana/ui';\n\nexport const QUERY_COMMANDS: CompletionItem[] = [\n  {\n    label: 'fields',\n    documentation: 'Retrieves the specified fields from log events',\n  },\n  { label: 'display', documentation: 'Specifies which fields to display in the query results' },\n  {\n    label: 'filter',\n    documentation: 'Filters the results of a query based on one or more conditions',\n  },\n  {\n    label: 'stats',\n    documentation: 'Calculates aggregate statistics based on the values of log fields',\n  },\n  { label: 'sort', documentation: 'Sorts the retrieved log events' },\n  { label: 'limit', documentation: 'Specifies the number of log events returned by the query' },\n  {\n    label: 'parse',\n    documentation:\n      'Extracts data from a log field, creating one or more ephemeral fields that you can process further in the query',\n  },\n];\n\nexport const COMPARISON_OPERATORS = ['=', '!=', '<', '<=', '>', '>='];\nexport const ARITHMETIC_OPERATORS = ['+', '-', '*', '/', '^', '%'];\n\nexport const NUMERIC_OPERATORS = [\n  {\n    label: 'abs',\n    detail: 'abs(a)',\n    documentation: 'Absolute value.',\n  },\n  {\n    label: 'ceil',\n    detail: 'ceil(a)',\n    documentation: 'Round to ceiling (the smallest integer that is greater than the value of a).',\n  },\n  {\n    label: 'floor',\n    detail: 'floor(a)',\n    documentation: 'Round to floor (the largest integer that is smaller than the value of a).',\n  },\n  {\n    label: 'greatest',\n    detail: 'greatest(a,b, ... z)',\n    documentation: 'Returns the largest value.',\n  },\n  {\n    label: 'least',\n    detail: 'least(a, b, ... z)',\n    documentation: 'Returns the smallest value.',\n  },\n  {\n    label: 'log',\n    detail: 'log(a)',\n    documentation: 'Natural logarithm.',\n  },\n  {\n    label: 'sqrt',\n    detail: 'sqrt(a)',\n    documentation: 'Square root.',\n  },\n];\n\nexport const GENERAL_FUNCTIONS = [\n  {\n    label: 'ispresent',\n    detail: 'ispresent(fieldname)',\n    documentation: 'Returns true if the field exists.',\n  },\n  {\n    label: 'coalesce',\n    detail: 'coalesce(fieldname1, fieldname2, ... fieldnamex)',\n    documentation: 'Returns the first non-null value from the list.',\n  },\n];\n\nexport const STRING_FUNCTIONS = [\n  {\n    label: 'isempty',\n    detail: 'isempty(fieldname)',\n    documentation: 'Returns true if the field is missing or is an empty string.',\n  },\n  {\n    label: 'isblank',\n    detail: 'isblank(fieldname)',\n    documentation: 'Returns true if the field is missing, an empty string, or contains only white space.',\n  },\n  {\n    label: 'concat',\n    detail: 'concat(string1, string2, ... stringz)',\n    documentation: 'Concatenates the strings.',\n  },\n  {\n    label: 'ltrim',\n    detail: 'ltrim(string) or ltrim(string1, string2)',\n    documentation:\n      'Remove white space from the left of the string. If the function has a second string argument, it removes the characters of string2 from the left of string1.',\n  },\n  {\n    label: 'rtrim',\n    detail: 'rtrim(string) or rtrim(string1, string2)',\n    documentation:\n      'Remove white space from the right of the string. If the function has a second string argument, it removes the characters of string2 from the right of string1.',\n  },\n  {\n    label: 'trim',\n    detail: 'trim(string) or trim(string1, string2)',\n    documentation:\n      'Remove white space from both ends of the string. If the function has a second string argument, it removes the characters of string2 from both sides of string1.',\n  },\n  {\n    label: 'strlen',\n    detail: 'strlen(string)',\n    documentation: 'Returns the length of the string in Unicode code points.',\n  },\n  {\n    label: 'toupper',\n    detail: 'toupper(string)',\n    documentation: 'Converts the string to uppercase.',\n  },\n  {\n    label: 'tolower',\n    detail: 'tolower(string)',\n    documentation: 'Converts the string to lowercase.',\n  },\n  {\n    label: 'substr',\n    detail: 'substr(string1, x), or substr(string1, x, y)',\n    documentation:\n      'Returns a substring from the index specified by the number argument to the end of the string. If the function has a second number argument, it contains the length of the substring to be retrieved.',\n  },\n  {\n    label: 'replace',\n    detail: 'replace(string1, string2, string3)',\n    documentation: 'Replaces all instances of string2 in string1 with string3.',\n  },\n  {\n    label: 'strcontains',\n    detail: 'strcontains(string1, string2)',\n    documentation: 'Returns 1 if string1 contains string2 and 0 otherwise.',\n  },\n];\n\nexport const DATETIME_FUNCTIONS = [\n  {\n    label: 'bin',\n    detail: 'bin(period)',\n    documentation: 'Rounds the value of @timestamp to the given period and then truncates.',\n  },\n  {\n    label: 'datefloor',\n    detail: 'datefloor(a, period)',\n    documentation: 'Truncates the timestamp to the given period.',\n  },\n  {\n    label: 'dateceil',\n    detail: 'dateceil(a, period)',\n    documentation: 'Rounds up the timestamp to the given period and then truncates.',\n  },\n  {\n    label: 'fromMillis',\n    detail: 'fromMillis(fieldname)',\n    documentation:\n      'Interprets the input field as the number of milliseconds since the Unix epoch and converts it to a timestamp.',\n  },\n  {\n    label: 'toMillis',\n    detail: 'toMillis(fieldname)',\n    documentation:\n      'Converts the timestamp found in the named field into a number representing the milliseconds since the Unix epoch.',\n  },\n];\n\nexport const IP_FUNCTIONS = [\n  {\n    label: 'isValidIp',\n    detail: 'isValidIp(fieldname)',\n    documentation: 'Returns true if the field is a valid v4 or v6 IP address.',\n  },\n  {\n    label: 'isValidIpV4',\n    detail: 'isValidIpV4(fieldname)',\n    documentation: 'Returns true if the field is a valid v4 IP address.',\n  },\n  {\n    label: 'isValidIpV6',\n    detail: 'isValidIpV6(fieldname)',\n    documentation: 'Returns true if the field is a valid v6 IP address.',\n  },\n  {\n    label: 'isIpInSubnet',\n    detail: 'isIpInSubnet(fieldname, string)',\n    documentation: 'Returns true if the field is a valid v4 or v6 IP address within the specified v4 or v6 subnet.',\n  },\n  {\n    label: 'isIpv4InSubnet',\n    detail: 'isIpv4InSubnet(fieldname, string)',\n    documentation: 'Returns true if the field is a valid v4 IP address within the specified v4 subnet.',\n  },\n  {\n    label: 'isIpv6InSubnet',\n    detail: 'isIpv6InSubnet(fieldname, string)',\n    documentation: 'Returns true if the field is a valid v6 IP address within the specified v6 subnet.',\n  },\n];\n\nexport const BOOLEAN_FUNCTIONS = [\n  {\n    label: 'ispresent',\n    detail: 'ispresent(fieldname)',\n    documentation: 'Returns true if the field exists.',\n  },\n  {\n    label: 'isempty',\n    detail: 'isempty(fieldname)',\n    documentation: 'Returns true if the field is missing or is an empty string.',\n  },\n  {\n    label: 'isblank',\n    detail: 'isblank(fieldname)',\n    documentation: 'Returns true if the field is missing, an empty string, or contains only white space.',\n  },\n  {\n    label: 'strcontains',\n    detail: 'strcontains(string1, string2)',\n    documentation: 'Returns 1 if string1 contains string2 and 0 otherwise.',\n  },\n  ...IP_FUNCTIONS,\n];\n\nexport const AGGREGATION_FUNCTIONS_STATS = [\n  {\n    label: 'avg',\n    detail: 'avg(NumericFieldname)',\n    documentation: 'The average of the values in the specified field.',\n  },\n  {\n    label: 'count',\n    detail: 'count(fieldname) or count(*)',\n    documentation: 'Counts the log records.',\n  },\n  {\n    label: 'count_distinct',\n    detail: 'count_distinct(fieldname)',\n    documentation: 'Returns the number of unique values for the field.',\n  },\n  {\n    label: 'max',\n    detail: 'max(fieldname)',\n    documentation: 'The maximum of the values for this log field in the queried logs.',\n  },\n  {\n    label: 'min',\n    detail: 'min(fieldname)',\n    documentation: 'The minimum of the values for this log field in the queried logs.',\n  },\n  {\n    label: 'pct',\n    detail: 'pct(fieldname, value)',\n    documentation: 'A percentile indicates the relative standing of a value in a datas.',\n  },\n  {\n    label: 'stddev',\n    detail: 'stddev(NumericFieldname)',\n    documentation: 'The standard deviation of the values in the specified field.',\n  },\n  {\n    label: 'sum',\n    detail: 'sum(NumericFieldname)',\n    documentation: 'The sum of the values in the specified field.',\n  },\n];\n\nexport const NON_AGGREGATION_FUNCS_STATS = [\n  {\n    label: 'earliest',\n    detail: 'earliest(fieldname)',\n    documentation:\n      'Returns the value of fieldName from the log event that has the earliest time stamp in the queried logs.',\n  },\n  {\n    label: 'latest',\n    detail: 'latest(fieldname)',\n    documentation:\n      'Returns the value of fieldName from the log event that has the latest time stamp in the queried logs.',\n  },\n  {\n    label: 'sortsFirst',\n    detail: 'sortsFirst(fieldname)',\n    documentation: 'Returns the value of fieldName that sorts first in the queried logs.',\n  },\n  {\n    label: 'sortsLast',\n    detail: 'sortsLast(fieldname)',\n    documentation: 'Returns the value of fieldName that sorts last in the queried logs.',\n  },\n];\n\nexport const STATS_FUNCS = [...AGGREGATION_FUNCTIONS_STATS, ...NON_AGGREGATION_FUNCS_STATS];\n\nexport const KEYWORDS = ['as', 'like', 'by', 'in', 'desc', 'asc'];\nexport const FIELD_AND_FILTER_FUNCTIONS = [\n  ...NUMERIC_OPERATORS,\n  ...GENERAL_FUNCTIONS,\n  ...STRING_FUNCTIONS,\n  ...DATETIME_FUNCTIONS,\n  ...IP_FUNCTIONS,\n];\n\nexport const FUNCTIONS = [...FIELD_AND_FILTER_FUNCTIONS, ...STATS_FUNCS];\n\nconst tokenizer: Grammar = {\n  comment: {\n    pattern: /^#.*/,\n    greedy: true,\n  },\n  backticks: {\n    pattern: /`.*?`/,\n    alias: 'string',\n    greedy: true,\n  },\n  quote: {\n    pattern: /\".*?\"/,\n    alias: 'string',\n    greedy: true,\n  },\n  regex: {\n    pattern: /\\/.*?\\/(?=\\||\\s*$|,)/,\n    greedy: true,\n  },\n  'query-command': {\n    pattern: new RegExp(`\\\\b(?:${QUERY_COMMANDS.map((command) => command.label).join('|')})\\\\b`, 'i'),\n    alias: 'function',\n  },\n  function: {\n    pattern: new RegExp(`\\\\b(?:${FUNCTIONS.map((f) => f.label).join('|')})\\\\b`, 'i'),\n  },\n  keyword: {\n    pattern: new RegExp(`(\\\\s+)(${KEYWORDS.join('|')})(?=\\\\s+)`, 'i'),\n    lookbehind: true,\n  },\n  'log-group-name': {\n    pattern: /[\\.\\-_/#A-Za-z0-9]+/,\n  },\n  'field-name': {\n    pattern: /(@?[_a-zA-Z]+[_.0-9a-zA-Z]*)|(`((\\\\`)|([^`]))*?`)/,\n    greedy: true,\n  },\n  number: /\\b-?\\d+((\\.\\d*)?([eE][+-]?\\d+)?)?\\b/,\n  'command-separator': {\n    pattern: /\\|/,\n    alias: 'punctuation',\n  },\n  'comparison-operator': {\n    pattern: /([<>]=?)|(!?=)/,\n  },\n  punctuation: /[{}()`,.]/,\n  whitespace: /\\s+/,\n};\n\nexport default tokenizer;\n","import { css } from '@emotion/css';\nimport { useEffect, useMemo, useState } from 'react';\n\nimport { GrafanaTheme2, SelectableValue } from '@grafana/data';\nimport { reportInteraction } from '@grafana/runtime';\nimport {\n  Button,\n  Card,\n  Collapse,\n  CustomScrollbar,\n  Field,\n  Input,\n  LoadingPlaceholder,\n  Select,\n  useStyles2,\n} from '@grafana/ui';\n\nimport AzureLogAnalyticsDatasource from '../../azure_log_analytics/azure_log_analytics_datasource';\nimport {\n  AzureMonitorQuery,\n  AzureQueryType,\n  Category,\n  CheatsheetQueries,\n  CheatsheetQuery,\n  DropdownCategories,\n} from '../../types';\n\nimport { RawQuery } from './RawQuery';\nimport tokenizer from './syntax';\n\nexport interface AzureCheatSheetProps {\n  onChange: (query: AzureMonitorQuery) => void;\n  query: AzureMonitorQuery;\n  datasource: AzureLogAnalyticsDatasource;\n}\n\nconst AzureCheatSheet = (props: AzureCheatSheetProps) => {\n  const [cheatsheetQueries, setCheatsheetQueries] = useState<CheatsheetQueries | null>(null);\n  const [areDropdownsOpen, setAreDropdownsOpen] = useState<DropdownCategories>({});\n  const [visibleQueries, setVisibleQueries] = useState<CheatsheetQueries | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [searchInputValue, setSearchInputValue] = useState('');\n  const styles = useStyles2(getStyles);\n  const lang = { grammar: tokenizer, name: 'kql' };\n  const dropdownMenu = useMemo(() => {\n    if (cheatsheetQueries) {\n      return Object.keys(cheatsheetQueries).map((category): SelectableValue<string> => {\n        return {\n          label: category,\n          value: category,\n        };\n      });\n    }\n    return [];\n  }, [cheatsheetQueries]);\n\n  const getCheatsheetQueries = async () => {\n    await props.datasource.getAzureLogAnalyticsCheatsheetQueries().then((result) => {\n      result.categories.sort((a: Category, b: Category) => {\n        return a.displayName.toLowerCase() === b.displayName.toLowerCase()\n          ? 0\n          : a.displayName.toLowerCase() < b.displayName.toLowerCase()\n            ? -1\n            : 1;\n      });\n      const alphabetizedQueries = result.categories.reduce(\n        (queriesByCategory: CheatsheetQueries, category: Category) => {\n          const categoryQueries = category.related.queries.map((queryId: string) => {\n            return result.queries.find((query: CheatsheetQuery) => query.id === queryId);\n          });\n          queriesByCategory[category.displayName] = categoryQueries;\n          setAreDropdownsOpen({ ...areDropdownsOpen, [category.id]: false });\n          return queriesByCategory;\n        },\n        {}\n      );\n      setCheatsheetQueries(alphabetizedQueries);\n      setVisibleQueries(alphabetizedQueries);\n      setIsLoading(false);\n      return alphabetizedQueries;\n    });\n  };\n\n  useEffect(() => {\n    if (!cheatsheetQueries) {\n      getCheatsheetQueries();\n    }\n  });\n\n  const filterQueriesBySearch = (searchValue: string) => {\n    const visibleQueriesCategories = Object.keys(visibleQueries!);\n    if (searchValue.length > 0 && cheatsheetQueries) {\n      const filteredQueries: CheatsheetQueries = Object.keys(cheatsheetQueries).reduce(\n        (filteredQueriesBySearch: CheatsheetQueries, category) => {\n          const filters = cheatsheetQueries![category]!.filter((query) => {\n            return query.displayName.toLowerCase().includes(searchValue.toLowerCase());\n          });\n          if (visibleQueriesCategories.includes(category)) {\n            filteredQueriesBySearch[category] = filters;\n          }\n          return filteredQueriesBySearch;\n        },\n        {}\n      );\n\n      setVisibleQueries(filteredQueries);\n      return filteredQueries;\n    } else {\n      if (Object.keys(visibleQueries!).length !== Object.keys(cheatsheetQueries!).length) {\n        setVisibleQueries(visibleQueries);\n        return visibleQueries;\n      } else {\n        setVisibleQueries(cheatsheetQueries);\n        return cheatsheetQueries;\n      }\n    }\n  };\n\n  const filterQueriesByCategory = (categories: SelectableValue<string>) => {\n    if (categories.length > 0) {\n      const selectedCategories = categories.map((selectedCategory: SelectableValue) => selectedCategory.label);\n      const updatedVisibleQueries = selectedCategories.reduce(\n        (updatedVisibleQueries: CheatsheetQueries, queryCategory: string) => {\n          updatedVisibleQueries[queryCategory] = cheatsheetQueries![queryCategory]!;\n          return updatedVisibleQueries;\n        },\n        {}\n      );\n      setVisibleQueries(updatedVisibleQueries);\n    } else {\n      setVisibleQueries(cheatsheetQueries);\n    }\n  };\n\n  return (\n    <div>\n      {!isLoading && visibleQueries ? (\n        <div>\n          <div className={styles.filterAlignment}>\n            <Input\n              value={searchInputValue}\n              onChange={(e) => {\n                setSearchInputValue(e.currentTarget.value);\n                const filteredQueries = filterQueriesBySearch(e.currentTarget.value);\n                setVisibleQueries(filteredQueries);\n              }}\n              placeholder=\"Search Logs queries\"\n              width={40}\n            />\n            <Field label=\"Categories\" className={styles.categoryDropdown}>\n              <Select\n                options={dropdownMenu}\n                value={''}\n                onChange={(a) => filterQueriesByCategory(a)}\n                allowCustomValue={false}\n                backspaceRemovesValue={true}\n                placeholder=\"All categories\"\n                isClearable={true}\n                noOptionsMessage=\"Unable to list all categories\"\n                formatCreateLabel={(input: string) => `Category: ${input}`}\n                isSearchable={true}\n                isMulti={true}\n                width={40}\n              />\n            </Field>\n          </div>\n          <div className={styles.spacing}>\n            Query results:{' '}\n            {Object.keys(visibleQueries).reduce((totalQueries: number, category) => {\n              totalQueries = visibleQueries[category]!.length + totalQueries;\n              return totalQueries;\n            }, 0)}\n          </div>\n          <CustomScrollbar showScrollIndicators={true} autoHeightMax=\"350px\">\n            {Object.keys(visibleQueries).map((category: string) => {\n              if (visibleQueries[category]!.length) {\n                return (\n                  <Collapse\n                    label={category + ' ' + `(${visibleQueries[category]!.length})`}\n                    collapsible={true}\n                    isOpen={areDropdownsOpen[category]}\n                    onToggle={(isOpen) => setAreDropdownsOpen({ ...areDropdownsOpen, [category]: isOpen })}\n                    key={category}\n                  >\n                    {visibleQueries[category]!.map((query) => {\n                      return (\n                        <Card className={styles.card} key={query.id}>\n                          <Card.Heading>{query.displayName}</Card.Heading>\n                          <CustomScrollbar showScrollIndicators={true} autoHeightMax=\"100px\">\n                            <RawQuery\n                              aria-label={`${query.displayName} raw query`}\n                              query={query.body}\n                              lang={lang}\n                              className={styles.rawQuery}\n                            />\n                          </CustomScrollbar>\n                          <Card.Actions>\n                            <Button\n                              size=\"sm\"\n                              aria-label=\"use this query button\"\n                              onClick={() => {\n                                props.onChange({\n                                  refId: 'A',\n                                  queryType: AzureQueryType.LogAnalytics,\n                                  azureLogAnalytics: { query: query.body },\n                                  datasource: props.datasource,\n                                });\n                                reportInteraction('grafana_azure_cheatsheet_logs_query_selected', {\n                                  id: query.id,\n                                  queryName: query.displayName,\n                                  query: query.body,\n                                  queryCategories: query.related.categories,\n                                });\n                              }}\n                            >\n                              Use this query\n                            </Button>\n                          </Card.Actions>\n                        </Card>\n                      );\n                    })}\n                  </Collapse>\n                );\n              }\n              return;\n            })}\n          </CustomScrollbar>\n        </div>\n      ) : (\n        <LoadingPlaceholder text=\"Loading...\" />\n      )}\n    </div>\n  );\n};\n\nexport default AzureCheatSheet;\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    card: css({\n      width: '90%',\n      display: 'flex',\n      flexDirection: 'column',\n    }),\n    rawQuery: css({\n      backgroundColor: `${theme.colors.background.primary}`,\n      padding: `${theme.spacing(1)}`,\n      marginTop: `${theme.spacing(1)}`,\n    }),\n    spacing: css({\n      marginBottom: `${theme.spacing(1)}`,\n    }),\n    filterAlignment: css({\n      display: 'flex',\n    }),\n    categoryDropdown: css({\n      margin: '0 0 10px 10px',\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'center',\n    }),\n  };\n};\n","import { CoreApp } from '@grafana/data';\nimport { Modal } from '@grafana/ui';\n\nimport AzureLogAnalyticsDatasource from '../../azure_log_analytics/azure_log_analytics_datasource';\nimport { AzureMonitorQuery } from '../../dataquery.gen';\n\nimport AzureCheatSheet from './AzureCheatSheet';\n\ntype Props = {\n  isOpen: boolean;\n  app?: CoreApp;\n  onClose: () => void;\n  onChange: (query: AzureMonitorQuery) => void;\n  onAddQuery?: (query: AzureMonitorQuery) => void;\n  datasource: AzureLogAnalyticsDatasource;\n};\n\nexport const AzureCheatSheetModal = (props: Props) => {\n  const { isOpen, onClose, datasource, onChange } = props;\n\n  return (\n    <Modal aria-label=\"Kick start your query modal\" isOpen={isOpen} title=\"Kick start your query\" onDismiss={onClose}>\n      <AzureCheatSheet\n        onChange={(a) => {\n          onChange(a);\n          onClose();\n        }}\n        query={{ refId: 'A' }}\n        datasource={datasource}\n      ></AzureCheatSheet>\n    </Modal>\n  );\n};\n","/**\nThis list is obtained parsing https://docs.microsoft.com/en-us/azure/governance/resource-graph/reference/supported-tables-resources\nTo programatically get the list, execute in the browser console:\n \n const i = {};\n document.querySelectorAll('li').forEach((li) => { \n    const m = li.textContent.match(/(.*\\..*\\/.*?)\\s\\((.*)\\)/);\n    if (m) {\n      i[m[1].toLowerCase()] = m[2];\n    }\n  });\n  i;\n \nNote: Validate that the output makes sense, the format of the page may change.\n */\nexport const resourceTypeDisplayNames: { [k: string]: string } = {\n  '84codes.cloudamqp/servers': 'CloudAMQP',\n  'citrix.services/xenappessentials': 'Citrix Virtual Apps Essentials',\n  'citrix.services/xendesktopessentials': 'Citrix Virtual Desktops Essentials',\n  'dynatrace.observability/monitors': 'Dynatrace',\n  'github.enterprise/accounts': 'GitHub AE',\n  'livearena.broadcast/services': 'LiveArena Broadcast',\n  'mailjet.email/services': 'Mailjet Email Service',\n  'microsoft.aad/domainservices': 'Azure AD Domain Services',\n  'microsoft.aadiam/privatelinkforazuread': 'Private Link for Azure AD',\n  'microsoft.agfoodplatform/farmbeats': 'Azure FarmBeats',\n  'microsoft.analysisservices/servers': 'Analysis Services',\n  'microsoft.anybuild/clusters': 'AnyBuild clusters',\n  'microsoft.apimanagement/service': 'API Management services',\n  'microsoft.appconfiguration/configurationstores': 'App Configuration',\n  'microsoft.appplatform/spring': 'Azure Spring Cloud',\n  'microsoft.attestation/attestationproviders': 'Attestation providers',\n  'microsoft.authorization/resourcemanagementprivatelinks': 'Resource management private links',\n  'microsoft.automation/automationaccounts': 'Automation Accounts',\n  'microsoft.automation/automationaccounts/runbooks': 'Runbook',\n  'microsoft.autonomoussystems/workspaces': 'Bonsai',\n  'microsoft.avs/privateclouds': 'AVS Private clouds',\n  'microsoft.azureactivedirectory/b2cdirectories': 'B2C Tenants',\n  'microsoft.azureactivedirectory/guestusages': 'Guest Usages',\n  'microsoft.azurearcdata/datacontrollers': 'Azure Arc data controllers',\n  'microsoft.azurearcdata/postgresinstances': 'Azure Arc-enabled PostgreSQL Hyperscale server groups',\n  'microsoft.azurearcdata/sqlmanagedinstances': 'SQL managed instances - Azure Arc',\n  'microsoft.azurearcdata/sqlserverinstances': 'SQL Server - Azure Arc',\n  'microsoft.azuredata/sqlserverregistrations': 'SQL Server registries',\n  'microsoft.azurepercept/accounts': 'Azure Percept accounts',\n  'microsoft.azurestack/registrations': 'Azure Stack Hubs',\n  'microsoft.azurestackhci/clusters': 'Azure Stack HCI',\n  'microsoft.azurestackhci/virtualmachines': 'Azure Stack HCI virtual machine - Azure Arc',\n  'microsoft.baremetal/crayservers': 'Cray Servers',\n  'microsoft.baremetal/monitoringservers': 'Monitoring Servers',\n  'microsoft.baremetalinfrastructure/baremetalinstances': 'BareMetal Instances',\n  'microsoft.batch/batchaccounts': 'Batch accounts',\n  'microsoft.bing/accounts': 'Bing Resources',\n  'microsoft.blockchain/blockchainmembers': 'Azure Blockchain Service',\n  'microsoft.blockchain/cordamembers': 'Corda',\n  'microsoft.botservice/botservices': 'Bot Services',\n  'microsoft.cache/redis': 'Azure Cache for Redis',\n  'microsoft.cache/redisenterprise': 'Redis Enterprise',\n  'microsoft.cdn/cdnwebapplicationfirewallpolicies': 'Content Delivery Network WAF policies',\n  'microsoft.cdn/profiles': '(front doors standard/premium Preview)',\n  'microsoft.cdn/profiles/afdendpoints': 'Endpoints',\n  'microsoft.cdn/profiles/endpoints': 'Endpoints',\n  'microsoft.certificateregistration/certificateorders': 'App Service Certificates',\n  'microsoft.chaos/chaosexperiments': 'Chaos Experiments (Classic)',\n  'microsoft.chaos/experiments': 'Chaos Experiments',\n  'microsoft.classiccompute/domainnames': 'Cloud services (classic)',\n  'microsoft.classiccompute/virtualmachines': 'Virtual machines (classic)',\n  'microsoft.classicnetwork/networksecuritygroups': 'Network security groups (classic)',\n  'microsoft.classicnetwork/reservedips': 'Reserved IP addresses (classic)',\n  'microsoft.classicnetwork/virtualnetworks': 'Virtual networks (classic)',\n  'microsoft.classicstorage/storageaccounts': 'Storage accounts (classic)',\n  'microsoft.cloudtest/accounts': 'CloudTest Accounts',\n  'microsoft.cloudtest/hostedpools': '1ES Hosted Pools',\n  'microsoft.cloudtest/images': 'CloudTest Images',\n  'microsoft.cloudtest/pools': 'CloudTest Pools',\n  'microsoft.cognition/syntheticsaccounts': 'Synthetics Accounts',\n  'microsoft.clusterstor/nodes': 'ClusterStors',\n  'microsoft.cognitiveservices/accounts': 'Cognitive Services',\n  'microsoft.compute/availabilitysets': 'Availability sets',\n  'microsoft.compute/capacityreservationgroups': 'Capacity Reservation Groups',\n  'microsoft.compute/cloudservices': 'Cloud services (extended support)',\n  'microsoft.compute/diskaccesses': 'Disk Accesses',\n  'microsoft.compute/diskencryptionsets': 'Disk Encryption Sets',\n  'microsoft.compute/disks': 'Disks',\n  'microsoft.compute/galleries': 'Azure compute galleries',\n  'microsoft.compute/galleries/applications': 'VM application definitions',\n  'microsoft.compute/galleries/applications/versions': 'VM application versions',\n  'microsoft.compute/galleries/images': 'VM image definitions',\n  'microsoft.compute/galleries/images/versions': 'VM image versions',\n  'microsoft.compute/hostgroups': 'Host groups',\n  'microsoft.compute/hostgroups/hosts': 'Hosts',\n  'microsoft.compute/images': 'Images',\n  'microsoft.compute/proximityplacementgroups': 'Proximity placement groups',\n  'microsoft.compute/restorepointcollections': 'Restore Point Collections',\n  'microsoft.compute/snapshots': 'Snapshots',\n  'microsoft.compute/sshpublickeys': 'SSH keys',\n  'microsoft.compute/virtualmachines': 'Virtual machines',\n  'microsoft.compute/virtualmachinescalesets': 'Virtual machine scale sets',\n  'microsoft.confidentialledger/ledgers': 'Confidential Ledgers',\n  'microsoft.confluent/organizations': 'Confluent organizations',\n  'microsoft.connectedcache/cachenodes': 'Connected Cache Resources',\n  'microsoft.connectedcache/enterprisecustomers': 'Connected Cache Resources',\n  'microsoft.connectedvehicle/platformaccounts': 'Connected Vehicle Platforms',\n  'microsoft.connectedvmwarevsphere/vcenters': 'VMware vCenters',\n  'microsoft.connectedvmwarevsphere/virtualmachines': 'VMware + AVS virtual machines',\n  'microsoft.containerinstance/containergroups': 'Container instances',\n  'microsoft.containerregistry/registries': 'Container registries',\n  'microsoft.containerregistry/registries/replications': 'Container registry replications',\n  'microsoft.containerregistry/registries/webhooks': 'Container registry webhooks',\n  'microsoft.containerservice/managedclusters': 'Kubernetes services',\n  'microsoft.dashboard/grafana': 'Grafana Workspaces',\n  'microsoft.databox/jobs': 'Azure Data Box',\n  'microsoft.databoxedge/databoxedgedevices': 'Azure Stack Edge / Data Box Gateway',\n  'microsoft.databricks/workspaces': 'Azure Databricks Services',\n  'microsoft.datacatalog/catalogs': 'Data Catalog',\n  'microsoft.datacollaboration/workspaces': 'Project CI',\n  'microsoft.datadog/monitors': 'Datadog',\n  'microsoft.datafactory/datafactories': 'Data factories',\n  'microsoft.datafactory/factories': 'Data factories (V2)',\n  'microsoft.datalakeanalytics/accounts': 'Data Lake Analytics',\n  'microsoft.datalakestore/accounts': 'Data Lake Storage Gen1',\n  'microsoft.datamigration/services': 'Azure Database Migration Services',\n  'microsoft.datamigration/services/projects': 'Azure Database Migration Projects',\n  'microsoft.datamigration/sqlmigrationservices': 'Azure Database Migration Services',\n  'microsoft.dataprotection/backupvaults': 'Backup vaults',\n  'microsoft.dataprotection/resourceguards': 'Resource Guards (Preview)',\n  'microsoft.datareplication/replicationvaults': 'Site Recovery Vaults',\n  'microsoft.datashare/accounts': 'Data Shares',\n  'microsoft.dbformariadb/servers': 'Azure Database for MariaDB servers',\n  'microsoft.dbformysql/flexibleservers': 'Azure Database for MySQL flexible servers',\n  'microsoft.dbformysql/servers': 'Azure Database for MySQL servers',\n  'microsoft.dbforpostgresql/flexibleservers': 'Azure Database for PostgreSQL flexible servers',\n  'microsoft.dbforpostgresql/servergroups': 'Azure Database for PostgreSQL server groups',\n  'microsoft.dbforpostgresql/servergroupsv2': 'Azure Database for PostgreSQL server groups',\n  'microsoft.dbforpostgresql/servers': 'Azure Database for PostgreSQL servers',\n  'microsoft.dbforpostgresql/serversv2': 'Azure Database for PostgreSQL servers v2',\n  'microsoft.deploymentmanager/rollouts': 'Rollouts',\n  'microsoft.desktopvirtualization/applicationgroups': 'Application groups',\n  'microsoft.desktopvirtualization/hostpools': 'Host pools',\n  'microsoft.desktopvirtualization/scalingplans': 'Scaling plans',\n  'microsoft.desktopvirtualization/workspaces': 'Workspaces',\n  'microsoft.devices/iothubs': 'IoT Hub',\n  'microsoft.devices/provisioningservices': 'Device Provisioning Services',\n  'microsoft.deviceupdate/accounts': 'Device Update for IoT Hubs',\n  'microsoft.devops/pipelines': 'DevOps Starter',\n  'microsoft.devtestlab/labs': 'DevTest Labs',\n  'microsoft.devtestlab/labs/virtualmachines': 'Virtual machines',\n  'microsoft.digitaltwins/digitaltwinsinstances': 'Azure Digital Twins',\n  'microsoft.documentdb/cassandraclusters': 'Azure Managed Instance for Apache Cassandra',\n  'microsoft.documentdb/databaseaccounts': 'Azure Cosmos DB accounts',\n  'microsoft.domainregistration/domains': 'App Service Domains',\n  'microsoft.edgeorder/addresses': 'Azure Edge Hardware Center Address',\n  'microsoft.edgeorder/orderitems': 'Azure Edge Hardware Center',\n  'microsoft.elastic/monitors': 'Elasticsearch (Elastic Cloud)',\n  'microsoft.eventgrid/domains': 'Event Grid Domains',\n  'microsoft.eventgrid/partnernamespaces': 'Event Grid Partner Namespaces',\n  'microsoft.eventgrid/partnerregistrations': 'Event Grid Partner Registrations',\n  'microsoft.eventgrid/partnertopics': 'Event Grid Partner Topics',\n  'microsoft.eventgrid/systemtopics': 'Event Grid System Topics',\n  'microsoft.eventgrid/topics': 'Event Grid Topics',\n  'microsoft.eventhub/clusters': 'Event Hubs Clusters',\n  'microsoft.eventhub/namespaces': 'Event Hubs Namespaces',\n  'microsoft.experimentation/experimentworkspaces': 'Experiment Workspaces',\n  'microsoft.extendedlocation/customlocations': 'Custom locations',\n  'microsoft.fidalgo/devcenters': 'Fidalgo DevCenters',\n  'microsoft.fidalgo/networksettings': 'Network Configurations',\n  'microsoft.fidalgo/projects': 'Fidalgo Projects',\n  'microsoft.fidalgo/projects/environments': 'Fidalgo Environments',\n  'microsoft.fluidrelay/fluidrelayservers': 'Fluid Relay',\n  'microsoft.genomics/accounts': 'Genomics accounts',\n  'microsoft.hanaonazure/hanainstances': 'SAP HANA on Azure',\n  'microsoft.hanaonazure/sapmonitors': 'Azure Monitors for SAP Solutions',\n  'microsoft.hdinsight/clusterpools': 'HDInsight cluster pools',\n  'microsoft.hdinsight/clusterpools/clusters': 'HDInsight gen2 clusters',\n  'microsoft.hdinsight/clusterpools/clusters/sessionclusters': 'HDInsight session clusters',\n  'microsoft.hdinsight/clusters': 'HDInsight clusters',\n  'microsoft.healthbot/healthbots': 'Azure Health Bot',\n  'microsoft.healthcareapis/services': 'Azure API for FHIR',\n  'microsoft.healthcareapis/workspaces': 'Healthcare APIs Workspaces',\n  'microsoft.healthcareapis/workspaces/dicomservices': 'DICOM services',\n  'microsoft.healthcareapis/workspaces/fhirservices': 'FHIR services',\n  'microsoft.healthcareapis/workspaces/iotconnectors': 'IoT connectors',\n  'microsoft.hpcworkbench/instances': 'HPC Workbenches (preview)',\n  'microsoft.hpcworkbench/instances/chambers': 'Chambers (preview)',\n  'microsoft.hpcworkbench/instances/chambers/accessprofiles': 'Chamber Profiles (preview)',\n  'microsoft.hpcworkbench/instances/chambers/workloads': 'Chamber VMs (preview)',\n  'microsoft.hpcworkbench/instances/consortiums': 'Consortiums (preview)',\n  'microsoft.hybridcompute/machines': 'Servers - Azure Arc',\n  'microsoft.hybridcompute/privatelinkscopes': 'Azure Arc Private Link Scopes',\n  'microsoft.hybridcontainerservice/provisionedclusters': 'Provisioned clusters',\n  'microsoft.hybriddata/datamanagers': 'StorSimple Data Managers',\n  'microsoft.hybridnetwork/devices': 'Azure Network Function Manager – Devices',\n  'microsoft.hybridnetwork/networkfunctions': 'Azure Network Function Manager – Network Functions',\n  'microsoft.importexport/jobs': 'Import/export jobs',\n  'microsoft.insights/components': 'Application Insights',\n  'microsoft.insights/datacollectionendpoints': 'Data collection endpoints',\n  'microsoft.insights/datacollectionrules': 'Data collection rules',\n  'microsoft.insights/privatelinkscopes': 'Azure Monitor Private Link Scopes',\n  'microsoft.insights/webtests': 'Availability tests',\n  'microsoft.insights/workbooks': 'Azure Workbooks',\n  'microsoft.insights/workbooktemplates': 'Azure Workbook Templates',\n  'microsoft.intelligentitdigitaltwin/digitaltwins': 'Minervas',\n  'microsoft.intelligentitdigitaltwin/digitaltwins/assets': 'Assets',\n  'microsoft.intelligentitdigitaltwin/digitaltwins/executionplans': 'Deployments',\n  'microsoft.intelligentitdigitaltwin/digitaltwins/testplans': 'Suites',\n  'microsoft.intelligentitdigitaltwin/digitaltwins/tests': 'Scripts',\n  'microsoft.iotcentral/iotapps': 'IoT Central Applications',\n  'microsoft.keyvault/vaults': 'Key vaults',\n  'microsoft.kubernetes/connectedclusters': 'Kubernetes - Azure Arc',\n  'microsoft.kusto/clusters': 'Azure Data Explorer Clusters',\n  'microsoft.kusto/clusters/databases': 'Azure Data Explorer Databases',\n  'microsoft.labservices/labaccounts': 'Lab Services',\n  'microsoft.labservices/labplans': 'Lab plans',\n  'microsoft.labservices/labs': 'Labs',\n  'microsoft.loadtestservice/loadtests': 'Azure Load Testing',\n  'microsoft.logic/integrationaccounts': 'Integration accounts',\n  'microsoft.logic/integrationserviceenvironments': 'Integration Service Environments',\n  'microsoft.logic/integrationserviceenvironments/managedapis': 'Managed Connector',\n  'microsoft.logic/workflows': 'Logic apps',\n  'microsoft.logz/monitors': 'Logz main account',\n  'microsoft.logz/monitors/accounts': 'Logz sub account',\n  'microsoft.logz/monitors/metricssource': 'Logz metrics data source',\n  'microsoft.machinelearning/commitmentplans': 'Machine Learning Studio (classic) web service plans',\n  'microsoft.machinelearning/webservices': 'Machine Learning Studio (classic) web services',\n  'microsoft.machinelearning/workspaces': 'Machine Learning Studio (classic) workspaces',\n  'microsoft.machinelearningservices/workspaces': 'Machine learning',\n  'microsoft.machinelearningservices/workspaces/onlineendpoints': 'Machine learning online endpoints',\n  'microsoft.machinelearningservices/workspaces/onlineendpoints/deployments': 'Machine learning online deployments',\n  'microsoft.maintenance/maintenanceconfigurations': 'Maintenance Configurations',\n  'microsoft.managedidentity/userassignedidentities': 'Managed Identities',\n  'microsoft.maps/accounts': 'Azure Maps Accounts',\n  'microsoft.maps/accounts/creators': 'Azure Maps Creator Resources',\n  'microsoft.marketplaceapps/classicdevservices': 'Classic Dev Services',\n  'microsoft.media/mediaservices': 'Media Services',\n  'microsoft.media/mediaservices/liveevents': 'Live events',\n  'microsoft.media/mediaservices/streamingendpoints': 'Streaming Endpoints',\n  'microsoft.media/videoanalyzers': 'Video Analyzers',\n  'microsoft.migrate/projects': 'Migration projects',\n  'microsoft.mixedreality/holographicsbroadcastaccounts': 'Holographics Broadcast Accounts',\n  'microsoft.mixedreality/objectanchorsaccounts': 'Object Anchors Accounts',\n  'microsoft.mixedreality/objectunderstandingaccounts': 'Object Understanding Accounts',\n  'microsoft.mixedreality/remoterenderingaccounts': 'Remote Rendering Accounts',\n  'microsoft.mixedreality/spatialanchorsaccounts': 'Spatial Anchors Accounts',\n  'microsoft.mobilenetwork/mobilenetworks': 'Mobile Networks',\n  'microsoft.mobilenetwork/mobilenetworks/datanetworks': 'Data Networks',\n  'microsoft.mobilenetwork/mobilenetworks/services': 'Services',\n  'microsoft.mobilenetwork/mobilenetworks/simpolicies': 'Sim Policies',\n  'microsoft.mobilenetwork/mobilenetworks/sites': 'Mobile Network Sites',\n  'microsoft.mobilenetwork/mobilenetworks/slices': 'Slices',\n  'microsoft.mobilenetwork/packetcorecontrolplanes': 'Packet Core Control Planes',\n  'microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes': 'Packet Core Data Planes',\n  'microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes/attacheddatanetworks': 'Attached Data Networks',\n  'microsoft.mobilenetwork/sims': 'Sims',\n  'microsoft.netapp/netappaccounts': 'NetApp accounts',\n  'microsoft.netapp/netappaccounts/capacitypools': 'Capacity pools',\n  'microsoft.netapp/netappaccounts/capacitypools/volumes': 'Volumes',\n  'microsoft.netapp/netappaccounts/capacitypools/volumes/snapshots': 'Snapshots',\n  'microsoft.netapp/netappaccounts/snapshotpolicies': 'Snapshot policies',\n  'microsoft.network/applicationgateways': 'Application gateways',\n  'microsoft.network/applicationgatewaywebapplicationfirewallpolicies': 'Application Gateway WAF policies',\n  'microsoft.network/applicationsecuritygroups': 'Application security groups',\n  'microsoft.network/azurefirewalls': 'Firewalls',\n  'microsoft.network/bastionhosts': 'Bastions',\n  'microsoft.network/connections': 'Connections',\n  'microsoft.network/customipprefixes': 'Custom IP Prefixes',\n  'microsoft.network/ddosprotectionplans': 'DDoS protection plans',\n  'microsoft.network/dnsforwardingrulesets': 'Dns Forwarding Rulesets',\n  'microsoft.network/dnsresolvers': 'DNS Private Resolvers',\n  'microsoft.network/dnszones': 'DNS zones',\n  'microsoft.network/expressroutecircuits': 'ExpressRoute circuits',\n  'microsoft.network/expressrouteports': 'ExpressRoute Direct',\n  'microsoft.network/firewallpolicies': 'Firewall Policies',\n  'microsoft.network/frontdoors': 'Front Doors',\n  'microsoft.network/frontdoorwebapplicationfirewallpolicies': 'Web Application Firewall policies (WAF)',\n  'microsoft.network/ipgroups': 'IP Groups',\n  'microsoft.network/loadbalancers': 'Load balancers',\n  'microsoft.network/localnetworkgateways': 'Local network gateways',\n  'microsoft.network/natgateways': 'NAT gateways',\n  'microsoft.network/networkexperimentprofiles': 'Internet Analyzer profiles',\n  'microsoft.network/networkinterfaces': 'Network interfaces',\n  'microsoft.network/networkmanagers': 'Network Managers',\n  'microsoft.network/networksecuritygroups': 'Network security groups',\n  'microsoft.network/networkwatchers': 'Network Watchers',\n  'microsoft.network/networkwatchers/connectionmonitors': 'Connection Monitors',\n  'microsoft.network/networkwatchers/flowlogs': 'NSG Flow Logs',\n  'microsoft.network/privatednszones': 'Private DNS zones',\n  'microsoft.network/privateendpoints': 'Private endpoints',\n  'microsoft.network/privatelinkservices': 'Private link services',\n  'microsoft.network/publicipaddresses': 'Public IP addresses',\n  'microsoft.network/publicipprefixes': 'Public IP Prefixes',\n  'microsoft.network/routefilters': 'Route filters',\n  'microsoft.network/routetables': 'Route tables',\n  'microsoft.network/serviceendpointpolicies': 'Service endpoint policies',\n  'microsoft.network/trafficmanagerprofiles': 'Traffic Manager profiles',\n  'microsoft.network/virtualnetworkgateways': 'Virtual network gateways',\n  'microsoft.network/virtualnetworks': 'Virtual networks',\n  'microsoft.network/virtualwans': 'Virtual WANs',\n  'microsoft.notificationhubs/namespaces': 'Notification Hub Namespaces',\n  'microsoft.notificationhubs/namespaces/notificationhubs': 'Notification Hubs',\n  'microsoft.openenergyplatform/energyservices': 'Azure OpenEnergy',\n  'microsoft.openlogisticsplatform/workspaces': 'Open Supply Chain Platform',\n  'microsoft.operationalinsights/querypacks': 'Log Analytics query packs',\n  'microsoft.operationalinsights/workspaces': 'Log Analytics workspaces',\n  'microsoft.operationsmanagement/solutions': 'Solutions',\n  'microsoft.orbital/contactprofiles': 'Contact Profiles',\n  'microsoft.orbital/edgesites': 'Edge Sites',\n  'microsoft.orbital/groundstations': 'Ground Stations',\n  'microsoft.orbital/l2connections': 'L2 Connections',\n  'microsoft.orbital/spacecrafts': 'Spacecrafts',\n  'microsoft.peering/peerings': 'Peerings',\n  'microsoft.peering/peeringservices': 'Peering Services',\n  'microsoft.playfab/playeraccountpools': 'Player account pools',\n  'microsoft.playfab/titles': 'PlayFab titles',\n  'microsoft.portal/dashboards': 'Shared dashboards',\n  'microsoft.powerbidedicated/capacities': 'Power BI Embedded',\n  'microsoft.purview/accounts': 'Purview accounts',\n  'microsoft.quantum/workspaces': 'Quantum Workspaces',\n  'microsoft.recommendationsservice/accounts': 'Intelligent Recommendations Accounts',\n  'microsoft.recommendationsservice/accounts/modeling': 'Modeling',\n  'microsoft.recommendationsservice/accounts/serviceendpoints': 'Service Endpoints',\n  'microsoft.recoveryservices/vaults': 'Recovery Services vaults',\n  'microsoft.recoveryservices/vaults/backupfabrics/protectioncontainers/protecteditems': 'Backup Items',\n  'microsoft.redhatopenshift/openshiftclusters': 'Azure Red Hat OpenShift',\n  'microsoft.relay/namespaces': 'Relays',\n  'microsoft.resourceconnector/appliances': 'Resource bridges',\n  'microsoft.resourcegraph/queries': 'Resource Graph queries',\n  'microsoft.resources/deploymentscripts': 'Deployment Scripts',\n  'microsoft.resources/subscriptions': 'Subscriptions',\n  'microsoft.resources/subscriptions/resourcegroups': 'Resource groups',\n  'microsoft.resources/templatespecs': 'Template specs',\n  'microsoft.saas/applications': 'Software as a Service (classic)',\n  'microsoft.saas/resources': 'SaaS',\n  'microsoft.scheduler/jobcollections': 'Scheduler Job Collections',\n  'microsoft.scom/managedinstances': 'Aquila Instances',\n  'microsoft.scvmm/virtualmachines': 'SCVMM virtual machine - Azure Arc',\n  'microsoft.scvmm/vmmservers': 'SCVMM management servers',\n  'microsoft.search/searchservices': 'Search services',\n  'microsoft.security/insights/classification': 'Data Sensitivity Security Insights (Preview)',\n  'microsoft.security/locations/alerts': 'Security Alerts',\n  'microsoft.securitydetonation/chambers': 'Security Detonation Chambers',\n  'microsoft.servicebus/namespaces': 'Service Bus Namespaces',\n  'microsoft.servicefabric/clusters': 'Service Fabric clusters',\n  'microsoft.servicefabric/managedclusters': 'Service Fabric managed clusters',\n  'microsoft.serviceshub/connectors': 'Services Hub Connectors',\n  'microsoft.signalrservice/signalr': 'SignalR',\n  'microsoft.signalrservice/webpubsub': 'Web PubSub Service',\n  'microsoft.solutions/applicationdefinitions': 'Service catalog managed application definitions',\n  'microsoft.solutions/applications': 'Managed applications',\n  'microsoft.sql/instancepools': 'Instance pools',\n  'microsoft.sql/managedinstances': 'SQL managed instances',\n  'microsoft.sql/managedinstances/databases': 'Managed databases',\n  'microsoft.sql/servers': 'SQL servers',\n  'microsoft.sql/servers/databases': 'SQL databases',\n  'microsoft.sql/servers/elasticpools': 'SQL elastic pools',\n  'microsoft.sql/servers/jobagents': 'Elastic Job agents',\n  'microsoft.sql/virtualclusters': 'Virtual clusters',\n  'microsoft.sqlvirtualmachine/sqlvirtualmachines': 'SQL virtual machines',\n  'microsoft.storage/storageaccounts': 'Storage accounts',\n  'microsoft.storagecache/amlfilesystems': 'Lustre File Systems',\n  'microsoft.storagecache/caches': 'HPC caches',\n  'microsoft.storagepool/diskpools': 'Disk Pools',\n  'microsoft.storagesync/storagesyncservices': 'Storage Sync Services',\n  'microsoft.storagesyncdev/storagesyncservices': 'Storage Sync Services',\n  'microsoft.storagesyncint/storagesyncservices': 'Storage Sync Services',\n  'microsoft.storsimple/managers': 'StorSimple Device Managers',\n  'microsoft.streamanalytics/clusters': 'Stream Analytics clusters',\n  'microsoft.streamanalytics/streamingjobs': 'Stream Analytics jobs',\n  'microsoft.synapse/privatelinkhubs': 'Azure Synapse Analytics (private link hubs)',\n  'microsoft.synapse/workspaces': 'Azure Synapse Analytics',\n  'microsoft.synapse/workspaces/bigdatapools': 'Apache Spark pools',\n  'microsoft.synapse/workspaces/kustopools': 'Data Explorer pools (preview)',\n  'microsoft.synapse/workspaces/sqlpools': 'Dedicated SQL pools',\n  'microsoft.testbase/testbaseaccounts': 'Test Base Accounts',\n  'microsoft.testbase/testbaseaccounts/packages': 'Test Base Packages',\n  'microsoft.timeseriesinsights/environments': 'Time Series Insights environments',\n  'microsoft.timeseriesinsights/environments/eventsources': 'Time Series Insights event sources',\n  'microsoft.timeseriesinsights/environments/referencedatasets': 'Time Series Insights reference data sets',\n  'microsoft.videoindexer/accounts': 'Video Analyzer for Media',\n  'microsoft.virtualmachineimages/imagetemplates': 'Image Templates',\n  'microsoft.visualstudio/account': 'Azure DevOps organizations',\n  'microsoft.visualstudio/account/project': 'DevOps Starter',\n  'microsoft.vmwarecloudsimple/dedicatedcloudnodes': 'CloudSimple Nodes',\n  'microsoft.vmwarecloudsimple/dedicatedcloudservices': 'CloudSimple Services',\n  'microsoft.vmwarecloudsimple/virtualmachines': 'CloudSimple Virtual Machines',\n  'microsoft.vsonline/plans': 'Visual Studio Online Plans',\n  'microsoft.web/connectiongateways': 'On-premises data gateways',\n  'microsoft.web/connections': 'API Connections',\n  'microsoft.web/containerapps': 'Container Apps',\n  'microsoft.web/customapis': 'Logic Apps Custom Connector',\n  'microsoft.web/hostingenvironments': 'App Service Environments',\n  'microsoft.web/kubeenvironments': 'App Service Kubernetes Environments',\n  'microsoft.web/serverfarms': 'App Service plans',\n  'microsoft.web/sites': 'App Services',\n  'microsoft.web/sites/slots': 'App Service (Slots)',\n  'microsoft.web/staticsites': 'Static Web Apps',\n  'microsoft.windowsesu/multipleactivationkeys': 'Windows Multiple Activation Keys',\n  'microsoft.windowsiot/deviceservices': 'Windows 10 IoT Core Services',\n  'microsoft.workloads/monitors': 'Azure Monitors for SAP Solutions (v2)',\n  'microsoft.workloads/phpworkloads': 'Scalable WordPress on Linux',\n  'microsoft.workloads/sapvirtualinstances': 'SAP Virtual Instances',\n  'microsoft.workloads/sapvirtualinstances/applicationinstances': 'SAP app server instances',\n  'microsoft.workloads/sapvirtualinstances/centralinstances': 'SAP central server instances',\n  'microsoft.workloads/sapvirtualinstances/databaseinstances': 'SAP database server instances',\n  'nginx.nginxplus/nginxdeployments': 'NGINX Deployment',\n  'paraleap.cloudmonix/services': 'CloudMonix',\n  'pokitdok.platform/services': 'PokitDok Platform',\n  'providers.test/statefulibizaengines': 'My Resources',\n  'ravenhq.db/databases': 'RavenHQ',\n  'raygun.crashreporting/apps': 'Raygun',\n  'sendgrid.email/accounts': 'SendGrid Accounts',\n  'trendmicro.deepsecurity/accounts': 'Deep Security SaaS',\n  'wandisco.fusion/fusiongroups': 'LiveData Planes',\n  'wandisco.fusion/fusiongroups/azurezones': 'Azure Zones',\n  'wandisco.fusion/fusiongroups/azurezones/plugins': 'Plugins',\n  'wandisco.fusion/fusiongroups/hivereplicationrules': 'Hive Replication Rules',\n  'wandisco.fusion/fusiongroups/managedonpremzones': 'On-premises Zones',\n  'wandisco.fusion/fusiongroups/replicationrules': 'Replication Rules',\n  'wandisco.fusion/migrators': 'LiveData Migrators',\n  'wandisco.fusion/migrators/exclusiontemplates': 'Exclusions',\n  'wandisco.fusion/migrators/livedatamigrations': 'Migrations',\n  'wandisco.fusion/migrators/metadatamigrations': 'Metadata Migrations',\n  'wandisco.fusion/migrators/metadatatargets': 'Metadata Targets',\n  'wandisco.fusion/migrators/pathmappings': 'Path Mappings',\n  'wandisco.fusion/migrators/targets': 'Targets',\n};\n\n// This list has been manually written using the Azure Portal as the source.\n// Visit https://portal.azure.com/#view/Microsoft_Azure_Monitoring/AzureMonitoringBrowseBlade/~/metrics\n// and go to Select a scope > Resource types > Multi-resource compatible (preview)\nexport const multiResourceCompatibleTypes: { [ns: string]: boolean } = {\n  'microsoft.cache/redis': true, // 'Azure Cache for Redis'\n  'microsoft.documentdb/mongoclusters': true, // 'Azure Cosmos DB for MongoDB'\n  'microsoft.dbforpostgresql/flexibleservers': true, // 'Azure Database for PostgreSQL flexible servers'\n  'microsoft.storagecache/amlfilesystems': true, // 'Lustre File Systems'\n  'microsoft.monitor/accounts': true, // Azure Monitor Workspaces\n  'microsoft.databoxedge/databoxedgedevices': true, // 'Azure Stack Edge / Data Box Gateway'\n  'microsoft.azurestackhci/clusters': true, // 'Azure Stack HCI'\n  'microsoft.dataprotection/backupvaults': true, // 'Backup vaults'\n  'microsoft.networkcloud/baremetalmachines': true, // 'Bare Metal Machines'\n  'microsoft.netapp/netappaccounts/capacitypools': true, // 'Capacity pools'\n  'microsoft.netapp/netappaccounts/capacitypools/volumes': true, // 'Capacity pool volumes'\n  'microsoft.network/networkwatchers/connectionmonitors': true, // 'Connection Monitors'\n  'microsoft.keyvault/vaults': true, // 'Key vaults'\n  'microsoft.recoveryservices/vaults': true, // 'Recovery Services vaults'\n  'microsoft.sql/servers/databases': true, // 'SQL databases'\n  'microsoft.sql/servers/elasticpools': true, // 'SQL elastic pools'\n  'microsoft.compute/virtualmachinescalesets': true, // 'Virtual machine scale sets'\n  'microsoft.compute/virtualmachines': true, // 'Virtual machines'\n  'microsoft.signalrservice/webpubsub': true, // 'Web PubSub Service'\n};\n\nexport const resourceTypes = [\n  'microsoft.aad/domainservices',\n  'microsoft.aadiam/azureadmetrics',\n  'microsoft.analysisservices/servers',\n  'microsoft.apimanagement/service',\n  'microsoft.app/containerapps',\n  'microsoft.app/jobs',\n  'microsoft.app/managedenvironments',\n  'microsoft.appconfiguration/configurationstores',\n  'microsoft.appplatform/spring',\n  'microsoft.automation/automationaccounts',\n  'microsoft.avs/privateclouds',\n  'microsoft.azuresphere/catalogs',\n  'microsoft.azurestackhci/clusters',\n  'microsoft.azurestackresourcemonitor/storageaccountmonitor',\n  'microsoft.batch/batchaccounts',\n  'microsoft.batchai/workspaces',\n  'microsoft.bing/accounts',\n  'microsoft.botservice/botservices',\n  'microsoft.botservice/botservices/channels',\n  'microsoft.botservice/botservices/connections',\n  'microsoft.botservice/checknameavailability',\n  'microsoft.botservice/hostsettings',\n  'microsoft.botservice/listauthserviceproviders',\n  'microsoft.botservice/listqnamakerendpointkeys',\n  'microsoft.cache/redis',\n  'microsoft.cache/redisenterprise',\n  'microsoft.cdn/cdnwebapplicationfirewallpolicies',\n  'microsoft.cdn/profiles',\n  'microsoft.classiccompute/domainnames',\n  'microsoft.classiccompute/domainnames/slots/roles',\n  'microsoft.classiccompute/virtualmachines',\n  'microsoft.classicstorage/storageaccounts',\n  'microsoft.classicstorage/storageaccounts/blobservices',\n  'microsoft.classicstorage/storageaccounts/fileservices',\n  'microsoft.classicstorage/storageaccounts/queueservices',\n  'microsoft.classicstorage/storageaccounts/tableservices',\n  'microsoft.cloudtest/hostedpools',\n  'microsoft.cloudtest/pools',\n  'microsoft.clusterstor/nodes',\n  'microsoft.codesigning/codesigningaccounts',\n  'microsoft.cognitiveservices/accounts',\n  'microsoft.communication/communicationservices',\n  'microsoft.compute/cloudservices',\n  'microsoft.compute/cloudservices/roles',\n  'microsoft.compute/disks',\n  'microsoft.compute/virtualmachines',\n  'microsoft.compute/virtualmachinescalesets',\n  'microsoft.compute/virtualmachinescalesets/virtualmachines',\n  'microsoft.connectedcache/cachenodes',\n  'microsoft.connectedcache/enterprisemcccustomers',\n  'microsoft.connectedcache/ispcustomers',\n  'microsoft.connectedvehicle/platformaccounts',\n  'microsoft.containerinstance/containergroups',\n  'microsoft.containerinstance/containerscalesets',\n  'microsoft.containerregistry/registries',\n  'microsoft.containerservice/managedclusters',\n  'microsoft.customerinsights/hubs',\n  'microsoft.customproviders/resourceproviders',\n  'microsoft.dashboard/grafana',\n  'microsoft.databoxedge/databoxedgedevices',\n  'microsoft.datacollaboration/workspaces',\n  'microsoft.datafactory/datafactories',\n  'microsoft.datafactory/factories',\n  'microsoft.datalakeanalytics/accounts',\n  'microsoft.datalakestore/accounts',\n  'microsoft.dataprotection/backupvaults',\n  'microsoft.datashare/accounts',\n  'microsoft.dbformariadb/servers',\n  'microsoft.dbformysql/flexibleservers',\n  'microsoft.dbformysql/servers',\n  'microsoft.dbforpostgresql/flexibleservers',\n  'microsoft.dbforpostgresql/servergroupsv2',\n  'microsoft.dbforpostgresql/servers',\n  'microsoft.dbforpostgresql/serversv2',\n  'microsoft.devcenter/devcenters',\n  'microsoft.devices/iothubs',\n  'microsoft.devices/provisioningservices',\n  'microsoft.devopsinfrastructure/pools',\n  'microsoft.digitaltwins/digitaltwinsinstances',\n  'microsoft.documentdb/cassandraclusters',\n  'microsoft.documentdb/databaseaccounts',\n  'microsoft.documentdb/mongoclusters',\n  'microsoft.edgezones/edgezones',\n  'microsoft.elasticsan/elasticsans',\n  'microsoft.enterpriseknowledgegraph/services',\n  'microsoft.eventgrid/domains',\n  'microsoft.eventgrid/eventsubscriptions',\n  'microsoft.eventgrid/extensiontopics',\n  'microsoft.eventgrid/namespaces',\n  'microsoft.eventgrid/partnernamespaces',\n  'microsoft.eventgrid/partnertopics',\n  'microsoft.eventgrid/systemtopics',\n  'microsoft.eventgrid/topics',\n  'microsoft.eventhub/clusters',\n  'microsoft.eventhub/namespaces',\n  'microsoft.fabric.admin/fabriclocations',\n  'microsoft.hdinsight/clusters',\n  'microsoft.healthcareapis/services',\n  'microsoft.healthcareapis/workspaces/dicomservices',\n  'microsoft.healthcareapis/workspaces/fhirservices',\n  'microsoft.healthcareapis/workspaces/iotconnectors',\n  'microsoft.healthmodel/healthmodels',\n  'microsoft.hybridcontainerservice/provisionedclusters',\n  'microsoft.hybridnetwork/networkfunctions',\n  'microsoft.hybridnetwork/virtualnetworkfunctions',\n  'microsoft.insights/autoscalesettings',\n  'microsoft.insights/components',\n  'microsoft.insights/datacollectionrules',\n  'microsoft.iotcentral/iotapps',\n  'microsoft.iotspaces/graph',\n  'microsoft.keyvault/managedhsms',\n  'microsoft.keyvault/vaults',\n  'microsoft.kubernetes/connectedclusters',\n  'microsoft.kubernetesconfiguration/extensions',\n  'microsoft.kusto/clusters',\n  'microsoft.logic/integrationserviceenvironments',\n  'microsoft.logic/workflows',\n  'microsoft.machinelearningservices/workspaces',\n  'microsoft.machinelearningservices/workspaces/onlineendpoints',\n  'microsoft.machinelearningservices/workspaces/onlineendpoints/deployments',\n  'microsoft.managednetworkfabric/internetgateways',\n  'microsoft.managednetworkfabric/l3isolationdomains',\n  'microsoft.managednetworkfabric/networkdevices',\n  'microsoft.maps/accounts',\n  'microsoft.media/mediaservices',\n  'microsoft.media/mediaservices/liveevents',\n  'microsoft.media/mediaservices/streamingendpoints',\n  'microsoft.media/videoanalyzers',\n  'microsoft.messagingconnectors/connectors',\n  'microsoft.mixedreality/remoterenderingaccounts',\n  'microsoft.mixedreality/spatialanchorsaccounts',\n  'microsoft.mobilenetwork/mobilenetworks/sites',\n  'microsoft.mobilenetwork/packetcorecontrolplanes',\n  'microsoft.mobilenetwork/packetcorecontrolplanes/packetcoredataplanes',\n  'microsoft.mobilenetwork/radioaccessnetworks',\n  'microsoft.monitor/accounts',\n  'microsoft.netapp/netappaccounts/capacitypools',\n  'microsoft.netapp/netappaccounts/capacitypools/volumes',\n  'microsoft.network/applicationgateways',\n  'microsoft.network/azurefirewalls',\n  'microsoft.network/bastionhosts',\n  'microsoft.network/connections',\n  'microsoft.network/dnsforwardingrulesets',\n  'microsoft.network/dnsresolverpolicies',\n  'microsoft.network/dnsresolvers',\n  'microsoft.network/dnszones',\n  'microsoft.network/expressroutecircuits',\n  'microsoft.network/expressroutecircuits/peerings',\n  'microsoft.network/expressroutegateways',\n  'microsoft.network/expressrouteports',\n  'microsoft.network/frontdoors',\n  'microsoft.network/loadbalancers',\n  'microsoft.network/natgateways',\n  'microsoft.network/networkinterfaces',\n  'microsoft.network/networkmanagers/ipampools',\n  'microsoft.network/networkvirtualappliances',\n  'microsoft.network/networkwatchers',\n  'microsoft.network/networkwatchers/connectionmonitors',\n  'microsoft.network/p2svpngateways',\n  'microsoft.network/privatednszones',\n  'microsoft.network/privateendpoints',\n  'microsoft.network/privatelinkservices',\n  'microsoft.network/publicipaddresses',\n  'microsoft.network/publicipprefixes',\n  'microsoft.network/trafficmanagerprofiles',\n  'microsoft.network/virtualhubs',\n  'microsoft.network/virtualnetworkgateways',\n  'microsoft.network/virtualnetworks',\n  'microsoft.network/virtualrouters',\n  'microsoft.network/vpngateways',\n  'microsoft.networkanalytics/dataconnectors',\n  'microsoft.networkcloud/baremetalmachines',\n  'microsoft.networkcloud/clustermanagers',\n  'microsoft.networkcloud/clusters',\n  'microsoft.networkcloud/storageappliances',\n  'microsoft.networkfunction/azuretrafficcollectors',\n  'microsoft.notificationhubs/namespaces/notificationhubs',\n  'microsoft.operationalinsights/workspaces',\n  'microsoft.operationsmanagement/solutions',\n  'microsoft.orbital/contactprofiles',\n  'microsoft.orbital/l2connections',\n  'microsoft.orbital/spacecrafts',\n  'microsoft.orbital/terminals',\n  'microsoft.peering/peerings',\n  'microsoft.peering/peeringservices',\n  'microsoft.playfab/titles',\n  'microsoft.powerbidedicated/capacities',\n  'microsoft.purview/accounts',\n  'microsoft.recoveryservices/vaults',\n  'microsoft.relay/namespaces',\n  'microsoft.resources/subscriptions',\n  'microsoft.search/searchservices',\n  'microsoft.securitydetonation/chambers',\n  'microsoft.securitydetonation/securitydetonationchambers',\n  'microsoft.servicebus/namespaces',\n  'microsoft.servicefabricmesh/applications',\n  'microsoft.servicenetworking/trafficcontrollers',\n  'microsoft.signalrservice/signalr',\n  'microsoft.signalrservice/signalr/replicas',\n  'microsoft.signalrservice/webpubsub',\n  'microsoft.signalrservice/webpubsub/replicas',\n  'microsoft.singularity/accounts',\n  'microsoft.sql/managedinstances',\n  'microsoft.sql/servers/databases',\n  'microsoft.sql/servers/elasticpools',\n  'microsoft.sql/servers/jobagents',\n  'microsoft.storageactions/storagetasks',\n  'microsoft.storage/storageaccounts',\n  'microsoft.storage/storageaccounts/blobservices',\n  'microsoft.storage/storageaccounts/fileservices',\n  'microsoft.storage/storageaccounts/objectreplicationpolicies',\n  'microsoft.storage/storageaccounts/queueservices',\n  'microsoft.storage/storageaccounts/storagetasks',\n  'microsoft.storage/storageaccounts/tableservices',\n  'microsoft.storage/storagetasks',\n  'microsoft.storagecache/amlfilesystems',\n  'microsoft.storagecache/caches',\n  'microsoft.storagemover/storagemovers',\n  'microsoft.storagesync/storagesyncservices',\n  'microsoft.storagetasks/storagetasks',\n  'microsoft.streamanalytics/streamingjobs',\n  'microsoft.synapse/workspaces',\n  'microsoft.synapse/workspaces/bigdatapools',\n  'microsoft.synapse/workspaces/kustopools',\n  'microsoft.synapse/workspaces/scopepools',\n  'microsoft.synapse/workspaces/sqlpools',\n  'microsoft.timeseriesinsights/environments',\n  'microsoft.timeseriesinsights/environments/eventsources',\n  'microsoft.vmwarecloudsimple/virtualmachines',\n  'microsoft.voiceservices/communicationsgateways',\n  'microsoft.web/containerapps',\n  'microsoft.web/hostingenvironments',\n  'microsoft.web/hostingenvironments/multirolepools',\n  'microsoft.web/hostingenvironments/workerpools',\n  'microsoft.web/serverfarms',\n  'microsoft.web/sites',\n  'microsoft.web/sites/slots',\n  'microsoft.web/staticsites',\n  'nginx.nginxplus/nginxdeployments',\n  'oracle.database/oracle.database/autonomousdatabases',\n  'oracle.database/oracle.database/cloudvmclusters',\n  'private.messagingconnectors/private.messagingconnectors/connectors',\n  'wandisco.fusion/migrators',\n  'wandisco.fusion/migrators/datatransferagents',\n  'wandisco.fusion/migrators/livedatamigrations',\n  'wandisco.fusion/migrators/metadatamigrations',\n];\n","import { css } from '@emotion/css';\nimport { useEffect } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { AccessoryButton } from '@grafana/experimental';\nimport { Input, Label, InlineField, Button, useStyles2 } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\nimport { AzureMonitorResource } from '../../types';\n\nexport interface ResourcePickerProps<T> {\n  resources: T[];\n  onChange: (resources: T[]) => void;\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  resourceList: css({ display: 'flex', columnGap: theme.spacing(1), flexWrap: 'wrap', marginBottom: theme.spacing(1) }),\n  resource: css({ flex: '0 0 auto' }),\n  resourceLabel: css({ padding: theme.spacing(1) }),\n  resourceGroupAndName: css({ display: 'flex', columnGap: theme.spacing(0.5) }),\n});\n\nconst AdvancedResourcePicker = ({ resources, onChange }: ResourcePickerProps<AzureMonitorResource>) => {\n  const styles = useStyles2(getStyles);\n\n  useEffect(() => {\n    // Ensure there is at least one resource\n    if (resources.length === 0) {\n      onChange([{}]);\n    }\n  }, [resources, onChange]);\n\n  const onResourceChange = (index: number, resource: AzureMonitorResource) => {\n    const newResources = [...resources];\n    newResources[index] = resource;\n    onChange(newResources);\n  };\n\n  const removeResource = (index: number) => {\n    const newResources = [...resources];\n    newResources.splice(index, 1);\n    onChange(newResources);\n  };\n\n  const addResource = () => {\n    onChange(\n      resources.concat({\n        subscription: resources[0]?.subscription,\n        metricNamespace: resources[0]?.metricNamespace,\n        resourceGroup: '',\n        resourceName: '',\n      })\n    );\n  };\n\n  const onCommonPropChange = (r: Partial<AzureMonitorResource>) => {\n    onChange(resources.map((resource) => ({ ...resource, ...r })));\n  };\n\n  return (\n    <>\n      <InlineField\n        label=\"Subscription\"\n        grow\n        transparent\n        htmlFor={`input-advanced-resource-picker-subscription`}\n        labelWidth={15}\n        data-testid={selectors.components.queryEditor.resourcePicker.advanced.subscription.input}\n      >\n        <Input\n          id={`input-advanced-resource-picker-subscription`}\n          value={resources[0]?.subscription ?? ''}\n          onChange={(event) => onCommonPropChange({ subscription: event.currentTarget.value })}\n          placeholder=\"aaaaaaaa-bbbb-cccc-dddd-eeeeeeee\"\n        />\n      </InlineField>\n      <InlineField\n        label=\"Namespace\"\n        grow\n        transparent\n        htmlFor={`input-advanced-resource-picker-metricNamespace`}\n        labelWidth={15}\n        data-testid={selectors.components.queryEditor.resourcePicker.advanced.namespace.input}\n        invalid={resources[0]?.metricNamespace?.endsWith('/')}\n        error={'Namespace cannot end with a \"/\"'}\n      >\n        <Input\n          id={`input-advanced-resource-picker-metricNamespace`}\n          value={resources[0]?.metricNamespace ?? ''}\n          onChange={(event) => onCommonPropChange({ metricNamespace: event.currentTarget.value })}\n          placeholder=\"Microsoft.Insights/metricNamespaces\"\n        />\n      </InlineField>\n      <InlineField\n        label=\"Region\"\n        grow\n        transparent\n        htmlFor={`input-advanced-resource-picker-region`}\n        labelWidth={15}\n        data-testid={selectors.components.queryEditor.resourcePicker.advanced.region.input}\n        tooltip=\"The code region of the resource. Optional for one resource but mandatory when selecting multiple ones.\"\n      >\n        <Input\n          id={`input-advanced-resource-picker-region`}\n          value={resources[0]?.region ?? ''}\n          onChange={(event) => onCommonPropChange({ region: event.currentTarget.value })}\n          placeholder=\"northeurope\"\n        />\n      </InlineField>\n      <div className={styles.resourceList}>\n        {resources.map((resource, index) => (\n          <div key={`resource-${index + 1}`} className={styles.resource}>\n            {resources.length !== 1 && <Label className={styles.resourceLabel}>Resource {index + 1}</Label>}\n            <InlineField\n              label=\"Resource Group\"\n              transparent\n              htmlFor={`input-advanced-resource-picker-resourceGroup-${index + 1}`}\n              labelWidth={15}\n              data-testid={selectors.components.queryEditor.resourcePicker.advanced.resourceGroup.input}\n            >\n              <div className={styles.resourceGroupAndName}>\n                <Input\n                  id={`input-advanced-resource-picker-resourceGroup-${index + 1}`}\n                  value={resource?.resourceGroup ?? ''}\n                  onChange={(event) =>\n                    onResourceChange(index, { ...resource, resourceGroup: event.currentTarget.value })\n                  }\n                  placeholder=\"resource-group\"\n                />\n                <AccessoryButton\n                  aria-label=\"remove\"\n                  icon=\"times\"\n                  variant=\"secondary\"\n                  onClick={() => removeResource(index)}\n                  hidden={resources.length === 1}\n                  data-testid={'remove-resource'}\n                />\n              </div>\n            </InlineField>\n\n            <InlineField\n              label=\"Resource Name\"\n              transparent\n              htmlFor={`input-advanced-resource-picker-resourceName-${index + 1}`}\n              labelWidth={15}\n              data-testid={selectors.components.queryEditor.resourcePicker.advanced.resource.input}\n            >\n              <Input\n                id={`input-advanced-resource-picker-resourceName-${index + 1}`}\n                value={resource?.resourceName ?? ''}\n                onChange={(event) => onResourceChange(index, { ...resource, resourceName: event.currentTarget.value })}\n                placeholder=\"name\"\n              />\n            </InlineField>\n          </div>\n        ))}\n      </div>\n      <Button aria-label=\"Add\" icon=\"plus\" variant=\"secondary\" onClick={addResource} type=\"button\">\n        Add resource\n      </Button>\n    </>\n  );\n};\n\nexport default AdvancedResourcePicker;\n","import { AzureMetricDimension, AzureMonitorQuery } from '../../types';\n\nexport function setCustomNamespace(query: AzureMonitorQuery, selection: string | undefined): AzureMonitorQuery {\n  if (query.azureMonitor?.customNamespace === selection) {\n    return query;\n  }\n\n  if (selection?.toLowerCase().startsWith('microsoft.storage/storageaccounts/')) {\n    return {\n      ...query,\n      azureMonitor: {\n        ...query.azureMonitor,\n        metricNamespace: selection,\n        metricName: undefined,\n        aggregation: undefined,\n        timeGrain: '',\n        dimensionFilters: [],\n      },\n    };\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      customNamespace: selection,\n      metricName: undefined,\n      aggregation: undefined,\n      timeGrain: '',\n      dimensionFilters: [],\n    },\n  };\n}\n\nexport function setMetricName(query: AzureMonitorQuery, metricName: string | undefined): AzureMonitorQuery {\n  if (query.azureMonitor?.metricName === metricName) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      metricName: metricName,\n      aggregation: undefined,\n      timeGrain: '',\n      dimensionFilters: [],\n    },\n  };\n}\n\nexport function setAggregation(query: AzureMonitorQuery, aggregation: string): AzureMonitorQuery {\n  if (query.azureMonitor?.aggregation === aggregation) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      aggregation: aggregation,\n    },\n  };\n}\n\nexport function setTimeGrain(query: AzureMonitorQuery, timeGrain: string): AzureMonitorQuery {\n  if (query.azureMonitor?.timeGrain === timeGrain) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      timeGrain: timeGrain,\n    },\n  };\n}\n\nexport function setDimensionFilters(query: AzureMonitorQuery, dimensions: AzureMetricDimension[]): AzureMonitorQuery {\n  if (query.azureMonitor?.dimensionFilters === dimensions) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      dimensionFilters: dimensions,\n    },\n  };\n}\n\nexport function appendDimensionFilter(\n  query: AzureMonitorQuery,\n  dimension = '',\n  operator = 'eq',\n  filters: string[] = []\n): AzureMonitorQuery {\n  const existingFilters = query.azureMonitor?.dimensionFilters ?? [];\n\n  return setDimensionFilters(query, [\n    ...existingFilters,\n    {\n      dimension,\n      operator,\n      filters,\n    },\n  ]);\n}\n\nexport function removeDimensionFilter(query: AzureMonitorQuery, indexToRemove: number): AzureMonitorQuery {\n  const existingFilters = query.azureMonitor?.dimensionFilters ?? [];\n  const newFilters = [...existingFilters];\n  newFilters.splice(indexToRemove, 1);\n  return setDimensionFilters(query, newFilters);\n}\n\nexport function setDimensionFilterValue<Key extends keyof AzureMetricDimension>(\n  query: AzureMonitorQuery,\n  index: number,\n  fieldName: Key,\n  value: AzureMetricDimension[Key]\n): AzureMonitorQuery {\n  const existingFilters = query.azureMonitor?.dimensionFilters ?? [];\n  const newFilters = [...existingFilters];\n  const newFilter = newFilters[index];\n  newFilter[fieldName] = value;\n  if (fieldName === 'dimension' || fieldName === 'operator') {\n    newFilter.filters = [];\n  }\n  return setDimensionFilters(query, newFilters);\n}\n\nexport function setTop(query: AzureMonitorQuery, top: string): AzureMonitorQuery {\n  if (query.azureMonitor?.top === top) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      top: top,\n    },\n  };\n}\n\nexport function setLegendAlias(query: AzureMonitorQuery, alias: string): AzureMonitorQuery {\n  if (query.azureMonitor?.alias === alias) {\n    return query;\n  }\n\n  return {\n    ...query,\n    azureMonitor: {\n      ...query.azureMonitor,\n      alias: alias,\n    },\n  };\n}\n","import { useCallback } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Select } from '@grafana/ui';\n\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { addValueToOptions } from '../../utils/common';\nimport { Field } from '../shared/Field';\n\nimport { setAggregation } from './setQueryValue';\n\ninterface AggregationFieldProps extends AzureQueryEditorFieldProps {\n  aggregationOptions: AzureMonitorOption[];\n  isLoading: boolean;\n}\n\nconst AggregationField = ({\n  query,\n  variableOptionGroup,\n  onQueryChange,\n  aggregationOptions,\n  isLoading,\n}: AggregationFieldProps) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setAggregation(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const options = addValueToOptions(aggregationOptions, variableOptionGroup, query.azureMonitor?.aggregation);\n\n  return (\n    <Field label=\"Aggregation\">\n      <Select\n        inputId=\"azure-monitor-metrics-aggregation-field\"\n        value={query.azureMonitor?.aggregation || null}\n        onChange={handleChange}\n        options={options}\n        isLoading={isLoading}\n      />\n    </Field>\n  );\n};\n\nexport default AggregationField;\n","import { Button } from '@grafana/ui';\nimport React from 'react';\nimport { Stack } from './Stack.js';\n\nconst EditorList = React.forwardRef(function EditorList2({ items, renderItem, onChange }, ref) {\n  const onAddItem = () => {\n    const newItems = [...items, {}];\n    onChange(newItems);\n  };\n  const onChangeItem = (itemIndex, newItem) => {\n    const newItems = [...items];\n    newItems[itemIndex] = newItem;\n    onChange(newItems);\n  };\n  const onDeleteItem = (itemIndex) => {\n    const newItems = [...items];\n    newItems.splice(itemIndex, 1);\n    onChange(newItems);\n  };\n  return /* @__PURE__ */ React.createElement(Stack, null, items.map((item, index) => /* @__PURE__ */ React.createElement(\"div\", { key: index }, renderItem(\n    item,\n    (newItem) => onChangeItem(index, newItem),\n    () => onDeleteItem(index)\n  ))), /* @__PURE__ */ React.createElement(Button, { ref, onClick: onAddItem, variant: \"secondary\", size: \"md\", icon: \"plus\", \"aria-label\": \"Add\", type: \"button\" }));\n});\n\nexport { EditorList };\n//# sourceMappingURL=EditorList.js.map\n","import { useEffect, useMemo, useState } from 'react';\n\nimport { SelectableValue, DataFrame, PanelData, Labels } from '@grafana/data';\nimport { EditorList, AccessoryButton } from '@grafana/experimental';\nimport { Select, HorizontalGroup, MultiSelect } from '@grafana/ui';\n\nimport { AzureMetricDimension, AzureMonitorOption, AzureMonitorQuery, AzureQueryEditorFieldProps } from '../../types';\nimport { Field } from '../shared/Field';\n\nimport { setDimensionFilters } from './setQueryValue';\n\ninterface DimensionFieldsProps extends AzureQueryEditorFieldProps {\n  dimensionOptions: AzureMonitorOption[];\n}\n\ninterface DimensionLabels {\n  [key: string]: Set<string>;\n}\n\nconst useDimensionLabels = (data: PanelData | undefined, query: AzureMonitorQuery) => {\n  const [dimensionLabels, setDimensionLabels] = useState<DimensionLabels>({});\n  useEffect(() => {\n    let labelsObj: DimensionLabels = {};\n    if (data?.series?.length) {\n      // Identify which series' in the dataframe are relevant to the current query\n      const series: DataFrame[] = data.series.flat().filter((series) => series.refId === query.refId);\n      const fields = series.flatMap((series) => series.fields);\n      // Retrieve labels for series fields\n      const labels = fields\n        .map((fields) => fields.labels)\n        .flat()\n        .filter((item): item is Labels => item !== null && item !== undefined);\n      for (const label of labels) {\n        // Labels only exist for series that have a dimension selected\n        for (const [dimension, value] of Object.entries(label)) {\n          const dimensionLower = dimension.toLowerCase();\n          if (labelsObj[dimensionLower]) {\n            labelsObj[dimensionLower].add(value);\n          } else {\n            labelsObj[dimensionLower] = new Set([value]);\n          }\n        }\n      }\n    }\n    setDimensionLabels((prevLabels) => {\n      const newLabels: DimensionLabels = {};\n      const currentLabels = Object.keys(labelsObj);\n      if (currentLabels.length === 0) {\n        return prevLabels;\n      }\n      for (const label of currentLabels) {\n        if (prevLabels[label] && labelsObj[label].size < prevLabels[label].size) {\n          newLabels[label] = prevLabels[label];\n        } else {\n          newLabels[label] = labelsObj[label];\n        }\n      }\n      return newLabels;\n    });\n  }, [data?.series, query.refId]);\n  return dimensionLabels;\n};\n\nconst DimensionFields = ({ data, query, dimensionOptions, onQueryChange }: DimensionFieldsProps) => {\n  const dimensionFilters = useMemo(\n    () => query.azureMonitor?.dimensionFilters ?? [],\n    [query.azureMonitor?.dimensionFilters]\n  );\n\n  const dimensionLabels = useDimensionLabels(data, query);\n\n  const dimensionOperators: Array<SelectableValue<string>> = [\n    { label: '==', value: 'eq' },\n    { label: '!=', value: 'ne' },\n    { label: 'starts with', value: 'sw' },\n  ];\n\n  const validDimensionOptions = useMemo(() => {\n    // We filter out any dimensions that have already been used in a filter as the API doesn't support having multiple filters with the same dimension name.\n    // The Azure portal also doesn't support this feature so it makes sense for consistency.\n    let t = dimensionOptions;\n    if (dimensionFilters.length) {\n      t = dimensionOptions.filter(\n        (val) => !dimensionFilters.some((dimensionFilter) => dimensionFilter.dimension === val.value)\n      );\n    }\n    return t;\n  }, [dimensionFilters, dimensionOptions]);\n\n  const onFieldChange = <Key extends keyof AzureMetricDimension>(\n    fieldName: Key,\n    item: Partial<AzureMetricDimension>,\n    value: AzureMetricDimension[Key],\n    onChange: (item: Partial<AzureMetricDimension>) => void\n  ) => {\n    item[fieldName] = value;\n    onChange(item);\n  };\n\n  const getValidDimensionOptions = (selectedDimension: string) => {\n    return validDimensionOptions.concat(dimensionOptions.filter((item) => item.value === selectedDimension));\n  };\n\n  const getValidFilterOptions = (selectedFilter: string | undefined, dimension: string) => {\n    const dimensionFilters = Array.from(dimensionLabels[dimension.toLowerCase()] ?? []);\n    if (dimensionFilters.find((filter) => filter === selectedFilter)) {\n      return dimensionFilters.map((filter) => ({ value: filter, label: filter }));\n    }\n    return [...dimensionFilters, ...(selectedFilter && selectedFilter !== '*' ? [selectedFilter] : [])].map((item) => ({\n      value: item,\n      label: item,\n    }));\n  };\n\n  const getValidMultiSelectOptions = (selectedFilters: string[] | undefined, dimension: string) => {\n    const labelOptions = getValidFilterOptions(undefined, dimension);\n    if (selectedFilters) {\n      for (const filter of selectedFilters) {\n        if (!labelOptions.find((label) => label.value === filter)) {\n          labelOptions.push({ value: filter, label: filter });\n        }\n      }\n    }\n    return labelOptions;\n  };\n  const getValidOperators = (selectedOperator: string) => {\n    if (dimensionOperators.find((operator: SelectableValue) => operator.value === selectedOperator)) {\n      return dimensionOperators;\n    }\n    return [...dimensionOperators, ...(selectedOperator ? [{ label: selectedOperator, value: selectedOperator }] : [])];\n  };\n\n  const changedFunc = (changed: Array<Partial<AzureMetricDimension>>) => {\n    const properData: AzureMetricDimension[] = changed.map((x) => {\n      return {\n        dimension: x.dimension ?? '',\n        operator: x.operator ?? 'eq',\n        filters: x.filters ?? [],\n      };\n    });\n    onQueryChange(setDimensionFilters(query, properData));\n  };\n\n  const renderFilters = (\n    item: Partial<AzureMetricDimension>,\n    onChange: (item: Partial<AzureMetricDimension>) => void,\n    onDelete: () => void\n  ) => {\n    return (\n      <HorizontalGroup spacing=\"none\">\n        <Select\n          menuShouldPortal\n          placeholder=\"Field\"\n          value={item.dimension}\n          options={getValidDimensionOptions(item.dimension || '')}\n          onChange={(e) => onFieldChange('dimension', item, e.value ?? '', onChange)}\n        />\n        <Select\n          menuShouldPortal\n          placeholder=\"Operation\"\n          value={item.operator}\n          options={getValidOperators(item.operator || 'eq')}\n          onChange={(e) => onFieldChange('operator', item, e.value ?? '', onChange)}\n          allowCustomValue\n        />\n        {item.operator === 'eq' || item.operator === 'ne' ? (\n          <MultiSelect\n            menuShouldPortal\n            placeholder=\"Select value(s)\"\n            value={item.filters}\n            options={getValidMultiSelectOptions(item.filters, item.dimension ?? '')}\n            onChange={(e) =>\n              onFieldChange(\n                'filters',\n                item,\n                e.map((x) => x.value ?? ''),\n                onChange\n              )\n            }\n            aria-label={'dimension-labels-select'}\n            allowCustomValue\n          />\n        ) : (\n          // The API does not currently allow for multiple \"starts with\" clauses to be used.\n          <Select\n            menuShouldPortal\n            placeholder=\"Select value\"\n            value={item.filters ? item.filters[0] : ''}\n            allowCustomValue\n            options={getValidFilterOptions(item.filters ? item.filters[0] : '', item.dimension ?? '')}\n            onChange={(e) => onFieldChange('filters', item, [e?.value ?? ''], onChange)}\n            isClearable\n          />\n        )}\n        <AccessoryButton aria-label=\"Remove\" icon=\"times\" variant=\"secondary\" onClick={onDelete} type=\"button\" />\n      </HorizontalGroup>\n    );\n  };\n\n  return (\n    <Field label=\"Dimensions\">\n      <EditorList items={dimensionFilters} onChange={changedFunc} renderItem={renderFilters} />\n    </Field>\n  );\n};\n\nexport default DimensionFields;\n","import { useCallback, useState } from 'react';\nimport * as React from 'react';\n\nimport { Input } from '@grafana/ui';\n\nimport { AzureQueryEditorFieldProps } from '../../types';\nimport { Field } from '../shared/Field';\n\nimport { setLegendAlias } from './setQueryValue';\n\nconst LegendFormatField = ({ onQueryChange, query }: AzureQueryEditorFieldProps) => {\n  const [value, setValue] = useState<string>(query.azureMonitor?.alias ?? '');\n\n  // As calling onQueryChange initiates a the datasource refresh, we only want to call it once\n  // the field loses focus\n  const handleChange = useCallback((ev: React.FormEvent) => {\n    if (ev.target instanceof HTMLInputElement) {\n      setValue(ev.target.value);\n    }\n  }, []);\n\n  const handleBlur = useCallback(() => {\n    const newQuery = setLegendAlias(query, value);\n    onQueryChange(newQuery);\n  }, [onQueryChange, query, value]);\n\n  return (\n    <Field label=\"Legend format\">\n      <Input\n        id=\"azure-monitor-metrics-legend-field\"\n        placeholder=\"Alias patterns\"\n        value={value}\n        onChange={handleChange}\n        onBlur={handleBlur}\n        width={38}\n      />\n    </Field>\n  );\n};\n\nexport default LegendFormatField;\n","import { useCallback } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Select } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { addValueToOptions } from '../../utils/common';\nimport { Field } from '../shared/Field';\n\nimport { setMetricName } from './setQueryValue';\n\ninterface MetricNameProps extends AzureQueryEditorFieldProps {\n  metricNames: AzureMonitorOption[];\n}\n\nconst MetricNameField = ({ metricNames, query, variableOptionGroup, onQueryChange }: MetricNameProps) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setMetricName(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const options = addValueToOptions(metricNames, variableOptionGroup, query.azureMonitor?.metricName);\n\n  return (\n    <Field label=\"Metric\" data-testid={selectors.components.queryEditor.metricsQueryEditor.metricName.input}>\n      <Select\n        inputId=\"azure-monitor-metrics-metric-field\"\n        value={query.azureMonitor?.metricName ?? null}\n        onChange={handleChange}\n        options={options}\n        allowCustomValue\n      />\n    </Field>\n  );\n};\n\nexport default MetricNameField;\n","import { useCallback } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Select } from '@grafana/ui';\n\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { addValueToOptions } from '../../utils/common';\nimport { Field } from '../shared/Field';\n\nimport { setCustomNamespace } from './setQueryValue';\n\ninterface MetricNamespaceFieldProps extends AzureQueryEditorFieldProps {\n  metricNamespaces: AzureMonitorOption[];\n}\n\nconst MetricNamespaceField = ({\n  metricNamespaces,\n  query,\n  variableOptionGroup,\n  onQueryChange,\n}: MetricNamespaceFieldProps) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setCustomNamespace(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const value = query.azureMonitor?.customNamespace || query.azureMonitor?.metricNamespace;\n  const options = addValueToOptions(metricNamespaces, variableOptionGroup, value);\n\n  return (\n    <Field label=\"Metric namespace\">\n      <Select\n        inputId=\"azure-monitor-metrics-metric-namespace-field\"\n        value={value || null}\n        onChange={handleChange}\n        options={options}\n        allowCustomValue\n      />\n    </Field>\n  );\n};\n\nexport default MetricNamespaceField;\n","import { useCallback, useMemo } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Select } from '@grafana/ui';\n\nimport TimegrainConverter from '../../time_grain_converter';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { addValueToOptions } from '../../utils/common';\nimport { Field } from '../shared/Field';\n\nimport { setTimeGrain } from './setQueryValue';\n\ninterface TimeGrainFieldProps extends AzureQueryEditorFieldProps {\n  timeGrainOptions: AzureMonitorOption[];\n}\n\nconst TimeGrainField = ({ query, timeGrainOptions, variableOptionGroup, onQueryChange }: TimeGrainFieldProps) => {\n  const handleChange = useCallback(\n    (change: SelectableValue<string>) => {\n      if (!change.value) {\n        return;\n      }\n\n      const newQuery = setTimeGrain(query, change.value);\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const timeGrains = useMemo(() => {\n    const autoInterval = TimegrainConverter.findClosestTimeGrain(\n      '1m',\n      timeGrainOptions.map((o) => TimegrainConverter.createKbnUnitFromISO8601Duration(o.value)) || [\n        '1m',\n        '5m',\n        '15m',\n        '30m',\n        '1h',\n        '6h',\n        '12h',\n        '1d',\n      ]\n    );\n\n    const baseTimeGrains = timeGrainOptions.map((v) => (v.value === 'auto' ? { ...v, description: autoInterval } : v));\n\n    const options = addValueToOptions(baseTimeGrains, variableOptionGroup, query.azureMonitor?.timeGrain);\n\n    return options;\n  }, [timeGrainOptions, variableOptionGroup, query.azureMonitor?.timeGrain]);\n\n  return (\n    <Field label=\"Time grain\">\n      <Select\n        inputId=\"azure-monitor-metrics-time-grain-field\"\n        value={query.azureMonitor?.timeGrain}\n        onChange={handleChange}\n        options={timeGrains}\n      />\n    </Field>\n  );\n};\n\nexport default TimeGrainField;\n","import { useCallback, useState } from 'react';\nimport * as React from 'react';\n\nimport { Input } from '@grafana/ui';\n\nimport { AzureQueryEditorFieldProps } from '../../types';\nimport { Field } from '../shared/Field';\n\nimport { setTop } from './setQueryValue';\n\nconst TopField = ({ onQueryChange, query }: AzureQueryEditorFieldProps) => {\n  const [value, setValue] = useState<string>(query.azureMonitor?.top ?? '');\n\n  // As calling onQueryChange initiates a the datasource refresh, we only want to call it once\n  // the field loses focus\n  const handleChange = useCallback((ev: React.FormEvent) => {\n    if (ev.target instanceof HTMLInputElement) {\n      setValue(ev.target.value);\n    }\n  }, []);\n\n  const handleBlur = useCallback(() => {\n    const newQuery = setTop(query, value);\n    onQueryChange(newQuery);\n  }, [onQueryChange, query, value]);\n\n  return (\n    <Field label=\"Top\">\n      <Input\n        id=\"azure-monitor-metrics-top-field\"\n        value={value}\n        onChange={handleChange}\n        onBlur={handleBlur}\n        width={16}\n      />\n    </Field>\n  );\n};\n\nexport default TopField;\n","import { useEffect, useMemo, useState } from 'react';\n\nexport function useAsyncState<T>(asyncFn: () => Promise<T>, setError: Function, dependencies: unknown[]) {\n  // Use the lazy initial state functionality of useState to assign a random ID to the API call\n  // to track where errors come from. See useLastError.\n  const [errorSource] = useState(() => Math.random());\n  const [value, setValue] = useState<T>();\n\n  const finalValue = useMemo(() => value ?? [], [value]);\n\n  useEffect(() => {\n    asyncFn()\n      .then((results) => {\n        setValue(results);\n        setError(errorSource, undefined);\n      })\n      .catch((err) => {\n        setError(errorSource, err);\n      });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, dependencies);\n\n  return finalValue;\n}\n","import { useEffect, useState } from 'react';\n\nimport { rangeUtil } from '@grafana/data';\n\nimport Datasource from '../../datasource';\nimport TimegrainConverter from '../../time_grain_converter';\nimport { AzureMonitorErrorish, AzureMonitorOption, AzureMonitorQuery, AzureMonitorResource } from '../../types';\nimport { toOption } from '../../utils/common';\nimport { useAsyncState } from '../../utils/useAsyncState';\n\nimport { setCustomNamespace } from './setQueryValue';\n\ntype SetErrorFn = (source: string, error: AzureMonitorErrorish | undefined) => void;\n\nexport type DataHook = (\n  query: AzureMonitorQuery,\n  datasource: Datasource,\n  onChange: OnChangeFn,\n  setError: SetErrorFn\n) => AzureMonitorOption[];\n\nexport type MetricsMetadataHook = (\n  query: AzureMonitorQuery,\n  datasource: Datasource,\n  onChange: OnChangeFn\n) => MetricMetadata;\n\nexport interface MetricMetadata {\n  aggOptions: AzureMonitorOption[];\n  timeGrains: AzureMonitorOption[];\n  dimensions: AzureMonitorOption[];\n  isLoading: boolean;\n\n  // These two properties are only used within the hook, and not elsewhere\n  supportedAggTypes: string[];\n  primaryAggType: string | undefined;\n}\n\ntype OnChangeFn = (newQuery: AzureMonitorQuery) => void;\n\nconst getResourceGroupAndName = (resources?: AzureMonitorResource[]) => {\n  if (!resources || !resources.length) {\n    return { resourceGroup: '', resourceName: '' };\n  }\n  return {\n    resourceGroup: resources[0].resourceGroup ?? '',\n    resourceName: resources[0].resourceName ?? '',\n  };\n};\n\nexport const useMetricNamespaces: DataHook = (query, datasource, onChange, setError) => {\n  const { subscription } = query;\n  const { metricNamespace, resources } = query.azureMonitor ?? {};\n  const { resourceGroup, resourceName } = getResourceGroupAndName(resources);\n\n  const metricNamespaces = useAsyncState(\n    async () => {\n      if (!subscription || !resourceGroup || !resourceName) {\n        return;\n      }\n\n      const results = await datasource.azureMonitorDatasource.getMetricNamespaces(\n        {\n          subscription,\n          metricNamespace,\n          resourceGroup,\n          resourceName,\n        },\n        false\n      );\n      const options = formatOptions(results, metricNamespace);\n\n      // Do some cleanup of the query state if need be\n      if (!metricNamespace && options.length) {\n        onChange(setCustomNamespace(query, options[0].value));\n      }\n\n      return options;\n    },\n    setError,\n    [subscription, metricNamespace, resourceGroup, resourceName]\n  );\n\n  return metricNamespaces;\n};\n\nexport const useMetricNames: DataHook = (query, datasource, onChange, setError) => {\n  const { subscription } = query;\n  const { metricNamespace, metricName, resources, customNamespace } = query.azureMonitor ?? {};\n  const { resourceGroup, resourceName } = getResourceGroupAndName(resources);\n  const multipleResources = (resources && resources.length > 1) ?? false;\n  const region = query.azureMonitor?.region ?? '';\n\n  return useAsyncState(\n    async () => {\n      if (!subscription || !metricNamespace || !resourceGroup || !resourceName) {\n        return;\n      }\n      const results = await datasource.azureMonitorDatasource.getMetricNames(\n        {\n          subscription,\n          resourceGroup,\n          resourceName,\n          metricNamespace,\n          customNamespace,\n        },\n        multipleResources,\n        region\n      );\n      const options = formatOptions(results, metricName);\n\n      return options;\n    },\n    setError,\n    [subscription, resourceGroup, resourceName, metricNamespace, customNamespace, multipleResources]\n  );\n};\n\nconst defaultMetricMetadata: MetricMetadata = {\n  aggOptions: [],\n  timeGrains: [],\n  dimensions: [],\n  isLoading: false,\n  supportedAggTypes: [],\n  primaryAggType: undefined,\n};\n\nexport const useMetricMetadata = (query: AzureMonitorQuery, datasource: Datasource, onChange: OnChangeFn) => {\n  const [metricMetadata, setMetricMetadata] = useState<MetricMetadata>(defaultMetricMetadata);\n  const { subscription } = query;\n  const { resources, metricNamespace, metricName, aggregation, timeGrain, customNamespace, region } =\n    query.azureMonitor ?? {};\n  const { resourceGroup, resourceName } = getResourceGroupAndName(resources);\n  const multipleResources = (resources && resources.length > 1) ?? false;\n\n  // Fetch new metric metadata when the fields change\n  useEffect(() => {\n    if (!subscription || !resourceGroup || !resourceName || !metricNamespace || !metricName) {\n      setMetricMetadata(defaultMetricMetadata);\n      return;\n    }\n    datasource.azureMonitorDatasource\n      .getMetricMetadata(\n        { subscription, resourceGroup, resourceName, metricNamespace, metricName, customNamespace },\n        multipleResources,\n        region\n      )\n      .then((metadata) => {\n        // TODO: Move the aggregationTypes and timeGrain defaults into `getMetricMetadata`\n        const aggregations = (metadata.supportedAggTypes || [metadata.primaryAggType]).map((v) => ({\n          label: v,\n          value: v,\n        }));\n\n        setMetricMetadata({\n          aggOptions: aggregations,\n          timeGrains: metadata.supportedTimeGrains,\n          dimensions: metadata.dimensions,\n          isLoading: false,\n          supportedAggTypes: metadata.supportedAggTypes ?? [],\n          primaryAggType: metadata.primaryAggType,\n        });\n      });\n  }, [\n    region,\n    datasource,\n    subscription,\n    resourceGroup,\n    resourceName,\n    metricNamespace,\n    metricName,\n    customNamespace,\n    multipleResources,\n  ]);\n\n  // Update the query state in response to the meta data changing\n  useEffect(() => {\n    const newAggregation = aggregation || metricMetadata.primaryAggType;\n    const newTimeGrain = timeGrain || 'auto';\n\n    if (newAggregation !== aggregation || newTimeGrain !== timeGrain) {\n      onChange({\n        ...query,\n        azureMonitor: {\n          ...query.azureMonitor,\n          aggregation: newAggregation,\n          timeGrain: newTimeGrain,\n          allowedTimeGrainsMs: metricMetadata.timeGrains\n            .filter((timeGrain) => timeGrain.value !== 'auto')\n            .map((timeGrain) =>\n              rangeUtil.intervalToMs(TimegrainConverter.createKbnUnitFromISO8601Duration(timeGrain.value))\n            ),\n        },\n      });\n    }\n  }, [onChange, metricMetadata, aggregation, timeGrain, query]);\n\n  return metricMetadata;\n};\n\nfunction formatOptions(\n  rawResults: Array<{\n    text: string;\n    value: string;\n  }>,\n  selectedValue?: string\n) {\n  const options = rawResults.map(toOption);\n\n  // account for custom values that might have been set in json file like ones crafted with a template variable (ex: \"cloud-datasource-resource-$Environment\")\n  if (selectedValue && !options.find((option) => option.value === selectedValue.toLowerCase())) {\n    options.push({ label: selectedValue, value: selectedValue });\n  }\n\n  return options;\n}\n","import { PanelData } from '@grafana/data';\nimport { EditorRows, EditorRow, EditorFieldGroup } from '@grafana/experimental';\n\nimport { multiResourceCompatibleTypes } from '../../azureMetadata';\nimport type Datasource from '../../datasource';\nimport { selectors } from '../../e2e/selectors';\nimport type { AzureMonitorQuery, AzureMonitorOption, AzureMonitorErrorish, AzureMonitorResource } from '../../types';\nimport ResourceField from '../ResourceField';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from '../ResourcePicker/types';\nimport { parseResourceDetails } from '../ResourcePicker/utils';\n\nimport AdvancedResourcePicker from './AdvancedResourcePicker';\nimport AggregationField from './AggregationField';\nimport DimensionFields from './DimensionFields';\nimport LegendFormatField from './LegendFormatField';\nimport MetricNameField from './MetricNameField';\nimport MetricNamespaceField from './MetricNamespaceField';\nimport TimeGrainField from './TimeGrainField';\nimport TopField from './TopField';\nimport { useMetricNames, useMetricNamespaces, useMetricMetadata } from './dataHooks';\n\ninterface MetricsQueryEditorProps {\n  data: PanelData | undefined;\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  onChange: (newQuery: AzureMonitorQuery) => void;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n}\n\nconst MetricsQueryEditor = ({\n  data,\n  query,\n  datasource,\n  variableOptionGroup,\n  onChange,\n  setError,\n}: MetricsQueryEditorProps) => {\n  const metricsMetadata = useMetricMetadata(query, datasource, onChange);\n  const metricNamespaces = useMetricNamespaces(query, datasource, onChange, setError);\n  const metricNames = useMetricNames(query, datasource, onChange, setError);\n  const resources =\n    query.azureMonitor?.resources?.map((r) => ({\n      subscription: query.subscription,\n      resourceGroup: r.resourceGroup,\n      metricNamespace: query.azureMonitor?.metricNamespace,\n      resourceName: r.resourceName,\n      region: query.azureMonitor?.region,\n    })) ?? [];\n\n  const supportMultipleResource = (namespace?: string) => {\n    return multiResourceCompatibleTypes[namespace?.toLocaleLowerCase() ?? ''] ?? false;\n  };\n\n  const disableRow = (row: ResourceRow, selectedRows: ResourceRowGroup) => {\n    if (selectedRows.length === 0) {\n      // Only if there is some resource(s) selected we should disable rows\n      return false;\n    }\n\n    const rowResource = parseResourceDetails(row.uri, row.location);\n    const selectedRowSample = parseResourceDetails(selectedRows[0].uri, selectedRows[0].location);\n    // Only resources:\n    // - in the same subscription\n    // - in the same region\n    // - with the same metric namespace\n    // - with a metric namespace that is compatible with multi-resource queries\n    return (\n      rowResource.subscription !== selectedRowSample.subscription ||\n      rowResource.region !== selectedRowSample.region ||\n      rowResource.metricNamespace?.toLocaleLowerCase() !== selectedRowSample.metricNamespace?.toLocaleLowerCase() ||\n      !supportMultipleResource(rowResource.metricNamespace)\n    );\n  };\n\n  const selectionNotice = (selectedRows: ResourceRowGroup) => {\n    if (selectedRows.length === 0) {\n      return '';\n    }\n    const selectedRowSample = parseResourceDetails(selectedRows[0].uri, selectedRows[0].location);\n    return supportMultipleResource(selectedRowSample.metricNamespace)\n      ? 'You can select items of the same resource type and location. To select resources of a different resource type or location, please first uncheck your current selection.'\n      : '';\n  };\n\n  return (\n    <span data-testid={selectors.components.queryEditor.metricsQueryEditor.container.input}>\n      <EditorRows>\n        <EditorRow>\n          <EditorFieldGroup>\n            <ResourceField\n              query={query}\n              datasource={datasource}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n              selectableEntryTypes={[ResourceRowType.Resource]}\n              resources={resources ?? []}\n              queryType={'metrics'}\n              disableRow={disableRow}\n              renderAdvanced={(resources, onChange) => (\n                // It's required to cast resources because the resource picker\n                // specifies the type to string | AzureMonitorResource.\n                // eslint-disable-next-line\n                <AdvancedResourcePicker resources={resources as AzureMonitorResource[]} onChange={onChange} />\n              )}\n              selectionNotice={selectionNotice}\n            />\n            <MetricNamespaceField\n              metricNamespaces={metricNamespaces}\n              query={query}\n              datasource={datasource}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n            />\n            <MetricNameField\n              metricNames={metricNames}\n              query={query}\n              datasource={datasource}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n            />\n            <AggregationField\n              query={query}\n              datasource={datasource}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n              aggregationOptions={metricsMetadata?.aggOptions ?? []}\n              isLoading={metricsMetadata.isLoading}\n            />\n            <TimeGrainField\n              query={query}\n              datasource={datasource}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n              timeGrainOptions={metricsMetadata?.timeGrains ?? []}\n            />\n          </EditorFieldGroup>\n        </EditorRow>\n        <EditorRow>\n          <EditorFieldGroup>\n            <DimensionFields\n              data={data}\n              query={query}\n              datasource={datasource}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n              dimensionOptions={metricsMetadata?.dimensions ?? []}\n            />\n          </EditorFieldGroup>\n        </EditorRow>\n        <EditorRow>\n          <EditorFieldGroup>\n            <TopField\n              query={query}\n              datasource={datasource}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n            />\n            <LegendFormatField\n              query={query}\n              datasource={datasource}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              setError={setError}\n            />\n          </EditorFieldGroup>\n        </EditorRow>\n      </EditorRows>\n    </span>\n  );\n};\n\nexport default MetricsQueryEditor;\n","// NOTE: by default Component string selectors are set up to be aria-labels,\n// however there are many cases where your component may not need an aria-label\n// (a <button> with clear text, for example, does not need an aria-label as it's already labeled)\n// but you still might need to select it for testing,\n// in that case please add the attribute data-testid={selector} in the component and\n// prefix your selector string with 'data-testid' so that when create the selectors we know to search for it on the right attribute\n/**\n * Selectors grouped/defined in Components\n *\n * @alpha\n */\nexport const Components = {\n  RadioButton: {\n    container: 'data-testid radio-button',\n  },\n  Breadcrumbs: {\n    breadcrumb: (title: string) => `data-testid ${title} breadcrumb`,\n  },\n  TimePicker: {\n    openButton: 'data-testid TimePicker Open Button',\n    overlayContent: 'data-testid TimePicker Overlay Content',\n    fromField: 'data-testid Time Range from field',\n    toField: 'data-testid Time Range to field',\n    applyTimeRange: 'data-testid TimePicker submit button',\n    copyTimeRange: 'data-testid TimePicker copy button',\n    pasteTimeRange: 'data-testid TimePicker paste button',\n    calendar: {\n      label: 'data-testid Time Range calendar',\n      openButton: 'data-testid Open time range calendar',\n      closeButton: 'data-testid Close time range Calendar',\n    },\n    absoluteTimeRangeTitle: 'data-testid-absolute-time-range-narrow',\n  },\n  DataSourcePermissions: {\n    form: () => 'form[name=\"addPermission\"]',\n    roleType: 'Role to add new permission to',\n    rolePicker: 'Built-in role picker',\n    permissionLevel: 'Permission Level',\n  },\n  DateTimePicker: {\n    input: 'data-testid date-time-input',\n  },\n  DataSource: {\n    TestData: {\n      QueryTab: {\n        scenarioSelectContainer: 'Test Data Query scenario select container',\n        scenarioSelect: 'Test Data Query scenario select',\n        max: 'TestData max',\n        min: 'TestData min',\n        noise: 'TestData noise',\n        seriesCount: 'TestData series count',\n        spread: 'TestData spread',\n        startValue: 'TestData start value',\n        drop: 'TestData drop values',\n      },\n    },\n    DataSourceHttpSettings: {\n      urlInput: 'data-testid Datasource HTTP settings url',\n    },\n    Jaeger: {\n      traceIDInput: 'Trace ID',\n    },\n    Prometheus: {\n      configPage: {\n        connectionSettings: 'Data source connection URL', // aria-label in grafana experimental\n        manageAlerts: 'prometheus-alerts-manager', // id for switch component\n        scrapeInterval: 'data-testid scrape interval',\n        queryTimeout: 'data-testid query timeout',\n        defaultEditor: 'data-testid default editor',\n        disableMetricLookup: 'disable-metric-lookup', // id for switch component\n        prometheusType: 'data-testid prometheus type',\n        prometheusVersion: 'data-testid prometheus version',\n        cacheLevel: 'data-testid cache level',\n        incrementalQuerying: 'prometheus-incremental-querying', // id for switch component\n        queryOverlapWindow: 'data-testid query overlap window',\n        disableRecordingRules: 'disable-recording-rules', // id for switch component\n        customQueryParameters: 'data-testid custom query parameters',\n        httpMethod: 'data-testid http method',\n        exemplarsAddButton: 'data-testid Add exemplar config button',\n        internalLinkSwitch: 'data-testid Internal link switch',\n        codeModeMetricNamesSuggestionLimit: 'data-testid code mode metric names suggestion limit',\n      },\n      queryEditor: {\n        // kickstart: '', see QueryBuilder queryPatterns below\n        explain: 'data-testid prometheus explain switch wrapper',\n        editorToggle: 'data-testid QueryEditorModeToggle', // wrapper for toggle\n        options: 'data-testid prometheus options', // wrapper for options group\n        legend: 'data-testid prometheus legend wrapper', // wrapper for multiple compomnents\n        format: 'data-testid prometheus format',\n        step: 'prometheus-step', // id for autosize component\n        type: 'data-testid prometheus type', //wrapper for radio button group\n        exemplars: 'prometheus-exemplars', // id for editor switch component\n        builder: {\n          // see QueryBuilder below for commented selectors\n          // labelSelect: 'data-testid Select label',\n          // valueSelect: 'data-testid Select value',\n          // matchOperatorSelect: 'data-testid Select match operator',\n          metricSelect: 'data-testid metric select',\n          hints: 'data-testid prometheus hints', // wrapper for hints component\n          metricsExplorer: 'data-testid metrics explorer',\n          queryAdvisor: 'data-testid query advisor',\n        },\n        code: {\n          queryField: 'data-testid prometheus query field',\n          metricsCountInfo: 'data-testid metrics count disclaimer',\n          metricsBrowser: {\n            openButton: 'data-testid open metrics browser',\n            selectMetric: 'data-testid select a metric',\n            seriesLimit: 'data-testid series limit',\n            metricList: 'data-testid metric list',\n            labelNamesFilter: 'data-testid label names filter',\n            labelValuesFilter: 'data-testid label values filter',\n            useQuery: 'data-testid use query',\n            useAsRateQuery: 'data-testid use as rate query',\n            validateSelector: 'data-testid validate selector',\n            clear: 'data-testid clear',\n          },\n        },\n      },\n      exemplarMarker: 'data-testid Exemplar marker',\n      variableQueryEditor: {\n        queryType: 'data-testid query type',\n        labelnames: {\n          metricRegex: 'data-testid label names metric regex',\n        },\n        labelValues: {\n          labelSelect: 'data-testid label values label select',\n          // metric select see queryEditor: builder for more context\n          // label select for metric filtering see queryEditor: builder for more context\n        },\n        metricNames: {\n          metricRegex: 'data-testid metric names metric regex',\n        },\n        varQueryResult: 'data-testid variable query result',\n        seriesQuery: 'data-testid prometheus series query',\n        classicQuery: 'data-testid prometheus classic query',\n      },\n      annotations: {\n        minStep: 'prometheus-annotation-min-step', // id for autosize input\n        title: 'data-testid prometheus annotation title',\n        tags: 'data-testid prometheus annotation tags',\n        text: 'data-testid prometheus annotation text',\n        seriesValueAsTimestamp: 'data-testid prometheus annotation series value as timestamp',\n      },\n    },\n  },\n  Menu: {\n    MenuComponent: (title: string) => `${title} menu`,\n    MenuGroup: (title: string) => `${title} menu group`,\n    MenuItem: (title: string) => `${title} menu item`,\n    SubMenu: {\n      container: 'data-testid SubMenu container',\n      icon: 'data-testid SubMenu icon',\n    },\n  },\n  Panels: {\n    Panel: {\n      title: (title: string) => `data-testid Panel header ${title}`,\n      content: 'data-testid panel content',\n      headerItems: (item: string) => `data-testid Panel header item ${item}`,\n      menuItems: (item: string) => `data-testid Panel menu item ${item}`,\n      menu: (title: string) => `data-testid Panel menu ${title}`,\n      containerByTitle: (title: string) => `${title} panel`,\n      headerCornerInfo: (mode: string) => `Panel header ${mode}`,\n      status: (status: string) => `data-testid Panel status ${status}`,\n      loadingBar: () => `Panel loading bar`,\n      HoverWidget: {\n        container: 'data-testid hover-header-container',\n        dragIcon: 'data-testid drag-icon',\n      },\n      PanelDataErrorMessage: 'data-testid Panel data error message',\n    },\n    Visualization: {\n      Graph: {\n        container: 'Graph container',\n        VisualizationTab: {\n          legendSection: 'Legend section',\n        },\n        Legend: {\n          legendItemAlias: (name: string) => `gpl alias ${name}`,\n          showLegendSwitch: 'gpl show legend',\n        },\n        xAxis: {\n          labels: () => 'div.flot-x-axis > div.flot-tick-label',\n        },\n      },\n      BarGauge: {\n        /**\n         * @deprecated use valueV2 from Grafana 8.3 instead\n         */\n        value: 'Bar gauge value',\n        valueV2: 'data-testid Bar gauge value',\n      },\n      PieChart: {\n        svgSlice: 'data testid Pie Chart Slice',\n      },\n      Text: {\n        container: () => '.markdown-html',\n      },\n      Table: {\n        header: 'table header',\n        footer: 'table-footer',\n        body: 'data-testid table body',\n      },\n    },\n  },\n  VizLegend: {\n    seriesName: (name: string) => `data-testid VizLegend series ${name}`,\n  },\n  Drawer: {\n    General: {\n      title: (title: string) => `Drawer title ${title}`,\n      expand: 'Drawer expand',\n      contract: 'Drawer contract',\n      close: 'data-testid Drawer close',\n      rcContentWrapper: () => '.rc-drawer-content-wrapper',\n      subtitle: 'data-testid drawer subtitle',\n    },\n    DashboardSaveDrawer: {\n      saveButton: 'data-testid Save dashboard drawer button',\n      saveAsButton: 'data-testid Save as dashboard drawer button',\n      saveAsTitleInput: 'Save dashboard title field',\n    },\n  },\n  PanelEditor: {\n    General: {\n      content: 'data-testid Panel editor content',\n    },\n    OptionsPane: {\n      content: 'data-testid Panel editor option pane content',\n      select: 'Panel editor option pane select',\n      fieldLabel: (type: string) => `${type} field property editor`,\n      fieldInput: (title: string) => `data-testid Panel editor option pane field input ${title}`,\n    },\n    // not sure about the naming *DataPane*\n    DataPane: {\n      content: 'data-testid Panel editor data pane content',\n    },\n    applyButton: 'data-testid Apply changes and go back to dashboard',\n    toggleVizPicker: 'data-testid toggle-viz-picker',\n    toggleVizOptions: 'data-testid toggle-viz-options',\n    toggleTableView: 'data-testid toggle-table-view',\n\n    // [Geomap] Map controls\n    showZoomField: 'Map controls Show zoom control field property editor',\n    showAttributionField: 'Map controls Show attribution field property editor',\n    showScaleField: 'Map controls Show scale field property editor',\n    showMeasureField: 'Map controls Show measure tools field property editor',\n    showDebugField: 'Map controls Show debug field property editor',\n\n    measureButton: 'show measure tools',\n  },\n  PanelInspector: {\n    Data: {\n      content: 'Panel inspector Data content',\n    },\n    Stats: {\n      content: 'Panel inspector Stats content',\n    },\n    Json: {\n      content: 'data-testid Panel inspector Json content',\n    },\n    Query: {\n      content: 'Panel inspector Query content',\n      refreshButton: 'Panel inspector Query refresh button',\n      jsonObjectKeys: () => '.json-formatter-key',\n    },\n  },\n  Tab: {\n    title: (title: string) => `data-testid Tab ${title}`,\n    active: () => '[class*=\"-activeTabStyle\"]',\n  },\n  RefreshPicker: {\n    /**\n     * @deprecated use runButtonV2 from Grafana 8.3 instead\n     */\n    runButton: 'RefreshPicker run button',\n    /**\n     * @deprecated use intervalButtonV2 from Grafana 8.3 instead\n     */\n    intervalButton: 'RefreshPicker interval button',\n    runButtonV2: 'data-testid RefreshPicker run button',\n    intervalButtonV2: 'data-testid RefreshPicker interval button',\n  },\n  QueryTab: {\n    content: 'Query editor tab content',\n    queryInspectorButton: 'Query inspector button',\n    queryHistoryButton: 'data-testid query-history-button',\n    addQuery: 'data-testid query-tab-add-query',\n    queryGroupTopSection: 'data-testid query group top section',\n    addExpression: 'data-testid query-tab-add-expression',\n  },\n  QueryHistory: {\n    queryText: 'Query text',\n  },\n  QueryEditorRows: {\n    rows: 'Query editor row',\n  },\n  QueryEditorRow: {\n    actionButton: (title: string) => `data-testid ${title}`,\n    title: (refId: string) => `Query editor row title ${refId}`,\n    container: (refId: string) => `Query editor row ${refId}`,\n  },\n  AlertTab: {\n    content: 'data-testid Alert editor tab content',\n  },\n  AlertRules: {\n    groupToggle: 'data-testid group-collapse-toggle',\n    toggle: 'data-testid collapse-toggle',\n    expandedContent: 'data-testid expanded-content',\n    previewButton: 'data-testid alert-rule preview-button',\n    ruleNameField: 'data-testid alert-rule name-field',\n    newFolderButton: 'data-testid alert-rule new-folder-button',\n    newFolderNameField: 'data-testid alert-rule name-folder-name-field',\n    newFolderNameCreateButton: 'data-testid alert-rule name-folder-name-create-button',\n    newEvaluationGroupButton: 'data-testid alert-rule new-evaluation-group-button',\n    newEvaluationGroupName: 'data-testid alert-rule new-evaluation-group-name',\n    newEvaluationGroupInterval: 'data-testid alert-rule new-evaluation-group-interval',\n    newEvaluationGroupCreate: 'data-testid alert-rule new-evaluation-group-create-button',\n  },\n  Alert: {\n    /**\n     * @deprecated use alertV2 from Grafana 8.3 instead\n     */\n    alert: (severity: string) => `Alert ${severity}`,\n    alertV2: (severity: string) => `data-testid Alert ${severity}`,\n  },\n  TransformTab: {\n    content: 'data-testid Transform editor tab content',\n    newTransform: (name: string) => `data-testid New transform ${name}`,\n    transformationEditor: (name: string) => `data-testid Transformation editor ${name}`,\n    transformationEditorDebugger: (name: string) => `data-testid Transformation editor debugger ${name}`,\n  },\n  Transforms: {\n    card: (name: string) => `data-testid New transform ${name}`,\n    disableTransformationButton: 'data-testid Disable transformation button',\n    Reduce: {\n      modeLabel: 'data-testid Transform mode label',\n      calculationsLabel: 'data-testid Transform calculations label',\n    },\n    SpatialOperations: {\n      actionLabel: 'root Action field property editor',\n      locationLabel: 'root Location Mode field property editor',\n      location: {\n        autoOption: 'Auto location option',\n        coords: {\n          option: 'Coords location option',\n          latitudeFieldLabel: 'root Latitude field field property editor',\n          longitudeFieldLabel: 'root Longitude field field property editor',\n        },\n        geohash: {\n          option: 'Geohash location option',\n          geohashFieldLabel: 'root Geohash field field property editor',\n        },\n        lookup: {\n          option: 'Lookup location option',\n          lookupFieldLabel: 'root Lookup field field property editor',\n          gazetteerFieldLabel: 'root Gazetteer field property editor',\n        },\n      },\n    },\n    searchInput: 'data-testid search transformations',\n    noTransformationsMessage: 'data-testid no transformations message',\n    addTransformationButton: 'data-testid add transformation button',\n    removeAllTransformationsButton: 'data-testid remove all transformations button',\n  },\n  NavBar: {\n    Configuration: {\n      button: 'Configuration',\n    },\n    Toggle: {\n      button: 'data-testid Toggle menu',\n    },\n    Reporting: {\n      button: 'Reporting',\n    },\n  },\n  NavMenu: {\n    Menu: 'data-testid navigation mega-menu',\n    item: 'data-testid Nav menu item',\n  },\n  NavToolbar: {\n    container: 'data-testid Nav toolbar',\n    shareDashboard: 'data-testid Share dashboard',\n    markAsFavorite: 'data-testid Mark as favorite',\n    editDashboard: {\n      editButton: 'data-testid Edit dashboard button',\n      saveButton: 'data-testid Save dashboard button',\n      exitButton: 'data-testid Exit edit mode button',\n      settingsButton: 'data-testid Dashboard settings',\n      addRowButton: 'data-testid Add row button',\n      addLibraryPanelButton: 'data-testid Add a panel from the panel library button',\n      addVisualizationButton: 'data-testid Add new visualization menu item',\n      pastePanelButton: 'data-testid Paste panel button',\n      discardChangesButton: 'data-testid Discard changes button',\n      discardLibraryPanelButton: 'data-testid Discard library panel button',\n      unlinkLibraryPanelButton: 'data-testid Unlink library panel button',\n      saveLibraryPanelButton: 'data-testid Save library panel button',\n      backToDashboardButton: 'data-testid Back to dashboard button',\n    },\n  },\n\n  PageToolbar: {\n    container: () => '.page-toolbar',\n    item: (tooltip: string) => `${tooltip}`,\n    itemButton: (title: string) => `data-testid ${title}`,\n  },\n  QueryEditorToolbarItem: {\n    button: (title: string) => `QueryEditor toolbar item button ${title}`,\n  },\n  BackButton: {\n    backArrow: 'data-testid Go Back',\n  },\n  OptionsGroup: {\n    group: (title?: string) => (title ? `data-testid Options group ${title}` : 'data-testid Options group'),\n    toggle: (title?: string) =>\n      title ? `data-testid Options group ${title} toggle` : 'data-testid Options group toggle',\n  },\n  PluginVisualization: {\n    item: (title: string) => `Plugin visualization item ${title}`,\n    current: () => '[class*=\"-currentVisualizationItem\"]',\n  },\n  Select: {\n    option: 'data-testid Select option',\n    toggleAllOptions: 'data-testid toggle all options',\n    input: () => 'input[id*=\"time-options-input\"]',\n    singleValue: () => 'div[class*=\"-singleValue\"]',\n  },\n  FieldConfigEditor: {\n    content: 'Field config editor content',\n  },\n  OverridesConfigEditor: {\n    content: 'Field overrides editor content',\n  },\n  FolderPicker: {\n    /**\n     * @deprecated use containerV2 from Grafana 8.3 instead\n     */\n    container: 'Folder picker select container',\n    containerV2: 'data-testid Folder picker select container',\n    input: 'data-testid folder-picker-input',\n  },\n  ReadonlyFolderPicker: {\n    container: 'data-testid Readonly folder picker select container',\n  },\n  DataSourcePicker: {\n    container: 'data-testid Data source picker select container',\n    /**\n     * @deprecated use inputV2 instead\n     */\n    input: () => 'input[id=\"data-source-picker\"]',\n    inputV2: 'data-testid Select a data source',\n    dataSourceList: 'data-testid Data source list dropdown',\n    advancedModal: {\n      dataSourceList: 'data-testid Data source list',\n      builtInDataSourceList: 'data-testid Built in data source list',\n    },\n  },\n  TimeZonePicker: {\n    /**\n     * @deprecated use TimeZonePicker.containerV2 from Grafana 8.3 instead\n     */\n    container: 'Time zone picker select container',\n    containerV2: 'data-testid Time zone picker select container',\n    changeTimeSettingsButton: 'data-testid Time zone picker Change time settings button',\n  },\n  WeekStartPicker: {\n    /**\n     * @deprecated use WeekStartPicker.containerV2 from Grafana 8.3 instead\n     */\n    container: 'Choose starting day of the week',\n    containerV2: 'data-testid Choose starting day of the week',\n    placeholder: 'Choose starting day of the week',\n  },\n  TraceViewer: {\n    spanBar: 'data-testid SpanBar--wrapper',\n  },\n  QueryField: { container: 'data-testid Query field' },\n  QueryBuilder: {\n    queryPatterns: 'data-testid Query patterns',\n    labelSelect: 'data-testid Select label',\n    inputSelect: 'data-testid Select label-input',\n    valueSelect: 'data-testid Select value',\n    matchOperatorSelect: 'data-testid Select match operator',\n  },\n  ValuePicker: {\n    button: (name: string) => `data-testid Value picker button ${name}`,\n    select: (name: string) => `data-testid Value picker select ${name}`,\n  },\n  Search: {\n    /**\n     * @deprecated use sectionV2 from Grafana 8.3 instead\n     */\n    section: 'Search section',\n    sectionV2: 'data-testid Search section',\n    /**\n     * @deprecated use itemsV2 from Grafana 8.3 instead\n     */\n    items: 'Search items',\n    itemsV2: 'data-testid Search items',\n    cards: 'data-testid Search cards',\n    collapseFolder: (sectionId: string) => `data-testid Collapse folder ${sectionId}`,\n    expandFolder: (sectionId: string) => `data-testid Expand folder ${sectionId}`,\n    dashboardItem: (item: string) => `${Components.Search.dashboardItems} ${item}`,\n    dashboardCard: (item: string) => `data-testid Search card ${item}`,\n    folderHeader: (folderName: string) => `data-testid Folder header ${folderName}`,\n    folderContent: (folderName: string) => `data-testid Folder content ${folderName}`,\n    dashboardItems: 'data-testid Dashboard search item',\n  },\n  DashboardLinks: {\n    container: 'data-testid Dashboard link container',\n    dropDown: 'data-testid Dashboard link dropdown',\n    link: 'data-testid Dashboard link',\n  },\n  LoadingIndicator: {\n    icon: 'data-testid Loading indicator',\n  },\n  CallToActionCard: {\n    /**\n     * @deprecated use buttonV2 from Grafana 8.3 instead\n     */\n    button: (name: string) => `Call to action button ${name}`,\n    buttonV2: (name: string) => `data-testid Call to action button ${name}`,\n  },\n  DataLinksContextMenu: {\n    singleLink: 'data-testid Data link',\n  },\n  CodeEditor: {\n    container: 'data-testid Code editor container',\n  },\n  ReactMonacoEditor: {\n    editorLazy: 'data-testid ReactMonacoEditor editorLazy',\n  },\n  DashboardImportPage: {\n    textarea: 'data-testid-import-dashboard-textarea',\n    submit: 'data-testid-load-dashboard',\n  },\n  ImportDashboardForm: {\n    name: 'data-testid-import-dashboard-title',\n    submit: 'data-testid-import-dashboard-submit',\n  },\n  PanelAlertTabContent: {\n    content: 'data-testid Unified alert editor tab content',\n  },\n  VisualizationPreview: {\n    card: (name: string) => `data-testid suggestion-${name}`,\n  },\n  ColorSwatch: {\n    name: `data-testid-colorswatch`,\n  },\n  DashboardRow: {\n    title: (title: string) => `data-testid dashboard-row-title-${title}`,\n  },\n  UserProfile: {\n    profileSaveButton: 'data-testid-user-profile-save',\n    preferencesSaveButton: 'data-testid-shared-prefs-save',\n    orgsTable: 'data-testid-user-orgs-table',\n    sessionsTable: 'data-testid-user-sessions-table',\n    extensionPointTabs: 'data-testid-extension-point-tabs',\n    extensionPointTab: (tabId: string) => `data-testid-extension-point-tab-${tabId}`,\n  },\n  FileUpload: {\n    inputField: 'data-testid-file-upload-input-field',\n    fileNameSpan: 'data-testid-file-upload-file-name',\n  },\n  DebugOverlay: {\n    wrapper: 'debug-overlay',\n  },\n  OrgRolePicker: {\n    input: 'Role',\n  },\n  AnalyticsToolbarButton: {\n    button: 'Dashboard insights',\n  },\n  Variables: {\n    variableOption: 'data-testid variable-option',\n    variableLinkWrapper: 'data-testid variable-link-wrapper',\n  },\n  Annotations: {\n    annotationsTypeInput: 'data-testid annotations-type-input',\n    annotationsChoosePanelInput: 'data-testid choose-panels-input',\n    editor: {\n      testButton: 'data-testid annotations-test-button',\n      resultContainer: 'data-testid annotations-query-result-container',\n    },\n  },\n  Tooltip: {\n    container: 'data-testid tooltip',\n  },\n  ReturnToPrevious: {\n    buttonGroup: 'data-testid dismissable button group',\n    backButton: 'data-testid back',\n    dismissButton: 'data-testid dismiss',\n  },\n  SQLQueryEditor: {\n    selectColumn: 'data-testid select-column',\n    selectAggregation: 'data-testid select-aggregation',\n    selectAlias: 'data-testid select-alias',\n    filterConjunction: 'data-testid filter-conjunction',\n    filterField: 'data-testid filter-field',\n    filterOperator: 'data-testid filter-operator',\n    headerTableSelector: 'data-testid header-table-selector',\n    headerFilterSwitch: 'data-testid header-filter-switch',\n    headerGroupSwitch: 'data-testid header-group-switch',\n    headerOrderSwitch: 'data-testid header-order-switch',\n    headerPreviewSwitch: 'data-testid header-preview-switch',\n  },\n  EntityNotFound: {\n    container: 'data-testid entity-not-found',\n  },\n};\n","import { E2ESelectors } from '../types';\n\nimport { Components } from './components';\nimport { Pages } from './pages';\n\n/**\n * Exposes selectors in package for easy use in e2e tests and in production code\n *\n * @alpha\n */\nexport const selectors: { pages: E2ESelectors<typeof Pages>; components: E2ESelectors<typeof Components> } = {\n  pages: Pages,\n  components: Components,\n};\n\n/**\n * Exposes Pages, Component selectors and E2ESelectors type in package for easy use in e2e tests and in production code\n *\n * @alpha\n */\nexport { Pages, Components, type E2ESelectors };\n","import { Components } from './components';\n\n/**\n * Selectors grouped/defined in Pages\n *\n * @alpha\n */\nexport const Pages = {\n  Login: {\n    url: '/login',\n    username: 'data-testid Username input field',\n    password: 'data-testid Password input field',\n    submit: 'data-testid Login button',\n    skip: 'data-testid Skip change password button',\n  },\n  Home: {\n    url: '/',\n  },\n  DataSource: {\n    name: 'data-testid Data source settings page name input field',\n    delete: 'Data source settings page Delete button',\n    readOnly: 'data-testid Data source settings page read only message',\n    saveAndTest: 'data-testid Data source settings page Save and Test button',\n    alert: 'data-testid Data source settings page Alert',\n  },\n  DataSources: {\n    url: '/datasources',\n    dataSources: (dataSourceName: string) => `Data source list item ${dataSourceName}`,\n  },\n  EditDataSource: {\n    url: (dataSourceUid: string) => `/datasources/edit/${dataSourceUid}`,\n    settings: 'Datasource settings page basic settings',\n  },\n  AddDataSource: {\n    url: '/datasources/new',\n    /** @deprecated Use dataSourcePluginsV2 */\n    dataSourcePlugins: (pluginName: string) => `Data source plugin item ${pluginName}`,\n    dataSourcePluginsV2: (pluginName: string) => `Add new data source ${pluginName}`,\n  },\n  ConfirmModal: {\n    delete: 'data-testid Confirm Modal Danger Button',\n  },\n  AddDashboard: {\n    url: '/dashboard/new',\n    itemButton: (title: string) => `data-testid ${title}`,\n    addNewPanel: 'data-testid Add new panel',\n    addNewRow: 'data-testid Add new row',\n    addNewPanelLibrary: 'data-testid Add new panel from panel library',\n  },\n  Dashboard: {\n    url: (uid: string) => `/d/${uid}`,\n    DashNav: {\n      /**\n       * @deprecated use navV2 from Grafana 8.3 instead\n       */\n      nav: 'Dashboard navigation',\n      navV2: 'data-testid Dashboard navigation',\n      publicDashboardTag: 'data-testid public dashboard tag',\n      shareButton: 'data-testid share-button',\n      scrollContainer: 'data-testid Dashboard canvas scroll container',\n      newShareButton: {\n        container: 'data-testid new share button',\n        shareLink: 'data-testid new share link-button',\n        arrowMenu: 'data-testid new share button arrow menu',\n        menu: {\n          container: 'data-testid new share button menu',\n          shareInternally: 'data-testid new share button share internally',\n          shareExternally: 'data-testid new share button share externally',\n          shareSnapshot: 'data-testid new share button share snapshot',\n        },\n      },\n      NewExportButton: {\n        container: 'data-testid new export button',\n        arrowMenu: 'data-testid new export button arrow menu',\n        Menu: {\n          container: 'data-testid new export button menu',\n          exportAsJson: 'data-testid new export button export as json',\n        },\n      },\n      playlistControls: {\n        prev: 'data-testid playlist previous dashboard button',\n        stop: 'data-testid playlist stop dashboard button',\n        next: 'data-testid playlist next dashboard button',\n      },\n    },\n    Controls: 'data-testid dashboard controls',\n    SubMenu: {\n      submenu: 'Dashboard submenu',\n      submenuItem: 'data-testid template variable',\n      submenuItemLabels: (item: string) => `data-testid Dashboard template variables submenu Label ${item}`,\n      submenuItemValueDropDownValueLinkTexts: (item: string) =>\n        `data-testid Dashboard template variables Variable Value DropDown value link text ${item}`,\n      submenuItemValueDropDownDropDown: 'Variable options',\n      submenuItemValueDropDownOptionTexts: (item: string) =>\n        `data-testid Dashboard template variables Variable Value DropDown option text ${item}`,\n      Annotations: {\n        annotationsWrapper: 'data-testid annotation-wrapper',\n        annotationLabel: (label: string) => `data-testid Dashboard annotations submenu Label ${label}`,\n        annotationToggle: (label: string) => `data-testid Dashboard annotations submenu Toggle ${label}`,\n      },\n    },\n    Settings: {\n      Actions: {\n        close: 'data-testid dashboard-settings-close',\n      },\n      General: {\n        deleteDashBoard: 'data-testid Dashboard settings page delete dashboard button',\n        sectionItems: (item: string) => `Dashboard settings section item ${item}`,\n        saveDashBoard: 'Dashboard settings aside actions Save button',\n        saveAsDashBoard: 'Dashboard settings aside actions Save As button',\n        /**\n         * @deprecated use components.TimeZonePicker.containerV2 from Grafana 8.3 instead\n         */\n        timezone: 'Time zone picker select container',\n        title: 'General',\n      },\n      Annotations: {\n        List: {\n          /**\n           * @deprecated use addAnnotationCTAV2 from Grafana 8.3 instead\n           */\n          addAnnotationCTA: Components.CallToActionCard.button('Add annotation query'),\n          addAnnotationCTAV2: Components.CallToActionCard.buttonV2('Add annotation query'),\n          annotations: 'data-testid list-annotations',\n        },\n        Settings: {\n          name: 'data-testid Annotations settings name input',\n        },\n        NewAnnotation: {\n          panelFilterSelect: 'data-testid annotations-panel-filter',\n          showInLabel: 'data-testid show-in-label',\n          previewInDashboard: 'data-testid annotations-preview',\n          delete: 'data-testid annotations-delete',\n          apply: 'data-testid annotations-apply',\n          enable: 'data-testid annotation-enable',\n          hide: 'data-testid annotation-hide',\n        },\n      },\n      Variables: {\n        List: {\n          /**\n           * @deprecated use addVariableCTAV2 from Grafana 8.3 instead\n           */\n          addVariableCTA: Components.CallToActionCard.button('Add variable'),\n          addVariableCTAV2: Components.CallToActionCard.buttonV2('Add variable'),\n          newButton: 'Variable editor New variable button',\n          table: 'Variable editor Table',\n          tableRowNameFields: (variableName: string) => `Variable editor Table Name field ${variableName}`,\n          tableRowDefinitionFields: (variableName: string) => `Variable editor Table Definition field ${variableName}`,\n          tableRowArrowUpButtons: (variableName: string) => `Variable editor Table ArrowUp button ${variableName}`,\n          tableRowArrowDownButtons: (variableName: string) => `Variable editor Table ArrowDown button ${variableName}`,\n          tableRowDuplicateButtons: (variableName: string) => `Variable editor Table Duplicate button ${variableName}`,\n          tableRowRemoveButtons: (variableName: string) => `Variable editor Table Remove button ${variableName}`,\n        },\n        Edit: {\n          General: {\n            headerLink: 'Variable editor Header link',\n            modeLabelNew: 'Variable editor Header mode New',\n            /**\n             * @deprecated\n             */\n            modeLabelEdit: 'Variable editor Header mode Edit',\n            generalNameInput: 'Variable editor Form Name field',\n            generalNameInputV2: 'data-testid Variable editor Form Name field',\n            generalTypeSelect: 'Variable editor Form Type select',\n            generalTypeSelectV2: 'data-testid Variable editor Form Type select',\n            generalLabelInput: 'Variable editor Form Label field',\n            generalLabelInputV2: 'data-testid Variable editor Form Label field',\n            generalHideSelect: 'Variable editor Form Hide select',\n            generalHideSelectV2: 'data-testid Variable editor Form Hide select',\n            selectionOptionsMultiSwitch: 'data-testid Variable editor Form Multi switch',\n            selectionOptionsIncludeAllSwitch: 'data-testid Variable editor Form IncludeAll switch',\n            selectionOptionsCustomAllInput: 'data-testid Variable editor Form IncludeAll field',\n            previewOfValuesOption: 'data-testid Variable editor Preview of Values option',\n            submitButton: 'data-testid Variable editor Run Query button',\n            applyButton: 'data-testid Variable editor Apply button',\n          },\n          QueryVariable: {\n            queryOptionsDataSourceSelect: Components.DataSourcePicker.inputV2,\n            queryOptionsRefreshSelect: 'Variable editor Form Query Refresh select',\n            queryOptionsRefreshSelectV2: 'data-testid Variable editor Form Query Refresh select',\n            queryOptionsRegExInput: 'Variable editor Form Query RegEx field',\n            queryOptionsRegExInputV2: 'data-testid Variable editor Form Query RegEx field',\n            queryOptionsSortSelect: 'Variable editor Form Query Sort select',\n            queryOptionsSortSelectV2: 'data-testid Variable editor Form Query Sort select',\n            queryOptionsQueryInput: 'data-testid Variable editor Form Default Variable Query Editor textarea',\n            valueGroupsTagsEnabledSwitch: 'Variable editor Form Query UseTags switch',\n            valueGroupsTagsTagsQueryInput: 'Variable editor Form Query TagsQuery field',\n            valueGroupsTagsTagsValuesQueryInput: 'Variable editor Form Query TagsValuesQuery field',\n          },\n          ConstantVariable: {\n            constantOptionsQueryInput: 'Variable editor Form Constant Query field',\n            constantOptionsQueryInputV2: 'data-testid Variable editor Form Constant Query field',\n          },\n          DatasourceVariable: {\n            datasourceSelect: 'data-testid datasource variable datasource type',\n          },\n          TextBoxVariable: {\n            textBoxOptionsQueryInput: 'Variable editor Form TextBox Query field',\n            textBoxOptionsQueryInputV2: 'data-testid Variable editor Form TextBox Query field',\n          },\n          CustomVariable: {\n            customValueInput: 'data-testid custom-variable-input',\n          },\n          IntervalVariable: {\n            intervalsValueInput: 'data-testid interval variable intervals input',\n            autoEnabledCheckbox: 'data-testid interval variable auto value checkbox',\n            stepCountIntervalSelect: 'data-testid interval variable step count input',\n            minIntervalInput: 'data-testid interval variable mininum interval input',\n          },\n          GroupByVariable: {\n            dataSourceSelect: Components.DataSourcePicker.inputV2,\n            infoText: 'data-testid group by variable info text',\n            modeToggle: 'data-testid group by variable mode toggle',\n          },\n          AdHocFiltersVariable: {\n            datasourceSelect: Components.DataSourcePicker.inputV2,\n            infoText: 'data-testid ad-hoc filters variable info text',\n            modeToggle: 'data-testid ad-hoc filters variable mode toggle',\n          },\n        },\n      },\n    },\n    Annotations: {\n      marker: 'data-testid annotation-marker',\n    },\n    Rows: {\n      Repeated: {\n        ConfigSection: {\n          warningMessage: 'data-testid Repeated rows warning message',\n        },\n      },\n    },\n  },\n  Dashboards: {\n    url: '/dashboards',\n    /**\n     * @deprecated use components.Search.dashboardItem from Grafana 8.3 instead\n     */\n    dashboards: (title: string) => `Dashboard search item ${title}`,\n  },\n  SaveDashboardAsModal: {\n    newName: 'Save dashboard title field',\n    save: 'Save dashboard button',\n  },\n  SaveDashboardModal: {\n    save: 'Dashboard settings Save Dashboard Modal Save button',\n    saveVariables: 'Dashboard settings Save Dashboard Modal Save variables checkbox',\n    saveTimerange: 'Dashboard settings Save Dashboard Modal Save timerange checkbox',\n    saveRefresh: 'Dashboard settings Save Dashboard Modal Save refresh checkbox',\n  },\n  SharePanelModal: {\n    linkToRenderedImage: 'Link to rendered image',\n  },\n  ShareDashboardModal: {\n    PublicDashboard: {\n      WillBePublicCheckbox: 'data-testid public dashboard will be public checkbox',\n      LimitedDSCheckbox: 'data-testid public dashboard limited datasources checkbox',\n      CostIncreaseCheckbox: 'data-testid public dashboard cost may increase checkbox',\n      PauseSwitch: 'data-testid public dashboard pause switch',\n      EnableAnnotationsSwitch: 'data-testid public dashboard on off switch for annotations',\n      CreateButton: 'data-testid public dashboard create button',\n      DeleteButton: 'data-testid public dashboard delete button',\n      CopyUrlInput: 'data-testid public dashboard copy url input',\n      CopyUrlButton: 'data-testid public dashboard copy url button',\n      SettingsDropdown: 'data-testid public dashboard settings dropdown',\n      TemplateVariablesWarningAlert: 'data-testid public dashboard disabled template variables alert',\n      UnsupportedDataSourcesWarningAlert: 'data-testid public dashboard unsupported data sources alert',\n      NoUpsertPermissionsWarningAlert: 'data-testid public dashboard no upsert permissions alert',\n      EnableTimeRangeSwitch: 'data-testid public dashboard on off switch for time range',\n      EmailSharingConfiguration: {\n        Container: 'data-testid email sharing config container',\n        ShareType: 'data-testid public dashboard share type',\n        EmailSharingInput: 'data-testid public dashboard email sharing input',\n        EmailSharingInviteButton: 'data-testid public dashboard email sharing invite button',\n        EmailSharingList: 'data-testid public dashboard email sharing list',\n        DeleteEmail: 'data-testid public dashboard delete email button',\n        ReshareLink: 'data-testid public dashboard reshare link button',\n      },\n    },\n    SnapshotScene: {\n      url: (key: string) => `/dashboard/snapshot/${key}`,\n      PublishSnapshot: 'data-testid publish snapshot button',\n      CopyUrlButton: 'data-testid snapshot copy url button',\n      CopyUrlInput: 'data-testid snapshot copy url input',\n    },\n  },\n  ShareDashboardDrawer: {\n    ShareInternally: {\n      container: 'data-testid share internally drawer container',\n      lockTimeRangeSwitch: 'data-testid share internally lock time range switch',\n      shortenUrlSwitch: 'data-testid share internally shorten url switch',\n      copyUrlButton: 'data-testid share internally copy url button',\n    },\n    ShareExternally: {\n      container: 'data-testid share externally drawer container',\n      publicAlert: 'data-testid public share alert',\n      emailSharingAlert: 'data-testid email share alert',\n      shareTypeSelect: 'data-testid share externally share type select',\n      Creation: {\n        PublicShare: {\n          createButton: 'data-testid public share dashboard create button',\n          cancelButton: 'data-testid public share dashboard cancel button',\n        },\n        EmailShare: {\n          createButton: 'data-testid email share dashboard create button',\n          cancelButton: 'data-testid email share dashboard cancel button',\n        },\n        willBePublicCheckbox: 'data-testid share dashboard will be public checkbox',\n      },\n      Configuration: {\n        enableTimeRangeSwitch: 'data-testid share externally enable time range switch',\n        enableAnnotationsSwitch: 'data-testid share externally enable annotations switch',\n        copyUrlButton: 'data-testid share externally copy url button',\n        revokeAccessButton: 'data-testid share externally revoke access button',\n        toggleAccessButton: 'data-testid share externally pause or resume access button',\n      },\n    },\n    ShareSnapshot: {\n      url: (key: string) => `/dashboard/snapshot/${key}`,\n      container: 'data-testid share snapshot drawer container',\n      publishSnapshot: 'data-testid share snapshot publish button',\n      copyUrlButton: 'data-testid share snapshot copy url button',\n    },\n  },\n  ExportDashboardDrawer: {\n    ExportAsJson: {\n      container: 'data-testid export as json drawer container',\n      codeEditor: 'data-testid export as json code editor',\n      exportExternallyToggle: 'data-testid export as json externally switch',\n      saveToFileButton: 'data-testid export as json save to file button',\n      copyToClipboardButton: 'data-testid export as json copy to clipboard button',\n      cancelButton: 'data-testid export as json cancel button',\n    },\n  },\n  PublicDashboard: {\n    page: 'public-dashboard-page',\n    NotAvailable: {\n      container: 'public-dashboard-not-available',\n      title: 'public-dashboard-title',\n      pausedDescription: 'public-dashboard-paused-description',\n    },\n    footer: 'public-dashboard-footer',\n  },\n  PublicDashboardScene: {\n    loadingPage: 'public-dashboard-scene-loading-page',\n    page: 'public-dashboard-scene-page',\n    controls: 'public-dashboard-controls',\n  },\n  RequestViewAccess: {\n    form: 'request-view-access-form',\n    recipientInput: 'request-view-access-recipient-input',\n    submitButton: 'request-view-access-submit-button',\n  },\n  PublicDashboardConfirmAccess: {\n    submitButton: 'data-testid confirm-access-submit-button',\n  },\n  Explore: {\n    url: '/explore',\n    General: {\n      container: 'data-testid Explore',\n      graph: 'Explore Graph',\n      table: 'Explore Table',\n      scrollView: 'data-testid explorer scroll view',\n    },\n    QueryHistory: {\n      container: 'data-testid QueryHistory',\n    },\n  },\n  SoloPanel: {\n    url: (page: string) => `/d-solo/${page}`,\n  },\n  PluginsList: {\n    page: 'Plugins list page',\n    list: 'Plugins list',\n    listItem: 'Plugins list item',\n    signatureErrorNotice: 'data-testid Unsigned plugins notice',\n  },\n  PluginPage: {\n    page: 'Plugin page',\n    signatureInfo: 'data-testid Plugin signature info',\n    disabledInfo: 'data-testid Plugin disabled info',\n  },\n  PlaylistForm: {\n    name: 'Playlist name',\n    interval: 'Playlist interval',\n    itemDelete: 'data-testid playlist-form-delete-item',\n  },\n  BrowseDashboards: {\n    table: {\n      body: 'data-testid browse-dashboards-table',\n      row: (name: string) => `data-testid browse dashboards row ${name}`,\n      checkbox: (uid: string) => `data-testid ${uid} checkbox`,\n    },\n    NewFolderForm: {\n      form: 'data-testid new folder form',\n      nameInput: 'data-testid new-folder-name-input',\n      createButton: 'data-testid new-folder-create-button',\n    },\n  },\n  Search: {\n    url: '/?search=openn',\n    FolderView: {\n      url: '/?search=open&layout=folders',\n    },\n  },\n  PublicDashboards: {\n    ListItem: {\n      linkButton: 'public-dashboard-link-button',\n      configButton: 'public-dashboard-configuration-button',\n      trashcanButton: 'public-dashboard-remove-button',\n      pauseSwitch: 'data-testid public dashboard pause switch',\n    },\n  },\n  UserListPage: {\n    tabs: {\n      allUsers: 'data-testid all-users-tab',\n      orgUsers: 'data-testid org-users-tab',\n      anonUserDevices: 'data-testid anon-user-devices-tab',\n      publicDashboardsUsers: 'data-testid public-dashboards-users-tab',\n      users: 'data-testid users-tab',\n    },\n    org: {\n      url: '/org/users',\n    },\n    admin: {\n      url: '/admin/users',\n    },\n    publicDashboards: {\n      container: 'data-testid public-dashboards-users-list',\n    },\n    UserListAdminPage: {\n      container: 'data-testid user-list-admin-page',\n    },\n    UsersListPage: {\n      container: 'data-testid users-list-page',\n    },\n    UserAnonListPage: {\n      container: 'data-testid user-anon-list-page',\n    },\n    UsersListPublicDashboardsPage: {\n      container: 'data-testid users-list-public-dashboards-page',\n      DashboardsListModal: {\n        listItem: (uid: string) => `data-testid dashboards-list-item-${uid}`,\n      },\n    },\n  },\n  ProfilePage: {\n    url: '/profile',\n  },\n};\n","import { cx } from '@emotion/css';\nimport { RefCallback, SyntheticEvent, useState } from 'react';\nimport * as React from 'react';\nimport { lastValueFrom } from 'rxjs';\n\nimport { CoreApp, DataFrame, getDefaultTimeRange, SelectableValue, TimeRange } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { AccessoryButton } from '@grafana/experimental';\nimport {\n  HorizontalGroup,\n  Select,\n  ButtonSelect,\n  AsyncMultiSelect,\n  getSelectStyles,\n  useTheme2,\n  Checkbox,\n} from '@grafana/ui';\n\nimport { AzureMonitorQuery, AzureQueryType, AzureTracesFilter } from '../../dataquery.gen';\nimport Datasource from '../../datasource';\nimport { VariableOptionGroup } from '../../types';\nimport { addValueToOptions } from '../../utils/common';\n\nexport interface FilterProps {\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  propertyMap: Map<string, SelectableValue[]>;\n  setPropertyMap: React.Dispatch<React.SetStateAction<Map<string, Array<SelectableValue<string>>>>>;\n  queryTraceTypes: string[];\n  properties: string[];\n  variableOptionGroup: VariableOptionGroup;\n  range?: TimeRange;\n}\n\nconst onFieldChange = <Key extends keyof AzureTracesFilter>(\n  fieldName: Key,\n  item: Partial<AzureTracesFilter>,\n  selected: SelectableValue<AzureTracesFilter[Key]>,\n  onChange: (item: Partial<AzureTracesFilter>) => void\n) => {\n  if (fieldName === 'filters') {\n    item[fieldName] = selected.map((item: SelectableValue<string>) => item.value);\n  } else {\n    item[fieldName] = selected.value;\n    if (fieldName === 'property') {\n      item.filters = [];\n    }\n  }\n  onChange(item);\n};\n\nconst getTraceProperties = async (\n  query: AzureMonitorQuery,\n  datasource: Datasource,\n  traceTypes: string[],\n  propertyMap: Map<string, SelectableValue[]>,\n  setPropertyMap: React.Dispatch<React.SetStateAction<Map<string, Array<SelectableValue<string>>>>>,\n  filter?: Partial<AzureTracesFilter>,\n  range?: TimeRange\n): Promise<SelectableValue[]> => {\n  const { azureTraces } = query;\n  if (!azureTraces) {\n    return [];\n  }\n\n  const { resources } = azureTraces;\n\n  if (!resources || !filter) {\n    return [];\n  }\n\n  const property = filter.property;\n  if (!property) {\n    return [];\n  }\n\n  const queryString = `let ${property} = toscalar(union isfuzzy=true ${traceTypes.join(',')}\n  | where $__timeFilter(timestamp)\n  | summarize count=count() by ${property}\n  | summarize make_list(pack_all()));\n  print properties = bag_pack(\"${property}\", ${property});`;\n\n  const results = await lastValueFrom(\n    datasource.azureLogAnalyticsDatasource.query({\n      requestId: 'azure-traces-properties-req',\n      interval: '',\n      intervalMs: 0,\n      scopedVars: {},\n      timezone: '',\n      startTime: 0,\n      app: CoreApp.Unknown,\n      targets: [\n        {\n          ...query,\n          azureLogAnalytics: {\n            resources,\n            query: queryString,\n          },\n          queryType: AzureQueryType.LogAnalytics,\n        },\n      ],\n      range: range || getDefaultTimeRange(),\n    })\n  );\n  if (results.data.length > 0) {\n    const result: DataFrame = results.data[0];\n    if (result.fields.length > 0) {\n      const properties: { [key: string]: Array<{ [key: string]: string | number; count: number }> } = JSON.parse(\n        result.fields[0].values.toArray()[0]\n      );\n      const values = properties[property].map((value) => {\n        let label = value[property];\n        if (value[property] === '') {\n          label = '<Empty>';\n        }\n        return { label: label.toString(), value: value[property].toString(), count: value.count };\n      });\n      propertyMap.set(property, values);\n      setPropertyMap(propertyMap);\n      return values;\n    }\n  }\n\n  return [];\n};\n\nexport function makeRenderItem(props: FilterProps) {\n  function renderItem(\n    item: Partial<AzureTracesFilter>,\n    onChange: (item: Partial<AzureTracesFilter>) => void,\n    onDelete: () => void\n  ) {\n    return <Filter {...props} item={item} onChange={onChange} onDelete={onDelete} />;\n  }\n\n  return renderItem;\n}\n\ninterface OptionProps {\n  isFocused: boolean;\n  isSelected: boolean;\n  innerProps: JSX.IntrinsicElements['div'];\n  innerRef: RefCallback<HTMLDivElement>;\n  data: SelectableValue<string>;\n  selectOption: (data: SelectableValue<string>) => void;\n}\n\nconst Option = (props: React.PropsWithChildren<OptionProps>) => {\n  const { data, innerProps, innerRef, isFocused, isSelected } = props;\n  const theme = useTheme2();\n  const styles = getSelectStyles(theme);\n\n  const onClickMultiOption = (e: SyntheticEvent) => {\n    props.selectOption({ ...data });\n    e.stopPropagation();\n    e.preventDefault();\n  };\n\n  return (\n    <div\n      ref={innerRef}\n      className={cx(\n        styles.option,\n        isFocused && styles.optionFocused,\n        isSelected && styles.optionSelected,\n        data.isDisabled && styles.optionDisabled\n      )}\n      {...innerProps}\n      data-testid={selectors.components.Select.option}\n      title={data.title}\n      onClick={onClickMultiOption}\n      onKeyDown={onClickMultiOption}\n      role=\"checkbox\"\n      aria-checked={isSelected}\n      tabIndex={0}\n    >\n      <div className={styles.optionBody}>\n        <Checkbox value={isSelected} label={data.label ? `${data.label} - (${data.count})` : ''} />\n      </div>\n    </div>\n  );\n};\n\nconst Filter = (\n  props: FilterProps & {\n    item: Partial<AzureTracesFilter>;\n    onChange: (item: Partial<AzureTracesFilter>) => void;\n    onDelete: () => void;\n  }\n) => {\n  const {\n    query,\n    datasource,\n    propertyMap,\n    setPropertyMap,\n    queryTraceTypes,\n    properties,\n    item,\n    onChange,\n    onDelete,\n    variableOptionGroup,\n    range,\n  } = props;\n  const [loading, setLoading] = useState(false);\n  const [values, setValues] = useState<Array<SelectableValue<string> | VariableOptionGroup>>(\n    addValueToOptions(propertyMap.get(item.property ?? '') ?? [], variableOptionGroup)\n  );\n  const [selected, setSelected] = useState<SelectableValue[]>(\n    item.filters ? item.filters.map((filter) => ({ value: filter, label: filter === '' ? '<Empty>' : filter })) : []\n  );\n\n  const loadOptions = async () => {\n    setLoading(true);\n    if (item.property && item.property !== '') {\n      const vals = propertyMap.get(item.property ?? '');\n      if (!vals) {\n        const promise = await getTraceProperties(\n          query,\n          datasource,\n          queryTraceTypes,\n          propertyMap,\n          setPropertyMap,\n          item,\n          range\n        );\n        setValues(addValueToOptions(promise, variableOptionGroup));\n        setLoading(false);\n        return promise;\n      } else {\n        setValues(addValueToOptions(vals, variableOptionGroup));\n        setLoading(false);\n        return Promise.resolve(vals);\n      }\n    }\n    const empty: Array<SelectableValue<string>> = [];\n    return Promise.resolve(empty);\n  };\n\n  return (\n    <HorizontalGroup spacing=\"none\">\n      <Select\n        menuShouldPortal\n        placeholder=\"Property\"\n        value={item.property ? { value: item.property, label: item.property } : null}\n        options={addValueToOptions(\n          properties.map((type) => ({ label: type, value: type })),\n          variableOptionGroup\n        )}\n        onChange={(e) => onFieldChange('property', item, e, onChange)}\n        width={25}\n      />\n      <ButtonSelect<string>\n        value={item.operation ? { label: item.operation === 'eq' ? '=' : '!=', value: item.operation } : undefined}\n        options={[\n          { label: '=', value: 'eq' },\n          { label: '!=', value: 'ne' },\n        ]}\n        onChange={(e) => onFieldChange('operation', item, e, onChange)}\n        defaultValue={'eq'}\n      />\n      <AsyncMultiSelect\n        blurInputOnSelect={false}\n        menuShouldPortal\n        placeholder=\"Value\"\n        value={selected}\n        loadOptions={loadOptions}\n        isLoading={loading}\n        onOpenMenu={loadOptions}\n        onChange={(e: Array<SelectableValue<string>>) => {\n          setSelected(e);\n          if (e.length === 0) {\n            onFieldChange('filters', item, selected, onChange);\n          }\n        }}\n        width={35}\n        defaultOptions={values}\n        isClearable\n        components={{ Option }}\n        closeMenuOnSelect={false}\n        onCloseMenu={() => onFieldChange('filters', item, selected, onChange)}\n        hideSelectedOptions={false}\n      />\n      <AccessoryButton aria-label=\"Remove filter\" icon=\"times\" variant=\"secondary\" onClick={onDelete} type=\"button\" />\n    </HorizontalGroup>\n  );\n};\n\nexport default Filter;\n","import { omit } from 'lodash';\n\nexport const Tables = {\n  availabilityResults: { label: 'Availablity Results', description: 'Availability test results.' },\n  dependencies: {\n    label: 'Dependencies',\n    description: 'Calls your application makes to other services such as databases or REST APIs.',\n  },\n  customEvents: { label: 'Custom Events', description: 'Calls to TrackEvent that are inserted to monitor usage.' },\n  exceptions: {\n    label: 'Exceptions',\n    description: 'Exceptions that are logged via TrackException, or uncaught exceptions.',\n  },\n  pageViews: { label: 'Page Views', description: 'Web client telemetry to create page view reports.' },\n  requests: { label: 'Requests', description: 'HTTP requests received by the application.' },\n  traces: {\n    label: 'Traces',\n    description:\n      'Diagnostic logs emitted using TrackTrace and similar methods. Note: Traces are not visualised if the result format is set to Trace',\n  },\n};\n\n// Resource centric tables mapped to legacy tables\nexport const tables = {\n  AppAvailabilityResults: 'availabilityResults',\n  AppDependencies: 'dependencies',\n  AppEvents: 'events',\n  AppExceptions: 'exceptions',\n  AppPageViews: 'pageViews',\n  AppRequests: 'requests',\n  AppTraces: 'traces',\n};\n\n// Properties to omit when generating the attributes bag\nexport const attributesOmit = [\n  'operationId',\n  'duration',\n  'id',\n  'name',\n  'problemId',\n  'operation_ParentId',\n  'timestamp',\n  'customDimensions',\n  'operation_Name',\n];\n\n// Common resource centric properties mapped to legacy property names\nexport const common = {\n  appId: 'ResourceGUID',\n  application_Version: 'AppVersion',\n  appName: '_ResourceId',\n  client_Browser: 'ClientBrowser',\n  client_City: 'ClientCity',\n  client_CountryOrRegion: 'ClientCountryOrRegion',\n  client_IP: 'ClientIP',\n  client_Model: 'ClientModel',\n  client_OS: 'ClientOS',\n  client_StateOrProvince: 'ClientStateOrProvince',\n  client_Type: 'ClientType',\n  cloud_RoleInstance: 'AppRoleInstance',\n  cloud_RoleName: 'AppRoleName',\n  customDimensions: 'Properties',\n  customMeasurements: 'Measurements',\n  duration: 'DurationMs',\n  id: 'Id',\n  iKey: 'IKey',\n  itemCount: 'ItemCount',\n  itemId: '_ItemId',\n  itemType: 'Type',\n  name: 'Name',\n  operation_Id: 'OperationId',\n  operation_Name: 'OperationName',\n  operation_ParentId: 'OperationParentId',\n  operation_SyntheticSource: 'OperationSyntheticSource',\n  performanceBucket: 'PerformanceBucket',\n  sdkVersion: 'SDKVersion',\n  session_Id: 'SessionId',\n  success: 'Success',\n  timestamp: 'TimeGenerated',\n  user_AccountId: 'UserAccountId',\n  user_AuthenticatedId: 'UserAuthenticatedId',\n  user_Id: 'UserId',\n};\n\n// Additional properties for availabilityResults\nexport const availabilityResultsSchema = {\n  ...common,\n  location: 'Location',\n  message: 'Message',\n  size: 'Size',\n};\n\n// Additional properties for dependencies\nexport const dependenciesSchema = {\n  ...common,\n  data: 'Data',\n  resultCode: 'ResultCode',\n  target: 'Target',\n  type: 'DependencyType',\n};\n\n// Additional properties for events\nexport const eventsSchema = omit(common, ['duration', 'id', 'success', 'performanceBucket']);\n\n// Additional properties for pageVies\nexport const pageViewsSchema = omit(\n  {\n    ...common,\n    url: 'Url',\n  },\n  ['success']\n);\n\n// Additional properties for requests\nexport const requestsSchema = {\n  resultCode: 'ResultCode',\n  source: 'Source',\n  url: 'Url',\n};\n\n// Additional properties for exceptions\nexport const exceptionsSchema = omit(\n  {\n    ...common,\n    assembly: 'Assembly',\n    details: 'Details',\n    handledAt: 'HandledAt',\n    innermostAssembly: 'InnermostAssembly',\n    innermostMessage: 'InnermostMessage',\n    innermostMethod: 'InnermostMethod',\n    innermostType: 'InnermostType',\n    message: 'Message',\n    method: 'Method',\n    outerAssembly: 'OuterAssembly',\n    outerMessage: 'OuterMessage',\n    outerMethod: 'OuterMethod',\n    outerType: 'OuterType',\n    problemId: 'ProblemId',\n    severityLevel: 'SeverityLevel',\n    type: 'ExceptionType',\n  },\n  ['duration', 'id', 'name', 'performanceBucket', 'success']\n);\n\n// Additional properties for traces\nexport const tracesSchema = omit(\n  {\n    message: 'Message',\n    severityLevel: 'SeverityLevel',\n  },\n  ['duration', 'id', 'name', 'performanceBucket', 'success']\n);\n\nexport const tablesSchema: { [key: string]: { [key: string]: string } } = {\n  availabilityResults: availabilityResultsSchema,\n  dependencies: dependenciesSchema,\n  customEvents: eventsSchema,\n  exceptions: exceptionsSchema,\n  pageViews: pageViewsSchema,\n  requests: requestsSchema,\n  traces: tracesSchema,\n};\n\nexport const tableTags = Object.entries(tablesSchema).reduce(\n  (val, [k, v]) => ({ ...val, [k]: Object.keys(omit(v, attributesOmit)).join(',') }),\n  {}\n);\n","import { SelectableValue } from '@grafana/data';\n\nimport { AzureMonitorQuery, AzureQueryType, AzureTracesFilter, ResultFormat } from '../../types';\n\n// Used when switching from a traces exemplar query to a standard Azure Traces query\nexport function setDefaultTracesQuery(query: AzureMonitorQuery): AzureMonitorQuery {\n  return {\n    ...query,\n    query: undefined,\n    queryType: AzureQueryType.AzureTraces,\n    azureTraces: undefined,\n  };\n}\n\nexport function setQueryOperationId(query: AzureMonitorQuery, operationId?: string): AzureMonitorQuery {\n  return {\n    ...query,\n    azureTraces: {\n      ...query.azureTraces,\n      operationId,\n    },\n  };\n}\n\nexport function setFormatAs(query: AzureMonitorQuery, formatAs: ResultFormat): AzureMonitorQuery {\n  return {\n    ...query,\n    azureTraces: {\n      ...query.azureTraces,\n      resultFormat: formatAs,\n    },\n  };\n}\n\nexport function setTraceTypes(query: AzureMonitorQuery, traceTypes: string[]): AzureMonitorQuery {\n  return {\n    ...query,\n    azureTraces: {\n      ...query.azureTraces,\n      traceTypes,\n    },\n  };\n}\n\nexport function setFilters(query: AzureMonitorQuery, filters: AzureTracesFilter[]): AzureMonitorQuery {\n  return {\n    ...query,\n    azureTraces: {\n      ...query.azureTraces,\n      filters,\n    },\n  };\n}\n\nexport function onLoad(\n  query: AzureMonitorQuery,\n  defaultValue: ResultFormat,\n  handleChange: (change: SelectableValue<ResultFormat>) => void\n) {\n  if (!query.azureTraces?.resultFormat) {\n    handleChange({ value: defaultValue });\n  }\n}\n","import { uniq } from 'lodash';\nimport { useEffect, useMemo, useState } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { EditorList } from '@grafana/experimental';\nimport { Field } from '@grafana/ui';\n\nimport { AzureQueryEditorFieldProps, AzureTracesFilter } from '../../types';\n\nimport { makeRenderItem } from './Filter';\nimport { tablesSchema } from './consts';\nimport { setFilters } from './setQueryValue';\n\nconst Filters = ({ query, datasource, onQueryChange, variableOptionGroup, range }: AzureQueryEditorFieldProps) => {\n  const { azureTraces } = query;\n  const queryTraceTypes = azureTraces?.traceTypes ? azureTraces.traceTypes : Object.keys(tablesSchema);\n\n  const excludedProperties = new Set([\n    'customDimensions',\n    'customMeasurements',\n    'details',\n    'duration',\n    'id',\n    'itemId',\n    'operation_Id',\n    'operation_ParentId',\n    'timestamp',\n  ]);\n  const properties = uniq(queryTraceTypes.map((type) => Object.keys(tablesSchema[type])).flat()).filter(\n    (item) => !excludedProperties.has(item)\n  );\n\n  const [propertyMap, setPropertyMap] = useState(new Map<string, Array<SelectableValue<string>>>());\n  const queryFilters = useMemo(() => query.azureTraces?.filters ?? [], [query.azureTraces?.filters]);\n  const [filters, updateFilters] = useState(queryFilters);\n\n  useEffect(() => {\n    setPropertyMap(new Map<string, Array<SelectableValue<string>>>());\n  }, [query.azureTraces?.resources, query.azureTraces?.traceTypes, query.azureTraces?.operationId]);\n\n  const changedFunc = (changed: Array<Partial<AzureTracesFilter>>) => {\n    let updateQuery = false;\n    const properData: AzureTracesFilter[] = changed.map((x) => {\n      if (x.property !== '' && x.filters && x.filters.length > 0 && x.operation !== '') {\n        updateQuery = true;\n      } else {\n        updateQuery = false;\n      }\n      return {\n        property: x.property ?? '',\n        filters: x.filters ?? [],\n        operation: x.operation ?? 'eq',\n      };\n    });\n    updateFilters(properData);\n    if (updateQuery || (queryFilters.length > 0 && properData.length === 0)) {\n      onQueryChange(setFilters(query, properData));\n    }\n  };\n\n  return (\n    <Field label=\"Filters\">\n      <EditorList\n        items={filters}\n        onChange={changedFunc}\n        renderItem={makeRenderItem({\n          query,\n          datasource,\n          propertyMap,\n          setPropertyMap,\n          queryTraceTypes,\n          properties,\n          variableOptionGroup,\n          range,\n        })}\n      />\n    </Field>\n  );\n};\n\nexport default Filters;\n","import { useCallback, useMemo } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { MultiSelect } from '@grafana/ui';\n\nimport { selectors } from '../../e2e/selectors';\nimport { AzureQueryEditorFieldProps, AzureMonitorOption } from '../../types';\nimport { findOptions } from '../../utils/common';\nimport { Field } from '../shared/Field';\n\nimport { Tables } from './consts';\nimport { setTraceTypes } from './setQueryValue';\n\nconst TraceTypeField = ({ query, variableOptionGroup, onQueryChange }: AzureQueryEditorFieldProps) => {\n  const tables: AzureMonitorOption[] = Object.entries(Tables).map(([key, value]) => ({\n    label: value.label,\n    description: value.description,\n    value: key,\n  }));\n  const handleChange = useCallback(\n    (change: Array<SelectableValue<string>>) => {\n      const newQuery = setTraceTypes(\n        query,\n        change.map((type) => type.value ?? '')\n      );\n      onQueryChange(newQuery);\n    },\n    [onQueryChange, query]\n  );\n\n  const options = useMemo(() => [...tables, variableOptionGroup], [tables, variableOptionGroup]);\n\n  // Select all trace event ypes by default\n  const getDefaultOptions = () => {\n    const allEventTypes = tables.map((t) => t.value);\n    const defaultQuery = setTraceTypes(query, allEventTypes);\n    onQueryChange(defaultQuery);\n    return allEventTypes;\n  };\n\n  return (\n    <Field label=\"Event Type\">\n      <MultiSelect\n        placeholder=\"Choose event types\"\n        inputId=\"azure-monitor-traces-type-field\"\n        value={findOptions(\n          [...tables, ...variableOptionGroup.options],\n          query.azureTraces?.traceTypes ?? getDefaultOptions()\n        )}\n        onChange={handleChange}\n        options={options}\n        allowCustomValue\n        isClearable\n        aria-label={selectors.components.queryEditor.tracesQueryEditor.traceTypes.select}\n      />\n    </Field>\n  );\n};\n\nexport default TraceTypeField;\n","import { useCallback, useEffect, useState } from 'react';\nimport * as React from 'react';\nimport { usePrevious } from 'react-use';\n\nimport { TimeRange } from '@grafana/data';\nimport { EditorFieldGroup, EditorRow, EditorRows } from '@grafana/experimental';\nimport { Input } from '@grafana/ui';\n\nimport Datasource from '../../datasource';\nimport { selectors } from '../../e2e/selectors';\nimport { AzureMonitorErrorish, AzureMonitorOption, AzureMonitorQuery, AzureQueryType, ResultFormat } from '../../types';\nimport AdvancedResourcePicker from '../LogsQueryEditor/AdvancedResourcePicker';\nimport ResourceField from '../ResourceField';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from '../ResourcePicker/types';\nimport { parseResourceDetails } from '../ResourcePicker/utils';\nimport { Field } from '../shared/Field';\nimport FormatAsField from '../shared/FormatAsField';\n\nimport Filters from './Filters';\nimport TraceTypeField from './TraceTypeField';\nimport { onLoad, setDefaultTracesQuery, setFormatAs, setQueryOperationId } from './setQueryValue';\n\ninterface TracesQueryEditorProps {\n  query: AzureMonitorQuery;\n  datasource: Datasource;\n  subscriptionId?: string;\n  onChange: (newQuery: AzureMonitorQuery) => void;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n  range?: TimeRange;\n}\n\nconst TracesQueryEditor = ({\n  query,\n  datasource,\n  subscriptionId,\n  variableOptionGroup,\n  onChange,\n  setError,\n  range,\n}: TracesQueryEditorProps) => {\n  const disableRow = (row: ResourceRow, selectedRows: ResourceRowGroup) => {\n    if (selectedRows.length === 0) {\n      // Only if there is some resource(s) selected we should disable rows\n      return false;\n    }\n    const rowResourceNS = parseResourceDetails(row.uri, row.location).metricNamespace?.toLowerCase();\n    const selectedRowSampleNs = parseResourceDetails(\n      selectedRows[0].uri,\n      selectedRows[0].location\n    ).metricNamespace?.toLowerCase();\n    // Only resources with the same metricNamespace can be selected\n    return rowResourceNS !== selectedRowSampleNs;\n  };\n\n  const [operationId, setOperationId] = useState<string>(query.azureTraces?.operationId ?? '');\n  const previousOperationId = usePrevious(query.azureTraces?.operationId);\n\n  useEffect(() => {\n    if (query.azureTraces?.operationId) {\n      if (previousOperationId !== query.azureTraces.operationId) {\n        setOperationId(query.azureTraces.operationId);\n      }\n    }\n  }, [setOperationId, previousOperationId, query, operationId]);\n\n  const handleChange = useCallback(\n    (ev: React.FormEvent) => {\n      if (ev.target instanceof HTMLInputElement) {\n        setOperationId(ev.target.value);\n        if (query.queryType === AzureQueryType.TraceExemplar && ev.target.value === '') {\n          // If this is an exemplars query and the operation ID is cleared we reset this to a default traces query\n          onChange(setDefaultTracesQuery(query));\n        }\n      }\n    },\n    [onChange, query]\n  );\n\n  const handleBlur = useCallback(\n    (ev: React.FormEvent) => {\n      const newQuery = setQueryOperationId(query, operationId);\n      onChange(newQuery);\n    },\n    [onChange, operationId, query]\n  );\n\n  return (\n    <span data-testid={selectors.components.queryEditor.tracesQueryEditor.container.input}>\n      <EditorRows>\n        {query.queryType !== AzureQueryType.TraceExemplar && (\n          <EditorRow>\n            <EditorFieldGroup>\n              <ResourceField\n                query={query}\n                datasource={datasource}\n                subscriptionId={subscriptionId}\n                variableOptionGroup={variableOptionGroup}\n                onQueryChange={onChange}\n                setError={setError}\n                selectableEntryTypes={[\n                  ResourceRowType.Subscription,\n                  ResourceRowType.ResourceGroup,\n                  ResourceRowType.Resource,\n                  ResourceRowType.Variable,\n                ]}\n                resources={query.azureTraces?.resources ?? []}\n                queryType=\"traces\"\n                disableRow={disableRow}\n                renderAdvanced={(resources, onChange) => (\n                  // It's required to cast resources because the resource picker\n                  // specifies the type to string | AzureMonitorResource.\n                  // eslint-disable-next-line\n                  <AdvancedResourcePicker resources={resources as string[]} onChange={onChange} />\n                )}\n                selectionNotice={() => 'You may only choose items of the same resource type.'}\n                range={range}\n              />\n            </EditorFieldGroup>\n          </EditorRow>\n        )}\n        <EditorRow>\n          <EditorFieldGroup>\n            <TraceTypeField\n              datasource={datasource}\n              onQueryChange={onChange}\n              query={query}\n              setError={setError}\n              variableOptionGroup={variableOptionGroup}\n              range={range}\n            />\n            <Field label=\"Operation ID\">\n              <Input\n                id=\"azure-monitor-traces-operation-id-field\"\n                value={operationId}\n                onChange={handleChange}\n                onBlur={handleBlur}\n                width={40}\n              />\n            </Field>\n          </EditorFieldGroup>\n        </EditorRow>\n        <EditorRow>\n          <EditorFieldGroup>\n            <Filters\n              datasource={datasource}\n              onQueryChange={onChange}\n              query={query}\n              setError={setError}\n              variableOptionGroup={variableOptionGroup}\n              range={range}\n            />\n          </EditorFieldGroup>\n        </EditorRow>\n        <EditorRow>\n          <EditorFieldGroup>\n            <FormatAsField\n              datasource={datasource}\n              setError={setError}\n              query={query}\n              variableOptionGroup={variableOptionGroup}\n              onQueryChange={onChange}\n              inputId=\"azure-monitor-traces\"\n              options={[\n                { label: 'Table', value: ResultFormat.Table },\n                { label: 'Trace', value: ResultFormat.Trace },\n              ]}\n              defaultValue={ResultFormat.Table}\n              setFormatAs={setFormatAs}\n              resultFormat={query.azureTraces?.resultFormat}\n              range={range}\n              onLoad={onLoad}\n            />\n          </EditorFieldGroup>\n        </EditorRow>\n      </EditorRows>\n    </span>\n  );\n};\n\nexport default TracesQueryEditor;\n","import { useEffect, useRef } from 'react';\nexport default function usePrevious(state) {\n    var ref = useRef();\n    useEffect(function () {\n        ref.current = state;\n    });\n    return ref.current;\n}\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport { useStyles2 } from '@grafana/ui';\n\nconst EditorHeader = ({ children }) => {\n  const styles = useStyles2(getStyles);\n  return /* @__PURE__ */ React.createElement(\"div\", { className: styles.root }, children);\n};\nconst getStyles = (theme) => ({\n  root: css({\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    alignItems: \"center\",\n    gap: theme.spacing(3),\n    minHeight: theme.spacing(4)\n  })\n});\n\nexport { EditorHeader };\n//# sourceMappingURL=EditorHeader.js.map\n","import { css, cx } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { useStyles2, Select, SelectContainer as SelectContainer$1 } from '@grafana/ui';\n\nvar __defProp = Object.defineProperty;\nvar __defProps = Object.defineProperties;\nvar __getOwnPropDescs = Object.getOwnPropertyDescriptors;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {}))\n    if (__hasOwnProp.call(b, prop))\n      __defNormalProp(a, prop, b[prop]);\n  if (__getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(b)) {\n      if (__propIsEnum.call(b, prop))\n        __defNormalProp(a, prop, b[prop]);\n    }\n  return a;\n};\nvar __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));\nvar __objRest = (source, exclude) => {\n  var target = {};\n  for (var prop in source)\n    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)\n      target[prop] = source[prop];\n  if (source != null && __getOwnPropSymbols)\n    for (var prop of __getOwnPropSymbols(source)) {\n      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))\n        target[prop] = source[prop];\n    }\n  return target;\n};\nfunction InlineSelect(_a) {\n  var _b = _a, { label: labelProp } = _b, props = __objRest(_b, [\"label\"]);\n  const styles = useStyles2(getSelectStyles);\n  const [id] = useState(() => Math.random().toString(16).slice(2));\n  const components = {\n    SelectContainer,\n    ValueContainer,\n    SingleValue: ValueContainer\n  };\n  return /* @__PURE__ */ React.createElement(\"div\", { className: styles.root }, labelProp && /* @__PURE__ */ React.createElement(\"label\", { className: styles.label, htmlFor: id }, labelProp, \":\", \"\\xA0\"), /* @__PURE__ */ React.createElement(Select, __spreadProps(__spreadValues({ openMenuOnFocus: true, inputId: id }, props), { components })));\n}\nconst SelectContainer = (props) => {\n  const { children } = props;\n  const styles = useStyles2(getSelectStyles);\n  return /* @__PURE__ */ React.createElement(SelectContainer$1, __spreadProps(__spreadValues({}, props), { className: cx(props.className, styles.container) }), children);\n};\nconst ValueContainer = (props) => {\n  const { className, children } = props;\n  const styles = useStyles2(getSelectStyles);\n  return /* @__PURE__ */ React.createElement(\"div\", { className: cx(className, styles.valueContainer) }, children);\n};\nconst getSelectStyles = (theme) => ({\n  root: css({\n    display: \"flex\",\n    fontSize: 12,\n    alignItems: \"center\"\n  }),\n  label: css({\n    color: theme.colors.text.secondary,\n    whiteSpace: \"nowrap\"\n  }),\n  container: css({\n    background: \"none\",\n    borderColor: \"transparent\"\n  }),\n  valueContainer: css({\n    display: \"flex\",\n    alignItems: \"center\",\n    flex: \"initial\",\n    color: theme.colors.text.secondary,\n    fontSize: 12\n  })\n});\n\nexport { InlineSelect };\n//# sourceMappingURL=InlineSelect.js.map\n","import { useCallback } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { EditorHeader, InlineSelect } from '@grafana/experimental';\n\nimport { selectors } from '../../e2e/selectors';\nimport { AzureMonitorQuery, AzureQueryType } from '../../types';\n\ninterface QueryTypeFieldProps {\n  query: AzureMonitorQuery;\n  onQueryChange: (newQuery: AzureMonitorQuery) => void;\n}\n\nexport const QueryHeader = ({ query, onQueryChange }: QueryTypeFieldProps) => {\n  const queryTypes: Array<{ value: AzureQueryType; label: string }> = [\n    { value: AzureQueryType.AzureMonitor, label: 'Metrics' },\n    { value: AzureQueryType.LogAnalytics, label: 'Logs' },\n    { value: AzureQueryType.AzureTraces, label: 'Traces' },\n    { value: AzureQueryType.AzureResourceGraph, label: 'Azure Resource Graph' },\n  ];\n\n  const handleChange = useCallback(\n    (change: SelectableValue<AzureQueryType>) => {\n      if (change.value && change.value !== query.queryType) {\n        onQueryChange({\n          refId: query.refId,\n          datasource: query.datasource,\n          queryType: change.value,\n        });\n      }\n    },\n    [onQueryChange, query]\n  );\n\n  return (\n    <span data-testid={selectors.components.queryEditor.header.select}>\n      <EditorHeader>\n        <InlineSelect\n          label=\"Service\"\n          value={query.queryType === AzureQueryType.TraceExemplar ? AzureQueryType.AzureTraces : query.queryType}\n          placeholder=\"Service...\"\n          allowCustomValue\n          options={queryTypes}\n          onChange={handleChange}\n        />\n      </EditorHeader>\n    </span>\n  );\n};\n","import { setKustoQuery } from '../components/LogsQueryEditor/setQueryValue';\nimport {\n  appendDimensionFilter,\n  setTimeGrain as setMetricsTimeGrain,\n} from '../components/MetricsQueryEditor/setQueryValue';\nimport { parseResourceDetails } from '../components/ResourcePicker/utils';\nimport TimegrainConverter from '../time_grain_converter';\nimport { AzureMetricDimension, AzureMonitorQuery, AzureQueryType } from '../types';\n\nconst OLD_DEFAULT_DROPDOWN_VALUE = 'select';\n\nexport default function migrateQuery(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  if (!workingQuery.queryType) {\n    workingQuery = {\n      ...workingQuery,\n      queryType: AzureQueryType.AzureMonitor,\n    };\n  }\n\n  workingQuery = migrateLogAnalyticsToFromTimes(workingQuery);\n  if (workingQuery.queryType === AzureQueryType.AzureMonitor && workingQuery.azureMonitor) {\n    workingQuery = migrateTimeGrains(workingQuery);\n    workingQuery = migrateToDefaultNamespace(workingQuery);\n    workingQuery = migrateDimensionToDimensionFilter(workingQuery);\n    workingQuery = migrateDimensionFilterToArray(workingQuery);\n    workingQuery = migrateResourceUriToResourceObj(workingQuery);\n  }\n\n  if (workingQuery.azureMonitor?.resourceGroup || workingQuery.azureMonitor?.resourceName) {\n    workingQuery = migrateResourceGroupAndName(workingQuery);\n  }\n\n  if (workingQuery.azureLogAnalytics?.resource) {\n    workingQuery = {\n      ...workingQuery,\n      azureLogAnalytics: {\n        ...workingQuery.azureLogAnalytics,\n        resources: [workingQuery.azureLogAnalytics.resource],\n      },\n    };\n\n    delete workingQuery.azureLogAnalytics?.resource;\n  }\n\n  if (workingQuery.azureLogAnalytics && workingQuery.azureLogAnalytics.dashboardTime === undefined) {\n    if (workingQuery.azureLogAnalytics.intersectTime) {\n      workingQuery = {\n        ...workingQuery,\n        azureLogAnalytics: {\n          ...workingQuery.azureLogAnalytics,\n          dashboardTime: true,\n        },\n      };\n    } else {\n      workingQuery = {\n        ...workingQuery,\n        azureLogAnalytics: {\n          ...workingQuery.azureLogAnalytics,\n          dashboardTime: false,\n        },\n      };\n    }\n  }\n\n  return workingQuery;\n}\n\nfunction migrateTimeGrains(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  if (workingQuery.azureMonitor?.timeGrainUnit && workingQuery.azureMonitor.timeGrain !== 'auto') {\n    const newTimeGrain = TimegrainConverter.createISO8601Duration(\n      workingQuery.azureMonitor.timeGrain ?? 'auto',\n      workingQuery.azureMonitor.timeGrainUnit\n    );\n    workingQuery = setMetricsTimeGrain(workingQuery, newTimeGrain);\n\n    delete workingQuery.azureMonitor?.timeGrainUnit;\n  }\n\n  return workingQuery;\n}\n\nfunction migrateLogAnalyticsToFromTimes(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  if (workingQuery.azureLogAnalytics?.query?.match(/\\$__from\\s/gi)) {\n    workingQuery = setKustoQuery(\n      workingQuery,\n      workingQuery.azureLogAnalytics.query.replace(/\\$__from\\s/gi, '$__timeFrom() ')\n    );\n  }\n\n  if (workingQuery.azureLogAnalytics?.query?.match(/\\$__to\\s/gi)) {\n    workingQuery = setKustoQuery(\n      workingQuery,\n      workingQuery.azureLogAnalytics.query.replace(/\\$__to\\s/gi, '$__timeTo() ')\n    );\n  }\n\n  return workingQuery;\n}\n\nfunction migrateToDefaultNamespace(query: AzureMonitorQuery): AzureMonitorQuery {\n  const haveMetricNamespace =\n    query.azureMonitor?.metricNamespace && query.azureMonitor.metricNamespace !== OLD_DEFAULT_DROPDOWN_VALUE;\n\n  if (!haveMetricNamespace && query.azureMonitor?.metricDefinition) {\n    return {\n      ...query,\n      azureMonitor: {\n        ...query.azureMonitor,\n        metricNamespace: query.azureMonitor.metricDefinition,\n        metricDefinition: undefined,\n      },\n    };\n  }\n\n  return query;\n}\n\nfunction migrateDimensionToDimensionFilter(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  const oldDimension = workingQuery.azureMonitor?.dimension;\n  if (oldDimension && oldDimension !== 'None') {\n    workingQuery = appendDimensionFilter(workingQuery, oldDimension, 'eq', [\n      workingQuery.azureMonitor?.dimensionFilter || '',\n    ]);\n  }\n\n  delete workingQuery.azureMonitor?.dimension;\n  delete workingQuery.azureMonitor?.dimensionFilter;\n\n  return workingQuery;\n}\n\nfunction migrateDimensionFilterToArray(query: AzureMonitorQuery): AzureMonitorQuery {\n  const azureMonitorQuery = query.azureMonitor;\n\n  if (!azureMonitorQuery) {\n    return query;\n  }\n\n  const newFilters: AzureMetricDimension[] = [];\n  const dimensionFilters = azureMonitorQuery.dimensionFilters;\n  if (dimensionFilters && dimensionFilters.length > 0) {\n    dimensionFilters.forEach((filter) => {\n      const staticProps = { dimension: filter.dimension, operator: filter.operator };\n      if (!filter.filters && filter.filter) {\n        newFilters.push({ ...staticProps, filters: [filter.filter] });\n      } else {\n        let hasFilter = false;\n        if (filter.filters && filter.filter) {\n          for (const oldFilter of filter.filters) {\n            if (filter.filter === oldFilter) {\n              hasFilter = true;\n              break;\n            }\n          }\n          if (!hasFilter && filter.filter !== '*') {\n            filter.filters.push(filter.filter);\n          }\n          newFilters.push({ ...staticProps, filters: filter.filters });\n        }\n      }\n    });\n    if (newFilters.length > 0) {\n      return { ...query, azureMonitor: { ...azureMonitorQuery, dimensionFilters: newFilters } };\n    }\n  }\n  return query;\n}\n\nfunction migrateResourceUriToResourceObj(query: AzureMonitorQuery): AzureMonitorQuery {\n  if (query.azureMonitor?.resourceUri && !query.azureMonitor.resourceUri.startsWith('$')) {\n    const details = parseResourceDetails(query.azureMonitor.resourceUri);\n    const isWellFormedUri = details?.subscription && details?.resourceGroup && details?.resourceName;\n    return {\n      ...query,\n      subscription: details?.subscription,\n      azureMonitor: {\n        ...query.azureMonitor,\n        resources: [{ resourceGroup: details?.resourceGroup, resourceName: details?.resourceName }],\n        metricNamespace: details?.metricNamespace,\n        resourceUri: isWellFormedUri ? undefined : query.azureMonitor.resourceUri,\n      },\n    };\n  }\n\n  return query;\n}\n\nfunction migrateResourceGroupAndName(query: AzureMonitorQuery): AzureMonitorQuery {\n  let workingQuery = query;\n\n  if (workingQuery.azureMonitor?.resourceGroup && workingQuery.azureMonitor?.resourceName) {\n    workingQuery = {\n      ...workingQuery,\n      azureMonitor: {\n        ...workingQuery.azureMonitor,\n        resources: [\n          {\n            resourceGroup: workingQuery.azureMonitor.resourceGroup,\n            resourceName: workingQuery.azureMonitor.resourceName,\n          },\n        ],\n      },\n    };\n\n    delete workingQuery.azureMonitor?.resourceGroup;\n    delete workingQuery.azureMonitor?.resourceName;\n  }\n\n  return workingQuery;\n}\n","import deepEqual from 'fast-deep-equal';\nimport { defaults } from 'lodash';\nimport { useEffect, useMemo } from 'react';\n\nimport { AzureMonitorQuery, AzureQueryType, ResultFormat } from '../../types';\nimport migrateQuery from '../../utils/migrateQuery';\n\nconst DEFAULT_QUERY = {\n  queryType: AzureQueryType.AzureMonitor,\n};\n\nconst transformExemplarQuery = (query: AzureMonitorQuery) => {\n  if (query.queryType === AzureQueryType.TraceExemplar && query.query !== '' && !query.azureTraces) {\n    query.azureTraces = {\n      operationId: query.query,\n      resultFormat: ResultFormat.Trace,\n    };\n  }\n\n  return query;\n};\n\nconst prepareQuery = (query: AzureMonitorQuery) => {\n  // Note: _.defaults does not apply default values deeply.\n  const withDefaults = defaults({}, query, DEFAULT_QUERY);\n  const transformedQuery = transformExemplarQuery(withDefaults);\n  const migratedQuery = migrateQuery(transformedQuery);\n\n  // If we didn't make any changes to the object, then return the original object to keep the\n  // identity the same, and not trigger any other useEffects or anything.\n  return deepEqual(migratedQuery, query) ? query : migratedQuery;\n};\n\n/**\n * Returns queries with some defaults + migrations, and calls onChange function to notify if it changes\n */\nconst usePreparedQuery = (query: AzureMonitorQuery, onChangeQuery: (newQuery: AzureMonitorQuery) => void) => {\n  const preparedQuery = useMemo(() => prepareQuery(query), [query]);\n\n  useEffect(() => {\n    if (preparedQuery !== query) {\n      onChangeQuery(preparedQuery);\n    }\n  }, [preparedQuery, query, onChangeQuery]);\n\n  return preparedQuery;\n};\n\nexport default usePreparedQuery;\n","import { css } from '@emotion/css';\nimport { debounce } from 'lodash';\nimport { useCallback, useMemo, useState } from 'react';\n\nimport { CoreApp, QueryEditorProps } from '@grafana/data';\nimport { config, reportInteraction } from '@grafana/runtime';\nimport { Alert, Button, CodeEditor, Space } from '@grafana/ui';\n\nimport AzureMonitorDatasource from '../../datasource';\nimport { selectors } from '../../e2e/selectors';\nimport {\n  AzureDataSourceJsonData,\n  AzureMonitorErrorish,\n  AzureMonitorOption,\n  AzureMonitorQuery,\n  AzureQueryType,\n} from '../../types';\nimport useLastError from '../../utils/useLastError';\nimport ArgQueryEditor from '../ArgQueryEditor';\nimport LogsQueryEditor from '../LogsQueryEditor';\nimport { AzureCheatSheetModal } from '../LogsQueryEditor/AzureCheatSheetModal';\nimport NewMetricsQueryEditor from '../MetricsQueryEditor/MetricsQueryEditor';\nimport TracesQueryEditor from '../TracesQueryEditor';\n\nimport { QueryHeader } from './QueryHeader';\nimport usePreparedQuery from './usePreparedQuery';\n\nexport type AzureMonitorQueryEditorProps = QueryEditorProps<\n  AzureMonitorDatasource,\n  AzureMonitorQuery,\n  AzureDataSourceJsonData\n>;\n\nconst QueryEditor = ({\n  app,\n  query: baseQuery,\n  datasource,\n  onChange,\n  onRunQuery: baseOnRunQuery,\n  data,\n  range,\n}: AzureMonitorQueryEditorProps) => {\n  const [errorMessage, setError] = useLastError();\n  const onRunQuery = useMemo(() => debounce(baseOnRunQuery, 500), [baseOnRunQuery]);\n  const [azureLogsCheatSheetModalOpen, setAzureLogsCheatSheetModalOpen] = useState(false);\n\n  const onQueryChange = useCallback(\n    (newQuery: AzureMonitorQuery) => {\n      onChange(newQuery);\n      onRunQuery();\n    },\n    [onChange, onRunQuery]\n  );\n\n  const query = usePreparedQuery(baseQuery, onQueryChange);\n\n  const subscriptionId = query.subscription || datasource.azureMonitorDatasource.defaultSubscriptionId;\n  const basicLogsEnabled =\n    datasource.azureMonitorDatasource.basicLogsEnabled &&\n    app !== CoreApp.UnifiedAlerting &&\n    app !== CoreApp.CloudAlerting;\n  const variableOptionGroup = {\n    label: 'Template Variables',\n    options: datasource.getVariables().map((v) => ({ label: v, value: v })),\n  };\n\n  // Allow authproxy as it may not be clear if an authproxy user is authenticated by Azure\n  const isAzureAuthenticated =\n    config.bootData.user.authenticatedBy === 'oauth_azuread' || config.bootData.user.authenticatedBy === 'authproxy';\n  if (datasource.currentUserAuth) {\n    if (\n      app === CoreApp.UnifiedAlerting &&\n      (!config.azure.userIdentityFallbackCredentialsEnabled || !datasource.currentUserAuthFallbackAvailable)\n    ) {\n      return <UserAuthFallbackAlert />;\n    }\n    if (!isAzureAuthenticated) {\n      return <UserAuthAlert />;\n    }\n  }\n\n  return (\n    <div data-testid=\"azure-monitor-query-editor\">\n      <AzureCheatSheetModal\n        datasource={datasource.azureLogAnalyticsDatasource}\n        isOpen={azureLogsCheatSheetModalOpen}\n        onClose={() => setAzureLogsCheatSheetModalOpen(false)}\n        onChange={(a) => onChange({ ...a, queryType: AzureQueryType.LogAnalytics })}\n      />\n      <div className={css({ display: 'flex', alignItems: 'center' })}>\n        <QueryHeader query={query} onQueryChange={onQueryChange} />\n        {query.queryType === AzureQueryType.LogAnalytics && (\n          <Button\n            aria-label=\"Azure logs kick start your query button\"\n            variant=\"secondary\"\n            size=\"sm\"\n            onClick={() => {\n              setAzureLogsCheatSheetModalOpen((prevValue) => !prevValue);\n\n              reportInteraction('grafana_azure_logs_query_patterns_opened', {\n                version: 'v2',\n                editorMode: query.azureLogAnalytics,\n              });\n            }}\n          >\n            Kick start your query\n          </Button>\n        )}\n      </div>\n      <EditorForQueryType\n        data={data}\n        subscriptionId={subscriptionId}\n        basicLogsEnabled={basicLogsEnabled ?? false}\n        query={query}\n        datasource={datasource}\n        onChange={onQueryChange}\n        variableOptionGroup={variableOptionGroup}\n        setError={setError}\n        range={range}\n      />\n\n      {errorMessage && (\n        <>\n          <Space v={2} />\n          <Alert severity=\"error\" title=\"An error occurred while requesting metadata from Azure Monitor\">\n            {errorMessage instanceof Error ? errorMessage.message : errorMessage}\n          </Alert>\n        </>\n      )}\n    </div>\n  );\n};\n\ninterface EditorForQueryTypeProps extends Omit<AzureMonitorQueryEditorProps, 'onRunQuery'> {\n  subscriptionId?: string;\n  basicLogsEnabled: boolean;\n  variableOptionGroup: { label: string; options: AzureMonitorOption[] };\n  setError: (source: string, error: AzureMonitorErrorish | undefined) => void;\n}\n\nconst EditorForQueryType = ({\n  data,\n  subscriptionId,\n  basicLogsEnabled,\n  query,\n  datasource,\n  variableOptionGroup,\n  onChange,\n  setError,\n  range,\n}: EditorForQueryTypeProps) => {\n  switch (query.queryType) {\n    case AzureQueryType.AzureMonitor:\n      return (\n        <NewMetricsQueryEditor\n          data={data}\n          query={query}\n          datasource={datasource}\n          onChange={onChange}\n          variableOptionGroup={variableOptionGroup}\n          setError={setError}\n        />\n      );\n\n    case AzureQueryType.LogAnalytics:\n      return (\n        <LogsQueryEditor\n          data={data}\n          subscriptionId={subscriptionId}\n          basicLogsEnabled={basicLogsEnabled}\n          query={query}\n          datasource={datasource}\n          onChange={onChange}\n          variableOptionGroup={variableOptionGroup}\n          setError={setError}\n          timeRange={range}\n        />\n      );\n\n    case AzureQueryType.AzureResourceGraph:\n      return (\n        <ArgQueryEditor\n          subscriptionId={subscriptionId}\n          query={query}\n          datasource={datasource}\n          onChange={onChange}\n          variableOptionGroup={variableOptionGroup}\n          setError={setError}\n        />\n      );\n\n    case AzureQueryType.AzureTraces:\n    case AzureQueryType.TraceExemplar:\n      return (\n        <TracesQueryEditor\n          subscriptionId={subscriptionId}\n          query={query}\n          datasource={datasource}\n          onChange={onChange}\n          variableOptionGroup={variableOptionGroup}\n          setError={setError}\n          range={range}\n        />\n      );\n\n    default:\n      const type = query.queryType as unknown;\n      return (\n        <Alert title=\"Unknown query type\">\n          {(type === 'Application Insights' || type === 'Insights Analytics') && (\n            <>\n              {type} was deprecated in Grafana 9. See the{' '}\n              <a\n                href=\"https://grafana.com/docs/grafana/latest/datasources/azure-monitor/#application-insights-and-insights-analytics-removed\"\n                target=\"_blank\"\n                rel=\"noreferrer\"\n              >\n                deprecation notice\n              </a>{' '}\n              to get more information about how to migrate your queries. This is the current query definition:\n              <CodeEditor height=\"200px\" readOnly language=\"json\" value={JSON.stringify(query, null, 4)} />\n            </>\n          )}\n        </Alert>\n      );\n  }\n};\n\nconst UserAuthAlert = () => {\n  return (\n    <Alert title=\"Unsupported authentication provider\" data-testid={selectors.components.queryEditor.userAuthAlert}>\n      <>\n        Usage of this data source requires you to be authenticated via Azure Entra (formerly Azure Active Directory).\n        Please review the{' '}\n        <a\n          href=\"https://grafana.com/docs/grafana/latest/datasources/azure-monitor/#configure-current-user-authentication\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          documentation\n        </a>{' '}\n        for more information.\n      </>\n    </Alert>\n  );\n};\n\nconst UserAuthFallbackAlert = () => {\n  return (\n    <Alert\n      title=\"No fallback credentials available\"\n      data-testid={selectors.components.queryEditor.userAuthFallbackAlert}\n    >\n      <>\n        Data source backend features (such as alerting) require service credentials to function. This data source is\n        configured without service credential fallback, or the fallback functionality is disabled. Please review the{' '}\n        <a\n          href=\"https://grafana.com/docs/grafana/latest/datasources/azure-monitor/#configure-current-user-authentication\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          documentation\n        </a>{' '}\n        for more information.\n      </>\n    </Alert>\n  );\n};\n\nexport default QueryEditor;\n","export function isFunction(value) {\n    return typeof value === 'function';\n}\n//# sourceMappingURL=isFunction.js.map","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n};\n","import { createErrorClass } from './createErrorClass';\nexport var UnsubscriptionError = createErrorClass(function (_super) {\n    return function UnsubscriptionErrorImpl(errors) {\n        _super(this);\n        this.message = errors\n            ? errors.length + \" errors occurred during unsubscription:\\n\" + errors.map(function (err, i) { return i + 1 + \") \" + err.toString(); }).join('\\n  ')\n            : '';\n        this.name = 'UnsubscriptionError';\n        this.errors = errors;\n    };\n});\n//# sourceMappingURL=UnsubscriptionError.js.map","export function createErrorClass(createImpl) {\n    var _super = function (instance) {\n        Error.call(instance);\n        instance.stack = new Error().stack;\n    };\n    var ctorFunc = createImpl(_super);\n    ctorFunc.prototype = Object.create(Error.prototype);\n    ctorFunc.prototype.constructor = ctorFunc;\n    return ctorFunc;\n}\n//# sourceMappingURL=createErrorClass.js.map","export function arrRemove(arr, item) {\n    if (arr) {\n        var index = arr.indexOf(item);\n        0 <= index && arr.splice(index, 1);\n    }\n}\n//# sourceMappingURL=arrRemove.js.map","import { __read, __spreadArray, __values } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { UnsubscriptionError } from './util/UnsubscriptionError';\nimport { arrRemove } from './util/arrRemove';\nvar Subscription = (function () {\n    function Subscription(initialTeardown) {\n        this.initialTeardown = initialTeardown;\n        this.closed = false;\n        this._parentage = null;\n        this._finalizers = null;\n    }\n    Subscription.prototype.unsubscribe = function () {\n        var e_1, _a, e_2, _b;\n        var errors;\n        if (!this.closed) {\n            this.closed = true;\n            var _parentage = this._parentage;\n            if (_parentage) {\n                this._parentage = null;\n                if (Array.isArray(_parentage)) {\n                    try {\n                        for (var _parentage_1 = __values(_parentage), _parentage_1_1 = _parentage_1.next(); !_parentage_1_1.done; _parentage_1_1 = _parentage_1.next()) {\n                            var parent_1 = _parentage_1_1.value;\n                            parent_1.remove(this);\n                        }\n                    }\n                    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n                    finally {\n                        try {\n                            if (_parentage_1_1 && !_parentage_1_1.done && (_a = _parentage_1.return)) _a.call(_parentage_1);\n                        }\n                        finally { if (e_1) throw e_1.error; }\n                    }\n                }\n                else {\n                    _parentage.remove(this);\n                }\n            }\n            var initialFinalizer = this.initialTeardown;\n            if (isFunction(initialFinalizer)) {\n                try {\n                    initialFinalizer();\n                }\n                catch (e) {\n                    errors = e instanceof UnsubscriptionError ? e.errors : [e];\n                }\n            }\n            var _finalizers = this._finalizers;\n            if (_finalizers) {\n                this._finalizers = null;\n                try {\n                    for (var _finalizers_1 = __values(_finalizers), _finalizers_1_1 = _finalizers_1.next(); !_finalizers_1_1.done; _finalizers_1_1 = _finalizers_1.next()) {\n                        var finalizer = _finalizers_1_1.value;\n                        try {\n                            execFinalizer(finalizer);\n                        }\n                        catch (err) {\n                            errors = errors !== null && errors !== void 0 ? errors : [];\n                            if (err instanceof UnsubscriptionError) {\n                                errors = __spreadArray(__spreadArray([], __read(errors)), __read(err.errors));\n                            }\n                            else {\n                                errors.push(err);\n                            }\n                        }\n                    }\n                }\n                catch (e_2_1) { e_2 = { error: e_2_1 }; }\n                finally {\n                    try {\n                        if (_finalizers_1_1 && !_finalizers_1_1.done && (_b = _finalizers_1.return)) _b.call(_finalizers_1);\n                    }\n                    finally { if (e_2) throw e_2.error; }\n                }\n            }\n            if (errors) {\n                throw new UnsubscriptionError(errors);\n            }\n        }\n    };\n    Subscription.prototype.add = function (teardown) {\n        var _a;\n        if (teardown && teardown !== this) {\n            if (this.closed) {\n                execFinalizer(teardown);\n            }\n            else {\n                if (teardown instanceof Subscription) {\n                    if (teardown.closed || teardown._hasParent(this)) {\n                        return;\n                    }\n                    teardown._addParent(this);\n                }\n                (this._finalizers = (_a = this._finalizers) !== null && _a !== void 0 ? _a : []).push(teardown);\n            }\n        }\n    };\n    Subscription.prototype._hasParent = function (parent) {\n        var _parentage = this._parentage;\n        return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));\n    };\n    Subscription.prototype._addParent = function (parent) {\n        var _parentage = this._parentage;\n        this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;\n    };\n    Subscription.prototype._removeParent = function (parent) {\n        var _parentage = this._parentage;\n        if (_parentage === parent) {\n            this._parentage = null;\n        }\n        else if (Array.isArray(_parentage)) {\n            arrRemove(_parentage, parent);\n        }\n    };\n    Subscription.prototype.remove = function (teardown) {\n        var _finalizers = this._finalizers;\n        _finalizers && arrRemove(_finalizers, teardown);\n        if (teardown instanceof Subscription) {\n            teardown._removeParent(this);\n        }\n    };\n    Subscription.EMPTY = (function () {\n        var empty = new Subscription();\n        empty.closed = true;\n        return empty;\n    })();\n    return Subscription;\n}());\nexport { Subscription };\nexport var EMPTY_SUBSCRIPTION = Subscription.EMPTY;\nexport function isSubscription(value) {\n    return (value instanceof Subscription ||\n        (value && 'closed' in value && isFunction(value.remove) && isFunction(value.add) && isFunction(value.unsubscribe)));\n}\nfunction execFinalizer(finalizer) {\n    if (isFunction(finalizer)) {\n        finalizer();\n    }\n    else {\n        finalizer.unsubscribe();\n    }\n}\n//# sourceMappingURL=Subscription.js.map","export var config = {\n    onUnhandledError: null,\n    onStoppedNotification: null,\n    Promise: undefined,\n    useDeprecatedSynchronousErrorHandling: false,\n    useDeprecatedNextContext: false,\n};\n//# sourceMappingURL=config.js.map","import { __read, __spreadArray } from \"tslib\";\nexport var timeoutProvider = {\n    setTimeout: function (handler, timeout) {\n        var args = [];\n        for (var _i = 2; _i < arguments.length; _i++) {\n            args[_i - 2] = arguments[_i];\n        }\n        var delegate = timeoutProvider.delegate;\n        if (delegate === null || delegate === void 0 ? void 0 : delegate.setTimeout) {\n            return delegate.setTimeout.apply(delegate, __spreadArray([handler, timeout], __read(args)));\n        }\n        return setTimeout.apply(void 0, __spreadArray([handler, timeout], __read(args)));\n    },\n    clearTimeout: function (handle) {\n        var delegate = timeoutProvider.delegate;\n        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearTimeout) || clearTimeout)(handle);\n    },\n    delegate: undefined,\n};\n//# sourceMappingURL=timeoutProvider.js.map","export function noop() { }\n//# sourceMappingURL=noop.js.map","export var COMPLETE_NOTIFICATION = (function () { return createNotification('C', undefined, undefined); })();\nexport function errorNotification(error) {\n    return createNotification('E', undefined, error);\n}\nexport function nextNotification(value) {\n    return createNotification('N', value, undefined);\n}\nexport function createNotification(kind, value, error) {\n    return {\n        kind: kind,\n        value: value,\n        error: error,\n    };\n}\n//# sourceMappingURL=NotificationFactories.js.map","import { config } from '../config';\nvar context = null;\nexport function errorContext(cb) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        var isRoot = !context;\n        if (isRoot) {\n            context = { errorThrown: false, error: null };\n        }\n        cb();\n        if (isRoot) {\n            var _a = context, errorThrown = _a.errorThrown, error = _a.error;\n            context = null;\n            if (errorThrown) {\n                throw error;\n            }\n        }\n    }\n    else {\n        cb();\n    }\n}\nexport function captureError(err) {\n    if (config.useDeprecatedSynchronousErrorHandling && context) {\n        context.errorThrown = true;\n        context.error = err;\n    }\n}\n//# sourceMappingURL=errorContext.js.map","import { __extends } from \"tslib\";\nimport { isFunction } from './util/isFunction';\nimport { isSubscription, Subscription } from './Subscription';\nimport { config } from './config';\nimport { reportUnhandledError } from './util/reportUnhandledError';\nimport { noop } from './util/noop';\nimport { nextNotification, errorNotification, COMPLETE_NOTIFICATION } from './NotificationFactories';\nimport { timeoutProvider } from './scheduler/timeoutProvider';\nimport { captureError } from './util/errorContext';\nvar Subscriber = (function (_super) {\n    __extends(Subscriber, _super);\n    function Subscriber(destination) {\n        var _this = _super.call(this) || this;\n        _this.isStopped = false;\n        if (destination) {\n            _this.destination = destination;\n            if (isSubscription(destination)) {\n                destination.add(_this);\n            }\n        }\n        else {\n            _this.destination = EMPTY_OBSERVER;\n        }\n        return _this;\n    }\n    Subscriber.create = function (next, error, complete) {\n        return new SafeSubscriber(next, error, complete);\n    };\n    Subscriber.prototype.next = function (value) {\n        if (this.isStopped) {\n            handleStoppedNotification(nextNotification(value), this);\n        }\n        else {\n            this._next(value);\n        }\n    };\n    Subscriber.prototype.error = function (err) {\n        if (this.isStopped) {\n            handleStoppedNotification(errorNotification(err), this);\n        }\n        else {\n            this.isStopped = true;\n            this._error(err);\n        }\n    };\n    Subscriber.prototype.complete = function () {\n        if (this.isStopped) {\n            handleStoppedNotification(COMPLETE_NOTIFICATION, this);\n        }\n        else {\n            this.isStopped = true;\n            this._complete();\n        }\n    };\n    Subscriber.prototype.unsubscribe = function () {\n        if (!this.closed) {\n            this.isStopped = true;\n            _super.prototype.unsubscribe.call(this);\n            this.destination = null;\n        }\n    };\n    Subscriber.prototype._next = function (value) {\n        this.destination.next(value);\n    };\n    Subscriber.prototype._error = function (err) {\n        try {\n            this.destination.error(err);\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    Subscriber.prototype._complete = function () {\n        try {\n            this.destination.complete();\n        }\n        finally {\n            this.unsubscribe();\n        }\n    };\n    return Subscriber;\n}(Subscription));\nexport { Subscriber };\nvar _bind = Function.prototype.bind;\nfunction bind(fn, thisArg) {\n    return _bind.call(fn, thisArg);\n}\nvar ConsumerObserver = (function () {\n    function ConsumerObserver(partialObserver) {\n        this.partialObserver = partialObserver;\n    }\n    ConsumerObserver.prototype.next = function (value) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.next) {\n            try {\n                partialObserver.next(value);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    ConsumerObserver.prototype.error = function (err) {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.error) {\n            try {\n                partialObserver.error(err);\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n        else {\n            handleUnhandledError(err);\n        }\n    };\n    ConsumerObserver.prototype.complete = function () {\n        var partialObserver = this.partialObserver;\n        if (partialObserver.complete) {\n            try {\n                partialObserver.complete();\n            }\n            catch (error) {\n                handleUnhandledError(error);\n            }\n        }\n    };\n    return ConsumerObserver;\n}());\nvar SafeSubscriber = (function (_super) {\n    __extends(SafeSubscriber, _super);\n    function SafeSubscriber(observerOrNext, error, complete) {\n        var _this = _super.call(this) || this;\n        var partialObserver;\n        if (isFunction(observerOrNext) || !observerOrNext) {\n            partialObserver = {\n                next: (observerOrNext !== null && observerOrNext !== void 0 ? observerOrNext : undefined),\n                error: error !== null && error !== void 0 ? error : undefined,\n                complete: complete !== null && complete !== void 0 ? complete : undefined,\n            };\n        }\n        else {\n            var context_1;\n            if (_this && config.useDeprecatedNextContext) {\n                context_1 = Object.create(observerOrNext);\n                context_1.unsubscribe = function () { return _this.unsubscribe(); };\n                partialObserver = {\n                    next: observerOrNext.next && bind(observerOrNext.next, context_1),\n                    error: observerOrNext.error && bind(observerOrNext.error, context_1),\n                    complete: observerOrNext.complete && bind(observerOrNext.complete, context_1),\n                };\n            }\n            else {\n                partialObserver = observerOrNext;\n            }\n        }\n        _this.destination = new ConsumerObserver(partialObserver);\n        return _this;\n    }\n    return SafeSubscriber;\n}(Subscriber));\nexport { SafeSubscriber };\nfunction handleUnhandledError(error) {\n    if (config.useDeprecatedSynchronousErrorHandling) {\n        captureError(error);\n    }\n    else {\n        reportUnhandledError(error);\n    }\n}\nfunction defaultErrorHandler(err) {\n    throw err;\n}\nfunction handleStoppedNotification(notification, subscriber) {\n    var onStoppedNotification = config.onStoppedNotification;\n    onStoppedNotification && timeoutProvider.setTimeout(function () { return onStoppedNotification(notification, subscriber); });\n}\nexport var EMPTY_OBSERVER = {\n    closed: true,\n    next: noop,\n    error: defaultErrorHandler,\n    complete: noop,\n};\n//# sourceMappingURL=Subscriber.js.map","import { config } from '../config';\nimport { timeoutProvider } from '../scheduler/timeoutProvider';\nexport function reportUnhandledError(err) {\n    timeoutProvider.setTimeout(function () {\n        var onUnhandledError = config.onUnhandledError;\n        if (onUnhandledError) {\n            onUnhandledError(err);\n        }\n        else {\n            throw err;\n        }\n    });\n}\n//# sourceMappingURL=reportUnhandledError.js.map","import { __extends } from \"tslib\";\nimport { Subscriber } from '../Subscriber';\nexport function createOperatorSubscriber(destination, onNext, onComplete, onError, onFinalize) {\n    return new OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize);\n}\nvar OperatorSubscriber = (function (_super) {\n    __extends(OperatorSubscriber, _super);\n    function OperatorSubscriber(destination, onNext, onComplete, onError, onFinalize, shouldUnsubscribe) {\n        var _this = _super.call(this, destination) || this;\n        _this.onFinalize = onFinalize;\n        _this.shouldUnsubscribe = shouldUnsubscribe;\n        _this._next = onNext\n            ? function (value) {\n                try {\n                    onNext(value);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n            }\n            : _super.prototype._next;\n        _this._error = onError\n            ? function (err) {\n                try {\n                    onError(err);\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._error;\n        _this._complete = onComplete\n            ? function () {\n                try {\n                    onComplete();\n                }\n                catch (err) {\n                    destination.error(err);\n                }\n                finally {\n                    this.unsubscribe();\n                }\n            }\n            : _super.prototype._complete;\n        return _this;\n    }\n    OperatorSubscriber.prototype.unsubscribe = function () {\n        var _a;\n        if (!this.shouldUnsubscribe || this.shouldUnsubscribe()) {\n            var closed_1 = this.closed;\n            _super.prototype.unsubscribe.call(this);\n            !closed_1 && ((_a = this.onFinalize) === null || _a === void 0 ? void 0 : _a.call(this));\n        }\n    };\n    return OperatorSubscriber;\n}(Subscriber));\nexport { OperatorSubscriber };\n//# sourceMappingURL=OperatorSubscriber.js.map","import { operate } from '../util/lift';\nimport { createOperatorSubscriber } from './OperatorSubscriber';\nexport function map(project, thisArg) {\n    return operate(function (source, subscriber) {\n        var index = 0;\n        source.subscribe(createOperatorSubscriber(subscriber, function (value) {\n            subscriber.next(project.call(thisArg, value, index++));\n        }));\n    });\n}\n//# sourceMappingURL=map.js.map","import { isFunction } from './isFunction';\nexport function hasLift(source) {\n    return isFunction(source === null || source === void 0 ? void 0 : source.lift);\n}\nexport function operate(init) {\n    return function (source) {\n        if (hasLift(source)) {\n            return source.lift(function (liftedSource) {\n                try {\n                    return init(liftedSource, this);\n                }\n                catch (err) {\n                    this.error(err);\n                }\n            });\n        }\n        throw new TypeError('Unable to lift unknown Observable type');\n    };\n}\n//# sourceMappingURL=lift.js.map","import { TypedVariableModel } from '@grafana/data';\n\nimport { EngineSchema } from '../types';\nimport { AzureLogAnalyticsMetadata } from '../types/logAnalyticsMetadata';\n\n// matches (name):(type) = (defaultValue)\n// e.g. fromRangeStart:datetime = datetime(null)\n//  - name: fromRangeStart\n//  - type: datetime\n//  - defaultValue: datetime(null)\nconst METADATA_FUNCTION_PARAMS = /([\\w\\W]+):([\\w]+)(?:\\s?=\\s?([\\w\\W]+))?/;\n\nfunction transformMetadataFunction(sourceSchema: AzureLogAnalyticsMetadata) {\n  if (!sourceSchema.functions) {\n    return [];\n  }\n\n  return sourceSchema.functions.map((fn) => {\n    const params =\n      fn.parameters &&\n      fn.parameters\n        .split(', ')\n        .map((arg) => {\n          const match = arg.match(METADATA_FUNCTION_PARAMS);\n          if (!match) {\n            return;\n          }\n\n          const [, name, type, defaultValue] = match;\n\n          return {\n            name,\n            type,\n            defaultValue,\n            cslDefaultValue: defaultValue,\n          };\n        })\n        .filter(<T>(v: T): v is Exclude<T, undefined> => !!v);\n\n    return {\n      name: fn.name,\n      body: fn.body,\n      inputParameters: params || [],\n    };\n  });\n}\n\nexport function transformMetadataToKustoSchema(\n  sourceSchema: AzureLogAnalyticsMetadata,\n  nameOrIdOrSomething: string,\n  templateVariables: TypedVariableModel[]\n): EngineSchema {\n  const database = {\n    name: nameOrIdOrSomething,\n    tables: sourceSchema.tables,\n    functions: transformMetadataFunction(sourceSchema),\n    majorVersion: 0,\n    minorVersion: 0,\n    entityGroups: [],\n  };\n\n  // Adding macros as known functions\n  database.functions.push(\n    {\n      name: '$__timeFilter',\n      body: '{ true }',\n      inputParameters: [\n        {\n          name: 'timeColumn',\n          type: 'System.String',\n          defaultValue: '\"\"',\n          cslDefaultValue: '\"\"',\n        },\n      ],\n    },\n    {\n      name: '$__timeFrom',\n      body: '{ datetime(2018-06-05T18:09:58.907Z) }',\n      inputParameters: [],\n    },\n    {\n      name: '$__timeTo',\n      body: '{ datetime(2018-06-05T20:09:58.907Z) }',\n      inputParameters: [],\n    },\n    {\n      name: '$__escapeMulti',\n      body: `{ @'\\\\grafana-vm\\Network(eth0)\\Total', @'\\\\hello!'}`,\n      inputParameters: [\n        {\n          name: '$myVar',\n          type: 'System.String',\n          defaultValue: '$myVar',\n          cslDefaultValue: '$myVar',\n        },\n      ],\n    },\n    {\n      name: '$__contains',\n      body: `{ colName in ('value1','value2') }`,\n      inputParameters: [\n        {\n          name: 'colName',\n          type: 'System.String',\n          defaultValue: 'colName',\n          cslDefaultValue: 'colName',\n        },\n        {\n          name: '$myVar',\n          type: 'System.String',\n          defaultValue: '$myVar',\n          cslDefaultValue: '$myVar',\n        },\n      ],\n    }\n  );\n\n  // Adding macros as global parameters\n  const globalScalarParameters = templateVariables.map((v) => {\n    return {\n      name: `$${v.name}`,\n      type: 'dynamic',\n    };\n  });\n\n  return {\n    clusterType: 'Engine',\n    cluster: {\n      connectionString: nameOrIdOrSomething,\n      databases: [database],\n    },\n    database: database,\n    globalScalarParameters,\n  };\n}\n","import { map } from 'lodash';\n\nimport { DataSourceInstanceSettings, ScopedVars } from '@grafana/data';\nimport { DataSourceWithBackend, getTemplateSrv, TemplateSrv } from '@grafana/runtime';\n\nimport ResponseParser from '../azure_monitor/response_parser';\nimport { getAuthType } from '../credentials';\nimport {\n  AzureAPIResponse,\n  AzureDataSourceJsonData,\n  AzureLogsVariable,\n  AzureMonitorQuery,\n  AzureQueryType,\n  DatasourceValidationResult,\n  Subscription,\n  Workspace,\n} from '../types';\nimport { interpolateVariable, routeNames } from '../utils/common';\n\nimport { transformMetadataToKustoSchema } from './utils';\n\nexport default class AzureLogAnalyticsDatasource extends DataSourceWithBackend<\n  AzureMonitorQuery,\n  AzureDataSourceJsonData\n> {\n  resourcePath: string;\n  declare applicationId: string;\n\n  defaultSubscriptionId?: string;\n\n  azureMonitorPath: string;\n  firstWorkspace?: string;\n\n  constructor(\n    private instanceSettings: DataSourceInstanceSettings<AzureDataSourceJsonData>,\n    private readonly templateSrv: TemplateSrv = getTemplateSrv()\n  ) {\n    super(instanceSettings);\n\n    this.resourcePath = `${routeNames.logAnalytics}`;\n    this.azureMonitorPath = `${routeNames.azureMonitor}/subscriptions`;\n\n    this.defaultSubscriptionId = this.instanceSettings.jsonData.subscriptionId || '';\n  }\n\n  isConfigured(): boolean {\n    // If validation didn't return any error then the data source is properly configured\n    return !this.validateDatasource();\n  }\n\n  filterQuery(item: AzureMonitorQuery): boolean {\n    return (\n      item.hide !== true &&\n      ((!!item.azureLogAnalytics?.query &&\n        (!!item.azureLogAnalytics.resources?.length || !!item.azureLogAnalytics.workspace)) ||\n        !!item.azureTraces?.resources?.length)\n    );\n  }\n\n  async getSubscriptions(): Promise<Array<{ text: string; value: string }>> {\n    if (!this.isConfigured()) {\n      return [];\n    }\n\n    const path = `${this.azureMonitorPath}?api-version=2019-03-01`;\n    return await this.getResource<AzureAPIResponse<Subscription>>(path).then((result) => {\n      return ResponseParser.parseSubscriptions(result);\n    });\n  }\n\n  async getWorkspaces(subscription: string): Promise<AzureLogsVariable[]> {\n    const response = await this.getWorkspaceList(subscription);\n\n    return (\n      map(response.value, (val: Workspace) => {\n        return {\n          text: val.name,\n          value: val.id,\n        };\n      }) || []\n    );\n  }\n\n  private getWorkspaceList(subscription: string): Promise<AzureAPIResponse<Workspace>> {\n    const subscriptionId = this.templateSrv.replace(subscription || this.defaultSubscriptionId);\n\n    const workspaceListUrl =\n      this.azureMonitorPath +\n      `/${subscriptionId}/providers/Microsoft.OperationalInsights/workspaces?api-version=2017-04-26-preview`;\n    return this.getResource<AzureAPIResponse<Workspace>>(workspaceListUrl);\n  }\n\n  async getMetadata(resourceUri: string) {\n    const path = `${this.resourcePath}/v1${resourceUri}/metadata`;\n\n    const resp = await this.getResource(path);\n    return resp;\n  }\n\n  async getKustoSchema(resourceUri: string) {\n    const interpolatedUri = this.templateSrv.replace(resourceUri, {}, interpolateVariable);\n    const metadata = await this.getMetadata(interpolatedUri);\n    return transformMetadataToKustoSchema(metadata, interpolatedUri, this.templateSrv.getVariables());\n  }\n\n  applyTemplateVariables(target: AzureMonitorQuery, scopedVars: ScopedVars): AzureMonitorQuery {\n    let item;\n    if (target.queryType === AzureQueryType.LogAnalytics && target.azureLogAnalytics) {\n      item = target.azureLogAnalytics;\n      const resources = this.expandResourcesForMultipleVariables(item.resources, scopedVars);\n      let workspace = this.templateSrv.replace(item.workspace, scopedVars);\n\n      if (!workspace && !resources && this.firstWorkspace) {\n        workspace = this.firstWorkspace;\n      }\n\n      const query = this.templateSrv.replace(item.query, scopedVars, interpolateVariable);\n\n      return {\n        ...target,\n        queryType: target.queryType || AzureQueryType.LogAnalytics,\n\n        azureLogAnalytics: {\n          resultFormat: item.resultFormat,\n          query,\n          resources,\n          // Workspace was removed in Grafana 8, but remains for backwards compat\n          workspace,\n          dashboardTime: item.dashboardTime,\n          basicLogsQuery: item.basicLogsQuery,\n          timeColumn: this.templateSrv.replace(item.timeColumn, scopedVars),\n        },\n      };\n    }\n\n    if (target.queryType === AzureQueryType.AzureTraces && target.azureTraces) {\n      item = target.azureTraces;\n      const resources = this.expandResourcesForMultipleVariables(item.resources, scopedVars);\n      const query = this.templateSrv.replace(item.query, scopedVars, interpolateVariable);\n      const traceTypes = item.traceTypes?.map((t) => this.templateSrv.replace(t, scopedVars));\n      const filters = (item.filters ?? [])\n        .filter((f) => !!f.property)\n        .map((f) => {\n          const filtersReplaced = f.filters?.map((filter) => this.templateSrv.replace(filter ?? '', scopedVars));\n          return {\n            property: this.templateSrv.replace(f.property, scopedVars),\n            operation: f.operation || 'eq',\n            filters: filtersReplaced || [],\n          };\n        });\n\n      return {\n        ...target,\n        queryType: target.queryType || AzureQueryType.AzureTraces,\n\n        azureTraces: {\n          resultFormat: item.resultFormat,\n          query,\n          resources,\n          operationId: this.templateSrv.replace(target.azureTraces?.operationId, scopedVars),\n          filters,\n          traceTypes,\n        },\n      };\n    }\n\n    return target;\n  }\n\n  private expandResourcesForMultipleVariables(\n    resources: string[] | undefined,\n    scopedVars: ScopedVars\n  ): string[] | undefined {\n    if (!resources) {\n      return undefined;\n    }\n    const expandedResources: string[] = [];\n    resources.forEach((r: string) => {\n      const tempVars = this.templateSrv.replace(r, scopedVars, 'raw');\n      const values = tempVars.split(',');\n      values.forEach((value) => {\n        expandedResources.push(value);\n      });\n    });\n    return expandedResources;\n  }\n\n  /*\n    In 7.5.x it used to be possible to set a default workspace id in the config on the auth page.\n    This has been deprecated, however is still used by a few legacy template queries.\n  */\n  getDeprecatedDefaultWorkSpace() {\n    return this.instanceSettings.jsonData.logAnalyticsDefaultWorkspace;\n  }\n\n  async getDefaultOrFirstSubscription(): Promise<string | undefined> {\n    if (this.defaultSubscriptionId) {\n      return this.defaultSubscriptionId;\n    }\n    const subscriptions = await this.getSubscriptions();\n    return subscriptions[0]?.value;\n  }\n\n  async getFirstWorkspace(): Promise<string | undefined> {\n    if (this.firstWorkspace) {\n      return this.firstWorkspace;\n    }\n\n    const subscriptionId = await this.getDefaultOrFirstSubscription();\n    if (!subscriptionId) {\n      return undefined;\n    }\n\n    const workspaces = await this.getWorkspaces(subscriptionId);\n    const workspace = workspaces[0]?.value;\n\n    if (workspace) {\n      this.firstWorkspace = workspace;\n    }\n\n    return workspace;\n  }\n\n  private validateDatasource(): DatasourceValidationResult | undefined {\n    const authType = getAuthType(this.instanceSettings);\n\n    if (authType === 'clientsecret') {\n      if (!this.isValidConfigField(this.instanceSettings.jsonData.tenantId)) {\n        return {\n          status: 'error',\n          message: 'The Tenant Id field is required.',\n        };\n      }\n\n      if (!this.isValidConfigField(this.instanceSettings.jsonData.clientId)) {\n        return {\n          status: 'error',\n          message: 'The Client Id field is required.',\n        };\n      }\n    }\n\n    return undefined;\n  }\n\n  private isValidConfigField(field: string | undefined): boolean {\n    return typeof field === 'string' && field.length > 0;\n  }\n\n  async getAzureLogAnalyticsCheatsheetQueries() {\n    return await this.getResource(`${this.resourcePath}/v1/metadata`);\n  }\n\n  async getBasicLogsQueryUsage(query: AzureMonitorQuery, table: string): Promise<number> {\n    const templateSrv = getTemplateSrv();\n\n    const data = {\n      table: table,\n      resource: templateSrv.replace(query.azureLogAnalytics?.resources?.[0]),\n      queryType: query.queryType,\n      from: templateSrv.replace('$__from'),\n      to: templateSrv.replace('$__to'),\n    };\n    return await this.postResource(`${this.resourcePath}/usage/basiclogs`, data);\n  }\n}\n","import { Namespace } from 'i18next';\nimport { find, startsWith } from 'lodash';\n\nimport { DataSourceInstanceSettings, ScopedVars } from '@grafana/data';\nimport { DataSourceWithBackend, getTemplateSrv, TemplateSrv } from '@grafana/runtime';\n\nimport { getAuthType } from '../credentials';\nimport TimegrainConverter from '../time_grain_converter';\nimport {\n  AzureDataSourceJsonData,\n  AzureMonitorMetricsMetadataResponse,\n  AzureMonitorQuery,\n  AzureQueryType,\n  DatasourceValidationResult,\n  GetMetricNamespacesQuery,\n  GetMetricNamesQuery,\n  GetMetricMetadataQuery,\n  AzureMetricQuery,\n  AzureMonitorLocations,\n  AzureMonitorProvidersResponse,\n  AzureAPIResponse,\n  AzureGetResourceNamesQuery,\n  Subscription,\n  Location,\n  ResourceGroup,\n  Metric,\n} from '../types';\nimport { routeNames } from '../utils/common';\nimport migrateQuery from '../utils/migrateQuery';\n\nimport ResponseParser from './response_parser';\nimport UrlBuilder from './url_builder';\n\nconst defaultDropdownValue = 'select';\n\nfunction hasValue(item?: string) {\n  return !!(item && item !== defaultDropdownValue);\n}\n\nexport default class AzureMonitorDatasource extends DataSourceWithBackend<AzureMonitorQuery, AzureDataSourceJsonData> {\n  apiVersion = '2018-01-01';\n  apiPreviewVersion = '2017-12-01-preview';\n  listByResourceGroupApiVersion = '2021-04-01';\n  providerApiVersion = '2021-04-01';\n  locationsApiVersion = '2020-01-01';\n  defaultSubscriptionId?: string;\n  basicLogsEnabled?: boolean;\n  resourcePath: string;\n  declare resourceGroup: string;\n  declare resourceName: string;\n\n  constructor(\n    private instanceSettings: DataSourceInstanceSettings<AzureDataSourceJsonData>,\n    private readonly templateSrv: TemplateSrv = getTemplateSrv()\n  ) {\n    super(instanceSettings);\n\n    this.defaultSubscriptionId = instanceSettings.jsonData.subscriptionId;\n    this.basicLogsEnabled = instanceSettings.jsonData.basicLogsEnabled;\n\n    this.resourcePath = routeNames.azureMonitor;\n  }\n\n  isConfigured(): boolean {\n    // If validation didn't return any error then the data source is properly configured\n    return !this.validateDatasource();\n  }\n\n  filterQuery(item: AzureMonitorQuery): boolean {\n    const hasResource =\n      item?.azureMonitor?.resources &&\n      item.azureMonitor.resources.length > 0 &&\n      item.azureMonitor.resources.every((r) => hasValue(r.resourceGroup) && hasValue(r.resourceName)) &&\n      hasValue(item?.azureMonitor?.metricDefinition || item?.azureMonitor?.metricNamespace);\n    const hasResourceUri = hasValue(item.azureMonitor?.resourceUri);\n\n    return !!(\n      item.hide !== true &&\n      (hasResource || hasResourceUri) &&\n      hasValue(item?.azureMonitor?.metricName) &&\n      hasValue(item?.azureMonitor?.aggregation)\n    );\n  }\n\n  applyTemplateVariables(target: AzureMonitorQuery, scopedVars: ScopedVars): AzureMonitorQuery {\n    const preMigrationQuery = target.azureMonitor;\n\n    if (!preMigrationQuery) {\n      throw new Error('Query is not a valid Azure Monitor Metrics query');\n    }\n\n    // These properties need to be replaced pre-migration to ensure values are correctly interpolated\n    if (preMigrationQuery.resourceUri) {\n      preMigrationQuery.resourceUri = this.templateSrv.replace(preMigrationQuery.resourceUri, scopedVars);\n    }\n    if (preMigrationQuery.metricDefinition) {\n      preMigrationQuery.metricDefinition = this.templateSrv.replace(preMigrationQuery.metricDefinition, scopedVars);\n    }\n\n    // fix for timeGrainUnit which is a deprecated/removed field name\n    if (preMigrationQuery.timeGrain && preMigrationQuery.timeGrainUnit && preMigrationQuery.timeGrain !== 'auto') {\n      preMigrationQuery.timeGrain = TimegrainConverter.createISO8601Duration(\n        preMigrationQuery.timeGrain,\n        preMigrationQuery.timeGrainUnit\n      );\n    }\n\n    const migratedTarget = migrateQuery(target);\n    const migratedQuery = migratedTarget.azureMonitor;\n    // This should never be triggered because the above error would've been thrown\n    if (!migratedQuery) {\n      throw new Error('Query is not a valid Azure Monitor Metrics query');\n    }\n\n    const subscriptionId = this.templateSrv.replace(\n      migratedTarget.subscription || this.defaultSubscriptionId,\n      scopedVars\n    );\n    const resources = migratedQuery.resources?.map((r) => this.replaceTemplateVariables(r, scopedVars)).flat();\n    const metricNamespace = this.templateSrv.replace(migratedQuery.metricNamespace, scopedVars);\n    const customNamespace = this.templateSrv.replace(migratedQuery.customNamespace, scopedVars);\n    const timeGrain = this.templateSrv.replace((migratedQuery.timeGrain || '').toString(), scopedVars);\n    const aggregation = this.templateSrv.replace(migratedQuery.aggregation, scopedVars);\n    const top = this.templateSrv.replace(migratedQuery.top || '', scopedVars);\n\n    const dimensionFilters = (migratedQuery.dimensionFilters ?? [])\n      .filter((f) => f.dimension && f.dimension !== 'None')\n      .map((f) => {\n        const filters = f.filters?.map((filter) => this.templateSrv.replace(filter ?? '', scopedVars));\n        return {\n          dimension: this.templateSrv.replace(f.dimension, scopedVars),\n          operator: f.operator || 'eq',\n          filters: filters || [],\n        };\n      });\n\n    const azMonitorQuery: AzureMetricQuery = {\n      ...migratedQuery,\n      resources,\n      metricNamespace,\n      customNamespace,\n      timeGrain,\n      allowedTimeGrainsMs: migratedQuery.allowedTimeGrainsMs,\n      metricName: this.templateSrv.replace(migratedQuery.metricName, scopedVars),\n      region: this.templateSrv.replace(migratedQuery.region, scopedVars),\n      aggregation: aggregation,\n      dimensionFilters,\n      top: top || '10',\n      alias: migratedQuery.alias,\n    };\n\n    return {\n      ...target,\n      subscription: subscriptionId,\n      queryType: AzureQueryType.AzureMonitor,\n      azureMonitor: azMonitorQuery,\n    };\n  }\n\n  async getSubscriptions(): Promise<Array<{ text: string; value: string }>> {\n    if (!this.isConfigured()) {\n      return [];\n    }\n\n    return this.getResource<AzureAPIResponse<Subscription>>(\n      `${this.resourcePath}/subscriptions?api-version=2019-03-01`\n    ).then((result) => {\n      return ResponseParser.parseSubscriptions(result);\n    });\n  }\n\n  getResourceGroups(subscriptionId: string) {\n    return this.getResource(\n      `${this.resourcePath}/subscriptions/${subscriptionId}/resourceGroups?api-version=${this.listByResourceGroupApiVersion}`\n    ).then((result: AzureAPIResponse<ResourceGroup>) => {\n      return ResponseParser.parseResponseValues<ResourceGroup>(result, 'name', 'name');\n    });\n  }\n\n  async getResourceNames(query: AzureGetResourceNamesQuery, skipToken?: string) {\n    const promises = this.replaceTemplateVariables(query).map(\n      ({ metricNamespace, subscriptionId, resourceGroup, region }) => {\n        const validMetricNamespace = startsWith(metricNamespace?.toLowerCase(), 'microsoft.storage/storageaccounts/')\n          ? 'microsoft.storage/storageaccounts'\n          : metricNamespace;\n        let url = `${this.resourcePath}/subscriptions/${subscriptionId}`;\n        if (resourceGroup) {\n          url += `/resourceGroups/${resourceGroup}`;\n        }\n        url += `/resources?api-version=${this.listByResourceGroupApiVersion}`;\n        const filters: string[] = [];\n        if (validMetricNamespace) {\n          filters.push(`resourceType eq '${validMetricNamespace}'`);\n        }\n        if (region) {\n          filters.push(`location eq '${region}'`);\n        }\n        if (filters.length > 0) {\n          url += `&$filter=${filters.join(' and ')}`;\n        }\n        if (skipToken) {\n          url += `&$skiptoken=${skipToken}`;\n        }\n        return this.getResource(url).then(async (result) => {\n          let list: Array<{ text: string; value: string }> = [];\n          if (startsWith(metricNamespace?.toLowerCase(), 'microsoft.storage/storageaccounts/')) {\n            list = ResponseParser.parseResourceNames(result, 'microsoft.storage/storageaccounts');\n            for (let i = 0; i < list.length; i++) {\n              list[i].text += '/default';\n              list[i].value += '/default';\n            }\n          } else {\n            list = ResponseParser.parseResourceNames(result, metricNamespace);\n          }\n\n          if (result.nextLink) {\n            // If there is a nextLink, we should request more pages\n            const nextURL = new URL(result.nextLink);\n            const nextToken = nextURL.searchParams.get('$skiptoken');\n            if (!nextToken) {\n              throw Error('unable to request the next page of resources');\n            }\n            const nextPage = await this.getResourceNames({ metricNamespace, subscriptionId, resourceGroup }, nextToken);\n            list = list.concat(nextPage);\n          }\n\n          return list;\n        });\n      }\n    );\n    return (await Promise.all(promises)).flat();\n  }\n\n  getMetricNamespaces(query: GetMetricNamespacesQuery, globalRegion: boolean, region?: string) {\n    const url = UrlBuilder.buildAzureMonitorGetMetricNamespacesUrl(\n      this.resourcePath,\n      this.apiPreviewVersion,\n      // Only use the first query, as the metric namespaces should be the same for all queries\n      this.replaceSingleTemplateVariables(query),\n      globalRegion,\n      this.templateSrv,\n      region\n    );\n    return this.getResource(url)\n      .then((result: AzureAPIResponse<Namespace>) => {\n        return ResponseParser.parseResponseValues(\n          result,\n          'properties.metricNamespaceName',\n          'properties.metricNamespaceName'\n        );\n      })\n      .then((result) => {\n        if (url.toLowerCase().includes('microsoft.storage/storageaccounts')) {\n          const storageNamespaces = [\n            'microsoft.storage/storageaccounts',\n            'microsoft.storage/storageaccounts/blobservices',\n            'microsoft.storage/storageaccounts/fileservices',\n            'microsoft.storage/storageaccounts/tableservices',\n            'microsoft.storage/storageaccounts/queueservices',\n          ];\n          for (const namespace of storageNamespaces) {\n            if (!find(result, ['value', namespace.toLowerCase()])) {\n              result.push({ value: namespace, text: namespace });\n            }\n          }\n        }\n        return result;\n      })\n      .catch((reason) => {\n        console.error(`Failed to get metric namespaces: ${reason}`);\n        return [];\n      });\n  }\n\n  getMetricNames(query: GetMetricNamesQuery, multipleResources?: boolean, region?: string) {\n    const apiVersion = multipleResources ? this.apiPreviewVersion : this.apiVersion;\n    const url = UrlBuilder.buildAzureMonitorGetMetricNamesUrl(\n      this.resourcePath,\n      apiVersion,\n      // Only use the first query, as the metric names should be the same for all queries\n      this.replaceSingleTemplateVariables(query),\n      this.templateSrv,\n      multipleResources,\n      region\n    );\n    return this.getResource(url).then((result: AzureAPIResponse<Metric>) => {\n      return ResponseParser.parseResponseValues(result, 'name.localizedValue', 'name.value');\n    });\n  }\n\n  getMetricMetadata(query: GetMetricMetadataQuery, multipleResources?: boolean, region?: string) {\n    const { metricName } = query;\n    const apiVersion = multipleResources ? this.apiPreviewVersion : this.apiVersion;\n    const url = UrlBuilder.buildAzureMonitorGetMetricNamesUrl(\n      this.resourcePath,\n      apiVersion,\n      // Only use the first query, as the metric metadata should be the same for all queries\n      this.replaceSingleTemplateVariables(query),\n      this.templateSrv,\n      multipleResources,\n      region\n    );\n    return this.getResource(url).then((result: AzureMonitorMetricsMetadataResponse) => {\n      return ResponseParser.parseMetadata(result, this.templateSrv.replace(metricName));\n    });\n  }\n\n  private validateDatasource(): DatasourceValidationResult | undefined {\n    const authType = getAuthType(this.instanceSettings);\n\n    if (authType === 'clientsecret') {\n      if (!this.isValidConfigField(this.instanceSettings.jsonData.tenantId)) {\n        return {\n          status: 'error',\n          message: 'The Tenant Id field is required.',\n        };\n      }\n\n      if (!this.isValidConfigField(this.instanceSettings.jsonData.clientId)) {\n        return {\n          status: 'error',\n          message: 'The Client Id field is required.',\n        };\n      }\n    }\n\n    return undefined;\n  }\n\n  private isValidConfigField(field?: string): boolean {\n    return typeof field === 'string' && field.length > 0;\n  }\n\n  private replaceSingleTemplateVariables<T extends { [K in keyof T]: string }>(query: T, scopedVars?: ScopedVars) {\n    // This method evaluates template variables supporting multiple values but only returns the first value.\n    // This will work as far as the first combination of variables is valid.\n    // For example if 'rg1' contains 'res1' and 'rg2' contains 'res2' then\n    // { resourceGroup: ['rg1', 'rg2'], resourceName: ['res1', 'res2'] } would return\n    // { resourceGroup: 'rg1', resourceName: 'res1' } which is valid but\n    // { resourceGroup: ['rg1', 'rg2'], resourceName: ['res2'] } would result in\n    // { resourceGroup: 'rg1', resourceName: 'res2' } which is not.\n    return this.replaceTemplateVariables(query, scopedVars)[0];\n  }\n\n  private replaceTemplateVariables<T extends { [K in keyof T]: string }>(query: T, scopedVars?: ScopedVars) {\n    const workingQueries: Array<{ [K in keyof T]: string }> = [{ ...query }];\n    const keys = Object.keys(query) as Array<keyof T>;\n    keys.forEach((key) => {\n      const replaced = this.templateSrv.replace(workingQueries[0][key], scopedVars, 'raw');\n      if (replaced.includes(',')) {\n        const multiple = replaced.split(',');\n        const currentQueries = [...workingQueries];\n        multiple.forEach((value, i) => {\n          currentQueries.forEach((q) => {\n            if (i === 0) {\n              q[key] = value;\n            } else {\n              workingQueries.push({ ...q, [key]: value });\n            }\n          });\n        });\n      } else {\n        workingQueries.forEach((q) => {\n          q[key] = replaced;\n        });\n      }\n    });\n\n    return workingQueries;\n  }\n\n  async getProvider(providerName: string) {\n    return await this.getResource<AzureMonitorProvidersResponse>(\n      `${routeNames.azureMonitor}/providers/${providerName}?api-version=${this.providerApiVersion}`\n    );\n  }\n\n  async getLocations(subscriptions: string[]) {\n    const locationMap = new Map<string, AzureMonitorLocations>();\n    for (const subscription of subscriptions) {\n      const subLocations = ResponseParser.parseLocations(\n        await this.getResource<AzureAPIResponse<Location>>(\n          `${routeNames.azureMonitor}/subscriptions/${this.templateSrv.replace(subscription)}/locations?api-version=${\n            this.locationsApiVersion\n          }`\n        )\n      );\n      for (const location of subLocations) {\n        locationMap.set(location.name, location);\n      }\n    }\n\n    return locationMap;\n  }\n}\n","// eslint-disable-next-line lodash/import-scope\nimport _ from 'lodash';\n\nimport { ScopedVars } from '@grafana/data';\nimport { getTemplateSrv, DataSourceWithBackend } from '@grafana/runtime';\n\nimport { AzureMonitorQuery, AzureDataSourceJsonData, AzureQueryType } from '../types';\nimport { interpolateVariable } from '../utils/common';\n\nexport default class AzureResourceGraphDatasource extends DataSourceWithBackend<\n  AzureMonitorQuery,\n  AzureDataSourceJsonData\n> {\n  filterQuery(item: AzureMonitorQuery): boolean {\n    return !!item.azureResourceGraph?.query && !!item.subscriptions && item.subscriptions.length > 0;\n  }\n\n  applyTemplateVariables(target: AzureMonitorQuery, scopedVars: ScopedVars): AzureMonitorQuery {\n    const ts = getTemplateSrv();\n    const item = target.azureResourceGraph;\n    if (!item) {\n      return target;\n    }\n    const variableNames = ts.getVariables().map((v) => `$${v.name}`);\n    const subscriptionVar = _.find(target.subscriptions, (sub) => _.includes(variableNames, sub));\n    const interpolatedSubscriptions = ts\n      .replace(subscriptionVar, scopedVars, (v: string[] | string) => v)\n      .split(',')\n      .filter((v) => v.length > 0);\n    const subscriptions = [\n      ...interpolatedSubscriptions,\n      ..._.filter(target.subscriptions, (sub) => !_.includes(variableNames, sub)),\n    ];\n    const query = ts.replace(item.query, scopedVars, interpolateVariable);\n\n    return {\n      ...target,\n      queryType: AzureQueryType.AzureResourceGraph,\n      subscriptions,\n      azureResourceGraph: {\n        resultFormat: 'table',\n        query,\n      },\n    };\n  }\n}\n","import { DataSourceInstanceSettings } from '@grafana/data';\nimport { DataSourceWithBackend, reportInteraction } from '@grafana/runtime';\n\nimport { logsResourceTypes, resourceTypeDisplayNames, resourceTypes } from '../azureMetadata';\nimport AzureMonitorDatasource from '../azure_monitor/azure_monitor_datasource';\nimport { ResourceRow, ResourceRowGroup, ResourceRowType } from '../components/ResourcePicker/types';\nimport {\n  addResources,\n  findRow,\n  parseMultipleResourceDetails,\n  parseResourceDetails,\n  parseResourceURI,\n  resourceToString,\n} from '../components/ResourcePicker/utils';\nimport {\n  AzureDataSourceJsonData,\n  AzureGraphResponse,\n  AzureMonitorResource,\n  AzureMonitorQuery,\n  AzureResourceGraphOptions,\n  AzureResourceSummaryItem,\n  RawAzureResourceGroupItem,\n  RawAzureResourceItem,\n  RawAzureSubscriptionItem,\n} from '../types';\nimport { routeNames } from '../utils/common';\n\nconst RESOURCE_GRAPH_URL = '/providers/Microsoft.ResourceGraph/resources?api-version=2021-03-01';\n\nconst logsSupportedResourceTypesKusto = logsResourceTypes.map((v) => `\"${v}\"`).join(',');\n\nexport type ResourcePickerQueryType = 'logs' | 'metrics' | 'traces';\n\nexport default class ResourcePickerData extends DataSourceWithBackend<AzureMonitorQuery, AzureDataSourceJsonData> {\n  private resourcePath: string;\n  resultLimit = 200;\n  azureMonitorDatasource;\n  supportedMetricNamespaces = '';\n\n  constructor(\n    instanceSettings: DataSourceInstanceSettings<AzureDataSourceJsonData>,\n    azureMonitorDatasource: AzureMonitorDatasource\n  ) {\n    super(instanceSettings);\n    this.resourcePath = `${routeNames.resourceGraph}`;\n    this.azureMonitorDatasource = azureMonitorDatasource;\n  }\n\n  async fetchInitialRows(\n    type: ResourcePickerQueryType,\n    currentSelection?: AzureMonitorResource[]\n  ): Promise<ResourceRowGroup> {\n    const subscriptions = await this.getSubscriptions();\n\n    if (!currentSelection) {\n      return subscriptions;\n    }\n\n    let resources = subscriptions;\n    const promises = currentSelection.map((selection) => async () => {\n      if (selection.subscription) {\n        const resourceGroupURI = `/subscriptions/${selection.subscription}/resourceGroups/${selection.resourceGroup}`;\n\n        if (selection.resourceGroup && !findRow(resources, resourceGroupURI)) {\n          const resourceGroups = await this.getResourceGroupsBySubscriptionId(selection.subscription, type);\n          resources = addResources(resources, `/subscriptions/${selection.subscription}`, resourceGroups);\n        }\n\n        const resourceURI = resourceToString(selection);\n        if (selection.resourceName && !findRow(resources, resourceURI)) {\n          const resourcesForResourceGroup = await this.getResourcesForResourceGroup(resourceGroupURI, type);\n          resources = addResources(resources, resourceGroupURI, resourcesForResourceGroup);\n        }\n      }\n    });\n\n    for (const promise of promises) {\n      // Fetch resources one by one, avoiding re-fetching the same resource\n      // and race conditions updating the resources array\n      await promise();\n    }\n\n    return resources;\n  }\n\n  async fetchAndAppendNestedRow(\n    rows: ResourceRowGroup,\n    parentRow: ResourceRow,\n    type: ResourcePickerQueryType\n  ): Promise<ResourceRowGroup> {\n    const nestedRows =\n      parentRow.type === ResourceRowType.Subscription\n        ? await this.getResourceGroupsBySubscriptionId(parentRow.id, type)\n        : await this.getResourcesForResourceGroup(parentRow.uri, type);\n\n    return addResources(rows, parentRow.uri, nestedRows);\n  }\n\n  search = async (searchPhrase: string, searchType: ResourcePickerQueryType): Promise<ResourceRowGroup> => {\n    let searchQuery = 'resources';\n    if (searchType === 'logs') {\n      searchQuery += `\n      | union resourcecontainers`;\n    }\n    searchQuery += `\n        | where id contains \"${searchPhrase}\"\n        ${await this.filterByType(searchType)}\n        | order by tolower(name) asc\n        | limit ${this.resultLimit}\n      `;\n    const { data: response } = await this.makeResourceGraphRequest<RawAzureResourceItem[]>(searchQuery);\n    return response.map((item) => {\n      const parsedUri = parseResourceURI(item.id);\n      if (!parsedUri || !(parsedUri.resourceName || parsedUri.resourceGroup || parsedUri.subscription)) {\n        throw new Error('unable to fetch resource details');\n      }\n      let id = parsedUri.subscription ?? '';\n      let type = ResourceRowType.Subscription;\n      if (parsedUri.resourceName) {\n        id = parsedUri.resourceName;\n        type = ResourceRowType.Resource;\n      } else if (parsedUri.resourceGroup) {\n        id = parsedUri.resourceGroup;\n        type = ResourceRowType.ResourceGroup;\n      }\n      return {\n        name: item.name,\n        id,\n        uri: item.id,\n        resourceGroupName: item.resourceGroup,\n        type,\n        typeLabel: resourceTypeDisplayNames[item.type] || item.type,\n        location: item.location,\n      };\n    });\n  };\n\n  // private\n  async getSubscriptions(): Promise<ResourceRowGroup> {\n    const query = `\n    resources\n    | join kind=inner (\n              ResourceContainers\n                | where type == 'microsoft.resources/subscriptions'\n                | project subscriptionName=name, subscriptionURI=id, subscriptionId\n              ) on subscriptionId\n    | summarize count() by subscriptionName, subscriptionURI, subscriptionId\n    | order by subscriptionName desc\n  `;\n\n    let resources: RawAzureSubscriptionItem[] = [];\n\n    let allFetched = false;\n    let $skipToken = undefined;\n    while (!allFetched) {\n      // The response may include several pages\n      let options: Partial<AzureResourceGraphOptions> = {};\n      if ($skipToken) {\n        options = {\n          $skipToken,\n        };\n      }\n      const resourceResponse = await this.makeResourceGraphRequest<RawAzureSubscriptionItem[]>(query, 1, options);\n      if (!resourceResponse.data.length) {\n        throw new Error('No subscriptions were found');\n      }\n      resources = resources.concat(resourceResponse.data);\n      $skipToken = resourceResponse.$skipToken;\n      allFetched = !$skipToken;\n    }\n\n    return resources.map((subscription) => ({\n      name: subscription.subscriptionName,\n      id: subscription.subscriptionId,\n      uri: `/subscriptions/${subscription.subscriptionId}`,\n      typeLabel: 'Subscription',\n      type: ResourceRowType.Subscription,\n      children: [],\n    }));\n  }\n\n  async getResourceGroupsBySubscriptionId(\n    subscriptionId: string,\n    type: ResourcePickerQueryType\n  ): Promise<ResourceRowGroup> {\n    // We can use subscription ID for the filtering here as they're unique\n    const query = `\n    resources\n     | join kind=inner (\n       ResourceContainers\n       | where type == 'microsoft.resources/subscriptions/resourcegroups'\n       | project resourceGroupURI=id, resourceGroupName=name, resourceGroup, subscriptionId\n     ) on resourceGroup, subscriptionId\n\n     ${await this.filterByType(type)}\n     | where subscriptionId == '${subscriptionId}'\n     | summarize count() by resourceGroupName, resourceGroupURI\n     | order by resourceGroupURI asc`;\n\n    let resourceGroups: RawAzureResourceGroupItem[] = [];\n    let allFetched = false;\n    let $skipToken = undefined;\n    while (!allFetched) {\n      // The response may include several pages\n      let options: Partial<AzureResourceGraphOptions> = {};\n      if ($skipToken) {\n        options = {\n          $skipToken,\n        };\n      }\n      const resourceResponse = await this.makeResourceGraphRequest<RawAzureResourceGroupItem[]>(query, 1, options);\n      resourceGroups = resourceGroups.concat(resourceResponse.data);\n      $skipToken = resourceResponse.$skipToken;\n      allFetched = !$skipToken;\n    }\n\n    return resourceGroups.map((r) => {\n      const parsedUri = parseResourceURI(r.resourceGroupURI);\n      if (!parsedUri || !parsedUri.resourceGroup) {\n        throw new Error('unable to fetch resource groups');\n      }\n      return {\n        name: r.resourceGroupName,\n        uri: r.resourceGroupURI,\n        id: parsedUri.resourceGroup,\n        type: ResourceRowType.ResourceGroup,\n        typeLabel: 'Resource Group',\n        children: [],\n      };\n    });\n  }\n\n  async getResourcesForResourceGroup(\n    resourceGroupUri: string,\n    type: ResourcePickerQueryType\n  ): Promise<ResourceRowGroup> {\n    // We use resource group URI for the filtering here because resource group names are not unique across subscriptions\n    // We also add a slash at the end of the resource group URI to ensure we do not pull resources from a resource group\n    // that has a similar naming prefix e.g. resourceGroup1 and resourceGroup10\n    const { data: response } = await this.makeResourceGraphRequest<RawAzureResourceItem[]>(`\n      resources\n      | where id hasprefix \"${resourceGroupUri}/\"\n      ${await this.filterByType(type)}\n    `);\n\n    return response.map((item) => {\n      const parsedUri = parseResourceURI(item.id);\n      if (!parsedUri || !parsedUri.resourceName) {\n        throw new Error('unable to fetch resource details');\n      }\n      return {\n        name: item.name,\n        id: parsedUri.resourceName,\n        uri: item.id,\n        resourceGroupName: item.resourceGroup,\n        type: ResourceRowType.Resource,\n        typeLabel: resourceTypeDisplayNames[item.type] || item.type,\n        locationDisplayName: item.location,\n        location: item.location,\n      };\n    });\n  }\n\n  // used to make the select resource button that launches the resource picker show a nicer file path to users\n  async getResourceURIDisplayProperties(resourceURI: string): Promise<AzureMonitorResource> {\n    const { subscription, resourceGroup, resourceName } = parseResourceDetails(resourceURI) ?? {};\n\n    if (!subscription) {\n      throw new Error('Invalid resource URI passed');\n    }\n\n    // resourceGroupURI and resourceURI could be invalid values, but that's okay because the join\n    // will just silently fail as expected\n    const subscriptionURI = `/subscriptions/${subscription}`;\n    const resourceGroupURI = `${subscriptionURI}/resourceGroups/${resourceGroup}`;\n\n    const query = `\n    resourcecontainers\n    | where type == \"microsoft.resources/subscriptions\"\n    | where id =~ \"${subscriptionURI}\"\n    | project subscriptionName=name, subscriptionId\n\n    | join kind=leftouter (\n      resourcecontainers            \n            | where type == \"microsoft.resources/subscriptions/resourcegroups\"\n            | where id =~ \"${resourceGroupURI}\"\n            | project resourceGroupName=name, resourceGroup, subscriptionId\n        ) on subscriptionId\n\n        | join kind=leftouter (\n          resources\n            | where id =~ \"${resourceURI}\"\n            | project resourceName=name, subscriptionId\n        ) on subscriptionId\n\n        | project subscriptionName, resourceGroupName, resourceName\n    `;\n\n    const { data: response } = await this.makeResourceGraphRequest<AzureResourceSummaryItem[]>(query);\n\n    if (!response.length) {\n      throw new Error('unable to fetch resource details');\n    }\n\n    const { subscriptionName, resourceGroupName, resourceName: responseResourceName } = response[0];\n    // if the name is undefined it could be because the id is undefined or because we are using a template variable.\n    // Either way we can use it as a fallback. We don't really want to interpolate these variables because we want\n    // to show the user when they are using template variables `$sub/$rg/$resource`\n    return {\n      subscription: subscriptionName || subscription,\n      resourceGroup: resourceGroupName || resourceGroup,\n      resourceName: responseResourceName || resourceName,\n    };\n  }\n\n  async getResourceURIFromWorkspace(workspace: string) {\n    const { data: response } = await this.makeResourceGraphRequest<RawAzureResourceItem[]>(`\n      resources\n      | where properties['customerId'] == \"${workspace}\"\n      | project id\n    `);\n\n    if (!response.length) {\n      throw new Error('unable to find resource for workspace ' + workspace);\n    }\n\n    return response[0].id;\n  }\n\n  async makeResourceGraphRequest<T = unknown>(\n    query: string,\n    maxRetries = 1,\n    reqOptions?: Partial<AzureResourceGraphOptions>\n  ): Promise<AzureGraphResponse<T>> {\n    try {\n      return await this.postResource(this.resourcePath + RESOURCE_GRAPH_URL, {\n        query: query,\n        options: {\n          resultFormat: 'objectArray',\n          ...reqOptions,\n        },\n      });\n    } catch (error) {\n      if (maxRetries > 0) {\n        return this.makeResourceGraphRequest(query, maxRetries - 1);\n      }\n\n      throw error;\n    }\n  }\n\n  private filterByType = async (t: ResourcePickerQueryType) => {\n    if (this.supportedMetricNamespaces === '' && t !== 'logs') {\n      await this.fetchAllNamespaces();\n    }\n    return t === 'logs'\n      ? `| where type in (${logsSupportedResourceTypesKusto})`\n      : `| where type in (${this.supportedMetricNamespaces})`;\n  };\n\n  private async fetchAllNamespaces() {\n    const subscriptions = await this.getSubscriptions();\n    reportInteraction('grafana_ds_azuremonitor_subscriptions_loaded', { subscriptions: subscriptions.length });\n\n    let supportedMetricNamespaces: Set<string> = new Set();\n    // Include a predefined set of metric namespaces as a fallback in the case the user cannot query subscriptions\n    resourceTypes.forEach((namespace) => {\n      supportedMetricNamespaces.add(`\"${namespace}\"`);\n    });\n\n    // We make use of these three regions as they *should* contain every possible namespace\n    const regions = ['westeurope', 'eastus', 'japaneast'];\n    const getNamespacesForRegion = async (region: string) => {\n      const namespaces = await this.azureMonitorDatasource.getMetricNamespaces(\n        {\n          // We only need to run this request against the first available subscription\n          resourceUri: `/subscriptions/${subscriptions[0].id}`,\n        },\n        false,\n        region\n      );\n      if (namespaces) {\n        for (const namespace of namespaces) {\n          supportedMetricNamespaces.add(`\"${namespace.value.toLocaleLowerCase()}\"`);\n        }\n      }\n    };\n\n    const promises = regions.map((region) => getNamespacesForRegion(region));\n    await Promise.all(promises);\n\n    if (supportedMetricNamespaces.size === 0) {\n      throw new Error(\n        'Unable to resolve a list of valid metric namespaces. Validate the datasource configuration is correct and required permissions have been granted for all subscriptions. Grafana requires at least the Reader role to be assigned.'\n      );\n    }\n\n    this.supportedMetricNamespaces = Array.from(supportedMetricNamespaces).join(',');\n  }\n\n  parseRows(resources: Array<string | AzureMonitorResource>): ResourceRow[] {\n    const resourceObjs = parseMultipleResourceDetails(resources);\n    const newSelectedRows: ResourceRow[] = [];\n    resourceObjs.forEach((resource, i) => {\n      let id = resource.resourceName;\n      let name = resource.resourceName;\n      let rtype = ResourceRowType.Resource;\n      if (!id) {\n        id = resource.resourceGroup;\n        name = resource.resourceGroup;\n        rtype = ResourceRowType.ResourceGroup;\n        if (!id) {\n          id = resource.subscription;\n          name = resource.subscription;\n          rtype = ResourceRowType.Subscription;\n        }\n      }\n      newSelectedRows.push({\n        id: id ?? '',\n        name: name ?? '',\n        type: rtype,\n        uri: resourceToString(resource),\n        typeLabel:\n          resourceTypeDisplayNames[resource.metricNamespace?.toLowerCase() ?? ''] ?? resource.metricNamespace ?? '',\n        location: resource.region,\n      });\n    });\n    return newSelectedRows;\n  }\n}\n","/**\nThis list is obtained parsing https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/resource-logs-categories\nTo programatically get the list, execute in the browser console:\n \n  const namespaces = []\n  document.querySelectorAll('tr').forEach((tr, index) => {\n      if(index !== 0) {\n          const tds = tr.cells\n          const resourceProvider = tds[0].innerText.replace(\"\\n\", \"\")\n          if(tds[2].innerText === \"N/A\" || !resourceProvider.match(/^(microsoft|Microsoft|Wandisco)/)) {\n              return;\n          }\n          const logsCategories = tds[2].innerText.split(\"\\n\")\n          logsCategories.forEach((category) => {\n              if(category === \"\") {\n                  return;\n              }\n              const string =resourceProvider+'/'+category\n              namespaces.push(string.toLowerCase())\n          })\n      }\n  })\n  namespaces;\n \nNote: Validate that the output makes sense, the format of the page may change.\n \nThat list is not complete so we should merge it with the one below. You can do with a node console:\n \n  const u = require('lodash')\n  const newList = [list from above]\n  const logsResourceTypes = [this list]\n  console.dir(u.uniq(logsResourceTypes.concat(newList)).sort(), {'maxArrayLength': null})\n \n */\n\nexport const logsResourceTypes = [\n  'microsoft.aad/domainservices',\n  'microsoft.aadiam/azureadmetrics',\n  'microsoft.aadiam/tenants',\n  'microsoft.agfoodplatform/farmbeats',\n  'microsoft.analysisservices/servers',\n  'microsoft.apimanagement/service',\n  'microsoft.app/managedenvironments',\n  'microsoft.appconfiguration/configurationstores',\n  'microsoft.appplatform/spring',\n  'microsoft.attestation/attestationproviders',\n  'microsoft.automation/automationaccounts',\n  'microsoft.autonomousdevelopmentplatform/accounts',\n  'microsoft.autonomousdevelopmentplatform/datapools',\n  'microsoft.autonomousdevelopmentplatform/workspaces',\n  'microsoft.avs/privateclouds',\n  'microsoft.azuredatatransfer/connections/flows',\n  'microsoft.azureplaywrightservice/accounts',\n  'microsoft.azuresphere/catalogs',\n  'microsoft.azurestackresourcemonitor/storageaccountmonitor',\n  'microsoft.batch/batchaccounts',\n  'microsoft.batchai/workspaces',\n  'microsoft.blockchain/blockchainmembers',\n  'microsoft.blockchain/cordamembers',\n  'microsoft.botservice/botservices',\n  'microsoft.cache/redis',\n  'microsoft.cache/redisenterprise',\n  'microsoft.cache/redisenterprise/databases',\n  'microsoft.cdn/cdnwebapplicationfirewallpolicies',\n  'microsoft.cdn/profiles',\n  'microsoft.cdn/profiles/endpoints',\n  'microsoft.chaos/experiments',\n  'microsoft.classiccompute/domainnames',\n  'microsoft.classiccompute/virtualmachines',\n  'microsoft.classicnetwork/networksecuritygroups',\n  'microsoft.classicstorage/storageaccounts',\n  'microsoft.codesigning/codesigningaccounts',\n  'microsoft.cognitiveservices/accounts',\n  'microsoft.communication/communicationservices',\n  'microsoft.community/communitytrainings',\n  'microsoft.compute/disks',\n  'microsoft.compute/virtualmachines',\n  'microsoft.compute/virtualmachinescalesets',\n  'microsoft.confidentialledger/managedccf',\n  'microsoft.confidentialledger/managedccfs',\n  'microsoft.connectedcache/cachenodes',\n  'microsoft.connectedcache/enterprisemcccustomers',\n  'microsoft.connectedcache/ispcustomers',\n  'microsoft.connectedvehicle/platformaccounts',\n  'microsoft.containerinstance/containergroups',\n  'microsoft.containerregistry/registries',\n  'microsoft.containerservice/fleets',\n  'microsoft.containerservice/managedclusters',\n  'microsoft.customerinsights/hubs',\n  'microsoft.customproviders/resourceproviders',\n  'microsoft.d365customerinsights/instances',\n  'microsoft.dashboard/grafana',\n  'microsoft.databoxedge/databoxedgedevices',\n  'microsoft.databricks/workspaces',\n  'microsoft.datacollaboration/workspaces',\n  'microsoft.datafactory/datafactories',\n  'microsoft.datafactory/factories',\n  'microsoft.datalakeanalytics/accounts',\n  'microsoft.datalakestore/accounts',\n  'microsoft.dataprotection/backupvaults',\n  'microsoft.datashare/accounts',\n  'microsoft.dbformariadb/servers',\n  'microsoft.dbformysql/flexibleservers',\n  'microsoft.dbformysql/servers',\n  'microsoft.dbforpostgresql/flexibleservers',\n  'microsoft.dbforpostgresql/servergroupsv2',\n  'microsoft.dbforpostgresql/servers',\n  'microsoft.dbforpostgresql/serversv2',\n  'microsoft.desktopvirtualization/appattachpackages',\n  'microsoft.desktopvirtualization/applicationgroups',\n  'microsoft.desktopvirtualization/hostpools',\n  'microsoft.desktopvirtualization/scalingplans',\n  'microsoft.desktopvirtualization/workspaces',\n  'microsoft.devcenter/devcenters',\n  'microsoft.devices/elasticpools/iothubtenants',\n  'microsoft.devices/iothubs',\n  'microsoft.devices/provisioningservices',\n  'microsoft.devopsinfrastructure/pools',\n  'microsoft.digitaltwins/digitaltwinsinstances',\n  'microsoft.documentdb/cassandraclusters',\n  'microsoft.documentdb/databaseaccounts',\n  'microsoft.documentdb/mongoclusters',\n  'microsoft.eventgrid/domains',\n  'microsoft.eventgrid/namespaces',\n  'microsoft.eventgrid/partnernamespaces',\n  'microsoft.eventgrid/partnertopics',\n  'microsoft.eventgrid/systemtopics',\n  'microsoft.eventgrid/topics',\n  'microsoft.eventhub/clusters',\n  'microsoft.eventhub/namespaces',\n  'microsoft.experimentation/experimentworkspaces',\n  'microsoft.fabric.admin/fabriclocations',\n  'microsoft.hardwaresecuritymodules/cloudhsmclusters',\n  'microsoft.hdinsight/clusters',\n  'microsoft.healthcareapis/services',\n  'microsoft.healthcareapis/workspaces/dicomservices',\n  'microsoft.healthcareapis/workspaces/fhirservices',\n  'microsoft.healthcareapis/workspaces/iotconnectors',\n  'microsoft.healthdataaiservices/deidservices',\n  'microsoft.insights/autoscalesettings',\n  'microsoft.insights/components',\n  'microsoft.insights/datacollectionrules',\n  'microsoft.insights/qos',\n  'microsoft.iotcentral/iotapps',\n  'microsoft.keyvault/managedhsms',\n  'microsoft.keyvault/vaults',\n  'microsoft.kubernetes/connectedclusters',\n  'microsoft.kusto/clusters',\n  'microsoft.loadtestservice/loadtests',\n  'microsoft.logic/integrationaccounts',\n  'microsoft.logic/integrationserviceenvironments',\n  'microsoft.logic/workflows',\n  'microsoft.machinelearningservices/registries',\n  'microsoft.machinelearningservices/workspaces',\n  'microsoft.machinelearningservices/workspaces/onlineendpoints',\n  'microsoft.managednetworkfabric/networkdevices',\n  'microsoft.media/mediaservices',\n  'microsoft.media/mediaservices/liveevents',\n  'microsoft.media/mediaservices/streamingendpoints',\n  'microsoft.media/videoanalyzers',\n  'microsoft.monitor/accounts',\n  'microsoft.netapp/netappaccounts/capacitypools',\n  'microsoft.netapp/netappaccounts/capacitypools/volumes',\n  'microsoft.network/applicationgateways',\n  'microsoft.network/azurefirewalls',\n  'microsoft.network/bastionhosts',\n  'microsoft.network/connections',\n  'microsoft.network/dnsresolverpolicies',\n  'microsoft.network/dnszones',\n  'microsoft.network/expressroutecircuits',\n  'microsoft.network/expressroutegateways',\n  'microsoft.network/expressrouteports',\n  'microsoft.network/frontdoors',\n  'microsoft.network/loadbalancers',\n  'microsoft.network/natgateways',\n  'microsoft.network/networkinterfaces',\n  'microsoft.network/networkmanagers',\n  'microsoft.network/networkmanagers/ipampools',\n  'microsoft.network/networksecuritygroups',\n  'microsoft.network/networksecurityperimeters',\n  'microsoft.network/networksecurityperimeters/profiles',\n  'microsoft.network/networkvirtualappliances',\n  'microsoft.network/networkwatchers',\n  'microsoft.network/networkwatchers/connectionmonitors',\n  'microsoft.network/p2svpngateways',\n  'microsoft.network/privateendpoints',\n  'microsoft.network/privatelinkservices',\n  'microsoft.network/publicipaddresses',\n  'microsoft.network/publicipprefixes',\n  'microsoft.network/trafficmanagerprofiles',\n  'microsoft.network/virtualnetworkgateways',\n  'microsoft.network/virtualnetworks',\n  'microsoft.network/vpngateways',\n  'microsoft.networkanalytics/dataproducts',\n  'microsoft.networkcloud/baremetalmachines',\n  'microsoft.networkcloud/clustermanagers',\n  'microsoft.networkcloud/clusters',\n  'microsoft.networkcloud/storageappliances',\n  'microsoft.networkfunction/azuretrafficcollectors',\n  'microsoft.notificationhubs/namespaces',\n  'microsoft.notificationhubs/namespaces/notificationhubs',\n  'microsoft.openlogisticsplatform/workspaces',\n  'microsoft.operationalinsights/workspaces',\n  'microsoft.operationsmanagement/solutions',\n  'microsoft.peering/peeringservices',\n  'microsoft.playfab/titles',\n  'microsoft.powerbi/tenants',\n  'microsoft.powerbi/tenants/workspaces',\n  'microsoft.powerbidedicated/capacities',\n  'microsoft.providerhub/providerregistrations',\n  'microsoft.purview/accounts',\n  'microsoft.recoveryservices/vaults',\n  'microsoft.relay/namespaces',\n  'microsoft.resources/subscriptions',\n  'microsoft.resources/subscriptions/resourcegroups',\n  'microsoft.search/searchservices',\n  'microsoft.security/antimalwaresettings',\n  'microsoft.security/defenderforstoragesettings',\n  'microsoft.securityinsights/settings',\n  'microsoft.servicebus/namespaces',\n  'microsoft.servicenetworking/trafficcontrollers',\n  'microsoft.signalrservice/signalr',\n  'microsoft.signalrservice/signalr/replicas',\n  'microsoft.signalrservice/webpubsub',\n  'microsoft.signalrservice/webpubsub/replicas',\n  'microsoft.singularity/accounts',\n  'microsoft.sql/managedinstances',\n  'microsoft.sql/managedinstances/databases',\n  'microsoft.sql/servers/databases',\n  'microsoft.sql/servers/elasticpools',\n  'microsoft.storage/storageaccounts',\n  'microsoft.storage/storageaccounts/blobservices',\n  'microsoft.storage/storageaccounts/fileservices',\n  'microsoft.storage/storageaccounts/queueservices',\n  'microsoft.storage/storageaccounts/tableservices',\n  'microsoft.storagecache/amlfilesystems',\n  'microsoft.storagecache/caches',\n  'microsoft.storagemover/storagemovers',\n  'microsoft.storagesync/storagesyncservices',\n  'microsoft.streamanalytics/streamingjobs',\n  'microsoft.synapse/workspaces',\n  'microsoft.synapse/workspaces/bigdatapools',\n  'microsoft.synapse/workspaces/kustopools',\n  'microsoft.synapse/workspaces/scopepools',\n  'microsoft.synapse/workspaces/sqlpools',\n  'microsoft.timeseriesinsights/environments',\n  'microsoft.timeseriesinsights/environments/eventsources',\n  'microsoft.videoindexer/accounts',\n  'microsoft.vmwarecloudsimple/virtualmachines',\n  'microsoft.web/hostingenvironments',\n  'microsoft.web/hostingenvironments/workerpools',\n  'microsoft.web/serverfarms',\n  'microsoft.web/sites',\n  'microsoft.web/sites/slots',\n  'microsoft.web/staticsites',\n  'microsoft.workloads/sapvirtualinstances',\n];\n","import { AnnotationQuery } from '@grafana/data';\n\nimport { AzureMonitorQuery, AzureQueryType } from '../types';\n\n// The old Angular annotations editor put some properties (rawQuery, workspace, subscription)\n// on the root annotation object, rather than down in the 'targets' query value\n// This migration moves them to a Log Analytics query compatible with the React query editor\n// The old Angular annotations editor did not support any other query types.\nexport default function migrateAnnotation(annotation: AnnotationQuery<AzureMonitorQuery>) {\n  const oldQuery = typeof annotation.rawQuery === 'string' ? annotation.rawQuery : null;\n  const oldWorkspace = typeof annotation.workspace === 'string' ? annotation.workspace : null;\n\n  if (!(oldQuery && oldWorkspace && !annotation.target?.azureLogAnalytics?.query)) {\n    return annotation;\n  }\n\n  const newQuery: AzureMonitorQuery = {\n    ...(annotation.target ?? {}),\n    refId: annotation.target?.refId ?? 'Anno',\n    queryType: AzureQueryType.LogAnalytics,\n    azureLogAnalytics: {\n      query: oldQuery,\n      resources: [oldWorkspace],\n    },\n  };\n\n  return {\n    ...annotation,\n    rawQuery: undefined,\n    workspace: undefined,\n    subscription: undefined,\n    queryType: undefined,\n    target: newQuery,\n  };\n}\n","import { isGUIDish } from './components/ResourcePicker/utils';\nimport DataSource from './datasource';\nimport { AzureMonitorQuery, AzureQueryType } from './types';\nimport {\n  AppInsightsGroupByQuery,\n  AppInsightsMetricNameQuery,\n  GrafanaTemplateVariableQuery,\n  MetricNamespaceQuery,\n  MetricNamesQuery,\n  ResourceGroupsQuery,\n  ResourceNamesQuery,\n  SubscriptionsQuery,\n  WorkspacesQuery,\n} from './types/templateVariables';\n\n/* \n  Grafana Template Variable Functions\n  ex: Subscriptions()\n\n  These are helper functions we have created and exposed to users to make the writing of template variables easier. \n  Due to legacy reasons, we still need to parse strings to determine if a query is a Grafana Template Variable Function \n  or if it's a KQL-type query\n*/\n\nexport const grafanaTemplateVariableFnMatches = (query: string) => {\n  return {\n    subscriptions: query.match(/^Subscriptions\\(\\)/i),\n    resourceGroups: query.match(/^ResourceGroups\\(\\)/i),\n    resourceGroupsWithSub: query.match(/^ResourceGroups\\(([^\\)]+?)(,\\s?([^,]+?))?\\)/i),\n    namespaces: query.match(/^Namespaces\\(([^\\)]+?)(,\\s?([^,]+?))?\\)/i),\n    namespacesWithSub: query.match(/^Namespaces\\(([^,]+?),\\s?([^,]+?)\\)/i),\n    resourceNames: query.match(/^ResourceNames\\(([^,]+?),\\s?([^,]+?)\\)/i),\n    resourceNamesWithSub: query.match(/^ResourceNames\\(([^,]+?),\\s?([^,]+?),\\s?(.+?)\\)/i),\n    metricNamespace: query.match(/^MetricNamespace\\(([^,]+?),\\s?([^,]+?),\\s?([^,]+?)\\)/i),\n    metricNamespaceWithSub: query.match(/^metricnamespace\\(([^,]+?),\\s?([^,]+?),\\s?([^,]+?),\\s?([^,]+?)\\)/i),\n    metricNames: query.match(/^MetricNames\\(([^,]+?),\\s?([^,]+?),\\s?([^,]+?),\\s?([^,]+?)\\)/i),\n    metricNamesWithSub: query.match(/^MetricNames\\(([^,]+?),\\s?([^,]+?),\\s?([^,]+?),\\s?([^,]+?),\\s?(.+?)\\)/i),\n    appInsightsMetricNameQuery: query.match(/^AppInsightsMetricNames\\(\\)/i),\n    appInsightsGroupByQuery: query.match(/^AppInsightsGroupBys\\(([^\\)]+?)(,\\s?([^,]+?))?\\)/i),\n    workspacesQuery: query.match(/^workspaces\\(\\)/i),\n    workspacesQueryWithSub: query.match(/^workspaces\\([\"']?([^\\)]+?)[\"']?\\)/i),\n  };\n};\n\nconst isGrafanaTemplateVariableFnQuery = (query: string) => {\n  const matches: Record<string, RegExpMatchArray | null> = grafanaTemplateVariableFnMatches(query);\n  return Object.keys(matches).some((key) => !!matches[key]);\n};\n\nconst createGrafanaTemplateVariableQuery = (rawQuery: string, datasource: DataSource): AzureMonitorQuery => {\n  const matchesForQuery = grafanaTemplateVariableFnMatches(rawQuery);\n  const defaultSubscriptionId = datasource.azureMonitorDatasource.defaultSubscriptionId;\n  const createGrafanaTemplateVariableDetails = (): GrafanaTemplateVariableQuery => {\n    // deprecated app insights template variables (will most likely remove in grafana 9)\n    if (matchesForQuery.appInsightsMetricNameQuery) {\n      const queryDetails: AppInsightsMetricNameQuery = { rawQuery, kind: 'AppInsightsMetricNameQuery' };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.appInsightsGroupByQuery) {\n      const queryDetails: AppInsightsGroupByQuery = {\n        kind: 'AppInsightsGroupByQuery',\n        rawQuery,\n        metricName: matchesForQuery.appInsightsGroupByQuery[1],\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.subscriptions) {\n      const queryDetails: SubscriptionsQuery = {\n        kind: 'SubscriptionsQuery',\n        rawQuery,\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.resourceGroupsWithSub) {\n      const queryDetails: ResourceGroupsQuery = {\n        kind: 'ResourceGroupsQuery',\n        rawQuery,\n        subscription: matchesForQuery.resourceGroupsWithSub[1],\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.resourceGroups && defaultSubscriptionId) {\n      const queryDetails: ResourceGroupsQuery = {\n        kind: 'ResourceGroupsQuery',\n        rawQuery,\n        subscription: defaultSubscriptionId,\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.namespacesWithSub) {\n      const queryDetails: MetricNamespaceQuery = {\n        kind: 'MetricNamespaceQuery',\n        rawQuery,\n        subscription: matchesForQuery.namespacesWithSub[1],\n        resourceGroup: matchesForQuery.namespacesWithSub[2],\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.namespaces && defaultSubscriptionId) {\n      const queryDetails: MetricNamespaceQuery = {\n        kind: 'MetricNamespaceQuery',\n        rawQuery,\n        subscription: defaultSubscriptionId,\n        resourceGroup: matchesForQuery.namespaces[1],\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.resourceNamesWithSub) {\n      const queryDetails: ResourceNamesQuery = {\n        kind: 'ResourceNamesQuery',\n        rawQuery,\n        subscription: matchesForQuery.resourceNamesWithSub[1],\n        resourceGroup: matchesForQuery.resourceNamesWithSub[2],\n        metricNamespace: matchesForQuery.resourceNamesWithSub[3],\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.resourceNames && defaultSubscriptionId) {\n      const queryDetails: ResourceNamesQuery = {\n        kind: 'ResourceNamesQuery',\n        rawQuery,\n        subscription: defaultSubscriptionId,\n        resourceGroup: matchesForQuery.resourceNames[1],\n        metricNamespace: matchesForQuery.resourceNames[2],\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.metricNamespaceWithSub) {\n      const queryDetails: MetricNamespaceQuery = {\n        kind: 'MetricNamespaceQuery',\n        rawQuery,\n        subscription: matchesForQuery.metricNamespaceWithSub[1],\n        resourceGroup: matchesForQuery.metricNamespaceWithSub[2],\n        metricNamespace: matchesForQuery.metricNamespaceWithSub[3],\n        resourceName: matchesForQuery.metricNamespaceWithSub[4],\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.metricNamespace && defaultSubscriptionId) {\n      const queryDetails: MetricNamespaceQuery = {\n        kind: 'MetricNamespaceQuery',\n        rawQuery,\n        subscription: defaultSubscriptionId,\n        resourceGroup: matchesForQuery.metricNamespace[1],\n        metricNamespace: matchesForQuery.metricNamespace[2],\n        resourceName: matchesForQuery.metricNamespace[3],\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.metricNames && defaultSubscriptionId) {\n      if (matchesForQuery.metricNames[3].indexOf(',') === -1) {\n        const queryDetails: MetricNamesQuery = {\n          kind: 'MetricNamesQuery',\n          rawQuery,\n          subscription: defaultSubscriptionId,\n          resourceGroup: matchesForQuery.metricNames[1],\n          metricNamespace: matchesForQuery.metricNames[2],\n          resourceName: matchesForQuery.metricNames[3],\n        };\n        return queryDetails;\n      }\n    }\n\n    if (matchesForQuery.metricNamesWithSub) {\n      const queryDetails: MetricNamesQuery = {\n        kind: 'MetricNamesQuery',\n        rawQuery,\n        subscription: matchesForQuery.metricNamesWithSub[1],\n        resourceGroup: matchesForQuery.metricNamesWithSub[2],\n        metricNamespace: matchesForQuery.metricNamesWithSub[3],\n        resourceName: matchesForQuery.metricNamesWithSub[4],\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.workspacesQueryWithSub) {\n      const queryDetails: WorkspacesQuery = {\n        kind: 'WorkspacesQuery',\n        rawQuery,\n        subscription: (matchesForQuery.workspacesQueryWithSub[1] || '').trim(),\n      };\n      return queryDetails;\n    }\n\n    if (matchesForQuery.workspacesQuery && defaultSubscriptionId) {\n      const queryDetails: WorkspacesQuery = {\n        kind: 'WorkspacesQuery',\n        rawQuery,\n        subscription: defaultSubscriptionId,\n      };\n      return queryDetails;\n    }\n\n    // fallback\n    const queryDetails: SubscriptionsQuery = { kind: 'SubscriptionsQuery', rawQuery };\n    return queryDetails;\n  };\n\n  const query: AzureMonitorQuery = {\n    refId: 'A',\n    queryType: AzureQueryType.GrafanaTemplateVariableFn,\n    grafanaTemplateVariableFn: createGrafanaTemplateVariableDetails(),\n    subscription: defaultSubscriptionId,\n  };\n  return query;\n};\n\nconst createLogAnalyticsTemplateVariableQuery = async (\n  rawQuery: string,\n  datasource: DataSource\n): Promise<AzureMonitorQuery> => {\n  const defaultSubscriptionId = datasource.azureMonitorDatasource.defaultSubscriptionId;\n  let resource = '';\n  // if there's an existing query, we try to get the resourcesuri from a deprecated default workspace\n  // a note this is very similar logic to what is used in useMigrations but moved out of the react-hook land\n  if (rawQuery) {\n    const defaultWorkspaceId = datasource.azureLogAnalyticsDatasource.getDeprecatedDefaultWorkSpace();\n    if (defaultWorkspaceId) {\n      const isWorkspaceGUID = isGUIDish(defaultWorkspaceId);\n      if (isWorkspaceGUID) {\n        resource = await datasource.resourcePickerData.getResourceURIFromWorkspace(defaultWorkspaceId);\n      } else {\n        resource = defaultWorkspaceId;\n      }\n    } else {\n      const maybeFirstWorkspace = await datasource.azureLogAnalyticsDatasource.getFirstWorkspace();\n      resource = maybeFirstWorkspace || '';\n    }\n  }\n\n  return {\n    refId: 'A',\n    queryType: AzureQueryType.LogAnalytics,\n    azureLogAnalytics: {\n      query: rawQuery,\n      resources: resource ? [resource] : [],\n    },\n    subscription: defaultSubscriptionId,\n  };\n};\n\nconst migrateGrafanaTemplateVariableFn = (query: AzureMonitorQuery) => {\n  const { queryType, grafanaTemplateVariableFn } = query;\n  if (queryType !== AzureQueryType.GrafanaTemplateVariableFn || !grafanaTemplateVariableFn) {\n    return query;\n  }\n\n  const migratedQuery: AzureMonitorQuery = {\n    ...query,\n  };\n  if ('subscription' in grafanaTemplateVariableFn) {\n    migratedQuery.subscription = grafanaTemplateVariableFn.subscription;\n  }\n  if ('resourceGroup' in grafanaTemplateVariableFn) {\n    migratedQuery.resourceGroup = grafanaTemplateVariableFn.resourceGroup;\n  }\n  if ('metricNamespace' in grafanaTemplateVariableFn) {\n    migratedQuery.namespace = grafanaTemplateVariableFn.metricNamespace;\n  }\n  if ('resourceName' in grafanaTemplateVariableFn) {\n    migratedQuery.resource = grafanaTemplateVariableFn.resourceName;\n  }\n\n  switch (grafanaTemplateVariableFn.kind) {\n    case 'SubscriptionsQuery':\n      migratedQuery.queryType = AzureQueryType.SubscriptionsQuery;\n      break;\n    case 'ResourceGroupsQuery':\n      migratedQuery.queryType = AzureQueryType.ResourceGroupsQuery;\n      break;\n    case 'ResourceNamesQuery':\n      migratedQuery.queryType = AzureQueryType.ResourceNamesQuery;\n      break;\n    case 'MetricNamespaceQuery':\n      migratedQuery.queryType = AzureQueryType.NamespacesQuery;\n      break;\n    case 'MetricDefinitionsQuery':\n      migratedQuery.queryType = AzureQueryType.NamespacesQuery;\n      break;\n    case 'MetricNamesQuery':\n      migratedQuery.queryType = AzureQueryType.MetricNamesQuery;\n      break;\n    case 'WorkspacesQuery':\n      migratedQuery.queryType = AzureQueryType.WorkspacesQuery;\n      break;\n  }\n\n  return migratedQuery;\n};\n\nexport const migrateStringQueriesToObjectQueries = async (\n  rawQuery: string | AzureMonitorQuery,\n  options: { datasource: DataSource }\n): Promise<AzureMonitorQuery> => {\n  // no need to migrate already migrated queries\n  if (typeof rawQuery !== 'string') {\n    return rawQuery;\n  }\n\n  return isGrafanaTemplateVariableFnQuery(rawQuery)\n    ? createGrafanaTemplateVariableQuery(rawQuery, options.datasource)\n    : createLogAnalyticsTemplateVariableQuery(rawQuery, options.datasource);\n};\n\nexport const migrateQuery = async (\n  rawQuery: string | AzureMonitorQuery,\n  options: { datasource: DataSource }\n): Promise<AzureMonitorQuery> => {\n  let query = await migrateStringQueriesToObjectQueries(rawQuery, options);\n\n  if (query.queryType === AzureQueryType.GrafanaTemplateVariableFn) {\n    query = migrateGrafanaTemplateVariableFn(query);\n  }\n\n  return query;\n};\n","import { ChangeEvent, useCallback, useEffect, useState } from 'react';\n\nimport { InlineField, Input } from '@grafana/ui';\n\nimport DataSource from '../../datasource';\nimport { migrateStringQueriesToObjectQueries } from '../../grafanaTemplateVariableFns';\nimport { AzureMonitorQuery, AzureQueryType } from '../../types';\n\nconst GrafanaTemplateVariableFnInput = ({\n  query,\n  updateQuery,\n  datasource,\n}: {\n  query: AzureMonitorQuery;\n  updateQuery: (val: AzureMonitorQuery) => void;\n  datasource: DataSource;\n}) => {\n  const [inputVal, setInputVal] = useState('');\n\n  useEffect(() => {\n    setInputVal(query.grafanaTemplateVariableFn?.rawQuery || '');\n  }, [query.grafanaTemplateVariableFn?.rawQuery]);\n\n  const onRunQuery = useCallback(\n    (newQuery: string) => {\n      migrateStringQueriesToObjectQueries(newQuery, { datasource }).then((updatedQuery) => {\n        if (updatedQuery.queryType === AzureQueryType.GrafanaTemplateVariableFn) {\n          updateQuery(updatedQuery);\n        } else {\n          updateQuery({\n            ...query,\n            grafanaTemplateVariableFn: {\n              kind: 'UnknownQuery',\n              rawQuery: newQuery,\n            },\n          });\n        }\n      });\n    },\n    [datasource, query, updateQuery]\n  );\n\n  const onChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setInputVal(event.target.value);\n  };\n\n  return (\n    <InlineField label=\"Grafana template variable function\">\n      <Input\n        placeholder={'type a grafana template variable function, ex: Subscriptions()'}\n        value={inputVal}\n        onChange={onChange}\n        onBlur={() => onRunQuery(inputVal)}\n      />\n    </InlineField>\n  );\n};\n\nexport default GrafanaTemplateVariableFnInput;\n","import { get, isEqual } from 'lodash';\nimport { useEffect, useState } from 'react';\nimport { useEffectOnce } from 'react-use';\n\nimport { SelectableValue } from '@grafana/data';\nimport { Alert, Field, Select, Space } from '@grafana/ui';\n\nimport DataSource from '../../datasource';\nimport { selectors } from '../../e2e/selectors';\nimport { migrateQuery } from '../../grafanaTemplateVariableFns';\nimport { AzureMonitorOption, AzureMonitorQuery, AzureQueryType } from '../../types';\nimport useLastError from '../../utils/useLastError';\nimport ArgQueryEditor from '../ArgQueryEditor';\nimport LogsQueryEditor from '../LogsQueryEditor';\n\nimport GrafanaTemplateVariableFnInput from './GrafanaTemplateVariableFn';\n\ntype Props = {\n  query: AzureMonitorQuery | string;\n  onChange: (query: AzureMonitorQuery) => void;\n  datasource: DataSource;\n};\n\nconst removeOption: SelectableValue = { label: '-', value: '' };\n\nconst VariableEditor = (props: Props) => {\n  const { query, onChange, datasource } = props;\n  const AZURE_QUERY_VARIABLE_TYPE_OPTIONS = [\n    { label: 'Subscriptions', value: AzureQueryType.SubscriptionsQuery },\n    { label: 'Resource Groups', value: AzureQueryType.ResourceGroupsQuery },\n    { label: 'Namespaces', value: AzureQueryType.NamespacesQuery },\n    { label: 'Regions', value: AzureQueryType.LocationsQuery },\n    { label: 'Resource Names', value: AzureQueryType.ResourceNamesQuery },\n    { label: 'Metric Names', value: AzureQueryType.MetricNamesQuery },\n    { label: 'Workspaces', value: AzureQueryType.WorkspacesQuery },\n    { label: 'Resource Graph', value: AzureQueryType.AzureResourceGraph },\n    { label: 'Logs', value: AzureQueryType.LogAnalytics },\n  ];\n  if (typeof props.query === 'object' && props.query.queryType === AzureQueryType.GrafanaTemplateVariableFn) {\n    // Add the option for the GrafanaTemplateVariableFn only if it's already in use\n    AZURE_QUERY_VARIABLE_TYPE_OPTIONS.push({\n      label: 'Grafana Query Function',\n      value: AzureQueryType.GrafanaTemplateVariableFn,\n    });\n  }\n  const [variableOptionGroup, setVariableOptionGroup] = useState<{ label: string; options: AzureMonitorOption[] }>({\n    label: 'Template Variables',\n    options: [],\n  });\n  const [requireSubscription, setRequireSubscription] = useState(false);\n  const [hasResourceGroup, setHasResourceGroup] = useState(false);\n  const [hasNamespace, setHasNamespace] = useState(false);\n  const [hasRegion, setHasRegion] = useState(false);\n  const [requireResourceGroup, setRequireResourceGroup] = useState(false);\n  const [requireNamespace, setRequireNamespace] = useState(false);\n  const [requireResource, setRequireResource] = useState(false);\n  const [subscriptions, setSubscriptions] = useState<SelectableValue[]>([]);\n  const [resourceGroups, setResourceGroups] = useState<SelectableValue[]>([]);\n  const [namespaces, setNamespaces] = useState<SelectableValue[]>([]);\n  const [resources, setResources] = useState<SelectableValue[]>([]);\n  const [regions, setRegions] = useState<SelectableValue[]>([]);\n  const [errorMessage, setError] = useLastError();\n  const queryType = typeof query === 'string' ? '' : query.queryType;\n\n  useEffect(() => {\n    migrateQuery(query, { datasource: datasource }).then((migratedQuery) => {\n      if (!isEqual(query, migratedQuery)) {\n        onChange(migratedQuery);\n      }\n    });\n  }, [query, datasource, onChange]);\n\n  useEffect(() => {\n    setRequireSubscription(false);\n    setHasResourceGroup(false);\n    setHasNamespace(false);\n    setRequireResourceGroup(false);\n    setRequireNamespace(false);\n    setRequireResource(false);\n    switch (queryType) {\n      case AzureQueryType.ResourceGroupsQuery:\n      case AzureQueryType.WorkspacesQuery:\n        setRequireSubscription(true);\n        break;\n      case AzureQueryType.NamespacesQuery:\n        setRequireSubscription(true);\n        setHasResourceGroup(true);\n        break;\n      case AzureQueryType.ResourceNamesQuery:\n        setRequireSubscription(true);\n        setHasResourceGroup(true);\n        setHasNamespace(true);\n        setHasRegion(true);\n        break;\n      case AzureQueryType.MetricNamesQuery:\n        setRequireSubscription(true);\n        setRequireResourceGroup(true);\n        setRequireNamespace(true);\n        setRequireResource(true);\n        break;\n      case AzureQueryType.LocationsQuery:\n        setRequireSubscription(true);\n        break;\n    }\n  }, [queryType]);\n\n  useEffect(() => {\n    const options: AzureMonitorOption[] = [];\n    datasource.getVariablesRaw().forEach((v) => {\n      if (get(v, 'query.queryType') !== queryType) {\n        options.push({ label: v.label || v.name, value: `$${v.name}` });\n      }\n    });\n    setVariableOptionGroup({\n      label: 'Template Variables',\n      options,\n    });\n  }, [datasource, queryType]);\n\n  useEffectOnce(() => {\n    datasource.getSubscriptions().then((subs) => {\n      setSubscriptions(subs.map((s) => ({ label: s.text, value: s.value })));\n    });\n  });\n\n  const subscription = typeof query === 'object' && query.subscription;\n  useEffect(() => {\n    if (subscription) {\n      datasource.getResourceGroups(subscription).then((rgs) => {\n        setResourceGroups(rgs.map((s) => ({ label: s.text, value: s.value })));\n      });\n    }\n  }, [datasource, subscription]);\n\n  const resourceGroup = (typeof query === 'object' && query.resourceGroup) || '';\n  useEffect(() => {\n    if (subscription) {\n      datasource.getMetricNamespaces(subscription, resourceGroup).then((rgs) => {\n        setNamespaces(rgs.map((s) => ({ label: s.text, value: s.value })));\n      });\n    }\n  }, [datasource, subscription, resourceGroup]);\n\n  useEffect(() => {\n    if (subscription) {\n      datasource.azureMonitorDatasource.getLocations([subscription]).then((rgs) => {\n        const regions: SelectableValue[] = [];\n        rgs.forEach((r) => regions.push({ label: r.displayName, value: r.name }));\n        setRegions(regions);\n      });\n    }\n  }, [datasource, subscription, resourceGroup]);\n\n  const namespace = (typeof query === 'object' && query.namespace) || '';\n  useEffect(() => {\n    if (subscription) {\n      datasource.getResourceNames(subscription, resourceGroup, namespace).then((rgs) => {\n        setResources(rgs.map((s) => ({ label: s.text, value: s.value })));\n      });\n    }\n  }, [datasource, subscription, resourceGroup, namespace]);\n\n  if (typeof query === 'string') {\n    // still migrating the query\n    return null;\n  }\n\n  const onQueryTypeChange = (selectableValue: SelectableValue) => {\n    if (selectableValue.value) {\n      onChange({\n        ...query,\n        queryType: selectableValue.value,\n        subscription: undefined,\n        resourceGroup: undefined,\n        namespace: undefined,\n        resource: undefined,\n      });\n    }\n  };\n\n  const onChangeSubscription = (selectableValue: SelectableValue) => {\n    if (selectableValue.value) {\n      onChange({\n        ...query,\n        subscription: selectableValue.value,\n        resourceGroup: undefined,\n        namespace: undefined,\n        resource: undefined,\n      });\n    }\n  };\n\n  const onChangeResourceGroup = (selectableValue: SelectableValue) => {\n    onChange({\n      ...query,\n      resourceGroup: selectableValue.value,\n      namespace: undefined,\n      resource: undefined,\n    });\n  };\n\n  const onChangeNamespace = (selectableValue: SelectableValue) => {\n    onChange({\n      ...query,\n      namespace: selectableValue.value,\n      resource: undefined,\n    });\n  };\n\n  const onChangeRegion = (selectableValue: SelectableValue) => {\n    onChange({\n      ...query,\n      region: selectableValue.value,\n    });\n  };\n\n  const onChangeResource = (selectableValue: SelectableValue) => {\n    onChange({\n      ...query,\n      resource: selectableValue.value,\n    });\n  };\n\n  const onQueryChange = (queryChange: AzureMonitorQuery) => {\n    onChange(queryChange);\n  };\n\n  return (\n    <>\n      <Field label=\"Query Type\" data-testid={selectors.components.variableEditor.queryType.input}>\n        <Select\n          aria-label=\"select query type\"\n          onChange={onQueryTypeChange}\n          options={AZURE_QUERY_VARIABLE_TYPE_OPTIONS}\n          width={25}\n          value={queryType}\n        />\n      </Field>\n      {query.queryType === AzureQueryType.LogAnalytics && (\n        <>\n          <LogsQueryEditor\n            subscriptionId={query.subscription}\n            query={query}\n            datasource={datasource}\n            onChange={onQueryChange}\n            variableOptionGroup={variableOptionGroup}\n            setError={setError}\n            hideFormatAs={true}\n            basicLogsEnabled={datasource.azureMonitorDatasource.basicLogsEnabled ?? false}\n          />\n          {errorMessage && (\n            <>\n              <Space v={2} />\n              <Alert severity=\"error\" title=\"An error occurred while requesting metadata from Azure Monitor\">\n                {errorMessage instanceof Error ? errorMessage.message : errorMessage}\n              </Alert>\n            </>\n          )}\n        </>\n      )}\n      {query.queryType === AzureQueryType.GrafanaTemplateVariableFn && (\n        <GrafanaTemplateVariableFnInput query={query} updateQuery={props.onChange} datasource={datasource} />\n      )}\n      {requireSubscription && (\n        <Field label=\"Subscription\" data-testid={selectors.components.variableEditor.subscription.input}>\n          <Select\n            aria-label=\"select subscription\"\n            onChange={onChangeSubscription}\n            options={subscriptions.concat(variableOptionGroup)}\n            width={25}\n            value={query.subscription || null}\n          />\n        </Field>\n      )}\n      {(requireResourceGroup || hasResourceGroup) && (\n        <Field label=\"Resource Group\" data-testid={selectors.components.variableEditor.resourceGroup.input}>\n          <Select\n            aria-label=\"select resource group\"\n            onChange={onChangeResourceGroup}\n            options={\n              requireResourceGroup\n                ? resourceGroups.concat(variableOptionGroup)\n                : resourceGroups.concat(variableOptionGroup, removeOption)\n            }\n            width={25}\n            value={query.resourceGroup || null}\n            placeholder={requireResourceGroup ? undefined : 'Optional'}\n          />\n        </Field>\n      )}\n      {(requireNamespace || hasNamespace) && (\n        <Field label=\"Namespace\" data-testid={selectors.components.variableEditor.namespace.input}>\n          <Select\n            aria-label=\"select namespace\"\n            onChange={onChangeNamespace}\n            options={\n              requireNamespace\n                ? namespaces.concat(variableOptionGroup)\n                : namespaces.concat(variableOptionGroup, removeOption)\n            }\n            width={25}\n            value={query.namespace || null}\n            placeholder={requireNamespace ? undefined : 'Optional'}\n          />\n        </Field>\n      )}\n      {hasRegion && (\n        <Field label=\"Region\" data-testid={selectors.components.variableEditor.region.input}>\n          <Select\n            aria-label=\"select region\"\n            onChange={onChangeRegion}\n            options={regions.concat(variableOptionGroup)}\n            width={25}\n            value={query.region || null}\n            placeholder=\"Optional\"\n          />\n        </Field>\n      )}\n      {requireResource && (\n        <Field label=\"Resource\" data-testid={selectors.components.variableEditor.resource.input}>\n          <Select\n            aria-label=\"select resource\"\n            onChange={onChangeResource}\n            options={resources.concat(variableOptionGroup)}\n            width={25}\n            value={query.resource || null}\n          />\n        </Field>\n      )}\n      {query.queryType === AzureQueryType.AzureResourceGraph && (\n        <>\n          <ArgQueryEditor\n            subscriptionId={datasource.azureLogAnalyticsDatasource.defaultSubscriptionId}\n            query={query}\n            datasource={datasource}\n            onChange={onQueryChange}\n            variableOptionGroup={variableOptionGroup}\n            setError={setError}\n          />\n          {errorMessage && (\n            <>\n              <Space v={2} />\n              <Alert severity=\"error\" title=\"An error occurred while requesting metadata from Azure Monitor\">\n                {errorMessage instanceof Error ? errorMessage.message : errorMessage}\n              </Alert>\n            </>\n          )}\n        </>\n      )}\n    </>\n  );\n};\n\nexport default VariableEditor;\n","import { from, lastValueFrom, Observable } from 'rxjs';\n\nimport {\n  CustomVariableSupport,\n  DataQueryRequest,\n  DataQueryResponse,\n  MetricFindValue,\n  toDataFrame,\n} from '@grafana/data';\nimport { getTemplateSrv, TemplateSrv } from '@grafana/runtime';\n\nimport VariableEditor from './components/VariableEditor/VariableEditor';\nimport DataSource from './datasource';\nimport { migrateQuery } from './grafanaTemplateVariableFns';\nimport { AzureMonitorQuery, AzureQueryType } from './types';\nimport { GrafanaTemplateVariableQuery } from './types/templateVariables';\nimport messageFromError from './utils/messageFromError';\n\nexport class VariableSupport extends CustomVariableSupport<DataSource, AzureMonitorQuery> {\n  constructor(\n    private readonly datasource: DataSource,\n    private readonly templateSrv: TemplateSrv = getTemplateSrv()\n  ) {\n    super();\n    this.datasource = datasource;\n  }\n\n  editor = VariableEditor;\n\n  hasValue(...values: string[]) {\n    return values.every((v) => !!this.templateSrv.replace(v));\n  }\n\n  query(request: DataQueryRequest<AzureMonitorQuery>): Observable<DataQueryResponse> {\n    const promisedResults = async () => {\n      const queryObj = await migrateQuery(request.targets[0], { datasource: this.datasource });\n\n      try {\n        switch (queryObj.queryType) {\n          case AzureQueryType.SubscriptionsQuery:\n            const res = await this.datasource.getSubscriptions();\n            return {\n              data: res?.length ? [toDataFrame(res)] : [],\n            };\n          case AzureQueryType.ResourceGroupsQuery:\n            if (queryObj.subscription && this.hasValue(queryObj.subscription)) {\n              const rgs = await this.datasource.getResourceGroups(queryObj.subscription);\n              return {\n                data: rgs?.length ? [toDataFrame(rgs)] : [],\n              };\n            }\n            return { data: [] };\n          case AzureQueryType.NamespacesQuery:\n            if (queryObj.subscription && this.hasValue(queryObj.subscription)) {\n              const rgs = await this.datasource.getMetricNamespaces(queryObj.subscription, queryObj.resourceGroup);\n              return {\n                data: rgs?.length ? [toDataFrame(rgs)] : [],\n              };\n            }\n            return { data: [] };\n          case AzureQueryType.ResourceNamesQuery:\n            if (queryObj.subscription && this.hasValue(queryObj.subscription)) {\n              const rgs = await this.datasource.getResourceNames(\n                queryObj.subscription,\n                queryObj.resourceGroup,\n                queryObj.namespace,\n                queryObj.region\n              );\n              return {\n                data: rgs?.length ? [toDataFrame(rgs)] : [],\n              };\n            }\n            return { data: [] };\n          case AzureQueryType.MetricNamesQuery:\n            if (\n              queryObj.subscription &&\n              queryObj.resourceGroup &&\n              queryObj.namespace &&\n              queryObj.resource &&\n              this.hasValue(queryObj.subscription, queryObj.resourceGroup, queryObj.namespace, queryObj.resource)\n            ) {\n              const rgs = await this.datasource.getMetricNames(\n                queryObj.subscription,\n                queryObj.resourceGroup,\n                queryObj.namespace,\n                queryObj.resource\n              );\n              return {\n                data: rgs?.length ? [toDataFrame(rgs)] : [],\n              };\n            }\n            return { data: [] };\n          case AzureQueryType.WorkspacesQuery:\n            if (queryObj.subscription && this.hasValue(queryObj.subscription)) {\n              const rgs = await this.datasource.getAzureLogAnalyticsWorkspaces(queryObj.subscription);\n              return {\n                data: rgs?.length ? [toDataFrame(rgs)] : [],\n              };\n            }\n            return { data: [] };\n          case AzureQueryType.GrafanaTemplateVariableFn:\n            if (queryObj.grafanaTemplateVariableFn) {\n              const templateVariablesResults = await this.callGrafanaTemplateVariableFn(\n                queryObj.grafanaTemplateVariableFn\n              );\n              return {\n                data: templateVariablesResults?.length ? [toDataFrame(templateVariablesResults)] : [],\n              };\n            }\n            return { data: [] };\n          case AzureQueryType.LocationsQuery:\n            if (queryObj.subscription && this.hasValue(queryObj.subscription)) {\n              const locationMap = await this.datasource.azureMonitorDatasource.getLocations([queryObj.subscription]);\n              const res: Array<{ text: string; value: string }> = [];\n              locationMap.forEach((loc) => {\n                res.push({ text: loc.displayName, value: loc.name });\n              });\n              return {\n                data: res?.length ? [toDataFrame(res)] : [],\n              };\n            }\n          default:\n            request.targets[0] = queryObj;\n            const queryResp = await lastValueFrom(this.datasource.query(request));\n            return {\n              data: queryResp.data,\n              error: queryResp.error ? new Error(messageFromError(queryResp.error)) : undefined,\n            };\n        }\n      } catch (err) {\n        return { data: [], error: new Error(messageFromError(err)) };\n      }\n    };\n\n    return from(promisedResults());\n  }\n\n  // Deprecated\n  callGrafanaTemplateVariableFn(query: GrafanaTemplateVariableQuery): Promise<MetricFindValue[]> | null {\n    if (query.kind === 'SubscriptionsQuery') {\n      return this.datasource.getSubscriptions();\n    }\n\n    if (query.kind === 'ResourceGroupsQuery') {\n      return this.datasource.getResourceGroups(this.replaceVariable(query.subscription));\n    }\n\n    if (query.kind === 'ResourceNamesQuery') {\n      return this.datasource.getResourceNames(\n        this.replaceVariable(query.subscription),\n        this.replaceVariable(query.resourceGroup),\n        this.replaceVariable(query.metricNamespace)\n      );\n    }\n\n    if (query.kind === 'MetricNamespaceQuery') {\n      return this.datasource.azureMonitorDatasource.getMetricNamespaces(query, true);\n    }\n\n    if (query.kind === 'MetricNamesQuery') {\n      return this.datasource.azureMonitorDatasource.getMetricNames(query);\n    }\n\n    if (query.kind === 'WorkspacesQuery') {\n      return this.datasource.azureLogAnalyticsDatasource.getWorkspaces(this.replaceVariable(query.subscription));\n    }\n\n    return null;\n  }\n\n  replaceVariable(metric: string) {\n    return this.templateSrv.replace((metric || '').trim());\n  }\n}\n","import { cloneDeep } from 'lodash';\nimport { forkJoin, Observable, of } from 'rxjs';\nimport { map } from 'rxjs/operators';\n\nimport {\n  DataFrame,\n  DataQueryRequest,\n  DataQueryResponse,\n  DataSourceInstanceSettings,\n  LoadingState,\n  QueryFixAction,\n  ScopedVars,\n} from '@grafana/data';\nimport { DataSourceWithBackend, getTemplateSrv, TemplateSrv } from '@grafana/runtime';\n\nimport AzureLogAnalyticsDatasource from './azure_log_analytics/azure_log_analytics_datasource';\nimport AzureMonitorDatasource from './azure_monitor/azure_monitor_datasource';\nimport AzureResourceGraphDatasource from './azure_resource_graph/azure_resource_graph_datasource';\nimport { instanceOfAzureCredential, isCredentialsComplete } from './credentials';\nimport ResourcePickerData from './resourcePicker/resourcePickerData';\nimport { AadCurrentUserCredentials, AzureDataSourceJsonData, AzureMonitorQuery, AzureQueryType } from './types';\nimport migrateAnnotation from './utils/migrateAnnotation';\nimport migrateQuery from './utils/migrateQuery';\nimport { VariableSupport } from './variables';\n\nexport default class Datasource extends DataSourceWithBackend<AzureMonitorQuery, AzureDataSourceJsonData> {\n  annotations = {\n    prepareAnnotation: migrateAnnotation,\n  };\n\n  azureMonitorDatasource: AzureMonitorDatasource;\n  azureLogAnalyticsDatasource: AzureLogAnalyticsDatasource;\n  resourcePickerData: ResourcePickerData;\n  azureResourceGraphDatasource: AzureResourceGraphDatasource;\n  currentUserAuth: boolean;\n  currentUserAuthFallbackAvailable: boolean;\n\n  pseudoDatasource: {\n    [key in AzureQueryType]?: AzureMonitorDatasource | AzureLogAnalyticsDatasource | AzureResourceGraphDatasource;\n  } = {};\n\n  declare optionsKey: Record<AzureQueryType, string>;\n\n  constructor(\n    instanceSettings: DataSourceInstanceSettings<AzureDataSourceJsonData>,\n    private readonly templateSrv: TemplateSrv = getTemplateSrv()\n  ) {\n    super(instanceSettings);\n    this.azureMonitorDatasource = new AzureMonitorDatasource(instanceSettings);\n    this.azureLogAnalyticsDatasource = new AzureLogAnalyticsDatasource(instanceSettings);\n    this.azureResourceGraphDatasource = new AzureResourceGraphDatasource(instanceSettings);\n    this.resourcePickerData = new ResourcePickerData(instanceSettings, this.azureMonitorDatasource);\n\n    this.pseudoDatasource = {\n      [AzureQueryType.AzureMonitor]: this.azureMonitorDatasource,\n      [AzureQueryType.LogAnalytics]: this.azureLogAnalyticsDatasource,\n      [AzureQueryType.AzureResourceGraph]: this.azureResourceGraphDatasource,\n      [AzureQueryType.AzureTraces]: this.azureLogAnalyticsDatasource,\n    };\n\n    this.variables = new VariableSupport(this);\n\n    this.currentUserAuth = instanceSettings.jsonData.azureAuthType === 'currentuser';\n    const credentials = instanceSettings.jsonData.azureCredentials;\n    if (credentials && instanceOfAzureCredential<AadCurrentUserCredentials>('currentuser', credentials)) {\n      if (!credentials.serviceCredentials) {\n        this.currentUserAuthFallbackAvailable = false;\n      } else {\n        this.currentUserAuthFallbackAvailable = isCredentialsComplete(credentials.serviceCredentials, true);\n      }\n    } else {\n      this.currentUserAuthFallbackAvailable = false;\n    }\n  }\n\n  filterQuery(item: AzureMonitorQuery): boolean {\n    if (!item.queryType) {\n      return false;\n    }\n\n    const query = migrateQuery(item);\n    const ds = this.pseudoDatasource[item.queryType];\n    return ds?.filterQuery?.(query) ?? true;\n  }\n\n  query(options: DataQueryRequest<AzureMonitorQuery>): Observable<DataQueryResponse> {\n    const byType = new Map<AzureQueryType, DataQueryRequest<AzureMonitorQuery>>();\n\n    for (const baseTarget of options.targets) {\n      // Migrate old query structures\n      const target = migrateQuery(baseTarget);\n\n      // Skip hidden or invalid queries or ones without properties\n      if (!target.queryType || target.hide || !hasQueryForType(target)) {\n        continue;\n      }\n\n      // Initialize the list of queries\n      if (!byType.has(target.queryType)) {\n        const queryForType = cloneDeep(options);\n        queryForType.requestId = `${queryForType.requestId}-${target.refId}`;\n        queryForType.targets = [];\n        byType.set(target.queryType, queryForType);\n      }\n\n      const queryForType = byType.get(target.queryType);\n      queryForType?.targets.push(target);\n    }\n\n    const observables: Array<Observable<DataQueryResponse>> = Array.from(byType.entries()).map(([queryType, req]) => {\n      let mappedQueryType = queryType;\n      if (queryType === AzureQueryType.AzureTraces || queryType === AzureQueryType.TraceExemplar) {\n        mappedQueryType = AzureQueryType.LogAnalytics;\n      }\n\n      const ds = this.pseudoDatasource[mappedQueryType];\n      if (!ds) {\n        throw new Error('Data source not created for query type ' + queryType);\n      }\n\n      return ds.query(req);\n    });\n\n    // Single query can skip merge\n    if (observables.length === 1) {\n      return observables[0];\n    }\n\n    if (observables.length > 1) {\n      return forkJoin(observables).pipe(\n        map((results: DataQueryResponse[]) => {\n          const data: DataFrame[] = [];\n          for (const result of results) {\n            for (const frame of result.data) {\n              data.push(frame);\n            }\n          }\n\n          return { state: LoadingState.Done, data };\n        })\n      );\n    }\n\n    return of({ state: LoadingState.Done, data: [] });\n  }\n\n  targetContainsTemplate(query: AzureMonitorQuery) {\n    if (query.subscription && this.templateSrv.containsTemplate(query.subscription)) {\n      return true;\n    }\n\n    let subQuery;\n    if (query.queryType === AzureQueryType.AzureMonitor) {\n      subQuery = JSON.stringify(query.azureMonitor);\n    } else if (query.queryType === AzureQueryType.LogAnalytics) {\n      subQuery = JSON.stringify(query.azureLogAnalytics);\n    } else if (query.queryType === AzureQueryType.AzureResourceGraph) {\n      subQuery = JSON.stringify([query.azureResourceGraph, query.subscriptions]);\n    }\n\n    return !!subQuery && this.templateSrv.containsTemplate(subQuery);\n  }\n\n  /* Azure Monitor REST API methods */\n  getResourceGroups(subscriptionId: string) {\n    return this.azureMonitorDatasource.getResourceGroups(this.templateSrv.replace(subscriptionId));\n  }\n\n  getMetricNamespaces(subscriptionId: string, resourceGroup?: string) {\n    let url = `/subscriptions/${subscriptionId}`;\n    if (resourceGroup) {\n      url += `/resourceGroups/${resourceGroup}`;\n    }\n    return this.azureMonitorDatasource.getMetricNamespaces({ resourceUri: url }, true);\n  }\n\n  getResourceNames(subscriptionId: string, resourceGroup?: string, metricNamespace?: string, region?: string) {\n    return this.azureMonitorDatasource.getResourceNames({ subscriptionId, resourceGroup, metricNamespace, region });\n  }\n\n  getMetricNames(subscriptionId: string, resourceGroup: string, metricNamespace: string, resourceName: string) {\n    return this.azureMonitorDatasource.getMetricNames({\n      subscription: subscriptionId,\n      resourceGroup,\n      metricNamespace,\n      resourceName,\n    });\n  }\n\n  /*Azure Log Analytics */\n  getAzureLogAnalyticsWorkspaces(subscriptionId: string) {\n    return this.azureLogAnalyticsDatasource.getWorkspaces(subscriptionId);\n  }\n\n  getSubscriptions() {\n    return this.azureMonitorDatasource.getSubscriptions();\n  }\n\n  interpolateVariablesInQueries(queries: AzureMonitorQuery[], scopedVars: ScopedVars): AzureMonitorQuery[] {\n    const mapped = queries.map((query) => {\n      if (!query.queryType) {\n        return query;\n      }\n\n      const queryType = query.queryType === AzureQueryType.AzureTraces ? AzureQueryType.LogAnalytics : query.queryType;\n      const ds = this.pseudoDatasource[queryType];\n      return {\n        datasource: ds?.getRef(),\n        ...(ds?.applyTemplateVariables(query, scopedVars) ?? query),\n      };\n    });\n\n    return mapped;\n  }\n\n  getVariables() {\n    return this.templateSrv.getVariables().map((v) => `$${v.name}`);\n  }\n\n  getVariablesRaw() {\n    return this.templateSrv.getVariables();\n  }\n\n  modifyQuery(query: AzureMonitorQuery, action: QueryFixAction): AzureMonitorQuery {\n    if (!action.options) {\n      return query;\n    }\n    let expression = query.azureLogAnalytics?.query;\n    if (expression === undefined) {\n      return query;\n    }\n    switch (action.type) {\n      case 'ADD_FILTER': {\n        expression += `\\n| where ${action.options.key} == \"${action.options.value}\"`;\n        break;\n      }\n      case 'ADD_FILTER_OUT': {\n        expression += `\\n| where ${action.options.key} != \"${action.options.value}\"`;\n        break;\n      }\n    }\n    return { ...query, azureLogAnalytics: { ...query.azureLogAnalytics, query: expression } };\n  }\n}\n\nfunction hasQueryForType(query: AzureMonitorQuery): boolean {\n  switch (query.queryType) {\n    case AzureQueryType.AzureMonitor:\n      return !!query.azureMonitor;\n\n    case AzureQueryType.LogAnalytics:\n      return !!query.azureLogAnalytics;\n\n    case AzureQueryType.AzureResourceGraph:\n      return !!query.azureResourceGraph;\n\n    case AzureQueryType.AzureTraces:\n    case AzureQueryType.TraceExemplar:\n      return !!query.azureTraces;\n\n    case AzureQueryType.GrafanaTemplateVariableFn:\n      return !!query.grafanaTemplateVariableFn;\n\n    default:\n      return false;\n  }\n}\n","import { DataSourcePlugin, DashboardLoadedEvent } from '@grafana/data';\nimport { getAppEvents } from '@grafana/runtime';\n\nimport { ConfigEditor } from './components/ConfigEditor/ConfigEditor';\nimport AzureMonitorQueryEditor from './components/QueryEditor';\nimport Datasource from './datasource';\nimport pluginJson from './plugin.json';\nimport { trackAzureMonitorDashboardLoaded } from './tracking';\nimport { AzureMonitorQuery, AzureDataSourceJsonData, AzureQueryType, ResultFormat } from './types';\n\nexport const plugin = new DataSourcePlugin<Datasource, AzureMonitorQuery, AzureDataSourceJsonData>(Datasource)\n  .setConfigEditor(ConfigEditor)\n  .setQueryEditor(AzureMonitorQueryEditor);\n\ninterface Statistics {\n  hidden: number;\n  visible: number;\n  multiResource: number;\n  count: number;\n  [key: string]: number;\n}\n\n// Track dashboard loads to RudderStack\ngetAppEvents().subscribe<DashboardLoadedEvent<AzureMonitorQuery>>(\n  DashboardLoadedEvent,\n  ({ payload: { dashboardId, orgId, userId, grafanaVersion, queries } }) => {\n    const azureQueries = queries[pluginJson.id];\n    const common = {\n      hidden: 0,\n      visible: 0,\n      multiResource: 0,\n      count: 0,\n    };\n    let stats: { [key in AzureQueryType | string]: Statistics } = {\n      [AzureQueryType.AzureMonitor]: {\n        ...common,\n      },\n      [AzureQueryType.LogAnalytics]: {\n        ...common,\n        grafanaTime: 0,\n        queryTime: 0,\n      },\n      [AzureQueryType.AzureResourceGraph]: {\n        ...common,\n      },\n      [AzureQueryType.AzureTraces]: {\n        ...common,\n        table: 0,\n        trace: 0,\n        operationIdSpecified: 0,\n        eventTypesSpecified: 0,\n        filtersSpecified: 0,\n      },\n      [AzureQueryType.SubscriptionsQuery]: { ...common },\n      [AzureQueryType.ResourceGroupsQuery]: { ...common },\n      [AzureQueryType.NamespacesQuery]: { ...common },\n      [AzureQueryType.ResourceNamesQuery]: { ...common },\n      [AzureQueryType.MetricNamesQuery]: { ...common },\n      [AzureQueryType.WorkspacesQuery]: { ...common },\n      [AzureQueryType.GrafanaTemplateVariableFn]: { ...common },\n      [AzureQueryType.LocationsQuery]: { ...common },\n      unknown: { ...common },\n    };\n\n    azureQueries.forEach((query) => {\n      if (query.queryType === AzureQueryType.AzureMonitor) {\n        stats[AzureQueryType.AzureMonitor][query.hide ? 'hidden' : 'visible']++;\n        if (query.azureMonitor?.resources && query.azureMonitor.resources.length > 1) {\n          stats[AzureQueryType.AzureMonitor].multiResource++;\n        }\n      }\n      if (query.queryType === AzureQueryType.LogAnalytics) {\n        stats[AzureQueryType.LogAnalytics][query.hide ? 'hidden' : 'visible']++;\n        stats[AzureQueryType.LogAnalytics][query.azureLogAnalytics?.dashboardTime ? 'grafanaTime' : 'queryTime']++;\n        if (query.azureLogAnalytics?.resources && query.azureLogAnalytics.resources.length > 1) {\n          stats[AzureQueryType.LogAnalytics].multiResource++;\n        }\n      }\n      if (query.queryType === AzureQueryType.AzureResourceGraph) {\n        stats[AzureQueryType.AzureResourceGraph][query.hide ? 'hidden' : 'visible']++;\n        if (query.subscriptions && query.subscriptions.length > 1) {\n          stats[AzureQueryType.AzureResourceGraph].multiResource++;\n        }\n      }\n      if (query.queryType === AzureQueryType.AzureTraces) {\n        stats[AzureQueryType.AzureTraces][query.hide ? 'hidden' : 'visible']++;\n        if (query.azureTraces) {\n          if (query.azureTraces.resultFormat) {\n            stats[AzureQueryType.AzureTraces][\n              query.azureTraces.resultFormat === ResultFormat.Trace ? ResultFormat.Trace : ResultFormat.Table\n            ]++;\n          }\n          if (query.azureTraces.resources && query.azureTraces.resources.length > 1) {\n            stats[AzureQueryType.AzureTraces].multiResource++;\n          }\n          if (query.azureTraces.operationId && query.azureTraces.operationId !== '') {\n            stats[AzureQueryType.AzureTraces].operationIdSpecified++;\n          }\n          if (query.azureTraces.traceTypes && query.azureTraces.traceTypes.length > 0) {\n            stats[AzureQueryType.AzureTraces].eventTypesSpecified++;\n          }\n          if (query.azureTraces.filters && query.azureTraces.filters.length > 0) {\n            stats[AzureQueryType.AzureTraces].filtersSpecified++;\n          }\n        }\n      }\n\n      switch (query.queryType) {\n        case AzureQueryType.AzureMonitor:\n        case AzureQueryType.LogAnalytics:\n        case AzureQueryType.AzureResourceGraph:\n        case AzureQueryType.AzureTraces:\n        case AzureQueryType.SubscriptionsQuery:\n        case AzureQueryType.ResourceGroupsQuery:\n        case AzureQueryType.NamespacesQuery:\n        case AzureQueryType.ResourceNamesQuery:\n        case AzureQueryType.MetricNamesQuery:\n        case AzureQueryType.WorkspacesQuery:\n        case AzureQueryType.GrafanaTemplateVariableFn:\n        case AzureQueryType.LocationsQuery:\n          stats[query.queryType].count++;\n          break;\n        default:\n          stats.unknown.count++;\n      }\n    });\n\n    if (azureQueries && azureQueries.length > 0) {\n      trackAzureMonitorDashboardLoaded({\n        grafana_version: grafanaVersion,\n        dashboard_id: dashboardId,\n        org_id: orgId,\n        // Metrics queries stats\n        azure_monitor_queries: stats[AzureQueryType.AzureMonitor].visible,\n        azure_monitor_queries_hidden: stats[AzureQueryType.AzureMonitor].hidden,\n        azure_monitor_multiple_resource: stats[AzureQueryType.AzureMonitor].multiResource,\n        azure_monitor_query: stats[AzureQueryType.AzureMonitor].count,\n\n        // Logs queries stats\n        azure_log_analytics_queries: stats[AzureQueryType.LogAnalytics].visible,\n        azure_log_analytics_queries_hidden: stats[AzureQueryType.LogAnalytics].hidden,\n        azure_log_multiple_resource: stats[AzureQueryType.LogAnalytics].multiResource,\n        azure_log_analytics_queries_grafana_time: stats[AzureQueryType.LogAnalytics].grafanaTime,\n        azure_log_analytics_queries_query_time: stats[AzureQueryType.LogAnalytics].queryTime,\n        azure_log_query: stats[AzureQueryType.LogAnalytics].count,\n\n        // ARG queries stats\n        azure_resource_graph_queries: stats[AzureQueryType.AzureResourceGraph].visible,\n        azure_resource_graph_queries_hidden: stats[AzureQueryType.AzureResourceGraph].hidden,\n        azure_resource_graph_multiple_subscription: stats[AzureQueryType.AzureResourceGraph].multiResource,\n        azure_resource_graph_query: stats[AzureQueryType.AzureResourceGraph].count,\n\n        // Traces queries stats\n        azure_traces_queries: stats[AzureQueryType.AzureTraces].visible,\n        azure_traces_queries_hidden: stats[AzureQueryType.AzureTraces].hidden,\n        azure_traces_multiple_resource: stats[AzureQueryType.AzureTraces].multiResource,\n        azure_traces_table: stats[AzureQueryType.AzureTraces].table,\n        azure_traces_trace: stats[AzureQueryType.AzureTraces].trace,\n        azure_traces_operation_id_specified: stats[AzureQueryType.AzureTraces].operationIdSpecified,\n        azure_traces_event_type_specified: stats[AzureQueryType.AzureTraces].eventTypesSpecified,\n        azure_traces_filters: stats[AzureQueryType.AzureTraces].filtersSpecified,\n        azure_traces_query: stats[AzureQueryType.AzureTraces].count,\n\n        // Variable queries stats\n        azure_subscriptions_query: stats[AzureQueryType.SubscriptionsQuery].count,\n        azure_resource_groups_query: stats[AzureQueryType.ResourceGroupsQuery].count,\n        azure_namespaces_query: stats[AzureQueryType.NamespacesQuery].count,\n        azure_resource_names_query: stats[AzureQueryType.ResourceNamesQuery].count,\n        azure_metric_names_query: stats[AzureQueryType.MetricNamesQuery].count,\n        azure_workspaces_query: stats[AzureQueryType.WorkspacesQuery].count,\n        azure_grafana_template_variable_query: stats[AzureQueryType.GrafanaTemplateVariableFn].count,\n        azure_locations_query: stats[AzureQueryType.LocationsQuery].count,\n\n        // Unknown query type\n        azure_unknown_query: stats.unknown.count,\n      });\n    }\n  }\n);\n","import { reportInteraction } from '@grafana/runtime';\n\n/**\n * Loaded the first time a dashboard containing azure queries is loaded (not on every render)\n * Note: The queries used here are the ones pre-migration and pre-filterQuery\n *\n * This allows answering questions about:\n * - the adoption of the three query types (Azure Monitor, Azure Logs Analytics and Azure Resource Graph)\n * - stats about number of azure dashboards loaded, number of users\n * - stats about the grafana and plugins versions used by our users\n *\n * Dashboard: https://ops.grafana.net/d/Ad0pti0N/data-sources-adoption-tracking?orgId=1\n * Changelog:\n * - v9.1.0 : list of queries logged\n * - v9.1.2 : list removed in favour of stats, user_id removed\n */\nexport const trackAzureMonitorDashboardLoaded = (props: AzureMonitorDashboardLoadedProps) => {\n  reportInteraction('grafana_ds_azuremonitor_dashboard_loaded', props);\n};\n\nexport type AzureMonitorDashboardLoadedProps = {\n  grafana_version?: string;\n  dashboard_id: string;\n  org_id?: number;\n\n  /** number of non hidden queries of type Azure Monitor if any  */\n  azure_monitor_queries: number;\n  /** number of hidden queries (not executed) of type Azure Monitor if any  */\n  azure_monitor_queries_hidden: number;\n  /** number of Azure Monitor queries using multiple resources */\n  azure_monitor_multiple_resource: number;\n  /** number of Azure Monitor queries */\n  azure_monitor_query: number;\n\n  /** number of non hidden queries of type Azure Logs Analytics if any  */\n  azure_log_analytics_queries: number;\n  /** number of hidden queries (not executed) of type Azure Logs Analytics if any  */\n  azure_log_analytics_queries_hidden: number;\n  /** number of Azure Log Analytics queries using multiple resources */\n  azure_log_multiple_resource: number;\n  /** number of Azure Log Analytics queries using time-range defined explicitly in query */\n  azure_log_analytics_queries_query_time: number;\n  /** number of Azure Log Analytics queries using Grafana time-range */\n  azure_log_analytics_queries_grafana_time: number;\n  /** number of Azure Log Analytics queries */\n  azure_log_query: number;\n\n  /** number of non hidden queries of type Azure Resource Graph if any  */\n  azure_resource_graph_queries: number;\n  /** number of hidden queries (not executed) of type Azure Resource Graph if any  */\n  azure_resource_graph_queries_hidden: number;\n  /** number of Azure Resource Graph queries using multiple subscriptions */\n  azure_resource_graph_multiple_subscription: number;\n  /** number of Azure Resource Graph queries */\n  azure_resource_graph_query: number;\n\n  /** number of non hidden queries of type Azure Traces if any  */\n  azure_traces_queries: number;\n  /** number of hidden queries of type Azure Traces if any  */\n  azure_traces_queries_hidden: number;\n  /** number of trace queries using multiple resources */\n  azure_traces_multiple_resource: number;\n  /** number of trace queries using table format */\n  azure_traces_table: number;\n  /** number of trace queries using trace format */\n  azure_traces_trace: number;\n  /** number of trace queries specifying operation ID */\n  azure_traces_operation_id_specified: number;\n  /** number of trace queries specifying event types */\n  azure_traces_event_type_specified: number;\n  /** number of trace queries using filters */\n  azure_traces_filters: number;\n  /** number of Azure Traces queries */\n  azure_traces_query: number;\n\n  /** variable query tracking */\n  azure_subscriptions_query: number;\n  azure_resource_groups_query: number;\n  azure_namespaces_query: number;\n  azure_resource_names_query: number;\n  azure_metric_names_query: number;\n  azure_workspaces_query: number;\n  azure_grafana_template_variable_query: number;\n  azure_locations_query: number;\n  azure_unknown_query: number;\n};\n"],"names":["module","exports","equal","a","b","constructor","length","i","keys","Array","isArray","RegExp","source","flags","valueOf","Object","prototype","toString","hasOwnProperty","call","key","reactIs","REACT_STATICS","childContextTypes","contextType","contextTypes","defaultProps","displayName","getDefaultProps","getDerivedStateFromError","getDerivedStateFromProps","mixins","propTypes","type","KNOWN_STATICS","name","caller","callee","arguments","arity","MEMO_STATICS","compare","TYPE_STATICS","getStatics","component","isMemo","ForwardRef","render","Memo","defineProperty","getOwnPropertyNames","getOwnPropertySymbols","getOwnPropertyDescriptor","getPrototypeOf","objectPrototype","hoistNonReactStatics","targetComponent","sourceComponent","blacklist","inheritedComponent","concat","targetStatics","sourceStatics","descriptor","e","Symbol","for","c","d","f","g","h","k","l","m","n","p","q","r","t","v","w","x","y","z","u","$$typeof","A","AsyncMode","ConcurrentMode","ContextConsumer","ContextProvider","Element","Fragment","Lazy","Portal","Profiler","StrictMode","Suspense","isAsyncMode","isConcurrentMode","isContextConsumer","isContextProvider","isElement","isForwardRef","isFragment","isLazy","isPortal","isProfiler","isStrictMode","isSuspense","isValidElementType","typeOf","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","ReactCurrentOwner","ref","__self","__source","props","_owner","current","jsx","jsxs","__WEBPACK_EXTERNAL_MODULE__89__","__WEBPACK_EXTERNAL_MODULE__781__","__WEBPACK_EXTERNAL_MODULE__531__","__WEBPACK_EXTERNAL_MODULE__7__","__WEBPACK_EXTERNAL_MODULE__831__","__WEBPACK_EXTERNAL_MODULE__241__","__WEBPACK_EXTERNAL_MODULE__146__","__WEBPACK_EXTERNAL_MODULE__959__","__WEBPACK_EXTERNAL_MODULE__269__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","definition","o","enumerable","get","obj","prop","toStringTag","value","__defProp","__defProps","defineProperties","__getOwnPropDescs","getOwnPropertyDescriptors","__getOwnPropSymbols","__hasOwnProp","__propIsEnum","propertyIsEnumerable","__defNormalProp","configurable","writable","__spreadValues","DataSourceDescription","dataSourceName","docsLink","hasRequiredFields","className","theme","useTheme2","styles","container","css","margin","marginTop","spacing","text","typography","body","color","colors","secondary","link","textDecoration","cx","href","target","rel","GenericConfigSection","children","title","description","isCollapsible","isInitiallyOpen","kind","isOpen","setIsOpen","useState","iconName","isSubSection","collapsibleButtonAriaLabel","header","display","justifyContent","alignItems","subtitle","fontWeight","fontWeightRegular","descriptionText","marginBottom","bodySmall","content","IconButton","onClick","size","ConfigSection","_a","_b","exclude","indexOf","__objRest","TimeGrainConverter","createISO8601Duration","timeGrain","timeGrainUnit","includes","toUpperCase","createISO8601DurationFromInterval","interval","slice","unit","toMinutes","findClosestTimeGrain","allowedTimeGrains","timeGrains","filter","closest","intervalMs","rangeUtil","intervalToMs","createTimeGrainFromISO8601Duration","duration","offset","substring","timeUnitToText","createKbnUnitFromISO8601Duration","timeUnitToKbn","ResponseParser","parseResponseValues","result","textFieldName","valueFieldName","list","find","push","parseResourceNames","metricNamespace","toLocaleLowerCase","parseMetadata","metricName","defaultAggTypes","metricData","primaryAggType","primaryAggregationType","supportedAggTypes","supportedAggregationTypes","supportedTimeGrains","label","parseTimeGrains","metricAvailabilities","dimensions","parseDimensions","forEach","avail","metadataDimensions","map","dimension","localizedValue","parseSubscriptions","parseSubscriptionsForSelect","data","parseLocations","locations","location","supportsLogs","findOptions","options","values","set","reduce","accum","item","add","Set","option","has","toOption","addValueToOptions","variableOptionGroup","optionValues","toLowerCase","routeNames","interpolateVariable","variable","multi","includeAll","allValue","val","join","effect","useEffect","predefinedClouds","getAzureClouds","settingsEx","config","azure","clouds","AzureQueryType","ResultFormat","AzureCloud","concealed","getAuthType","jsonData","azureAuthType","tenantId","clientId","managedIdentityEnabled","resolveLegacyCloudName","cloudName","Public","China","USGovernment","getDefaultAzureCloud","cloud","None","cloudInfo","Error","getSecret","secureJsonFields","clientSecret","secret","secureJsonData","isCredentialsComplete","credentials","ignoreSecret","authType","azureCloud","instanceOfAzureCredential","object","selectors","select","input","tenantID","clientID","loadSubscriptions","button","defaultSubscription","serviceCredentialsEnabled","userAuthAlert","userAuthFallbackAlert","resourcePicker","search","apply","cancel","advanced","collapse","subscription","resourceGroup","namespace","region","resource","metricsQueryEditor","logsQueryEditor","formatSelection","argsQueryEditor","subscriptions","tracesQueryEditor","traceTypes","queryType","AppRegistrationCredentials","azureCloudOptions","disabled","onCredentialsChange","Field","data-testid","htmlFor","Select","inputId","aria-label","opt","onChange","selected","updated","required","invalid","error","Input","placeholder","event","div","style","gap","Button","variant","id","workloadIdentityEnabled","authTypeOptions","useMemo","opts","userIdentityFallbackCredentialsEnabled","Alert","severity","Stack","direction","RadioButtonGroup","serviceCredentials","onServiceCredentialsEnabledChange","defaultAuthType","getAzureCloudOptions","AzureCredentialsForm","userIdentityEnabled","unshift","CurrentUserFallbackCredentials","BasicLogsToggle","onBasicLogsEnabledChange","fontSize","Switch","checked","basicLogsEnabled","DefaultSubscription","getSubscriptions","onSubscriptionChange","onSubscriptionsChange","loadSubscriptionsClicked","onLoadSubscriptions","useReducer","updateSubscriptions","canceled","then","received","autoSelect","subscriptionId","MonitorConfig","updateOptions","setSubscriptions","azureCredentials","getCredentials","oauthPassThru","disableGrafanaCache","updateCredentials","useEffectOnce","readOnly","receivedSubscriptions","enableBasicLogs","ConfigEditor","PureComponent","onOptionsChange","this","state","Divider","details","whiteSpace","secureSocksDSProxyEnabled","enableSecureSocksProxy","SecureSocksProxySettings","super","templateSrv","getTemplateSrv","baseURL","optionsFunc","setState","unsaved","saveOptions","getBackendSrv","put","updateDatasourcePluginOption","datasource","version","fetch","url","method","toPromise","err","isFetchError","message","Promise","resolve","messageFromError","maybeAMessage","innererror","useLastError","errors","setErrors","addError","useCallback","errorSource","errorsCopy","index","findIndex","vSource","splice","recentError","isValidElement","useStyles2","getStyles","root","_c","flexDirection","flexWrap","wrap","flexGrow","EditorRows","EditorRow","padding","backgroundColor","background","borderRadius","shape","EditorFieldGroup","query","onQueryChange","newQuery","azureResourceGraph","CodeEditor","language","height","width","showMiniMap","onBlur","onSave","Space","layout","wrapper","paddingRight","paddingBottom","EditorField","optional","tooltip","tooltipInteractive","fieldProps","childInputId","ReactUtils","getChildId","labelEl","Tooltip","placement","interactive","Icon","tabIndex","icon","field","minWidth","fontWeightMedium","fontStyle","marginLeft","primary","labelWidth","inlineField","remainingProps","InlineField","setError","setValues","MultiSelect","isClearable","change","containsSelectAll","allSubs","newSubs","FieldValidationMessage","ERROR_SOURCE","selectSubscriptions","fetchedSubscriptions","currentSubscriptions","currentSubscription","querySubscriptions","templateVars","sub","commonSubscriptions","intersection","results","catch","span","SubscriptionField","QueryField","resources","renderAdvanced","isAdvancedOpen","setIsAdvancedOpen","JSON","stringify","Collapse","collapsible","onToggle","ResourceRowType","EntryIcon","entry","Subscription","ResourceGroup","Resource","VariableGroup","Variable","table","tableLayout","overflow","scrollableTable","tableScroller","maxHeight","selectedTableScroller","row","borderBottom","border","weak","borderBottomColor","medium","disabledRow","opacity","cell","textOverflow","collapseButton","loadingCell","textAlign","spinner","nestedEntry","entryContentItem","truncated","resourceField","maxWidth","resourceFieldButton","nestedRowCheckbox","zIndex","selectionFooter","paddingTop","loadingWrapper","resultLimit","modal","breakpoints","lg","NestedEntry","isSelected","isDisabled","isSelectable","level","scrollIntoView","onToggleCollapse","onSelectedChange","hasChildren","handleToggleCollapse","handleSelectedChanged","ev","checkboxId","uri","document","getElementById","behavior","block","gridSize","Checkbox","NOTHING","DRAFTABLE","DRAFT_STATE","die","args","isDraft","isDraftable","isPlainObject","isMap","isSet","objectCtorString","proto","Ctor","Function","each","iter","getArchtype","Reflect","ownKeys","thing","type_","propOrOldValue","Map","latest","copy_","base_","shallowCopy","base","strict","isPlain","descriptors","desc","create","assign","freeze","deep","isFrozen","clear","delete","dontMutateFrozenCollections","entries","currentScope","plugins","getPlugin","pluginKey","plugin","getCurrentScope","usePatchesInScope","scope","patchListener","patches_","inversePatches_","patchListener_","revokeScope","leaveScope","drafts_","revokeDraft","parent_","enterScope","immer2","immer_","canAutoFreeze_","unfinalizedDrafts_","draft","revoke_","revoked_","processResult","baseDraft","modified_","finalize","maybeFreeze","generateReplacementPatches_","rootScope","path","childValue","finalizeProperty","scope_","finalized_","resultEach","isSet2","generatePatches_","parentState","targetObject","rootPath","targetIsSet","res","assigned_","autoFreeze_","objectTraps","getDescriptorFromProto","draft_","readPropFromProto","peek","prepareCopy","createProxy","current2","currentState","markChanged","Number","isNaN","deleteProperty","owner","setPrototypeOf","arrayTraps","useStrictShallowCopy_","parent","proxyMap_","proxySet_","isManual_","traps","revoke","proxy","Proxy","revocable","createProxyProxy","currentImpl","copy","fn","immer","produce","recipe","defaultBase","self","base2","hasError","ip","produceWithPatches","patches","inversePatches","autoFreeze","setAutoFreeze","useStrictShallowCopy","setUseStrictShallowCopy","createDraft","finishDraft","applyPatches","patch","op","applyPatchesImpl","applyPatches_","bind","UrlBuilder","buildResourceUri","multipleResources","urlArray","resourceName","metricNamespaceProcessed","replace","metricNamespaceArray","split","resourceNameProcessed","resourceNameArray","provider","shift","startsWith","endsWith","parentResource","buildAzureMonitorGetMetricNamespacesUrl","baseUrl","apiVersion","globalRegion","resourceUri","buildAzureMonitorGetMetricNamesUrl","customNamespace","encodeURIComponent","RESOURCE_URI_REGEX","parseResourceURI","resourceURI","matches","exec","groups","metricNamespaceAndResource","metricNamespaceAndName","stringArray","namespaceArray","nextElem","parseNamespaceAndName","parseMultipleResourceDetails","parseResourceDetails","resourcesToStrings","resourceToString","isGUIDish","match","matchURI","rowURI","rowParams","targetParams","rowNamespace","rowName","resourceNamespace","findRow","rows","addResources","targetParentId","newResources","draftState","draftRow","NestedRow","selectedRows","requestNestedRows","onRowSelectedChange","selectableEntryTypes","disableRow","rowStatus","setRowStatus","onRowToggleCollapse","selectedRow","tr","td","some","typeLabel","childRow","FadeTransition","visible","colSpan","LoadingPlaceholder","searchFn","searchFilter","setSearchFilter","debouncedSearch","debounce","prefix","searchPhrase","currentTarget","resourcePickerData","onApply","onCancel","selectionNotice","isLoading","setIsLoading","setRows","setSelectedRows","internalSelected","setInternalSelected","errorMessage","setErrorMessage","shouldShowLimitFlag","setShouldShowLimitFlag","selectionNoticeText","loadInitialData","fetchInitialRows","isValid","sanitized","found","uris","findRows","parseRows","parentRow","nestedRows","fetchAndAppendNestedRow","handleSelectionChanged","newRes","newSelected","newInternalSelected","handleApply","handleSearch","searchWord","searchResults","Search","thead","tbody","aria-live","footer","h5","AdvancedMulti","Modal","ButtonRow","fill","every","ResourceLabel","resourcesComponents","setResourcesComponents","FormattedResource","items","pickerIsOpen","setPickerIsOpen","handleOpenPicker","closePicker","parsedResource","azureLogAnalytics","azureTraces","azureMonitor","aggregation","dimensionFilters","setResources","onDismiss","trapFocus","ResourcePicker","formatOptions","defaultValue","onLoad","setFormatAs","resultFormat","handleChange","AccessoryButton","getButtonStyles","paddingLeft","resourceList","marginBlock","Label","h6","onResourceChange","removeResource","hidden","setKustoQuery","kustoQuery","formatAs","setDashboardTime","dashboardTime","setTimeColumn","timeColumn","setBasicLogsQuery","basicLogsQuery","TimeSeries","LogsManagement","basicLogsAckOpen","setBasicLogsAckOpen","ConfirmModal","confirmText","onConfirm","updatedBasicLogsQuery","confirmButtonVariant","schema","monaco","setMonaco","setupEditor","editor","model","getModel","kustoWorker","getKustoWorker","kustoMode","setSchema","console","handleEditorMount","onEditorDidMount","TimeManagement","defaultTimeColumns","setDefaultTimeColumns","timeColumns","setTimeColumns","disabledTimePicker","setDisabledTimePicker","setDefaultColumn","column","timeColumnOptions","timeColumnsSet","defaultColumnsMap","db","database","tables","cols","columns","prev","curr","timespanColumn","defaultColumns","from","handleTimeColumnChange","code","disabledOptions","allowCustomValue","migrateWorkspaceQueryToResourceQuery","workspace","getResourceURIFromWorkspace","shouldShowBasicLogsToggle","selectedResource","hideFormatAs","timeRange","migrationError","setMigrationError","useMigrations","showBasicLogsToggle","setShowBasicLogsToggle","dataIngestedWarning","setDataIngestedWarning","to","azureLogAnalyticsDatasource","getKustoSchema","getBasicLogsUsage","trim","dataIngested","getBasicLogsQueryUsage","textToShow","Text","TextLink","external","portalLinkButton","series","querySeries","refId","meta","custom","azurePortalLink","LinkButton","ResourceField","AdvancedResourcePicker","FormatAsField","Logs","Table","ThemeContextMock","RawQuery","lang","useContext","ThemeContext","highlighted","Prism","grammar","editorField","dangerouslySetInnerHTML","__html","WeakMap","fontFamily","fontFamilyMonospace","FUNCTIONS","detail","documentation","comment","pattern","greedy","backticks","alias","quote","regex","command","function","keyword","lookbehind","number","punctuation","whitespace","cheatsheetQueries","setCheatsheetQueries","areDropdownsOpen","setAreDropdownsOpen","visibleQueries","setVisibleQueries","searchInputValue","setSearchInputValue","tokenizer","dropdownMenu","category","getCheatsheetQueries","getAzureLogAnalyticsCheatsheetQueries","categories","sort","alphabetizedQueries","queriesByCategory","categoryQueries","related","queries","queryId","filterAlignment","filteredQueries","searchValue","visibleQueriesCategories","filteredQueriesBySearch","filters","filterQueriesBySearch","categoryDropdown","updatedVisibleQueries","selectedCategory","queryCategory","filterQueriesByCategory","backspaceRemovesValue","noOptionsMessage","formatCreateLabel","isSearchable","isMulti","totalQueries","CustomScrollbar","showScrollIndicators","autoHeightMax","Card","card","Heading","rawQuery","Actions","LogAnalytics","reportInteraction","queryName","queryCategories","AzureCheatSheetModal","onClose","AzureCheatSheet","resourceTypeDisplayNames","multiResourceCompatibleTypes","resourceTypes","columnGap","flex","resourceLabel","resourceGroupAndName","onCommonPropChange","grow","transparent","setCustomNamespace","selection","setTimeGrain","setDimensionFilters","aggregationOptions","setAggregation","EditorList","renderItem","newItem","itemIndex","newItems","onChangeItem","onDeleteItem","dimensionOptions","dimensionLabels","setDimensionLabels","labelsObj","labels","flat","flatMap","fields","dimensionLower","prevLabels","newLabels","currentLabels","useDimensionLabels","dimensionOperators","validDimensionOptions","dimensionFilter","onFieldChange","fieldName","getValidFilterOptions","selectedFilter","getValidMultiSelectOptions","selectedFilters","labelOptions","changed","properData","operator","onDelete","selectedOperator","selectedDimension","HorizontalGroup","menuShouldPortal","setValue","HTMLInputElement","handleBlur","setLegendAlias","metricNames","setMetricName","metricNamespaces","timeGrainOptions","autoInterval","TimegrainConverter","baseTimeGrains","top","setTop","useAsyncState","asyncFn","dependencies","Math","random","finalValue","getResourceGroupAndName","defaultMetricMetadata","aggOptions","rawResults","selectedValue","metricsMetadata","metricMetadata","setMetricMetadata","azureMonitorDatasource","getMetricMetadata","metadata","aggregations","newAggregation","newTimeGrain","allowedTimeGrainsMs","useMetricMetadata","getMetricNamespaces","useMetricNamespaces","getMetricNames","useMetricNames","supportMultipleResource","rowResource","selectedRowSample","MetricNamespaceField","MetricNameField","AggregationField","TimeGrainField","DimensionFields","TopField","LegendFormatField","Components","RadioButton","Breadcrumbs","breadcrumb","TimePicker","openButton","overlayContent","fromField","toField","applyTimeRange","copyTimeRange","pasteTimeRange","calendar","closeButton","absoluteTimeRangeTitle","DataSourcePermissions","form","roleType","rolePicker","permissionLevel","DateTimePicker","DataSource","TestData","QueryTab","scenarioSelectContainer","scenarioSelect","max","min","noise","seriesCount","spread","startValue","drop","DataSourceHttpSettings","urlInput","Jaeger","traceIDInput","Prometheus","configPage","connectionSettings","manageAlerts","scrapeInterval","queryTimeout","defaultEditor","disableMetricLookup","prometheusType","prometheusVersion","cacheLevel","incrementalQuerying","queryOverlapWindow","disableRecordingRules","customQueryParameters","httpMethod","exemplarsAddButton","internalLinkSwitch","codeModeMetricNamesSuggestionLimit","queryEditor","explain","editorToggle","legend","format","step","exemplars","builder","metricSelect","hints","metricsExplorer","queryAdvisor","queryField","metricsCountInfo","metricsBrowser","selectMetric","seriesLimit","metricList","labelNamesFilter","labelValuesFilter","useQuery","useAsRateQuery","validateSelector","exemplarMarker","variableQueryEditor","labelnames","metricRegex","labelValues","labelSelect","varQueryResult","seriesQuery","classicQuery","annotations","minStep","tags","seriesValueAsTimestamp","Menu","MenuComponent","MenuGroup","MenuItem","SubMenu","Panels","Panel","headerItems","menuItems","menu","containerByTitle","headerCornerInfo","mode","status","loadingBar","HoverWidget","dragIcon","PanelDataErrorMessage","Visualization","Graph","VisualizationTab","legendSection","Legend","legendItemAlias","showLegendSwitch","xAxis","BarGauge","valueV2","PieChart","svgSlice","VizLegend","seriesName","Drawer","General","expand","contract","close","rcContentWrapper","DashboardSaveDrawer","saveButton","saveAsButton","saveAsTitleInput","PanelEditor","OptionsPane","fieldLabel","fieldInput","DataPane","applyButton","toggleVizPicker","toggleVizOptions","toggleTableView","showZoomField","showAttributionField","showScaleField","showMeasureField","showDebugField","measureButton","PanelInspector","Data","Stats","Json","Query","refreshButton","jsonObjectKeys","Tab","active","RefreshPicker","runButton","intervalButton","runButtonV2","intervalButtonV2","queryInspectorButton","queryHistoryButton","addQuery","queryGroupTopSection","addExpression","QueryHistory","queryText","QueryEditorRows","QueryEditorRow","actionButton","AlertTab","AlertRules","groupToggle","toggle","expandedContent","previewButton","ruleNameField","newFolderButton","newFolderNameField","newFolderNameCreateButton","newEvaluationGroupButton","newEvaluationGroupName","newEvaluationGroupInterval","newEvaluationGroupCreate","alert","alertV2","TransformTab","newTransform","transformationEditor","transformationEditorDebugger","Transforms","disableTransformationButton","Reduce","modeLabel","calculationsLabel","SpatialOperations","actionLabel","locationLabel","autoOption","coords","latitudeFieldLabel","longitudeFieldLabel","geohash","geohashFieldLabel","lookup","lookupFieldLabel","gazetteerFieldLabel","searchInput","noTransformationsMessage","addTransformationButton","removeAllTransformationsButton","NavBar","Configuration","Toggle","Reporting","NavMenu","NavToolbar","shareDashboard","markAsFavorite","editDashboard","editButton","exitButton","settingsButton","addRowButton","addLibraryPanelButton","addVisualizationButton","pastePanelButton","discardChangesButton","discardLibraryPanelButton","unlinkLibraryPanelButton","saveLibraryPanelButton","backToDashboardButton","PageToolbar","itemButton","QueryEditorToolbarItem","BackButton","backArrow","OptionsGroup","group","PluginVisualization","toggleAllOptions","singleValue","FieldConfigEditor","OverridesConfigEditor","FolderPicker","containerV2","ReadonlyFolderPicker","DataSourcePicker","inputV2","dataSourceList","advancedModal","builtInDataSourceList","TimeZonePicker","changeTimeSettingsButton","WeekStartPicker","TraceViewer","spanBar","QueryBuilder","queryPatterns","inputSelect","valueSelect","matchOperatorSelect","ValuePicker","section","sectionV2","itemsV2","cards","collapseFolder","sectionId","expandFolder","dashboardItem","dashboardItems","dashboardCard","folderHeader","folderName","folderContent","DashboardLinks","dropDown","LoadingIndicator","CallToActionCard","buttonV2","DataLinksContextMenu","singleLink","ReactMonacoEditor","editorLazy","DashboardImportPage","textarea","submit","ImportDashboardForm","PanelAlertTabContent","VisualizationPreview","ColorSwatch","DashboardRow","UserProfile","profileSaveButton","preferencesSaveButton","orgsTable","sessionsTable","extensionPointTabs","extensionPointTab","tabId","FileUpload","inputField","fileNameSpan","DebugOverlay","OrgRolePicker","AnalyticsToolbarButton","Variables","variableOption","variableLinkWrapper","Annotations","annotationsTypeInput","annotationsChoosePanelInput","testButton","resultContainer","ReturnToPrevious","buttonGroup","backButton","dismissButton","SQLQueryEditor","selectColumn","selectAggregation","selectAlias","filterConjunction","filterField","filterOperator","headerTableSelector","headerFilterSwitch","headerGroupSwitch","headerOrderSwitch","headerPreviewSwitch","EntityNotFound","pages","Login","username","password","skip","Home","saveAndTest","DataSources","dataSources","EditDataSource","dataSourceUid","settings","AddDataSource","dataSourcePlugins","pluginName","dataSourcePluginsV2","AddDashboard","addNewPanel","addNewRow","addNewPanelLibrary","Dashboard","uid","DashNav","nav","navV2","publicDashboardTag","shareButton","scrollContainer","newShareButton","shareLink","arrowMenu","shareInternally","shareExternally","shareSnapshot","NewExportButton","exportAsJson","playlistControls","stop","next","Controls","submenu","submenuItem","submenuItemLabels","submenuItemValueDropDownValueLinkTexts","submenuItemValueDropDownDropDown","submenuItemValueDropDownOptionTexts","annotationsWrapper","annotationLabel","annotationToggle","Settings","deleteDashBoard","sectionItems","saveDashBoard","saveAsDashBoard","timezone","List","addAnnotationCTA","addAnnotationCTAV2","NewAnnotation","panelFilterSelect","showInLabel","previewInDashboard","enable","hide","addVariableCTA","addVariableCTAV2","newButton","tableRowNameFields","variableName","tableRowDefinitionFields","tableRowArrowUpButtons","tableRowArrowDownButtons","tableRowDuplicateButtons","tableRowRemoveButtons","Edit","headerLink","modeLabelNew","modeLabelEdit","generalNameInput","generalNameInputV2","generalTypeSelect","generalTypeSelectV2","generalLabelInput","generalLabelInputV2","generalHideSelect","generalHideSelectV2","selectionOptionsMultiSwitch","selectionOptionsIncludeAllSwitch","selectionOptionsCustomAllInput","previewOfValuesOption","submitButton","QueryVariable","queryOptionsDataSourceSelect","queryOptionsRefreshSelect","queryOptionsRefreshSelectV2","queryOptionsRegExInput","queryOptionsRegExInputV2","queryOptionsSortSelect","queryOptionsSortSelectV2","queryOptionsQueryInput","valueGroupsTagsEnabledSwitch","valueGroupsTagsTagsQueryInput","valueGroupsTagsTagsValuesQueryInput","ConstantVariable","constantOptionsQueryInput","constantOptionsQueryInputV2","DatasourceVariable","datasourceSelect","TextBoxVariable","textBoxOptionsQueryInput","textBoxOptionsQueryInputV2","CustomVariable","customValueInput","IntervalVariable","intervalsValueInput","autoEnabledCheckbox","stepCountIntervalSelect","minIntervalInput","GroupByVariable","dataSourceSelect","infoText","modeToggle","AdHocFiltersVariable","marker","Rows","Repeated","warningMessage","Dashboards","dashboards","SaveDashboardAsModal","newName","save","SaveDashboardModal","saveVariables","saveTimerange","saveRefresh","SharePanelModal","linkToRenderedImage","ShareDashboardModal","PublicDashboard","WillBePublicCheckbox","LimitedDSCheckbox","CostIncreaseCheckbox","PauseSwitch","EnableAnnotationsSwitch","CreateButton","DeleteButton","CopyUrlInput","CopyUrlButton","SettingsDropdown","TemplateVariablesWarningAlert","UnsupportedDataSourcesWarningAlert","NoUpsertPermissionsWarningAlert","EnableTimeRangeSwitch","EmailSharingConfiguration","Container","ShareType","EmailSharingInput","EmailSharingInviteButton","EmailSharingList","DeleteEmail","ReshareLink","SnapshotScene","PublishSnapshot","ShareDashboardDrawer","ShareInternally","lockTimeRangeSwitch","shortenUrlSwitch","copyUrlButton","ShareExternally","publicAlert","emailSharingAlert","shareTypeSelect","Creation","PublicShare","createButton","cancelButton","EmailShare","willBePublicCheckbox","enableTimeRangeSwitch","enableAnnotationsSwitch","revokeAccessButton","toggleAccessButton","ShareSnapshot","publishSnapshot","ExportDashboardDrawer","ExportAsJson","codeEditor","exportExternallyToggle","saveToFileButton","copyToClipboardButton","page","NotAvailable","pausedDescription","PublicDashboardScene","loadingPage","controls","RequestViewAccess","recipientInput","PublicDashboardConfirmAccess","Explore","graph","scrollView","SoloPanel","PluginsList","listItem","signatureErrorNotice","PluginPage","signatureInfo","disabledInfo","PlaylistForm","itemDelete","BrowseDashboards","checkbox","NewFolderForm","nameInput","FolderView","PublicDashboards","ListItem","linkButton","configButton","trashcanButton","pauseSwitch","UserListPage","tabs","allUsers","orgUsers","anonUserDevices","publicDashboardsUsers","users","org","admin","publicDashboards","UserListAdminPage","UsersListPage","UserAnonListPage","UsersListPublicDashboardsPage","DashboardsListModal","ProfilePage","components","getTraceProperties","propertyMap","setPropertyMap","range","property","queryString","lastValueFrom","requestId","scopedVars","startTime","app","CoreApp","Unknown","targets","getDefaultTimeRange","parse","toArray","count","Option","innerProps","innerRef","isFocused","getSelectStyles","onClickMultiOption","selectOption","stopPropagation","preventDefault","optionFocused","optionSelected","optionDisabled","onKeyDown","role","aria-checked","optionBody","Filter","queryTraceTypes","properties","loading","setLoading","setSelected","loadOptions","vals","promise","ButtonSelect","operation","AsyncMultiSelect","blurInputOnSelect","onOpenMenu","defaultOptions","closeMenuOnSelect","onCloseMenu","hideSelectedOptions","Tables","availabilityResults","customEvents","exceptions","pageViews","requests","traces","attributesOmit","common","appId","application_Version","appName","client_Browser","client_City","client_CountryOrRegion","client_IP","client_Model","client_OS","client_StateOrProvince","client_Type","cloud_RoleInstance","cloud_RoleName","customDimensions","customMeasurements","iKey","itemCount","itemId","itemType","operation_Id","operation_Name","operation_ParentId","operation_SyntheticSource","performanceBucket","sdkVersion","session_Id","success","timestamp","user_AccountId","user_AuthenticatedId","user_Id","availabilityResultsSchema","dependenciesSchema","resultCode","eventsSchema","omit","pageViewsSchema","tablesSchema","assembly","handledAt","innermostAssembly","innermostMessage","innermostMethod","innermostType","outerAssembly","outerMessage","outerMethod","outerType","problemId","severityLevel","setTraceTypes","excludedProperties","uniq","queryFilters","updateFilters","operationId","updateQuery","setFilters","allEventTypes","defaultQuery","getDefaultOptions","setOperationId","previousOperationId","useRef","TraceExemplar","AzureTraces","setDefaultTracesQuery","setQueryOperationId","TraceTypeField","Filters","Trace","EditorHeader","minHeight","InlineSelect","labelProp","SelectContainer","ValueContainer","SingleValue","openMenuOnFocus","valueContainer","borderColor","QueryHeader","queryTypes","AzureMonitor","AzureResourceGraph","migrateQuery","workingQuery","migrateLogAnalyticsToFromTimes","setMetricsTimeGrain","migrateTimeGrains","metricDefinition","migrateToDefaultNamespace","oldDimension","appendDimensionFilter","migrateDimensionToDimensionFilter","azureMonitorQuery","newFilters","staticProps","hasFilter","oldFilter","migrateDimensionFilterToArray","isWellFormedUri","migrateResourceUriToResourceObj","migrateResourceGroupAndName","intersectTime","DEFAULT_QUERY","onChangeQuery","preparedQuery","transformedQuery","transformExemplarQuery","defaults","migratedQuery","deepEqual","prepareQuery","EditorForQueryType","NewMetricsQueryEditor","LogsQueryEditor","ArgQueryEditor","TracesQueryEditor","UserAuthAlert","UserAuthFallbackAlert","isFunction","extendStatics","__proto__","__extends","TypeError","String","__","__values","s","iterator","done","__read","ar","__spreadArray","pack","SuppressedError","ctorFunc","UnsubscriptionError","_super","createImpl","instance","stack","arrRemove","arr","initialTeardown","closed","_parentage","_finalizers","empty","unsubscribe","e_1","e_2","_parentage_1","_parentage_1_1","remove","e_1_1","return","initialFinalizer","_finalizers_1","_finalizers_1_1","finalizer","execFinalizer","e_2_1","teardown","_hasParent","_addParent","_removeParent","EMPTY","timeoutProvider","setTimeout","handler","timeout","_i","delegate","clearTimeout","handle","noop","COMPLETE_NOTIFICATION","createNotification","Subscriber","destination","_this","isStopped","EMPTY_OBSERVER","complete","SafeSubscriber","handleStoppedNotification","nextNotification","_next","_error","_complete","_bind","thisArg","ConsumerObserver","partialObserver","handleUnhandledError","observerOrNext","context_1","reportUnhandledError","notification","subscriber","onStoppedNotification","OperatorSubscriber","onNext","onComplete","onError","onFinalize","shouldUnsubscribe","closed_1","project","init","subscribe","lift","hasLift","liftedSource","METADATA_FUNCTION_PARAMS","transformMetadataFunction","sourceSchema","functions","params","parameters","arg","cslDefaultValue","inputParameters","AzureLogAnalyticsDatasource","DataSourceWithBackend","isConfigured","validateDatasource","filterQuery","azureMonitorPath","getResource","getWorkspaces","response","getWorkspaceList","defaultSubscriptionId","workspaceListUrl","getMetadata","resourcePath","interpolatedUri","nameOrIdOrSomething","templateVariables","majorVersion","minorVersion","entityGroups","clusterType","cluster","connectionString","databases","globalScalarParameters","transformMetadataToKustoSchema","getVariables","applyTemplateVariables","expandResourcesForMultipleVariables","firstWorkspace","filtersReplaced","expandedResources","getDeprecatedDefaultWorkSpace","instanceSettings","logAnalyticsDefaultWorkspace","getDefaultOrFirstSubscription","getFirstWorkspace","workspaces","isValidConfigField","postResource","hasValue","AzureMonitorDatasource","hasResource","hasResourceUri","preMigrationQuery","migratedTarget","replaceTemplateVariables","azMonitorQuery","getResourceGroups","listByResourceGroupApiVersion","getResourceNames","skipToken","promises","validMetricNamespace","nextLink","nextToken","URL","searchParams","nextPage","all","apiPreviewVersion","replaceSingleTemplateVariables","storageNamespaces","reason","workingQueries","replaced","multiple","currentQueries","getProvider","providerName","providerApiVersion","getLocations","locationMap","subLocations","locationsApiVersion","AzureResourceGraphDatasource","ts","variableNames","subscriptionVar","_","logsSupportedResourceTypesKusto","ResourcePickerData","currentSelection","resourceGroupURI","resourceGroups","getResourceGroupsBySubscriptionId","resourcesForResourceGroup","getResourcesForResourceGroup","$skipToken","allFetched","resourceResponse","makeResourceGraphRequest","subscriptionName","filterByType","parsedUri","resourceGroupName","resourceGroupUri","locationDisplayName","getResourceURIDisplayProperties","subscriptionURI","responseResourceName","maxRetries","reqOptions","fetchAllNamespaces","supportedMetricNamespaces","getNamespacesForRegion","namespaces","resourceObjs","newSelectedRows","rtype","searchType","searchQuery","migrateAnnotation","annotation","oldQuery","oldWorkspace","grafanaTemplateVariableFnMatches","resourceGroupsWithSub","namespacesWithSub","resourceNames","resourceNamesWithSub","metricNamespaceWithSub","metricNamesWithSub","appInsightsMetricNameQuery","appInsightsGroupByQuery","workspacesQuery","workspacesQueryWithSub","createLogAnalyticsTemplateVariableQuery","defaultWorkspaceId","migrateStringQueriesToObjectQueries","isGrafanaTemplateVariableFnQuery","matchesForQuery","GrafanaTemplateVariableFn","grafanaTemplateVariableFn","createGrafanaTemplateVariableQuery","SubscriptionsQuery","ResourceGroupsQuery","ResourceNamesQuery","NamespacesQuery","MetricNamesQuery","WorkspacesQuery","migrateGrafanaTemplateVariableFn","inputVal","setInputVal","onRunQuery","updatedQuery","removeOption","AZURE_QUERY_VARIABLE_TYPE_OPTIONS","LocationsQuery","setVariableOptionGroup","requireSubscription","setRequireSubscription","hasResourceGroup","setHasResourceGroup","hasNamespace","setHasNamespace","hasRegion","setHasRegion","requireResourceGroup","setRequireResourceGroup","requireNamespace","setRequireNamespace","requireResource","setRequireResource","setResourceGroups","setNamespaces","regions","setRegions","isEqual","getVariablesRaw","subs","rgs","queryChange","selectableValue","GrafanaTemplateVariableFnInput","VariableSupport","CustomVariableSupport","request","promisedResults","queryObj","toDataFrame","getAzureLogAnalyticsWorkspaces","templateVariablesResults","callGrafanaTemplateVariableFn","loc","queryResp","replaceVariable","metric","VariableEditor","Datasource","ds","pseudoDatasource","byType","baseTarget","hasQueryForType","queryForType","cloneDeep","observables","req","mappedQueryType","forkJoin","pipe","frame","LoadingState","Done","of","targetContainsTemplate","containsTemplate","subQuery","interpolateVariablesInQueries","getRef","modifyQuery","action","expression","azureResourceGraphDatasource","currentUserAuth","currentUserAuthFallbackAvailable","prepareAnnotation","variables","DataSourcePlugin","setConfigEditor","setQueryEditor","baseQuery","baseOnRunQuery","azureLogsCheatSheetModalOpen","setAzureLogsCheatSheetModalOpen","usePreparedQuery","UnifiedAlerting","CloudAlerting","isAzureAuthenticated","bootData","user","authenticatedBy","prevValue","editorMode","getAppEvents","DashboardLoadedEvent","payload","dashboardId","orgId","userId","grafanaVersion","azureQueries","pluginJson","multiResource","stats","grafanaTime","queryTime","trace","operationIdSpecified","eventTypesSpecified","filtersSpecified","unknown","grafana_version","dashboard_id","org_id","azure_monitor_queries","azure_monitor_queries_hidden","azure_monitor_multiple_resource","azure_monitor_query","azure_log_analytics_queries","azure_log_analytics_queries_hidden","azure_log_multiple_resource","azure_log_analytics_queries_grafana_time","azure_log_analytics_queries_query_time","azure_log_query","azure_resource_graph_queries","azure_resource_graph_queries_hidden","azure_resource_graph_multiple_subscription","azure_resource_graph_query","azure_traces_queries","azure_traces_queries_hidden","azure_traces_multiple_resource","azure_traces_table","azure_traces_trace","azure_traces_operation_id_specified","azure_traces_event_type_specified","azure_traces_filters","azure_traces_query","azure_subscriptions_query","azure_resource_groups_query","azure_namespaces_query","azure_resource_names_query","azure_metric_names_query","azure_workspaces_query","azure_grafana_template_variable_query","azure_locations_query","azure_unknown_query"],"sourceRoot":""}